{
  "source_url": "https://github.com/mcneel/rhino-developer-samples/blob/8462fc3487f8b7a58595ef73f6a5c09f92717f60/rhinopython/SampleEtoRebuildCurve.py",
  "repo": "mcneel/rhino-developer-samples",
  "repo_stars": 743,
  "repo_description": "Rhino and Grasshopper developer sample code",
  "license": "NOASSERTION",
  "filepath": "rhinopython/SampleEtoRebuildCurve.py",
  "instruction": "SampleEtoRebuildCurve.py Copyright (c) 2017 Robert McNeel & Associates. See License.md in the root of this repository for details. Imports",
  "code": "################################################################################\n# SampleEtoRebuildCurve.py\n# Copyright (c) 2017 Robert McNeel & Associates.\n# See License.md in the root of this repository for details.\n################################################################################\n# Imports\nimport Rhino\nimport scriptcontext as sc\nimport Rhino.UI\nimport Eto.Drawing as drawing\nimport Eto.Forms as forms\n\n################################################################################\n# Class to hold rebuild arguments\n################################################################################\nclass RebuildCurveArgs():\n    \n    # Initializer\n    def __init__(self):\n        self.PointCount = 0\n        self.Degree = 0\n        self.PreserveTangents = False\n        self.DeleteInput = True\n    \n    # Validator\n    def IsValid(self):\n        if self.PointCount < 2 or self.PointCount > 32767: return False\n        if self.Degree < 1 or self.Degree > 11: return False\n        return True\n    \n################################################################################\n# Rebuild curve dialog class\n################################################################################\nclass RebuildCurveDialog(forms.Dialog[bool]):\n    \n    # Initializer\n    def __init__(self, args):\n        self.Args = args\n        # Initialize dialog box\n        self.Title = 'Rebuild'\n        self.Padding = drawing.Padding(5)\n        # Create layout\n        layout = forms.DynamicLayout()\n        layout.Padding = drawing.Padding(5)\n        layout.Spacing = drawing.Size(5, 5)\n        layout.AddRow(self.CreateSteppers())\n        layout.AddRow(None) # spacer\n        layout.AddRow(self.CreateCheckBoxes())\n        layout.AddRow(None) # spacer\n        layout.AddRow(self.CreateButtons())\n        # Set the dialog content\n        self.Content = layout\n    \n    # Creates numeric stepper controls\n    def CreateSteppers(self):\n        # Create labels\n        label0 = forms.Label(Text = 'Point count:')\n        label1 = forms.Label(Text = 'Degree:')\n        label2 = forms.Label(Text = '({})'.format(self.Args.PointCount))\n        label3 = forms.Label(Text = '({})'.format(self.Args.Degree))\n        # Create numeric steppers\n        self.PointCount = forms.NumericStepper(\n            Value = self.Args.PointCount,\n            MinValue = 2,\n            MaxValue = 32767\n            )\n        self.Degree = forms.NumericStepper(\n            Value = self.Args.Degree,\n            MinValue = 1,\n            MaxValue = 11\n            )\n        # Create table layout\n        layout = forms.DynamicLayout()\n        layout.Spacing = drawing.Size(5, 5)\n        layout.AddRow(label0, label2, self.PointCount)\n        layout.AddRow(label1, label3, self.Degree)\n        return layout\n    \n    # Creates checkbox controls\n    def CreateCheckBoxes(self):\n        # Create checkboxes\n        self.DeleteInput = forms.CheckBox(\n            Text = 'Delete input', \n            Checked = self.Args.DeleteInput,\n            ThreeState = False\n            )\n        self.PreserveTangents = forms.CheckBox(\n            Text = 'Preserve tangent end directions', \n            Checked = self.Args.PreserveTangents,\n            ThreeState = False\n            )\n        # Create table layout\n        layout = forms.DynamicLayout()\n        layout.Spacing = drawing.Size(5, 5)\n        layout.AddRow (self.DeleteInput)\n        layout.AddRow (self.PreserveTangents)\n        return layout\n    \n    # OK button click handler\n    def OnOkButtonClick(self, sender, e):\n        # Harvest control values before closing\n        self.Args.PointCount = self.PointCount.Value\n        self.Args.Degree = self.Degree.Value\n        self.Args.PreserveTangents = self.PreserveTangents.Checked\n        self.Args.DeleteInput = self.DeleteInput.Checked\n        self.Close(True)\n    \n    # Cancel button click handler\n    def OnCancelButtonClick(self, sender, e):\n        self.Close(False)\n    \n    # Create button controls\n    def CreateButtons(self):\n        # Create the default button\n        self.DefaultButton = forms.Button(Text = 'OK')\n        self.DefaultButton.Click += self.OnOkButtonClick\n        # Create the abort button\n        self.AbortButton = forms.Button(Text = 'Cancel')\n        self.AbortButton.Click += self.OnCancelButtonClick\n        # Create button layout\n        button_layout = forms.DynamicLayout()\n        button_layout.Spacing = drawing.Size(5, 5)\n        button_layout.AddRow(None, self.DefaultButton, self.AbortButton, None)\n        return button_layout\n    \n################################################################################\n# Function to test the rebuild curve dialog\n################################################################################\ndef TestRebuildCurve():\n    \n    res, objref = Rhino.Input.RhinoGet.GetOneObject(\n        \"Select curve to rebuild\", \n        True, \n        Rhino.DocObjects.ObjectType.Curve\n        )\n    if res != Rhino.Commands.Result.Success: return\n    \n    curve = objref.Curve()\n    if curve is None: return\n        \n    nurb = curve.ToNurbsCurve()\n    if curve is None: return    \n    \n    args = RebuildCurveArgs()\n    args.PointCount = nurb.Points.Count\n    args.Degree = nurb.Degree\n    \n    dlg = RebuildCurveDialog(args)\n    rc = dlg.ShowModal(Rhino.UI.RhinoEtoApp.MainWindow)\n    if rc and args.IsValid():\n        nurb = curve.Rebuild(args.PointCount, args.Degree, args.PreserveTangents)\n        if nurb:\n            if args.DeleteInput:\n                sc.doc.Objects.Replace(objref, nurb)\n            else:\n                sc.doc.Objects.Add(nurb, objref.Object().Attributes)\n            sc.doc.Views.Redraw()\n    \n################################################################################\n# Check to see if this file is being executed as the \"main\" python\n# script instead of being used as a module by some other python script\n# This allows us to use the module which ever way we want.\n################################################################################\nif __name__ == \"__main__\":\n    TestRebuildCurve()",
  "language": "python",
  "imports": [
    "Rhino",
    "scriptcontext"
  ],
  "has_docstring": true
}