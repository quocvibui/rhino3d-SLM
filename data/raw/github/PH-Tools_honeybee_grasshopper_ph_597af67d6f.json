{
  "source_url": "https://github.com/PH-Tools/honeybee_grasshopper_ph/blob/c433bc8e66f3a51fd05ee4c485f4c54c03d2a569/honeybee_ph_rhino/gh_compo_io/tb_create.py",
  "repo": "PH-Tools/honeybee_grasshopper_ph",
  "repo_stars": 6,
  "repo_description": "Honeybe-PH plugin for Rhino / Grasshopper ",
  "license": "GPL-3.0",
  "filepath": "honeybee_ph_rhino/gh_compo_io/tb_create.py",
  "instruction": "GHCompo Interface: HBPH - Add Thermal Bridges to Rooms.",
  "code": "# -*- coding: utf-8 -*-\n# -*- Python Version: 2.7 -*-\n\n\"\"\"GHCompo Interface: HBPH - Add Thermal Bridges to Rooms.\"\"\"\n\nfrom uuid import uuid4\n\ntry:\n    from typing import List, Union\nexcept ImportError:\n    pass  # IronPython 2.7\n\ntry:\n    from ladybug_rhino.togeometry import to_polyline3d\nexcept ImportError as e:\n    raise ImportError(\"\\nFailed to import ladybug_rhino:\\n\\t{}\".format(e))\n\ntry:\n    from ladybug_geometry.geometry3d.polyline import LineSegment3D, Polyline3D\nexcept ImportError as e:\n    raise ImportError(\"\\nFailed to import ladybug_geometry:\\n\\t{}\".format(e))\n\nfrom honeybee_energy_ph.construction import thermal_bridge\nfrom honeybee_ph_utils import input_tools\n\nfrom honeybee_ph_rhino import gh_io\nfrom honeybee_ph_rhino.gh_compo_io import ghio_validators\n\n\nclass _TBBuilder(object):\n    \"\"\"Interface for collect and clean PhThermalBridge user-inputs\"\"\"\n\n    display_name = ghio_validators.HBName(\"display_name\", default=\"_unnamed_bldg_segment_\")\n    psi_value = ghio_validators.UnitW_MK(\"psi_value\", default=0.1)\n    fRsi_value = ghio_validators.FloatPercentage(\"fRsi_value\", default=0.75)\n    quantity = ghio_validators.Float(\"quantity\", default=1.0)\n\n    def __init__(\n        self,\n        _IGH,\n        _geometry,\n        _display_name=\"_unnamed_bldg_segment_\",\n        _psi=0.1,\n        _fRsi=0.75,\n        _quantity=1.0,\n        _grp_type=15,\n    ):\n        # type: (gh_io.IGH, Union[Polyline3D, LineSegment3D], str, float, float, float, int) -> None\n        self.IGH = _IGH\n        self.geometry = _geometry\n        self.display_name = _display_name\n        self.psi_value = _psi\n        self.fRsi_value = _fRsi\n        self.quantity = _quantity\n        self.group_type = _grp_type\n\n    def _convert_to_polyline(self, _input):\n        \"\"\"Try to convert to a Rhino Polyline object\"\"\"\n        cps = self.IGH.ghpythonlib_components.ControlPoints(_input).points\n        return self.IGH.ghpythonlib_components.PolyLine(cps, False)\n\n    @property\n    def geometry(self):\n        return self._geometry\n\n    @geometry.setter\n    def geometry(self, _input):\n        try:\n            self._geometry = to_polyline3d(_input)\n        except:\n            try:\n                self._geometry = to_polyline3d(self._convert_to_polyline(_input))\n            except Exception as e:\n                raise Exception(\"{}\\nError: Input {} cannot be converted to an LBT Polyline3D?\".format(e, _input))\n\n    @property\n    def group_type(self):\n        return self._group_type\n\n    @group_type.setter\n    def group_type(self, _in):\n        # type: (int) -> None\n        input_int = input_tools.input_to_int(_in)\n        if input_int:\n            self._group_type = thermal_bridge.PhThermalBridgeType(input_int)\n        else:\n            self._group_type = thermal_bridge.PhThermalBridgeType(15)\n\n    def create_hbph_thermal_bridge(self):\n        # type () -> thermal_bridge.PhThermalBridge\n        if not self.geometry:\n            raise Exception(\"Error: Invalid or None Geometry input? Cannot build Thermal Bridge.\")\n\n        new_obj = thermal_bridge.PhThermalBridge(uuid4(), self.geometry)\n        new_obj.display_name = self.display_name\n        new_obj.psi_value = self.psi_value\n        new_obj.fRsi_value = self.fRsi_value\n        new_obj.quantity = self.quantity\n        new_obj.group_type = self.group_type.number\n\n        return new_obj\n\n\nclass GHCompo_CreateTB(object):\n    def __init__(self, _IGH, _geometry, _names, _psi_values, _fRsi_values, _types, _quantities):\n        self.IGH = _IGH\n        self.geometry = _geometry\n        self.names = _names\n        self.psi_values = _psi_values\n        self.fRsi_values = _fRsi_values\n        self.types = _types\n        self.quantities = _quantities\n\n    def run(self):\n        # type: () -> List[thermal_bridge.PhThermalBridge]\n        thermal_bridges_ = []\n        for i in range(len(self.geometry)):\n            tb_builder = _TBBuilder(\n                self.IGH,\n                input_tools.clean_get(self.geometry, i),\n                input_tools.clean_get(self.names, i),\n                input_tools.clean_get(self.psi_values, i),\n                input_tools.clean_get(self.fRsi_values, i, 0.75),\n                input_tools.clean_get(self.quantities, i, 1),\n                input_tools.clean_get(self.types, i, 15),\n            )\n            thermal_bridges_.append(tb_builder.create_hbph_thermal_bridge())\n\n        return thermal_bridges_\n",
  "language": "python",
  "imports": [
    "ghpythonlib"
  ],
  "has_docstring": true
}