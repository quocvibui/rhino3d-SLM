{
  "source_url": "https://github.com/ar0551/Wasp/blob/66f63c018f2420d37aa451ade0178de260946b0c/src/wasp/core/attributes.py",
  "repo": "ar0551/Wasp",
  "repo_stars": 67,
  "repo_description": "Combinatorial Design with Grasshopper plug-in (LGPL) initiated by Andrea Rossi",
  "license": "LGPL-3.0",
  "filepath": "src/wasp/core/attributes.py",
  "instruction": "(C) 2017-2020 Andrea Rossi <ghwasp@gmail.com>",
  "code": "\"\"\"\n(C) 2017-2020 Andrea Rossi <ghwasp@gmail.com>\n\nThis file is part of Wasp. https://github.com/ar0551/Wasp\n@license GPL-3.0 <https://www.gnu.org/licenses/gpl.html>\n\n@version 0.6.001\n\nAttribute classes and utilities\n\"\"\"\n\nfrom Rhino.Geometry import Point3d\nfrom Rhino.Geometry import Plane\nfrom Rhino.Geometry import Line\n\n#################################################################### Attribute ####################################################################\nclass Attribute(object):\n\t\n\t## constructor\n\tdef __init__(self, name, values, transformable):\n\t\tself.name = name\n\t\tself.values = values\n\t\tself.transformable = transformable\n\t\n\t## override Rhino .ToString() method (display name of the class in Gh)\n\tdef ToString(self):\n\t\treturn \"WaspAttribute [name: %s]\" % (self.name)\n\t\n\t## return a transformed copy of the attribute\n\tdef transform(self, trans):\n\t\tif self.transformable == True:\n\t\t\tvalues_trans = []\n\t\t\tfor val in self.values:\n\t\t\t\tval_trans = None\n\t\t\t\t## !!!! add try..except.. block for other geometry types (?)\n\t\t\t\tif type(val) == Point3d:\n\t\t\t\t\tval_trans = Point3d(val)\n\t\t\t\telif type(val) == Plane:\n\t\t\t\t\tval_trans = Plane(val)\n\t\t\t\telif type(val) == Line:\n\t\t\t\t\tval_trans = Line(val.From, val.To)\n\t\t\t\telse:\n\t\t\t\t\tval_trans = val.Duplicate()\n\t\t\t\tval_trans.Transform(trans)\n\t\t\t\tvalues_trans.append(val_trans)\n\t\t\tattr_trans = Attribute(self.name, values_trans, self.transformable)\n\t\telse:\n\t\t\tattr_trans = Attribute(self.name, self.values, self.transformable)\n\t\treturn attr_trans\n\t\n\t## return a copy of the attribute\n\tdef copy(self):\n\t\tif self.transformable == True:\n\t\t\tvalues_copy = []\n\t\t\tfor val in self.values:\n\t\t\t\tval_copy = None\n\t\t\t\tif type(val) == Point3d:\n\t\t\t\t\tval_copy = Point3d(val)\n\t\t\t\telif type(val) == Plane:\n\t\t\t\t\tval_copy = Plane(val)\n\t\t\t\telif type(val) == Line:\n\t\t\t\t\tval_copy = Line(val.From, val.To)\n\t\t\t\telse:\n\t\t\t\t\tval_copy = val.Duplicate()\n\t\t\t\tvalues_copy.append(val_copy)\n\t\t\tattr_copy = Attribute(self.name, values_copy, self.transformable)\n\t\telse:\n\t\t\tattr_copy = Attribute(self.name, self.values, self.transformable)\n\t\treturn attr_copy\n\n\n#################################################################### Attribute ####################################################################\nclass SmartAttribute(Attribute):\n\t\n\t## constructor\n\tdef __init__(self, name, values, transformable, connections = [], conn_mask = []):\n\t\tsuper(SmartAttribute, self).__init__(name, values, transformable)\n\n\t\tself.connections = connections\n\t\tself.conn_mask = conn_mask\n\t\n\t## override Rhino .ToString() method (display name of the class in Gh)\n\tdef ToString(self):\n\t\treturn \"WaspSmartAttribute [name: %s]\" % (self.name)\n\t\n\t## return a transformed copy of the attribute\n\tdef transform(self, trans):\n\t\tif self.transformable == True:\n\t\t\tvalues_trans = []\n\t\t\tfor val in self.values:\n\t\t\t\tval_trans = None\n\t\t\t\t## !!!! add try..except.. block for other geometry types (?)\n\t\t\t\tif type(val) == Point3d:\n\t\t\t\t\tval_trans = Point3d(val)\n\t\t\t\telif type(val) == Plane:\n\t\t\t\t\tval_trans = Plane(val)\n\t\t\t\telif type(val) == Line:\n\t\t\t\t\tval_trans = Line(val.From, val.To)\n\t\t\t\telse:\n\t\t\t\t\tval_trans = val.Duplicate()\n\t\t\t\tval_trans.Transform(trans)\n\t\t\t\tvalues_trans.append(val_trans)\n\t\t\tattr_trans = SmartAttribute(self.name, values_trans, self.transformable, self.connections, self.conn_mask)\n\t\telse:\n\t\t\tattr_trans = SmartAttribute(self.name, self.values, self.transformable, self.connections, self.conn_mask)\n\t\treturn attr_trans\n\t\n\t## return a copy of the attribute\n\tdef copy(self):\n\t\tif self.transformable == True:\n\t\t\tvalues_copy = []\n\t\t\tfor val in self.values:\n\t\t\t\tval_copy = None\n\t\t\t\tif type(val) == Point3d:\n\t\t\t\t\tval_copy = Point3d(val)\n\t\t\t\telif type(val) == Plane:\n\t\t\t\t\tval_copy = Plane(val)\n\t\t\t\telif type(val) == Line:\n\t\t\t\t\tval_copy = Line(val.From, val.To)\n\t\t\t\telse:\n\t\t\t\t\tval_copy = val.Duplicate()\n\t\t\t\tvalues_copy.append(val_copy)\n\t\t\tattr_copy = SmartAttribute(self.name, values_copy, self.transformable, self.connections, self.conn_mask)\n\t\telse:\n\t\t\tattr_copy = SmartAttribute(self.name, self.values, self.transformable, self.connections, self.conn_mask)\n\t\treturn attr_copy\n\n\n#################################################################### Support ####################################################################\nclass InternalTransform(Attribute):\n    \n    def __init__(self, id, part1, part2, tr_type, tr_axis, tr_domain):\n        \n        super(InternalTransform, self).__init__(id, [part1, part2, tr_axis], True)\n        \n        self.transform_type = tr_type\n        self.transform_domain = tr_domain\n        self.current_pos = 0.5\n    \n    def ToString(self):\n        return \"WaspInternalTransform [name: %s]\" % (self.name)\n    \n    def transform(self, trans):\n        values_trans = []\n        for val in self.values:\n            val_trans = None\n            if type(val) == Point3d:\n                val_trans = Point3d(val)\n            elif type(val) == Plane:\n                val_trans = Plane(val)\n            elif type(val) == Line:\n                val_trans = Line(val.From, val.To)\n            else:\n                val_trans = val.Duplicate()\n            val_trans.Transform(trans)\n            values_trans.append(val_trans)\n        \n        it_trans = InternalTransform(self.name, values_trans[0], values_trans[1], self.transform_type, values_trans[2], self.transform_domain)\n        return it_trans\n    \n    def copy(self):\n        values_copy = []\n        for val in self.values:\n            val_copy = None\n            if type(val) == Point3d:\n                val_copy = Point3d(val)\n            elif type(val) == Plane:\n                val_copy = Plane(val)\n            elif type(val) == Line:\n                val_copy = Line(val.From, val.To)\n            else:\n                val_copy = val.Duplicate()\n            values_copy.append(val_copy)\n        \n        it_copy = InternalTransform(self.name, values_copy[0], values_copy[1], self.transform_type, values_copy[2], self.transform_domain)\n        return it_copy",
  "language": "python",
  "imports": [
    "Rhino",
    "Rhino.Geometry"
  ],
  "has_docstring": true
}