{
  "source_url": "https://github.com/ar0551/Wasp/blob/66f63c018f2420d37aa451ade0178de260946b0c/src/wasp/core/connection.py",
  "repo": "ar0551/Wasp",
  "repo_stars": 67,
  "repo_description": "Combinatorial Design with Grasshopper plug-in (LGPL) initiated by Andrea Rossi",
  "license": "LGPL-3.0",
  "filepath": "src/wasp/core/connection.py",
  "instruction": "(C) 2017-2020 Andrea Rossi <ghwasp@gmail.com>",
  "code": "\"\"\"\n(C) 2017-2020 Andrea Rossi <ghwasp@gmail.com>\n\nThis file is part of Wasp. https://github.com/ar0551/Wasp\n@license GPL-3.0 <https://www.gnu.org/licenses/gpl.html>\n\n@version 0.6.001\n\nConnection class\n\"\"\"\n\nfrom Rhino.Geometry import Plane\nfrom Rhino.Geometry import Vector3d\n\nfrom wasp.utilities import plane_from_data, plane_to_data\n\nimport math\n\n#################################################################### Connection ####################################################################\nclass Connection(object):\n\t'''\n\tConnection class. Stores the connection plane as well as information about types and rules.\n\n\tArgs:\n\t\t_plane (Plane): Connection plane\n\t\t_type (str): Connection type (for automated rules generation)\n\t\t_part (str): Name of the part the connection belongs to\n\t\t_id (int): Connection ID (unique within each part)\n\n\tAttributes:\n\t\tpln (Plane): Connection plane\n\t\tflip_pln (Plane): Connection plane with Y-axis flipped (in order to connect to another connection)\n\t\ttype (str): Connection type (for automated rules generation)\n\t\tpart (str): Name of the part the connection belongs to\n\t\tid (int): Connection ID (unique within each part)\n\t\trule_table ([]): List of Wasp rules compatible with this connection\n\t\tactive_rules ([int]): Indexes of still active rules in the rule_table list\n\t'''\n\n\t\n\t## constructor\n\tdef __init__(self, _plane, _type, _part, _id):\n\t\t\n\t\tself.pln = _plane\n\t\t\n\t\tflip_pln_Y = Vector3d(self.pln.YAxis)\n\t\tflip_pln_Y.Reverse()\n\t\tself.flip_pln = Plane(self.pln.Origin, self.pln.XAxis, flip_pln_Y)\n\t\t\n\t\tself.type = _type\n\t\tself.part = _part\n\t\tself.id = _id\n\t\t\n\t\tself.rules_table = []\n\t\tself.active_rules = []\n\t\n\n\t## override Rhino .ToString() method (display name of the class in Gh)\n\tdef ToString(self):\n\t\treturn \"WaspConnection [id: %s, type: %s]\" % (self.id, self.type)\n\t\n\n\t## create class from data dictionary\n\t@classmethod\n\tdef from_data(cls, data):\n\t\tc_pln = plane_from_data(data['plane'])\n\t\treturn cls(c_pln, data['type'], data['part'], int(data['id']))\n\n\t\t\n\t## return the data dictionary representing the connection\n\tdef to_data(self):\n\t\tdata = {}\n\t\tdata['plane'] = plane_to_data(self.pln)\n\t\tdata['type'] = self.type\n\t\tdata['part'] = self.part\n\t\tdata['id'] = self.id\n\t\t#### rules_table and active_rules NOT IMPLEMENTED\n\t\treturn data\t\n\n\t\n\t## return a transformed copy of the connection\n\tdef transform(self, trans):\n\t\t'''\n\t\tReturns a transformed connection\n\n\t\tArgs:\n\t\t\ttrans (Transformation): Transformation to apply to the Connection\n\n\t\tReturns:\n\t\t\tconn_trans (Connection): Transformed copy of the Connection\n\t\t'''\n\t\tpln_trans = Plane(self.pln.Origin, self.pln.XAxis, self.pln.YAxis)\n\t\tpln_trans.Transform(trans)\n\t\t\n\t\tconn_trans = Connection(pln_trans, self.type, self.part, self.id)\n\t\treturn conn_trans\n\t\n\t## return a copy of the connection\n\tdef copy(self):\n\t\t'''\n\t\tReturns a copy of the Connection\n\n\t\tReturns:\n\t\t\tconn_copy (Connection): Connection copy\n\t\t'''\n\t\tpln_copy = Plane(self.pln.Origin, self.pln.XAxis, self.pln.YAxis)\n\t\tconn_copy = Connection(pln_copy, self.type, self.part, self.id)\n\t\treturn conn_copy\n\t\n\t## generate the rules-table for the connection\n\tdef generate_rules_table(self, rules):\n\t\t'''\n\t\tGenerates the Connection rule_table, given a set of rules\n\n\t\tArgs:\n\t\t\trules ([]): list of available rules\n\t\t'''\n\t\tcount = 0\n\t\tself.rules_table = []\n\t\tself.active_rules = []\n\t\tfor rule in rules:\n\t\t\tif rule.part1 == self.part and rule.conn1 == self.id:\n\t\t\t\tself.rules_table.append(rule)\n\t\t\t\tself.active_rules.append(count)\n\t\t\t\tcount += 1",
  "language": "python",
  "imports": [
    "Rhino",
    "Rhino.Geometry"
  ],
  "has_docstring": true
}