{
  "source_url": "https://github.com/ar0551/GhFunken/blob/f302bf61eef96c30d149aa022f2b3adea5c76927/src/ghComp/Funken_Analog%20Read.py",
  "repo": "ar0551/GhFunken",
  "repo_stars": 4,
  "repo_description": "Grasshopper interface for Funken Serial Protocol Toolkit",
  "license": "GPL-3.0",
  "filepath": "src/ghComp/Funken_Analog Read.py",
  "instruction": "Read an analog input pin (mirrors the Arduino analogRead method).\n-\nProvided by Funken 0.3\n    Args:\n        PIN: The number of the pin from which to read.\n        GET: True to read data.\n       ...",
  "code": "#########################################################################\n##                            COMPONENT INFO                           ##\n#########################################################################\n\n\"\"\"\nRead an analog input pin (mirrors the Arduino analogRead method).\n-\nProvided by Funken 0.3\n    Args:\n        PIN: The number of the pin from which to read.\n        GET: True to read data.\n        PORT: Serial port to send the message [Default is the first port available].\n        ID: ID of the device [Default is the first device available].\n    Returns:\n        VAL: Read value.\n        _COMM: Funken command.\n        _PORT: Serial port where the message was sent (for daisy-chaining). \n        _ID: Device ID (for daisy-chaining). \n\"\"\"\n\nghenv.Component.Name = \"Funken_Analog Read\"\nghenv.Component.NickName = 'AnalogRead'\nghenv.Component.Message = 'VER 0.3.3'\nghenv.Component.IconDisplayMode = ghenv.Component.IconDisplayMode.application\nghenv.Component.Category = \"Funken\"\nghenv.Component.SubCategory = \"1 | Arduino\"\ntry: ghenv.Component.AdditionalHelpFromDocStrings = \"2\"\nexcept: pass\n\nimport scriptcontext as sc\nimport Grasshopper as gh\nimport time\n\ndef main(pin, get, port, id):\n    \n    if sc.sticky.has_key(\"pyFunken\") == False:\n        check_data = False\n        msg = \"No serial object available. Have you opened the serial port?\"\n        ghenv.Component.AddRuntimeMessage(gh.Kernel.GH_RuntimeMessageLevel.Warning, msg)\n        return\n    \n    if pin is None:\n        check_data = False\n        msg = \"No pin provided.\"\n        ghenv.Component.AddRuntimeMessage(gh.Kernel.GH_RuntimeMessageLevel.Warning, msg)\n        return\n    \n    if get is None:\n        get = False\n    \n    if port is None:\n        if len(sc.sticky[\"pyFunken\"].com_ports) == 0:\n            msg = \"No serial connection available. Did you connect open the serial port?\"\n            ghenv.Component.AddRuntimeMessage(gh.Kernel.GH_RuntimeMessageLevel.Warning, msg)\n            return\n        else:\n            port = sc.sticky[\"pyFunken\"].com_ports[0]\n    \n    if id is None:\n        if len(sc.sticky['pyFunken'].ser_conn[port].devices_ids) == 0:\n            msg = \"No device available. Did you connect an Arduino-compatible device and registered it?\"\n            ghenv.Component.AddRuntimeMessage(gh.Kernel.GH_RuntimeMessageLevel.Warning, msg)\n            return\n        else:\n            id = sc.sticky['pyFunken'].ser_conn[port].devices_ids[0]\n    \n    value = None\n    comm = \"AR \" + str(pin) + \"\\n\"\n    if get:\n        response = sc.sticky['pyFunken'].get_response(comm, \"AR\", port, id)\n        try:\n            value = int(response.split(\" \")[1])\n        except:\n            value = -1\n        \n    return value, comm, port, id\n\nresult = main(PIN, GET, PORT, ID)\n\nif result is not None:\n    VAL = result[0]\n    _COMM = result[1]\n    _PORT = result[2]\n    _ID = result[3]\n",
  "language": "python",
  "imports": [
    "scriptcontext"
  ],
  "has_docstring": true
}