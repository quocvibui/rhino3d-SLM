{
  "source_url": "https://discourse.mcneel.com/t/the-same-script-works-in-rhino-python-editor-yet-not-in-ghpython-component/101645",
  "topic_id": 101645,
  "title": "The same script works in Rhino Python Editor yet not in GhPython Component",
  "question": "Hello!\n\nA Rhino/GH frequent user but python newbie here \n\n\nwas working on a Python script that could fix broken text objects(for example one text object “33.6” breaks into two objects “33” & “6”; the script is trying to fix it) in Rhino, it worked perfectly in Rhino Python Editor, but when I was trying to transfer the same code to GhPython Component (the reason why I do this is that I would like to use Human UI in GH to make the workflow more smooth ), some error occurred and I can’t find out why.\n\n\nHere is a screen shot, it seems that the TextObjectPoint() & TextObjectText() methods are returning correct value in Rhino Python Editor but returning “none” value in GhPython:\n\n\n\n\n121\n1346×742 188 KB\n\n\n\n\nand here is my complete script which works perfectly (a bit slow though) in Rhino Python Editor but not in GhPython Component:\n\n\npython\nimport rhinoscriptsyntax as rs\n\ndef fixbrokentext():\n    \n    T01 = rs.GetObjects(\"Pick broken text\",512,True,True,True)\n\n    VL_f = []\n    PL_f = []\n\n    VL_i = []\n    PL_i = []\n\n    VL_t = []\n    PL_t = []\n\n    count = 0\n    for i in T01:\n        ID = T01[count]\n        P00 = rs.TextObjectPoint(ID)\n        V00 = rs.TextObjectText(ID)\n        \n        st = str(V00)\n        \n        if \",\" in st :\n            V00 = V00.replace(\",\",\".\")\n            VL_t.append(V00)\n            PL_t.append(P00)\n        elif float(st)<10:\n            VL_f.append(V00)\n            PL_f.append(P00)\n        else:\n            VL_i.append(V00)\n            PL_i.append(P00)\n        \n        count += 1\n        \n    t = len(PL_i)\n    for i in range(0,t):\n        P = PL_i[i]\n        Inx = rs.PointArrayClosestPoint(PL_f,P)\n        F = float(VL_f[Inx])\n        T = int(VL_i[i]) + F/10\n        rs.AddText(T,PL_i[i],1.0)\n    \n    s = len(VL_t)\n    for i in range(0,s):\n        rs.AddText(VL_t[i],PL_t[i],1.0)\n        \n\nfixbrokentext()\n\n\n\nAny ideas on how to make the script work also in GhPython Component?",
  "code_blocks": [
    {
      "code": "import scriptcontext as sc\nimport Rhino as rh\nsc.doc = rh.RhinoDoc.ActiveDoc",
      "language": "python",
      "author": "piac",
      "post_number": 2,
      "is_solution": true
    },
    {
      "code": "python\nimport rhinoscriptsyntax as rs\n\ndef fixbrokentext():\n    \n    T01 = rs.GetObjects(\"Pick broken text\",512,True,True,True)\n\n    VL_f = []\n    PL_f = []\n\n    VL_i = []\n    PL_i = []\n\n    VL_t = []\n    PL_t = []\n\n    count = 0\n    for i in T01:\n        ID = T01[count]\n        P00 = rs.TextObjectPoint(ID)\n        V00 = rs.TextObjectText(ID)\n        \n        st = str(V00)\n        \n        if \",\" in st :\n            V00 = V00.replace(\",\",\".\")\n            VL_t.append(V00)\n            PL_t.append(P00)\n        elif float(st)<10:\n            VL_f.append(V00)\n            PL_f.append(P00)\n        else:\n            VL_i.append(V00)\n            PL_i.append(P00)\n        \n        count += 1\n        \n    t = len(PL_i)\n    for i in range(0,t):\n        P = PL_i[i]\n        Inx = rs.PointArrayClosestPoint(PL_f,P)\n        F = float(VL_f[Inx])\n        T = int(VL_i[i]) + F/10\n        rs.AddText(T,PL_i[i],1.0)\n    \n    s = len(VL_t)\n    for i in range(0,s):\n        rs.AddText(VL_t[i],PL_t[i],1.0)\n        \n\nfixbrokentext()",
      "language": "python",
      "author": "xudong",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "file-io",
    "geometry",
    "grasshopper",
    "python",
    "rhinoscriptsyntax",
    "selection"
  ],
  "has_accepted_answer": true,
  "category_id": 11,
  "posts_count": 3,
  "views": 575
}