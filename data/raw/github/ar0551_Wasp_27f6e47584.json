{
  "source_url": "https://github.com/ar0551/Wasp/blob/66f63c018f2420d37aa451ade0178de260946b0c/src/ghComp/Wasp_Save%20Aggregation%20to%20File.py",
  "repo": "ar0551/Wasp",
  "repo_stars": 67,
  "repo_description": "Combinatorial Design with Grasshopper plug-in (LGPL) initiated by Andrea Rossi",
  "license": "LGPL-3.0",
  "filepath": "src/ghComp/Wasp_Save Aggregation to File.py",
  "instruction": "Saves current status of an aggregation to a .json file.\n-\nProvided by Wasp 0.6\n    Args:\n        AGGR: Aggregation to save\n        PATH: Path where to save the aggregation\n        NAME: Name of the...",
  "code": "# Wasp: Discrete Design with Grasshopper plug-in (LGPL) initiated by Andrea Rossi\n# \n# This file is part of Wasp.\n# \n# Copyright (c) 2017-2023, Andrea Rossi <a.rossi.andrea@gmail.com>\n# Wasp is free software; you can redistribute it and/or modify \n# it under the terms of the GNU Lesser General Public License as published \n# by the Free Software Foundation; either version 3 of the License, \n# or (at your option) any later version. \n# \n# Wasp is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of \n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the \n# GNU Lesser General Public License for more details.\n# \n# You should have received a copy of the GNU Lesser General Public License\n# along with Wasp; If not, see <http://www.gnu.org/licenses/>.\n# \n# @license LGPL-3.0 https://www.gnu.org/licenses/lgpl-3.0.html\n#\n# Early development of Wasp has been carried out by Andrea Rossi\n# as part of research on digital materials and discrete design at:\n# DDU Digital Design Unit - Prof. Oliver Tessmann\n# Technische Universitt Darmstadt\n\n\n#########################################################################\n##                            COMPONENT INFO                           ##\n#########################################################################\n\n\"\"\"\nSaves current status of an aggregation to a .json file.\n-\nProvided by Wasp 0.6\n    Args:\n        AGGR: Aggregation to save\n        PATH: Path where to save the aggregation\n        NAME: Name of the exported file\n        SAVE: True to export\n    Returns:\n        TXT: Text representation of the aggregation\n        FILE: Path to the saved file\n\"\"\"\n\nghenv.Component.Name = \"Wasp_Save Aggregation to File\"\nghenv.Component.NickName = 'SaveAggr'\nghenv.Component.Message = 'v0.6.001'\nghenv.Component.IconDisplayMode = ghenv.Component.IconDisplayMode.application\nghenv.Component.Category = \"Wasp\"\nghenv.Component.SubCategory = \"6 | Aggregation\"\ntry: ghenv.Component.AdditionalHelpFromDocStrings = \"3\"\nexcept: pass\n\n\nimport sys\nimport os\nimport Rhino.Geometry as rg\nimport Grasshopper as gh\nimport json\n\n\n## add Wasp install directory to system path\nwasp_loaded = False\nghcompfolder = gh.Folders.DefaultAssemblyFolder\nif ghcompfolder not in sys.path:\n    sys.path.append(ghcompfolder)\ntry:\n    from wasp import __version__\n    wasp_loaded = True\nexcept:\n    msg = \"Cannot import Wasp. Is the wasp folder available in \" + ghcompfolder + \"?\"\n    ghenv.Component.AddRuntimeMessage(gh.Kernel.GH_RuntimeMessageLevel.Error, msg)\n\n## if Wasp is installed correctly, load the classes required by the component\nif wasp_loaded:\n    pass\n\n\ndef main(aggregation, path, filename, save):\n        \n    check_data = True\n    \n    ## check inputs\n    if aggregation is None:\n        check_data = False\n        msg = \"No aggregation provided\"\n        ghenv.Component.AddRuntimeMessage(gh.Kernel.GH_RuntimeMessageLevel.Warning, msg)\n    \n    if path is None:\n        check_data = False\n        msg = \"No path provided\"\n        ghenv.Component.AddRuntimeMessage(gh.Kernel.GH_RuntimeMessageLevel.Warning, msg)\n    \n    if filename is None:\n        check_data = False\n        msg = \"No filename provided\"\n        ghenv.Component.AddRuntimeMessage(gh.Kernel.GH_RuntimeMessageLevel.Warning, msg)\n    \n    if save is None:\n        save = False\n    \n    ## execute main code if all needed inputs are available\n    if check_data:\n        \n        aggr_dict = {}\n        aggr_dict['aggregation_name'] = aggregation.name\n        aggr_dict['parts'] = {}\n        for part in aggregation.aggregated_parts:\n            \n            part_dict = {}\n            \n            part_dict['name'] = part.name\n            part_dict['active_connections'] = part.active_connections\n            part_dict['parent'] = part.parent\n            part_dict['children'] = part.children\n            \n            \n            part_dict['transform'] = {}\n            part_dict['transform']['M00'] = part.transformation.M00\n            part_dict['transform']['M01'] = part.transformation.M01\n            part_dict['transform']['M02'] = part.transformation.M02\n            part_dict['transform']['M03'] = part.transformation.M03\n            \n            part_dict['transform']['M10'] = part.transformation.M10\n            part_dict['transform']['M11'] = part.transformation.M11\n            part_dict['transform']['M12'] = part.transformation.M12\n            part_dict['transform']['M13'] = part.transformation.M13\n            \n            part_dict['transform']['M20'] = part.transformation.M20\n            part_dict['transform']['M21'] = part.transformation.M21\n            part_dict['transform']['M22'] = part.transformation.M22\n            part_dict['transform']['M23'] = part.transformation.M23\n            \n            part_dict['transform']['M30'] = part.transformation.M30\n            part_dict['transform']['M31'] = part.transformation.M31\n            part_dict['transform']['M32'] = part.transformation.M32\n            part_dict['transform']['M33'] = part.transformation.M33\n            \n            part_dict['is_constrained'] = part.is_constrained\n            \n            aggr_dict['parts'][part.id] = part_dict\n        \n        full_path = os.path.join(path, filename + \".json\")\n        \n        if save:\n            with open(full_path, \"w\") as outF:\n                json.dump(aggr_dict, outF)\n        \n        return json.dumps(aggr_dict), full_path\n    else:\n        return -1\n\nresult = main(AGGR, PATH, NAME, SAVE)\n\nif result != -1:\n    TXT = result[0]\n    FILE = result[1]",
  "language": "python",
  "imports": [
    "Rhino",
    "Rhino.Geometry"
  ],
  "has_docstring": true
}