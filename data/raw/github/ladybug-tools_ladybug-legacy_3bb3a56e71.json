{
  "source_url": "https://github.com/ladybug-tools/ladybug-legacy/blob/d90db02f2776febbb38100dea26ec0c93e77aa53/src/Ladybug_Import%20CEC%20Photovoltaics%20Module.py",
  "repo": "ladybug-tools/ladybug-legacy",
  "repo_stars": 202,
  "repo_description": ":beetle: Ladybug is an environmental plugin for Grasshopper.",
  "license": "NOASSERTION",
  "filepath": "src/Ladybug_Import CEC Photovoltaics Module.py",
  "instruction": "Use this component to import Photovoltaics module settings for particular module from \"California Energy Commission (CEC) Modules\" library.\r\nDownload library's newest version from the bottom of the...",
  "code": "# import cec photovoltaics module\r\n#\r\n# Ladybug: A Plugin for Environmental Analysis (GPL) started by Mostapha Sadeghipour Roudsari\r\n# \r\n# This file is part of Ladybug.\r\n# \r\n# Copyright (c) 2013-2020, Jason Sensibaugh and Djordje Spasic <sensij@yahoo.com> and <djordjedspasic@gmail.com>\r\n# Ladybug is free software; you can redistribute it and/or modify \r\n# it under the terms of the GNU General Public License as published \r\n# by the Free Software Foundation; either version 3 of the License, \r\n# or (at your option) any later version. \r\n# \r\n# Ladybug is distributed in the hope that it will be useful,\r\n# but WITHOUT ANY WARRANTY; without even the implied warranty of \r\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the \r\n# GNU General Public License for more details.\r\n# \r\n# You should have received a copy of the GNU General Public License\r\n# along with Ladybug; If not, see <http://www.gnu.org/licenses/>.\r\n# \r\n# @license GPL-3.0+ <http://spdx.org/licenses/GPL-3.0+>\r\n\r\n\r\n\"\"\"\r\nUse this component to import Photovoltaics module settings for particular module from \"California Energy Commission (CEC) Modules\" library.\r\nDownload library's newest version from the bottom of the following page:\r\nhttps://sam.nrel.gov/libraries\r\n-\r\nProvided by Ladybug 0.0.69\r\n    \r\n    input:\r\n        _modulesLibraryFile: Add \"California Energy Commission (CEC) Modules\" .csv file path to this input.\r\n                             -\r\n                             Download its newest version on the bottom of this web page\r\n                             sam.nrel.gov/libraries\r\n        moduleIndex_: An index corresponding to chosen module from \"allModuleNames\" output.\r\n                      -\r\n                      If nothing added to this input, \"0\" will be used as a default (the first module from the \"allModuleNames\" output will be chosen).\r\n        newModuleMountType_: New mounting type (configuration) of the module.\r\n                             Each module from \"_modulesLibraryFile\" input comes with predefined mounting type (configuration). You can see it in \"moduleMountType\" output.\r\n                             If you would like to change that predefined mounting type, then use this input, and the following values:\r\n                             -\r\n                             0 = Insulated back (pv curtain wall, pv skylights, BIPV installations with obstructed backside airflow)\r\n                             1 = Close (flush) roof mount (pv array mounted parallel and relatively close to the plane of the roof (between 5 and 15 centimenters))\r\n                             2 = Open rack (ground mount array, flat/sloped roof array that is tilted, pole-mount solar panels, solar carports, solar canopies, BIPV installations with sufficient backside airflow)\r\n                             -\r\n                             This input is actually the same as \"mountType\" input of the Ladybug \"Simplified Photovoltaics Module\" component.\r\n                             -\r\n                             If nothing is added to this input, default mount type of the chosen module will be used (you can check which one by looking at the \"moduleMountType\" output).\r\n        moduleHeightAboveGround_: Height (vertical distance) from ground surface to the lowest part of the module.\r\n                                  -\r\n                                  If not supplied, default value of 3 meters (10 feet) will be used.\r\n                                  -\r\n                                  In Rhino document units (meters, feet, inches...).\r\n        moduleActiveAreaPercent_: Percentage of the module's area excluding module framing and gaps between cells. \r\n                                  -\r\n                                  If not supplied, default value of 90(perc.) will be used.\r\n                                  -\r\n                                  In percent.\r\n    \r\n    output:\r\n        readMe!: ...\r\n        allModuleNames: Names of all crystalline silicon modules from the \"_modulesLibraryFile\" file.\r\n        moduleName: Name of the chosen module, according to \"moduleIndex_\" input.\r\n        moduleMaterial: Material of the chosen module.\r\n        moduleMountType: Final mount type (configuration) of the chosen module.\r\n                         This output can have two values:\r\n                         -\r\n                         a) default one: coming directly from \"_modulesLibraryFile\". This value will only appear if \"newModuleMountType_\" input is empty.\r\n                         b) custom one: altered mounting type, according to \"newModuleMountType_\" input.\r\n                         -\r\n                         One of the following mount types will be shown:\r\n                         -\r\n                         0 = Insulated back (pv curtain wall, pv skylights, BIPV installations with obstructed backside airflow)\r\n                         1 = Close (flush) roof mount (pv array mounted parallel and relatively close to the plane of the roof (between 5 and 15 centimenters))\r\n                         2 = Open rack (ground mount array, flat/sloped roof array that is tilted, pole-mount solar panels, solar carports, solar canopies, BIPV installations with sufficient backside airflow)\r\n        moduleArea: Area of the chosen module.\r\n                    -\r\n                    In square meters.\r\n        modulePower: Module's power at maximum-power point of the chose module.\r\n                     -\r\n                     In Watts.\r\n        moduleEfficiency: Module's aperture (active area) efficiency.\r\n                          -\r\n                          In percent (%).\r\n        sourceNotes: Source notes corresponding to the chosen module.\r\n                     It basically contains source from which the \"PVmoduleSettings\" output data has been generated, and date when it has been generated.\r\n        PVmoduleSettings: A list of PV module settings. Plug it to \"Photovoltaics surface\" component's \"PVmoduleSettings_\" input.\r\n\"\"\"\r\n\r\nghenv.Component.Name = \"Ladybug_Import CEC Photovoltaics Module\"\r\nghenv.Component.NickName = \"ImportCECPhotovoltaicsModule\"\r\nghenv.Component.Message = 'VER 0.0.69\\nJUL_07_2020'\r\nghenv.Component.IconDisplayMode = ghenv.Component.IconDisplayMode.application\r\nghenv.Component.Category = \"LB-Legacy\"\r\nghenv.Component.SubCategory = \"4 | Renewables\"\r\n#compatibleLBVersion = VER 0.0.64\\nAPR_12_2017\r\ntry: ghenv.Component.AdditionalHelpFromDocStrings = \"0\"\r\nexcept: pass\r\n\r\nimport Grasshopper.Kernel as gh\r\nimport rhinoscriptsyntax as rs\r\nimport scriptcontext as sc\r\nimport System\r\nimport Rhino\r\n\r\n\r\ndef main(modulesLibraryFile_filePath, moduleIndex, newModuleMountType, moduleHeightAboveGroundRhinoUnits, moduleActiveAreaPercent):\r\n    \r\n    # find unitConversionFactor\r\n    unitConversionFactor = lb_preparation.checkUnits()\r\n    sc.doc = Rhino.RhinoDoc.ActiveDoc\r\n    unitSystem = rs.UnitSystemName()\r\n    sc.doc = ghdoc\r\n    \r\n    \r\n    if (modulesLibraryFile_filePath == None):\r\n        moduleNameL = moduleName = moduleMaterial = moduleMountType = moduleArea = nameplateDCpowerRating_m = moduleEfficiency = sourceNotes = PVmoduleSettings = None\r\n        validInputData = False\r\n        printMsg = \"Add \\\"California Energy Commission (CEC) Modules\\\" .csv file path to \\\"_modulesLibraryFile\\\" input.\\n\" + \\\r\n                   \"Download its newest version from the bottom of the following page:\\n\\n\" + \\\r\n                   \"https://sam.nrel.gov/libraries\"\r\n        return moduleNameL, moduleName, moduleMaterial, moduleMountType, moduleArea, nameplateDCpowerRating_m, moduleEfficiency, sourceNotes, PVmoduleSettings, validInputData, printMsg\r\n    # testing if the \"modulesLibraryFile_filePath\" is valid:\r\n    try:\r\n        with open(modulesLibraryFile_filePath) as modulesCSVFile:\r\n            pass\r\n    except:\r\n        moduleNameL = moduleName = moduleMaterial = moduleMountType = moduleArea = nameplateDCpowerRating_m = moduleEfficiency = sourceNotes = PVmoduleSettings = None\r\n        validInputData = False\r\n        printMsg = \"The .csv file path you added to the \\\"_modulesLibraryFile\\\" input is invalid.\\n\" + \\\r\n                   \"Download the newest version of \\\"California Energy Commission (CEC) Modules\\\" .csv file from the bottom of the following page:\\n\" + \\\r\n                   \"https://sam.nrel.gov/libraries\\n\" + \\\r\n                   \"And add its file path to the \\\"_modulesLibraryFile\\\" input.\"\r\n        return moduleNameL, moduleName, moduleMaterial, moduleMountType, moduleArea, nameplateDCpowerRating_m, moduleEfficiency, sourceNotes, PVmoduleSettings, validInputData, printMsg\r\n    \r\n    \r\n    if (newModuleMountType == None):\r\n        pass\r\n    elif (newModuleMountType < 0) or (newModuleMountType > 2):\r\n        print \"newModuleMountType: \", newModuleMountType\r\n        moduleNameL = moduleName = moduleMaterial = moduleMountType = moduleArea = nameplateDCpowerRating_m = moduleEfficiency = sourceNotes = PVmoduleSettings = None\r\n        validInputData = False\r\n        printMsg = \"\\\"newModuleMountType_\\\" input supports only the following values:\\n\" + \\\r\n                   \"0 = Insulated back\\n\" + \\\r\n                   \"1 = Close (flush) roof mount\\n\" + \\\r\n                   \"2 = Open rack\\n\" + \\\r\n                   \"Choose one of these three.\"\r\n        return moduleNameL, moduleName, moduleMaterial, moduleMountType, moduleArea, nameplateDCpowerRating_m, moduleEfficiency, sourceNotes, PVmoduleSettings, validInputData, printMsg\r\n    \r\n    \r\n    if (moduleHeightAboveGroundRhinoUnits == None) or (moduleHeightAboveGroundRhinoUnits < 0):\r\n        moduleHeightAboveGroundM = 6  # default value: 6 meters, in meters\r\n    else:\r\n        moduleHeightAboveGroundM = moduleHeightAboveGroundRhinoUnits/unitConversionFactor  # in meters\r\n    \r\n    \r\n    if (moduleActiveAreaPercent == None) or (moduleActiveAreaPercent <= 0) or (moduleActiveAreaPercent > 100):\r\n        moduleActiveAreaPercent = 90  # default in %\r\n    \r\n    \r\n    # define \"ws_adjusted_factor\" based on the height of module above the ground\r\n    if (moduleHeightAboveGroundM <= 3):\r\n        ws_adjusted_factor = 0.51  # unitless\r\n    elif (moduleHeightAboveGroundM > 3):\r\n        ws_adjusted_factor = 0.61  # unitless\r\n    \r\n    \r\n    with open(modulesLibraryFile_filePath) as modulesCSVFile:\r\n        moduleNameL = []\r\n        materialL = []\r\n        dateL = []\r\n        versionL = []\r\n        moduleAreaML = []\r\n        Vmp_refL = []\r\n        Imp_refL = []\r\n        Voc_refL = []\r\n        Isc_refL = []\r\n        alpha_sc_refL = []\r\n        beta_oc_refL = []\r\n        IL_refL = []\r\n        Io_refL = []\r\n        Rs_refL = []\r\n        Rsh_refL = []\r\n        A_refL = []\r\n        n_sL = []\r\n        adjustL = []\r\n        gamma_r_refL = []\r\n        TnoctL = []\r\n        mountType_libraryL = []\r\n        nameplateDCpowerRating_mL = []\r\n        moduleEfficiencyL = []\r\n        \r\n        lines = modulesCSVFile.readlines()\r\n        for lineIndex, line in enumerate(lines):\r\n            itemsPerLine = line.strip().split(\",\")\r\n            if (lineIndex >= 3)  and  ((len(itemsPerLine[10]) > 0) and (len(itemsPerLine[19]) > 0)):  # \"Yingli Energy (China) YL310P-35b\" with lineIndex = 13817 is invalid (does not contain all \"PVmoduleSettings\" items)\r\n                # lineIndex = 0,1,2 are column names, units, script variables names\r\n                moduleName = itemsPerLine[0]  # \"Name\" from .csv file\r\n                material = itemsPerLine[21]  # \"Technology\" from .csv file\r\n                date = itemsPerLine[2]  # \"Date\" from .csv file\r\n                version = itemsPerLine[19]  # \"Version\" from .csv file\r\n                moduleAreaM = float(itemsPerLine[4])  # \"Area\"(\"cec_area\") from .csv file. The total area of the module, including spaces between cells and the frame!!\r\n                BIPVorNot = itemsPerLine[23].strip()  # \"BIPV\" from .csv file\r\n                #if material in [\"c-Si\", \"mono-Si\", \"mc-Si\", \"multi-Si\", \"EFG mc-Si\",   \"Si-Film\", \"HIT Si\"]:  # only use mono and multi crystalline photovoltaics\r\n                #if True:\r\n                if not \"Concentrator\" in moduleName:\r\n                    Vmp_ref = float(itemsPerLine[9])  # \"cec_v_mp_ref\" from .csv\r\n                    Imp_ref = float(itemsPerLine[8])  # \"cec_i_mp_ref\" from .csv\r\n                    # if data is missing then use 0 as the value\r\n                    if len(itemsPerLine[7]) != 0:\r\n                        Voc_ref = float(itemsPerLine[7])  # \"cec_v_oc_ref\" from .csv\r\n                    elif len(itemsPerLine[7]) == 0:\r\n                        Voc_ref = 0\r\n                    # if data is missing then use 0 as the value\r\n                    if len(itemsPerLine[6]) != 0:\r\n                        Isc_ref = float(itemsPerLine[6])  # \"cec_i_sc_ref\" from .csv\r\n                    elif len(itemsPerLine[6]) == 0:\r\n                        Isc_ref = 0\r\n                    alpha_sc_ref = float(itemsPerLine[10])  # \"cec_alpha_sc\" from .csv\r\n                    beta_oc_ref = float(itemsPerLine[11])  # \"cec_beta_oc\" from .csv\r\n                    IL_ref = float(itemsPerLine[13])  # \"cec_i_l_ref\" from .csv\r\n                    Io_ref = float(itemsPerLine[14])  # \"cec_i_o_ref\" from .csv\r\n                    Rs_ref = float(itemsPerLine[15])  # \"cec_r_s\" from .csv\r\n                    Rsh_ref = float(itemsPerLine[16])  # \"cec_r_sh_ref\" from .csv\r\n                    A_ref = float(itemsPerLine[12])  # \"cec_a_ref\" from .csv\r\n                    n_s = float(itemsPerLine[5])  # \"cec_n_s\" from .csv\r\n                    adjust = float(itemsPerLine[17])  # \"cec_adjust\" from .csv\r\n                    gamma_r_ref = float(itemsPerLine[18])  # \"cec_gamma_r\" from .csv\r\n                    Tnoct = float(itemsPerLine[3])  # \"cec_t_noct\" from .csv\r\n                    \r\n                    if (BIPVorNot == \"Y\"): mountType_library = 0  # (insulated back)\r\n                    elif (BIPVorNot == \"N\"): mountType_library = 2  #(open rack)\r\n                    \r\n                    nameplateDCpowerRating_m = round( Imp_ref * Vmp_ref ,2)  # Power at maximum-power point of a single module, in W\r\n                    moduleEfficiency = round( (Imp_ref * Vmp_ref) / (1000 * moduleAreaM * (moduleActiveAreaPercent/100))  * 100 ,2)  # in percent\r\n                    \r\n                    # add to lists\r\n                    moduleNameL.append(moduleName)\r\n                    materialL.append(material)\r\n                    dateL.append(date)\r\n                    versionL.append(version)\r\n                    moduleAreaML.append(moduleAreaM)\r\n                    Vmp_refL.append(Vmp_ref)\r\n                    Imp_refL.append(Imp_ref)\r\n                    Voc_refL.append(Voc_ref)\r\n                    Isc_refL.append(Isc_ref)\r\n                    alpha_sc_refL.append(alpha_sc_ref)\r\n                    beta_oc_refL.append(beta_oc_ref)\r\n                    IL_refL.append(IL_ref)\r\n                    Io_refL.append(Io_ref)\r\n                    Rs_refL.append(Rs_ref)\r\n                    Rsh_refL.append(Rsh_ref)\r\n                    A_refL.append(A_ref)\r\n                    n_sL.append(n_s)\r\n                    adjustL.append(adjust)\r\n                    gamma_r_refL.append(gamma_r_ref)\r\n                    TnoctL.append(Tnoct)\r\n                    mountType_libraryL.append(mountType_library)\r\n                    nameplateDCpowerRating_mL.append(nameplateDCpowerRating_m)  # in Watts\r\n                    moduleEfficiencyL.append(moduleEfficiency)  # in percent\r\n    modulesCSVFile.close()\r\n    \r\n    \r\n    if (moduleIndex > (len(moduleNameL)-1)):\r\n        moduleName = moduleMaterial = moduleMountType = moduleArea = nameplateDCpowerRating_m = moduleEfficiency = sourceNotes = PVmoduleSettings = None\r\n        validInputData = False\r\n        printMsg = \"\\\"moduleIndex_\\\" input is higher than the number of modules from the \\\"_modulesLibraryFile\\\" file.\\n\" + \\\r\n                   \"Use \\\"moduleIndex_\\\" input from 0 to %s.\" % (len(moduleNameL)-1)\r\n        return moduleNameL, moduleName, moduleMaterial, moduleMountType, moduleArea, nameplateDCpowerRating_m, moduleEfficiency, sourceNotes, PVmoduleSettings, validInputData, printMsg\r\n    \r\n    \r\n    # NOCT Cell Temperature Model\r\n    # if NOTHING added to \"newModuleMountType_\" input: Tnoct_adj = Tnoct value from the .csv file\r\n    # if something added to \"newModuleMountType_\" input: Tnoct_adj is corrected according to \"newModuleMountType_\" input\r\n    if (newModuleMountType == None):\r\n        # NOTHING inputted to \"newModuleMountType_\" input\r\n        moduleMountType_final = mountType_library\r\n        Tnoct_adj = TnoctL[moduleIndex]\r\n    elif (newModuleMountType != None):\r\n        # something added to \"newModuleMountType_\" input\r\n        if (newModuleMountType == 0):\r\n            moduleMountType_final = 0\r\n            Tnoct_adj = TnoctL[moduleIndex] + 18  # Insulated back/BIPV without back airflow (for standoff distance: 0.5 in)\r\n        elif (newModuleMountType == 1):\r\n            moduleMountType_final = 1\r\n            Tnoct_adj = TnoctL[moduleIndex] + 6  # Close (flush) mount (for standoff distance: 1.5 to 2.5 in)\r\n        elif (newModuleMountType == 2):\r\n            moduleMountType_final = 2\r\n            Tnoct_adj = TnoctL[moduleIndex] + 0  # Open rack (for standoff distance: > 3.5 in)\r\n        \r\n    \r\n    \r\n    PVmoduleSettings = [\r\n    moduleNameL[moduleIndex],\r\n    materialL[moduleIndex],\r\n    moduleMountType_final,\r\n    moduleAreaML[moduleIndex],\r\n    moduleActiveAreaPercent,\r\n    nameplateDCpowerRating_mL[moduleIndex],\r\n    moduleEfficiencyL[moduleIndex],\r\n    Vmp_refL[moduleIndex],\r\n    Imp_refL[moduleIndex],\r\n    Voc_refL[moduleIndex],\r\n    Isc_refL[moduleIndex],\r\n    alpha_sc_refL[moduleIndex],\r\n    beta_oc_refL[moduleIndex],\r\n    IL_refL[moduleIndex],\r\n    Io_refL[moduleIndex],\r\n    Rs_refL[moduleIndex],\r\n    Rsh_refL[moduleIndex],\r\n    A_refL[moduleIndex],\r\n    n_sL[moduleIndex],\r\n    adjustL[moduleIndex],\r\n    gamma_r_refL[moduleIndex],\r\n    ws_adjusted_factor,\r\n    Tnoct_adj]\r\n    \r\n    sourceNotes = versionL[moduleIndex] + \", \" + dateL[moduleIndex]\r\n    \r\n    #print \"__len(moduleNameL): \", len(moduleNameL)\r\n    # deleting\r\n    del modulesLibraryFile_filePath; del modulesCSVFile; del lines\r\n    \"del versionL\"; \"del moduleAreaML\"; \"del materialL\"; del Vmp_refL; del Imp_refL; del Voc_refL; del Isc_refL; del alpha_sc_refL; del beta_oc_refL; del IL_refL;  del Io_refL; del Rs_refL; del Rsh_refL; del A_refL; del n_sL; del adjustL; del gamma_r_refL; del ws_adjusted_factor; \"del nameplateDCpowerRating_mL\"; \"del moduleEfficiencyL\"\r\n    \r\n    # printing\r\n    resultsCompletedMsg = \"Import CEC photovoltaics module component results successfully completed!\"\r\n    printOutputMsg = \\\r\n    \"\"\"\r\nInput data:,\r\n\r\nModule Name:  %s,\r\nModule Material:  %s,\r\nModule Area (m2):  %s,\r\nModule Active Area Percent (perc.):  %s,\r\nModule height above ground (%s):  %s\r\n\r\nNew Module Mount type:  %s,\r\nDefault Module Mount type:  %s,\r\n\r\nPower at Max Power (W):  %s,\r\nModule Efficiency (perc.):  %s,\r\nReference Max Power Voltage (V):  %s,\r\nReference Max Power Current (A):  %s,\r\nReference Open Circuit Voltage (V):  %s,\r\nReference Short Circuit Current (A):  %s,\r\n\r\nShort circuit current temperature coefficient (A/C deg.):  %s,\r\nOpen circuit voltage temperature coefficient (V/C deg.):  %s,\r\n\r\nReference light current:  %s,\r\nReference diode saturation current:  %s,\r\nReference series resistance:  %s,\r\nReference shunt resistance:  %s,\r\n\r\nReference ideality factor:  %s,\r\nDiode factor:  %s,\r\n\r\nTemperature coefficient adjustment factor:  %s,\r\nTemperature coefficient of Power (perc./C deg.):  %s,\r\nWind speed adjustment factor:  %s,\r\nNormal operating cell temperature:  %s,\r\n    \"\"\" % (PVmoduleSettings[0], PVmoduleSettings[1], PVmoduleSettings[3], PVmoduleSettings[4], unitSystem, moduleHeightAboveGroundM/unitConversionFactor,\r\n    newModuleMountType, mountType_libraryL[moduleIndex], \r\n    PVmoduleSettings[5], PVmoduleSettings[6], PVmoduleSettings[7], PVmoduleSettings[8], PVmoduleSettings[9], PVmoduleSettings[10], \r\n    PVmoduleSettings[11], PVmoduleSettings[12],\r\n    PVmoduleSettings[13], PVmoduleSettings[14], PVmoduleSettings[15], PVmoduleSettings[16],\r\n    PVmoduleSettings[17], PVmoduleSettings[18],\r\n    PVmoduleSettings[19], PVmoduleSettings[20], PVmoduleSettings[21], PVmoduleSettings[22])\r\n    print resultsCompletedMsg\r\n    print printOutputMsg\r\n    \r\n    \r\n    validInputData = True\r\n    printMsg = \"ok\"\r\n    \r\n    \r\n    # testing (comment out line \"300\" first)\r\n    \"\"\"\r\n    print \"-------\"\r\n    print \"testing\"\r\n    print \" \"\r\n    print \"Module Name: \", moduleNameL[moduleIndex], \"_\", PVmoduleSettings[0]\r\n    print \"Module Material: \", materialL[moduleIndex], \"_\", PVmoduleSettings[1]\r\n    print \"Default Module Mount type: \", mountType_libraryL[moduleIndex], \"_\"\r\n    print \"Module Area (m2): \", moduleAreaML[moduleIndex], \"_\", PVmoduleSettings[3]\r\n    print \"Module Active Area Percent (perc.): \", moduleActiveAreaPercent, \"_\", PVmoduleSettings[4]\r\n    print \" \"\r\n    print \"Power at Max Power (W): \", nameplateDCpowerRating_mL[moduleIndex], \"_\", PVmoduleSettings[5]\r\n    print \"Module Efficiency (perc.): \", moduleEfficiencyL[moduleIndex], \"_\", PVmoduleSettings[6]\r\n    print \"Reference Max Power Voltage (V): \", Vmp_refL[moduleIndex], \"_\", PVmoduleSettings[7]\r\n    print \"Reference Max Power Current (A): \", Imp_refL[moduleIndex], \"_\", PVmoduleSettings[8]\r\n    print \"Reference Open Circuit Voltage (V): \", Voc_refL[moduleIndex], \"_\", PVmoduleSettings[9]\r\n    print \"Reference Short Circuit Current (A): \", Isc_refL[moduleIndex], \"_\", PVmoduleSettings[10]\r\n    print \" \"\r\n    print \"Short circuit current temperature coefficient (A/C deg.): \", alpha_sc_refL[moduleIndex], \"_\", PVmoduleSettings[11]\r\n    print \"Open circuit voltage temperature coefficient (V/C deg.): \", beta_oc_refL[moduleIndex], \"_\", PVmoduleSettings[12]\r\n    print \" \"\r\n    print \"Reference light current: \", IL_refL[moduleIndex], \"_\", PVmoduleSettings[13]\r\n    print \"Reference diode saturation current: \", Io_refL[moduleIndex], \"_\", PVmoduleSettings[14]\r\n    print \"Reference series resistance: \", Rs_refL[moduleIndex], \"_\", PVmoduleSettings[15]\r\n    print \"Reference shunt resistance: \", Rsh_refL[moduleIndex], \"_\", PVmoduleSettings[16]\r\n    print \" \"\r\n    print \"Reference ideality factor: \", A_refL[moduleIndex], \"_\", PVmoduleSettings[17]\r\n    print \"Diode factor: \", n_sL[moduleIndex], \"_\", PVmoduleSettings[18]\r\n    print \" \"\r\n    print \"Temperature coefficient adjustment factor: \", adjustL[moduleIndex], \"_\", PVmoduleSettings[19]\r\n    print \"Temperature coefficient of Power (perc./C deg.): \", gamma_r_refL[moduleIndex], \"_\", PVmoduleSettings[20]\r\n    print \"Wind speed adjustment factor: \", ws_adjusted_factor, \"_\", PVmoduleSettings[21]\r\n    print \"Normal operating cell temperature: \", Tnoct_adj, \"_\", PVmoduleSettings[22]\r\n    \"\"\"\r\n    return moduleNameL, moduleNameL[moduleIndex], materialL[moduleIndex], moduleMountType_final, moduleAreaML[moduleIndex], nameplateDCpowerRating_mL[moduleIndex], moduleEfficiencyL[moduleIndex], sourceNotes, PVmoduleSettings, validInputData, printMsg\r\n\r\n\r\nlevel = gh.GH_RuntimeMessageLevel.Warning\r\nif sc.sticky.has_key(\"ladybug_release\"):\r\n    if sc.sticky[\"ladybug_release\"].isCompatible(ghenv.Component):\r\n        lb_preparation = sc.sticky[\"ladybug_Preparation\"]()\r\n        \r\n        allModuleNames, moduleName, moduleMaterial, moduleMountType, moduleArea, modulePower, moduleEfficiency, sourceNotes, PVmoduleSettings, validInputData, printMsg = main(_modulesLibraryFile, moduleIndex_, newModuleMountType_, moduleHeightAboveGround_, moduleActiveAreaPercent_)\r\n        if not validInputData:\r\n            print printMsg\r\n            ghenv.Component.AddRuntimeMessage(level, printMsg)\r\n    else:\r\n        printMsg = \"You need a newer version of Ladybug to use this component.\" + \\\r\n            \"Use updateLadybug component to update userObjects.\\n\" + \\\r\n            \"If you have already updated userObjects drag the Ladybug_Ladybug component \" + \\\r\n            \"into the canvas and try again.\"\r\n        print printMsg\r\nelse:\r\n    printMsg = \"First please let the Ladybug fly...\"\r\n    print printMsg\r\n    ghenv.Component.AddRuntimeMessage(level, printMsg)\r\n",
  "language": "python",
  "imports": [
    "Rhino",
    "rhinoscriptsyntax",
    "scriptcontext"
  ],
  "has_docstring": true
}