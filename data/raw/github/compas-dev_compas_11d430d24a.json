{
  "source_url": "https://github.com/compas-dev/compas/blob/HEAD/src/compas_rhino/scene/sceneobject.py",
  "repo": "compas-dev/compas",
  "repo_stars": 352,
  "repo_description": "Main library of the COMPAS framework and CAD integrations for Rhino/GH and Blender.",
  "license": "MIT",
  "filepath": "src/compas_rhino/scene/sceneobject.py",
  "instruction": "Sceneobject",
  "code": "from __future__ import absolute_import\nfrom __future__ import division\nfrom __future__ import print_function\n\nimport Rhino  # type: ignore\nimport scriptcontext as sc  # type: ignore\nimport System  # type: ignore\n\nimport compas_rhino.layers\nfrom compas.scene import SceneObject\n\nfrom .helpers import ensure_layer\n\n\nclass RhinoSceneObject(SceneObject):\n    \"\"\"Base class for all Rhino scene objects.\n\n    Parameters\n    ----------\n    layer : str, optional\n        A layer name.\n    group : str, optional\n        The name of the group to add the mesh components. The group will be created if not already present.\n        Default is ``None``.\n    **kwargs : dict, optional\n        Additional keyword arguments.\n\n    Attributes\n    ----------\n    layer : str\n        The name of the layer.\n    group : str\n        The name of the group.\n\n    \"\"\"\n\n    def __init__(self, layer=None, group=None, **kwargs):\n        super(RhinoSceneObject, self).__init__(**kwargs)\n        self.layer = layer\n        self.group = group\n\n    def get_group(self, name):\n        \"\"\"Find the group with the given name, or create a new one.\n\n        Parameters\n        ----------\n        name : str\n            The name of the group.\n\n        Returns\n        -------\n        :rhino:`Rhino.DocObjects.Group`\n\n        \"\"\"\n        group = sc.doc.Groups.FindName(name)\n        if not group:\n            if sc.doc.Groups.Add(name) < 0:\n                raise Exception(\"Failed to add group: {}\".format(name))\n            group = sc.doc.Groups.FindName(name)\n        return group\n\n    def add_to_group(self, name, guids):\n        \"\"\"Add the objects to the group.\n\n        Parameters\n        ----------\n        name : str\n            The name of the group.\n        guids : list[System.Guid]\n            A list of GUIDs.\n\n        Returns\n        -------\n        None\n\n        \"\"\"\n        group = self.get_group(name)\n        if group:\n            sc.doc.Groups.AddToGroup(group.Index, guids)\n\n    def clear_layer(self):\n        \"\"\"Clear the layer of the scene object.\n\n        Returns\n        -------\n        None\n\n        \"\"\"\n        if self.layer:\n            compas_rhino.layers.clear_layer(self.layer)\n\n    def compile_attributes(self, name=None, color=None, arrow=None):\n        \"\"\"Compile Rhino DocObject Attributes.\n\n        Parameters\n        ----------\n        name : str, optional\n            The name of the object.\n        color : :class:`compas.colors.Color`, optional\n            The color of the object.\n        arrow : {'end', 'start'}, optional\n            Add an arrow at the start or end of the object.\n\n        Returns\n        -------\n        :rhino:`Rhino.DocObjects.ObjectAttributes`\n\n        \"\"\"\n        name = name or self.item.name\n        color = color or self.color\n\n        attributes = Rhino.DocObjects.ObjectAttributes()\n\n        if name:\n            attributes.Name = name\n\n        if color:\n            attributes.ObjectColor = System.Drawing.Color.FromArgb(*color.rgb255)\n            attributes.ColorSource = Rhino.DocObjects.ObjectColorSource.ColorFromObject\n\n        if self.layer:\n            attributes.LayerIndex = ensure_layer(self.layer)\n\n        if arrow:\n            if arrow == \"end\":\n                attributes.ObjectDecoration = Rhino.DocObjects.ObjectDecoration.EndArrowhead\n            elif arrow == \"start\":\n                attributes.ObjectDecoration = Rhino.DocObjects.ObjectDecoration.StartArrowhead\n\n        return attributes\n",
  "language": "python",
  "imports": [
    "Rhino",
    "scriptcontext"
  ],
  "has_docstring": false
}