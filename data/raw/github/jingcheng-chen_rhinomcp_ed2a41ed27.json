{
  "source_url": "https://github.com/jingcheng-chen/rhinomcp/blob/615f0eae092d3d129f07fde519b28ca10d31dd6e/rhino_mcp_server/static/userdata.py",
  "repo": "jingcheng-chen/rhinomcp",
  "repo_stars": 299,
  "repo_description": "RhinoMCP connects Rhino 3D to AI Agent through the Model Context Protocol (MCP)",
  "license": "Apache-2.0",
  "filepath": "rhino_mcp_server/static/userdata.py",
  "instruction": "Userdata",
  "code": "import scriptcontext\n\nfrom rhinoscript import utility as rhutil\n\n\ndef DeleteDocumentData(section=None, entry=None):\n    \"\"\"Removes user data strings from the current document\n    Parameters:\n      section (str, optional): section name. If omitted, all sections and their corresponding\n        entries are removed\n      entry (str, optional): entry name. If omitted, all entries for section are removed\n    Returns:\n      bool: True or False indicating success or failure\n    Example:\n      import rhinoscriptsyntax as rs\n      rs.DeleteDocumentData( \"MySection1\", \"MyEntry1\" )\n      rs.DeleteDocumentData( \"MySection1\", \"MyEntry2\" )\n      rs.DeleteDocumentData( \"MySection2\", \"MyEntry1\" )\n    See Also:\n      DocumentDataCount\n      GetDocumentData\n      IsDocumentData\n      SetDocumentData\n    \"\"\"\n    return scriptcontext.doc.Strings.Delete(section, entry)\n\n\ndef DocumentDataCount():\n    \"\"\"Returns the number of user data strings in the current document\n    Returns:\n      number: the number of user data strings in the current document\n    Example:\n      import rhinoscriptsyntax as rs\n      count = rs.DocumentDataCount()\n      print(\"RhinoScript document user data count: {}\".format(count))\n    See Also:\n      DeleteDocumentData\n      GetDocumentData\n      IsDocumentData\n      SetDocumentData\n    \"\"\"\n    return scriptcontext.doc.Strings.DocumentDataCount\n\n\ndef DocumentUserTextCount():\n    \"\"\"Returns the number of user text strings in the current document\n    Returns:\n      number: the number of user text strings in the current document\n    Example:\n      \n    See Also:\n      GetDocumentUserText\n      IsDocumentUserText\n      SetDocumentUserText\n    \"\"\"\n    return scriptcontext.doc.Strings.DocumentUserTextCount\n\n\ndef GetDocumentData(section=None, entry=None):\n    \"\"\"Returns a user data item from the current document\n    Parameters:\n      section (str, optional): section name. If omitted, all section names are returned\n      entry (str, optional): entry name. If omitted, all entry names for section are returned\n    Returns:\n      list(str, ...): of all section names if section name is omitted\n      list(str, ...) of all entry names for a section if entry is omitted\n      str: value of the entry if both section and entry are specified\n      None: if not successful\n    Example:\n      import rhinoscriptsyntax as rs\n      value = rs.GetDocumentData(\"MySection1\", \"MyEntry1\")\n      print(value)\n      value = rs.GetDocumentData(\"MySection1\", \"MyEntry2\")\n      print(value)\n      value = rs.GetDocumentData(\"MySection2\", \"MyEntry1\")\n      print(value)\n    See Also:\n      DeleteDocumentData\n      DocumentDataCount\n      IsDocumentData\n      SetDocumentData\n    \"\"\"\n    if section is None:\n        rc = scriptcontext.doc.Strings.GetSectionNames()\n        return list(rc) if rc else None\n    if entry is None:\n        rc = scriptcontext.doc.Strings.GetEntryNames(section)\n        return list(rc) if rc else None\n    val = scriptcontext.doc.Strings.GetValue(section, entry)\n    return val if val else None\n\n\ndef GetDocumentUserText(key=None):\n    \"\"\"Returns user text stored in the document\n    Parameters:\n      key (str, optional): key to use for retrieving user text. If empty, all keys are returned\n    Returns:\n      str: If key is specified, then the associated value if successful.\n      list(str, ...):If key is not specified, then a list of key names if successful.\n      None: If not successful, or on error.\n    Example:\n      import rhinoscriptsyntax as rs\n      print(rs.GetDocumentUserText(\"Designer\"))\n      print(rs.GetDocumentUserText(\"Notes\"))\n    See Also:\n      SetDocumentUserText\n    \"\"\"\n    if key: \n      val =  scriptcontext.doc.Strings.GetValue(key)\n      return val if val else None\n    #todo: leaky abstraction: \"\\\\\" logic should be inside doc.Strings implementation\n    keys = [scriptcontext.doc.Strings.GetKey(i) for i in range(scriptcontext.doc.Strings.Count) if not \"\\\\\" in scriptcontext.doc.Strings.GetKey(i)]\n    return keys if keys else None\n\n\ndef GetUserText(object_id, key=None, attached_to_geometry=False):\n    \"\"\"Returns user text stored on an object.\n    Parameters:\n      object_id (guid): the object's identifies\n      key (str, optional): the key name. If omitted all key names for an object are returned\n      attached_to_geometry (bool, optional): location on the object to retrieve the user text\n    Returns:\n      str: if key is specified, the associated value if successful\n      list(str, ...): if key is not specified, a list of key names if successful\n    Example:\n      import rhinoscriptsyntax as rs\n      obj = rs.GetObject(\"Select object\")\n      if obj:\n          print(rs.GetUserText(obj, \"PartNo\"))\n          print(rs.GetUserText(obj, \"Price\"))\n    See Also:\n      IsUserText\n      SetUserText\n    \"\"\"\n    obj = rhutil.coercerhinoobject(object_id, True, True)\n    source = None\n    if attached_to_geometry: source = obj.Geometry\n    else: source = obj.Attributes\n    rc = None\n    if key: return source.GetUserString(key)\n    userstrings = source.GetUserStrings()\n    return [userstrings.GetKey(i) for i in range(userstrings.Count)]\n\n\ndef IsDocumentData():\n    \"\"\"Verifies the current document contains user data\n    Returns:\n      bool: True or False indicating the presence of Script user data\n    Example:\n      import rhinoscriptsyntax as rs\n      result = rs.IsDocumentData()\n      if result:\n          print(\"This document contains Script document user data\")\n      else:\n          print(\"This document contains no Script document user data\")\n    See Also:\n      DeleteDocumentData\n      DocumentDataCount\n      GetDocumentData\n      SetDocumentData\n    \"\"\"\n    return scriptcontext.doc.Strings.DocumentDataCount > 0\n\n\ndef IsDocumentUserText():\n    \"\"\"Verifies the current document contains user text\n    Returns:\n      bool: True or False indicating the presence of Script user text\n    Example:\n      \n    See Also:\n      GetDocumentUserText\n      SetDocumentUserText\n    \"\"\"\n    return scriptcontext.doc.Strings.DocumentUserTextCount > 0\n\n\ndef IsUserText(object_id):\n    \"\"\"Verifies that an object contains user text\n    Parameters:\n      object_id (guid): the object's identifier\n    Returns:\n      number: result of test:\n        0 = no user text\n        1 = attribute user text\n        2 = geometry user text\n        3 = both attribute and geometry user text\n    Example:\n      import rhinoscriptsyntax as rs\n      obj = rs.GetObject(\"Select object\")  \n      if obj:\n          usertext_type = rs.IsUserText(obj)\n          if usertext_type==0: print(\"Object has no user text\")\n          elif usertext_type==1: print(\"Object has attribute user text\")\n          elif usertext_type==2: print(\"Object has geometry user text\")\n          elif usertext_type==3: print(\"Object has attribute and geometry user text\")\n          else: print(\"Object does not exist\")\n    See Also:\n      GetUserText\n      SetUserText\n    \"\"\"\n    obj = rhutil.coercerhinoobject(object_id, True, True)\n    rc = 0\n    if obj.Attributes.UserStringCount: rc = rc|1\n    if obj.Geometry.UserStringCount: rc = rc|2\n    return rc\n\n\ndef SetDocumentData(section, entry, value):\n    \"\"\"Adds or sets a user data string to the current document\n    Parameters:\n      section (str): the section name\n      entry (str): the entry name\n      value (str): the string value\n    Returns:\n      str: The previous value\n    Example:\n      import rhinoscriptsyntax as rs\n      rs.SetDocumentData( \"MySection1\", \"MyEntry1\", \"MyValue1\" )\n      rs.SetDocumentData( \"MySection1\", \"MyEntry2\", \"MyValue2\" )\n      rs.SetDocumentData( \"MySection2\", \"MyEntry1\", \"MyValue1\" )\n    See Also:\n      DeleteDocumentData\n      DocumentDataCount\n      GetDocumentData\n      IsDocumentData\n    \"\"\"\n    val = scriptcontext.doc.Strings.SetString(section, entry, value)\n    return val if val else None\n\n\ndef SetDocumentUserText(key, value=None):\n    \"\"\"Sets or removes user text stored in the document\n    Parameters:\n      key (str): key name to set\n      value (str): The string value to set. If omitted the key/value pair\n        specified by key will be deleted\n    Returns:\n      bool: True or False indicating success\n    Example:\n      import rhinoscriptsyntax as rs\n      rs.SetDocumentUserText(\"Designer\", \"Steve Baer\")\n      rs.SetDocumentUserText(\"Notes\", \"Added some layer and updated some geometry\")\n    See Also:\n      GetDocumentUserText\n    \"\"\"\n    if value: scriptcontext.doc.Strings.SetString(key,value)\n    else: scriptcontext.doc.Strings.Delete(key)\n    return True\n\n\ndef SetUserText(object_id, key, value=None, attach_to_geometry=False):\n    \"\"\"Sets or removes user text stored on an object.\n    Parameters:\n      object_id (str): the object's identifier\n      key (str): the key name to set\n      value (str, optional) the string value to set. If omitted, the key/value pair\n          specified by key will be deleted\n      attach_to_geometry (bool, optional): location on the object to store the user text\n    Returns:\n      bool: True or False indicating success or failure\n    Example:\n      import rhinoscriptsyntax as rs\n      obj = rs.GetObject(\"Select object\")\n      if obj:\n          rs.SetUserText( obj, \"PartNo\", \"KM40-4960\" )\n          rs.SetUserText( obj, \"Price\", \"1.25\" )\n    See Also:\n      GetUserText\n      IsUserText\n    \"\"\"\n    obj = rhutil.coercerhinoobject(object_id, True, True)\n    if type(key) is not str: key = str(key)\n    if value and type(value) is not str: value = str(value)\n    if attach_to_geometry: return obj.Geometry.SetUserString(key, value)\n    return obj.Attributes.SetUserString(key, value)",
  "language": "python",
  "imports": [
    "rhinoscriptsyntax",
    "scriptcontext"
  ],
  "has_docstring": false
}