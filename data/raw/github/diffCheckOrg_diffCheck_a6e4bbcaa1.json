{
  "source_url": "https://github.com/diffCheckOrg/diffCheck/blob/8f668b1f273e8d81a282c6115ba3eae07eef9235/src/gh/components/DF_visualization/code.py",
  "repo": "diffCheckOrg/diffCheck",
  "repo_stars": 15,
  "repo_description": "diffCheck is a CAD-integrated tool for evaluating digital timber fabrication processes.",
  "license": "GPL-3.0",
  "filepath": "src/gh/components/DF_visualization/code.py",
  "instruction": null,
  "code": "#! python3\n\nfrom ghpythonlib.componentbase import executingcomponent as component\n\nfrom diffCheck import df_cvt_bindings\nfrom diffCheck import df_visualization\nfrom diffCheck.df_visualization import DFVizSettings\nfrom diffCheck.df_error_estimation import DFVizResults, DFInvalidData\n\nclass DFVisualization(component):\n    def RunScript(self,\n                  i_result: DFVizResults,\n                  i_viz_settings: DFVizSettings):\n\n        if i_result is None or i_viz_settings is None:\n            return None, None, None\n\n        # make a DFVizResult copy to avoid modifying the original result to be exported in csv\n        result_cp = DFVizResults(i_result.assembly)\n        exclude_indices = [idx for idx, sanity_val in enumerate(i_result.sanity_check) if sanity_val.value != DFInvalidData.VALID.value]\n        result_cp.source = [val for idx, val in enumerate(i_result.source) if idx not in exclude_indices]\n        result_cp.target = [val for idx, val in enumerate(i_result.target) if idx not in exclude_indices]\n        result_cp.distances = [val for idx, val in enumerate(i_result.distances) if idx not in exclude_indices]\n        result_cp.distances_mean = [val for idx, val in enumerate(i_result.distances_mean) if idx not in exclude_indices]\n        result_cp.distances_rmse = [val for idx, val in enumerate(i_result.distances_rmse) if idx not in exclude_indices]\n        result_cp.distances_max_deviation = [val for idx, val in enumerate(i_result.distances_rmse) if idx not in exclude_indices]\n        result_cp.distances_min_deviation = [val for idx, val in enumerate(i_result.distances_min_deviation) if idx not in exclude_indices]\n        result_cp.distances_sd_deviation = [val for idx, val in enumerate(i_result.distances_sd_deviation) if idx not in exclude_indices]\n\n        values, min_value, max_value = result_cp.filter_values_based_on_valuetype(i_viz_settings)\n\n        # check if result_cp.source is a list of pointclouds or a mesh\n        if result_cp.is_source_cloud:\n            o_source = [df_cvt_bindings.cvt_dfcloud_2_rhcloud(src) for src in result_cp.source]\n            o_colored_geo = [df_visualization.color_rh_pcd(src, dist, min_value, max_value, i_viz_settings.palette) for src, dist in zip(o_source, values)]\n        else:\n            o_source = result_cp.source\n            o_colored_geo = [df_visualization.color_rh_mesh(src, dist, min_value, max_value, i_viz_settings.palette) for src, dist in zip(o_source, values)]\n\n        o_legend = df_visualization.create_legend(min_value,\n                                                  max_value,\n                                                  i_viz_settings.palette,\n                                                  steps=10,\n                                                  plane=i_viz_settings.legend_plane,\n                                                  width=i_viz_settings.legend_width,\n                                                  total_height=i_viz_settings.legend_height)\n\n        if len(result_cp.source) > 1 and i_viz_settings.one_histogram_per_item:\n            multiple_curves = True\n        else:\n            multiple_curves = False\n\n        o_histogram = df_visualization.create_histogram(values,\n                                                        min_value,\n                                                        max_value,\n                                                        res=100,\n                                                        steps=10,\n                                                        plane=i_viz_settings.legend_plane,\n                                                        total_height=i_viz_settings.legend_height,\n                                                        scaling_factor=i_viz_settings.histogram_scale_factor,\n                                                        multiple_curves = multiple_curves)\n\n        return o_colored_geo, o_legend, o_histogram\n",
  "language": "python",
  "imports": [
    "ghpythonlib"
  ],
  "has_docstring": false
}