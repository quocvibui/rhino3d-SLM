{
  "source_url": "https://github.com/ENZYME-APD/tapir-archicad-automation/blob/3cc4d67228a62381d6cf7d9c0c3897171044ace2/sandbox/grasshopper-plugin/src/basic.py",
  "repo": "ENZYME-APD/tapir-archicad-automation",
  "repo_stars": 94,
  "repo_description": "The easiest way to use the JSON/Python API from Archicad without knowing how to code.",
  "license": "MIT",
  "filepath": "sandbox/grasshopper-plugin/src/basic.py",
  "instruction": null,
  "code": "#!/usr/bin/env ipy\n# -*- coding: utf-8 -*-\n\n__all__ = ['Connect_Component']\n\n# - - - - - - - - BUILT-IN IMPORTS\nimport System\nimport traceback\n\n# - - - - - - - - LOCAL IMPORTS\nimport tapir\nfrom tapir_py import core\n\n# - - - - - - - - RH/GH IMPORTS\nfrom ghpythonlib.componentbase import dotnetcompiledcomponent as component\nfrom Grasshopper.Kernel import GH_RuntimeMessageLevel as RML\nimport Rhino, Grasshopper, GhPython\n\n# - - - - - - - - COMPONENT\nclass Connect_Component(component):\n\n    def __new__(cls):\n        instance = Grasshopper.Kernel.GH_Component.__new__(cls, \"Connect\", \"Connect\", \"\"\"Establishes connection between current Grasshopper document, and any open ArchiCAD project.\"\"\", \"tAPIr\", \"01 Setup\")\n        return instance\n    \n    def get_ComponentGuid(self):\n        return System.Guid(\"bb340f32-83f5-4140-9956-960003773db4\")\n    \n    def SetUpParam(self, p, name, nickname, description):\n        p.Name = name\n        p.NickName = nickname\n        p.Description = description\n        p.Optional = True\n    \n    def RegisterInputParams(self, pManager):\n        p = Grasshopper.Kernel.Parameters.Param_Boolean()\n        self.SetUpParam(p, \"Refresh\", \"R\", \"Refreshes the link to the ArchiCAD project.\")\n        p.Access = Grasshopper.Kernel.GH_ParamAccess.item\n        self.Params.Input.Add(p)\n    \n    def RegisterOutputParams(self, pManager):\n        p = Grasshopper.Kernel.Parameters.Param_GenericObject()\n        self.SetUpParam(p, \"Link\", \"A\", \"ArchiCAD Command Object, that can execute commands.\")\n        self.Params.Output.Add(p)\n        \n    def SolveInstance(self, DA):\n        p0 = self.marshal.GetInput(DA, 0)\n        result = self.RunScript(p0)\n\n        if result is not None:\n            self.marshal.SetOutput(result, DA, 0, True)\n        \n    def get_Internal_Icon_24x24(self):\n        o = \"iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAFDSURBVHgB7ZSxTsJQFIb/cwuJE2Egzt24TSHUN+ARfAR8A0dkIT6Awuimj8DqJKObkIiQLmLSSSFKu7DQY6+mTWrEmN4uRL/pz/lv/pObc3KAXYeggZTSBAqXRHAYKIMxJNq0ptPpk3aDz3DjBkTmVy/csOO6k7HSApkxut+Ff4QK6icaGSEiZ7uJpmk6Za0GDCr/5l32HwCDH7zRfD5602tAGG7zhCi2Ym0gA7ZtN0KmKwIdgWlNgsxoJuvIujVE8XAyuRsjKypcWvVH2z5oIG/+w3czPHXspKx1o/0+VpqZByDRNERBb+1iLKvea7c77Ps+e57H7ZMOV6v1HvLCsmqvKjhmtfK5GtWgSepUlEqlRAdBgDxITkWlsr/3slg0LSnVncHZeQ+zB/diuXy+hgapIas5RJWW0hxyfza7P8Wf5x2l5XcOZmQWkAAAAABJRU5ErkJggg==\"\n        return System.Drawing.Bitmap(System.IO.MemoryStream(System.Convert.FromBase64String(o)))\n\n    def __init__(self):\n        self.is_valid = False\n        self.archicad = None\n\n    def RunScript(self, refresh):\n        self.ensure_button()\n\n        if refresh:\n            self.archicad = core.Command.create()\n            self.is_valid = self.archicad.IsAlive()\n        \n        tapir.Plugin.is_active = self.is_valid\n\n        if self.is_valid:\n            tapir.Plugin.Archicad = self.archicad\n            self.Message = \"Port: {}\".format(self.archicad.link.port)\n            return self.archicad\n        \n        else:\n            tapir.Plugin.Archicad = None\n            self.Message = \"\"\n            self.AddRuntimeMessage(RML.Warning, \"Connection Failed: Unable to connect to ArchiCAD.\")\n            return None\n    \n    def ensure_button(self):\n        if self.Params.Input[0].Sources.Count == 0:\n            tapir.Factory.create_button(self, 0, \"Update\", 150)\n            self.ExpireSolution(True)\n\n    def on_disconnect_click(self, sender, args):\n        try:\n            self.__init__()\n            self.ExpireSolution(True)\n        except Exception as ex:\n            System.Windows.Forms.MessageBox.Show(traceback.format_exc(), ex)\n\n    def AppendAdditionalMenuItems(self , items):\n        component.AppendAdditionalMenuItems(self , items)\n        try:\n            disconnect_menu_item = items.Items.Add('Disconnect', None, self.on_disconnect_click)\n        except Exception as ex:\n            System.Windows.Forms.MessageBox.Show(traceback.format_exc(), ex)\n\n# TODO: ProjectInfo / ProductInfo / ",
  "language": "python",
  "imports": [
    "Rhino",
    "ghpythonlib"
  ],
  "has_docstring": false
}