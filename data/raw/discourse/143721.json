{
  "source_url": "https://discourse.mcneel.com/t/ironpython-losing-connection-to-scriptcontext-doc/143721",
  "topic_id": 143721,
  "title": "IronPython losing connection to scriptcontext.doc",
  "question": "I have a simple Python script that is causing an error Grasshopper. I can get the same script to work by moving the line generating the error out the loop.\n\n\nThis works:\n\n\nimport rhinoscriptsyntax as rs\n\nall_pts = [ ]\nfor j in range(30):\n    if j %2 == 0 :\n        pts = rs.AddPoint(j , 4, 0)\n    else :\n        pts = rs.AddPoint(j, 10 , 0)\n    all_pts.append(pts)\npl = rs.AddPolyline(all_pts)\n\n\n\nThis does not work:\n\n\nimport rhinoscriptsyntax as rs\n\nall_pts = []\nfor j in range(30):\n    if j %2 == 0 :\n        pts = rs.AddPoint(j , 4, 0)\n    else :\n        pts = rs.AddPoint(j, 10 , 0)\n    all_pts.append(pts)\n    pl = rs.AddPolyline(all_pts)\n\n\n\nThe error has the following message:\n\n\n\n\nRuntime error (Python Exception): Unable to add polyline to document\n\n\nTraceback:\n\nline 563, in AddPolyline,\n\n“C:\\Users\\graha\\AppData\\Roaming\\McNeel\\Rhinoceros\\7.0\\Plug-ins\\IronPython (814d908a-e25c-493d-97e9-ee3861957f49)\\settings\\lib\\rhinoscript\\curve.py” line 10, in script\n\n\n\n\nI believe that the error case should be a valid Python script, even though it’s less efficient than the working case. In any case, I don’t believe that moving line 10 should an error.\n\n\nI have attached the two versions of the Grasshopper scripts, as well as my Rhino installation information.\n\n\nAddPolyline_Working.gh\n (2.8 KB)\n\n\nAddPolyline Working\n851×469 37.8 KB\n\n\nAddPolyline_Error.gh\n (2.8 KB)\n\n\nAddPolyline Error\n831×476 45.2 KB\n\n\nRhino System Information.txt\n (2.7 KB)",
  "code_blocks": [
    {
      "code": "import rhinoscriptsyntax as rs\n\nall_pts = [ ]\nfor j in range(30):\n    if j %2 == 0 :\n        pts = rs.AddPoint(j , 4, 0)\n    else :\n        pts = rs.AddPoint(j, 10 , 0)\n    all_pts.append(pts)\npl = rs.AddPolyline(all_pts)",
      "language": "python",
      "author": "graham_best",
      "post_number": 1,
      "is_solution": false
    },
    {
      "code": "import rhinoscriptsyntax as rs\n\nall_pts = []\nfor j in range(30):\n    if j %2 == 0 :\n        pts = rs.AddPoint(j , 4, 0)\n    else :\n        pts = rs.AddPoint(j, 10 , 0)\n    all_pts.append(pts)\n    pl = rs.AddPolyline(all_pts)",
      "language": "python",
      "author": "graham_best",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "file-io",
    "geometry",
    "grasshopper",
    "python",
    "rhinoscriptsyntax"
  ],
  "has_accepted_answer": true,
  "category_id": 11,
  "posts_count": 3,
  "views": 444
}