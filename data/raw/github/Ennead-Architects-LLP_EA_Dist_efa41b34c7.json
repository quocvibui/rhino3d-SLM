{
  "source_url": "https://github.com/Ennead-Architects-LLP/EA_Dist/blob/635520d89b8308b78eabf5b60bb80121d0fa3838/Apps/_rhino/View.tab/batch_rename_camera.button/batch_rename_camera_left.py",
  "repo": "Ennead-Architects-LLP/EA_Dist",
  "repo_stars": 0,
  "repo_description": null,
  "license": "unknown",
  "filepath": "Apps/_rhino/View.tab/batch_rename_camera.button/batch_rename_camera_left.py",
  "instruction": "Batch rename camera left",
  "code": "__title__ = \"BatchRenameCamera\"\r\n__doc__ = \"\"\"Enables bulk camera renaming operations.\r\n\r\nProvides interface for renaming multiple cameras without activation.\r\nMaintains camera properties while updating names efficiently.\r\n\"\"\"\r\n__is_popular__ = True\r\nimport Rhino # pyright: ignore\r\nimport Eto # pyright: ignore\r\nimport rhinoscriptsyntax as rs\r\nimport scriptcontext as sc\r\n\r\nfrom EnneadTab import SOUND\r\nfrom EnneadTab import LOG, ERROR_HANDLE\r\nfrom EnneadTab.RHINO import RHINO_UI\r\n\r\nclass rename_dialog(Eto.Forms.Dialog[bool]):\r\n\r\n    # Initializer\r\n    def __init__(self):\r\n        # Initialize dialog box\r\n        self.Title = 'Ennead Camera Batch Rename'\r\n        self.Padding = Eto.Drawing.Padding(5)\r\n        #self.Resizable = True\r\n        #self.Height = 500\r\n        self.Width = 600\r\n\r\n\r\n\r\n\r\n        # the bm of forms buttoms\r\n        button_layout = Eto.Forms.TableLayout()\r\n        button_layout.Spacing = Eto.Drawing.Size(5, 5)\r\n\r\n\r\n        button_layout.Rows.Add(Eto.Forms.TableRow(None, self.create_update_names_button(), self.CloseButton()))\r\n\r\n\r\n        # helper text\r\n        self.m_label = Eto.Forms.Label(Text = 'Double click to rename new name.')\r\n\r\n\r\n        # datagrid view\r\n        self.m_gridview = Eto.Forms.GridView()\r\n        self.m_gridview.ShowCellBorders = True\r\n        self.m_gridview.ShowHeader = True\r\n        self.m_gridview.Height = 600\r\n        self.m_gridview.CellDoubleClick += self.OnDblClickCell\r\n        #self.m_gridview.DataStore = [['current name1', 'new name1'],['current name1', 'new name1']]\r\n        view_names = rs.NamedViews()\r\n        self.m_gridview.DataStore = [[x, x] for x in view_names]\r\n\r\n        column_headers = [\"Current Name\", \"New Name\"]\r\n        for i, header in enumerate(column_headers):\r\n            column = Eto.Forms.GridColumn()\r\n            column.Width = self.Width/2 * 0.9\r\n            column.HeaderText = header\r\n            column.Editable = True if \"new\" in header.lower() else False\r\n            column.DataCell = Eto.Forms.TextBoxCell(i)\r\n            self.m_gridview.Columns.Add(column)\r\n\r\n\r\n\r\n        # Create main layout\r\n        layout = Eto.Forms.StackLayout()\r\n        layout.Padding = Eto.Drawing.Padding(5)\r\n        layout.Spacing = 5\r\n        layout.HorizontalContentAlignment = Eto.Forms.HorizontalAlignment.Stretch\r\n\r\n        logo_layout = Eto.Forms.DynamicLayout()\r\n        logo_layout.AddSeparateRow(None, self.CreateLogoImage())\r\n\r\n\r\n        layout.Items.Add(logo_layout)\r\n        layout.Items.Add(self.m_label)\r\n        layout.Items.Add(self.m_gridview)\r\n\r\n        layout.Items.Add(None)\r\n        layout.Items.Add(button_layout)\r\n        # Set the dialog content\r\n        self.Content = layout\r\n        \r\n        RHINO_UI.apply_dark_style(self)\r\n\r\n\r\n\r\n\r\n    def CreateLogoImage(self):\r\n        self.logo = Eto.Forms.ImageView()\r\n\r\n        return self.logo\r\n\r\n    # Close button click handler\r\n    def OnCloseButtonClick(self, sender, e):\r\n\r\n        self.Close(True)\r\n\r\n\r\n    # Grid.CellDoubleClick event and method----> isolate and refresh viewport\r\n    def OnDblClickCell(self, sender,e):\r\n        pass\r\n\r\n\r\n    # update button click handler\r\n    def OnUpdateButtonClick(self, sender, e):\r\n        \"\"\"\r\n        main body of update\r\n\r\n        self.m_gridview.SelectedItems to access select item to update the viewport\r\n        Grid.OnCellEdited event and method----> check blockname allowed\r\n        Grid.CellDoubleClick event and method----> isolate and refresh viewport\r\n        \"\"\"\r\n        #print 123\r\n        #print rs.NamedViews()\r\n        #print sc.doc.NamedViews\r\n        #print \"@@@\"\r\n        for data in self.m_gridview.DataStore:\r\n\r\n            #print data\r\n            old_name = data[0]\r\n            new_name = str(data[1])\r\n            if new_name == old_name:\r\n                continue\r\n\r\n            while True:\r\n                if new_name not in rs.NamedViews():\r\n                    break\r\n                new_name += \"_Name Conflict\"\r\n\r\n\r\n            \"\"\"\r\n            for view in sc.doc.NamedViews:\r\n                if view.Name == old_name:\r\n                    view.Name = new_name\r\n                    break\r\n            \"\"\"\r\n            sc.doc.NamedViews.Rename( old_name, new_name)\r\n\r\n\r\n        self.Close(True)\r\n\r\n    # Create button control\r\n    def CloseButton(self):\r\n        # Create the default button\r\n        self.DefaultButton = Eto.Forms.Button(Text = 'Close')\r\n        self.DefaultButton.Click += self.OnCloseButtonClick\r\n        return self.DefaultButton\r\n\r\n    def create_update_names_button(self):\r\n        # Create the update button, change text and bind action\r\n        self.update_button = Eto.Forms.Button(Text = 'Update Camera Names')\r\n        self.update_button.Click += self.OnUpdateButtonClick\r\n        return self.update_button\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n@LOG.log(__file__, __title__)\r\n@ERROR_HANDLE.try_catch_error()\r\ndef batch_rename_camera():\r\n    dlg = rename_dialog()\r\n    dlg.ShowModal(Rhino.UI.RhinoEtoApp.MainWindow)\r\n    SOUND.play_sound()\r\n\r\n\r\nif __name__ == \"__main__\":\r\n    batch_rename_camera()",
  "language": "python",
  "imports": [
    "Rhino",
    "rhinoscriptsyntax",
    "scriptcontext"
  ],
  "has_docstring": false
}