{
  "source_url": "https://discourse.mcneel.com/t/rhinocommon-beginundorecord-and-endundorecord/7213",
  "topic_id": 7213,
  "title": "[RhinoCommon] BeginUndoRecord and EndUndoRecord",
  "question": "Have searched shortly but canâ€™t find info about these functions.\n\nI can add a UInteger but how to call this undo?\n\n\nHow does the function work and how to apply it?\n\n\nCheers,\n\n\nJordy",
  "code_blocks": [
    {
      "code": "def MyStuff():\n    sn = scriptcontext.doc.BeginUndoRecord(\"My Stuff\")\n    pt = Rhino.Geometry.Point3d(0,0,0)\n    scriptcontext.doc.Objects.AddPoint(pt)\n    scriptcontext.doc.Views.Redraw()\n    if (sn > 0):\n        scriptcontext.doc.EndUndoRecord(sn)",
      "language": "python",
      "author": "jordy1989",
      "post_number": 3,
      "is_solution": false
    },
    {
      "code": "[\nSystem.Runtime.InteropServices.Guid(\"e6617215-682d-46cb-86a8-e0733d88d0a3\"),\nRhino.Commands.CommandStyle(Rhino.Commands.Style.ScriptRunner)\n]\npublic class TestCommand : Command\n{\n  public TestCommand() {}\n\n  public override string EnglishName { get { return \"TestCommand\"; } }\n\n  protected override Result RunCommand(RhinoDoc doc, RunMode mode)\n  {\n    Rhino.RhinoApp.RunScript(\"_Line 5,5 10,10\", true);\n    Rhino.RhinoApp.RunScript(\"_Line 10,5 5,10\", true);\n    doc.Views.Redraw();\n    return Result.Success;\n  }\n}",
      "language": "csharp",
      "author": "dale",
      "post_number": 7,
      "is_solution": false
    }
  ],
  "tags": [
    "csharp",
    "geometry",
    "python",
    "rhinocommon"
  ],
  "has_accepted_answer": false,
  "category_id": 3,
  "posts_count": 8,
  "views": 2293
}