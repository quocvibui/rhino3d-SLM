{
  "source_url": "https://github.com/SoniaHashim/compfab/blob/e8a0e2b6f1e15a135e886f6d30608a5e96026502/week2/transforms.py",
  "repo": "SoniaHashim/compfab",
  "repo_stars": 3,
  "repo_description": "Sonia's git repo for mat594x computational fabrication taught by Prof. Jennifer Jacobs at UC Santa Barbara Spring 2020. ",
  "license": "unknown",
  "filepath": "week2/transforms.py",
  "instruction": "Provides a scripting component.\n    Inputs:\n        c: The curve that specifies the transformation\n        g: The base geometry to transform\n        o: The offset for stacking / nesting\n        s:...",
  "code": "\"\"\"Provides a scripting component.\n    Inputs:\n        c: The curve that specifies the transformation\n        g: The base geometry to transform\n        o: The offset for stacking / nesting\n        s: The scale factor for iteratively created geometries\n        N: The number of objects to create\n    Output:\n        a: The a output variable\"\"\"\n\n__author__ = \"soniahashim\"\n\nimport rhinoscriptsyntax as rs\nimport Rhino.Geometry as geom\nimport math\n\n'''\nmethod: init_transform\nparams: i; initial curve that specifies the transformation\n-------------------------------------------------------------\nConstructs a change of basis using input curve (assumes curve\nstarts at the origin). Scale factor determined by length of\ncurve. Translates geometry to end of curve.\n'''\ndef init_transform(i):\n    p0 = i.PointAtStart\n    p1 = i.PointAtEnd\n\n    # Calculate inital basis and scale factor\n    t0 = p1-p0; v0 = geom.Vector3d(t0)\n    v2 = rs.CreateVector(0,0,1)\n    v1 = geom.Vector3d.CrossProduct(v0,v2)\n    v2 = geom.Vector3d.CrossProduct(v0,v1)\n    scaleFactor = t0.Length/5\n\n    # Normalize constructed basis\n    v0.Unitize()\n    v1.Unitize()\n    v2.Unitize()\n\n    # Standard basis\n    e0 = geom.Vector3d.XAxis\n    e1 = geom.Vector3d.YAxis\n    e2 = geom.Vector3d.ZAxis\n\n    # Get change of basis transform (standard --> curve)\n    b = geom.Transform.ChangeBasis(e0,e1,e2,v0,v1,-v2)\n\n    # Get scale transform matching scale factor set by curve length\n    s = geom.Transform.Scale(geom.Point3d.Origin,scaleFactor)\n\n    # Get translation transform to curve endpoint\n    r = geom.Transform.Translation(t0)\n\n    # Return geometry in new basis, scaled, and translated\n    return b\n\n'''\nmethod: scale\nparams: x,y,z; scale factors in x,y,z\n-------------------------------------------------------------\nReturns an affine scale matrix that scales by x, y, z\n'''\ndef scale(x,y,z):\n    t = geom.Transform.Identity\n    t.M00 = x\n    t.M11 = y\n    t.M22 = z\n    return t;\n\n'''\nmethod: translate\nparams: x,y,z; translation in x,y,z\n-------------------------------------------------------------\nReturns an affine translation matrix that translates by x,y,z\n'''\ndef translate(x,y,z):\n    t = geom.Transform.Identity\n    t.M03 = x\n    t.M13 = y\n    t.M23 = z\n    return t\n\n'''\nmethod: rotateZ\nparams: theta; degree in angles\n-------------------------------------------------------------\nReturns an affine transformation matrix that rotates around\nthe z axis by the specified amount\n'''\ndef rotateZ(theta):\n    t = geom.Transform.Identity\n    a = math.radians(theta)\n    t.M00 = math.cos(a)\n    t.M01 = -math.sin(a)\n    t.M10 = math.sin(a)\n    t.M11 = math.cos(a)\n    return t\n\n# Set initial transformation of geometry\nt = init_transform(c)\ng.Transform(t)\nf = (c.PointAtEnd - c.PointAtStart).Length/15\nt = scale(f,f,f)\ng.Transform(t)\n\n\nh0 = o    # height offset\n# s = .85 # iterative scaling\n# N = 5   # number of objects\n\nw = 0\nobjects = []\n# Create series via iteration to make N objects\nfor i in range(0,N):\n    x = g.Duplicate()\n    if i != 0:\n        w += (s**(i-1))*(1+s)*h0\n        t = scale(s**i, s**i, s**i)\n        x.Transform(t)\n        t = translate(0, 0, w)\n        x.Transform(t)\n        t = rotateZ(i*90)\n        x.Transform(t)\n    objects.append(x)\n\n\na = objects\n",
  "language": "python",
  "imports": [
    "Rhino",
    "Rhino.Geometry",
    "rhinoscriptsyntax"
  ],
  "has_docstring": true
}