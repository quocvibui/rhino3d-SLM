{
  "source_url": "https://discourse.mcneel.com/t/r8-view-capture-to-bitmap-result-in-white-jpgs/209757",
  "topic_id": 209757,
  "title": "R8: View Capture to Bitmap result in White JPGs",
  "question": "Hello Forum!\n\nI don’t know if this is a bug. I have a python script that I used for batch export JPG from layout using capture to bitmap. The script works fine in R7, but in Rhino 8 it produces only white images (sizes and dpi remains correct).\n\n\nThis is a simplified script. Thanks in advance for anyone chipping in \n\n\n# -*- coding: utf-8 -*-\nimport scriptcontext as sc\nimport Rhino, System, os\n\ndef export_to_jpg(layouts, folder, dpi=150):\n    if not layouts:\n        print(\"No layouts to export to JPG.\")\n        return\n\n    for layout in layouts:\n        layout_name = layout.MainViewport.Name\n        filename = \"{}.jpg\".format(layout_name)\n        full_path = os.path.join(folder, filename)\n\n        print(\"Exporting JPG:\", layout_name)\n\n        settings = Rhino.Display.ViewCaptureSettings(layout, dpi)\n        bitmap = Rhino.Display.ViewCapture.CaptureToBitmap(settings)\n\n        if bitmap:\n            bitmap.SetResolution(dpi, dpi)\n            bitmap.Save(full_path, System.Drawing.Imaging.ImageFormat.Jpeg)\n            print(\"✔ JPG saved:\", full_path)\n        else:\n            print(\"✖ Failed to export JPG:\", layout_name)\n\ndef main():\n    # Get all layouts\n    pages = sc.doc.Views.GetPageViews()\n    if not pages:\n        print(\"No layouts found.\")\n        return\n\n    # Default folder = Downloads\n    folder_name = os.path.join(os.path.expanduser(\"~\"), \"Downloads\")\n\n    # Run export\n    export_to_jpg(pages, folder_name, dpi=150)\n\n    # Try to open the folder in Explorer/Finder\n    try:\n        os.startfile(folder_name)\n    except:\n        pass\n\nif __name__ == \"__main__\":\n    main()\n\n\n\n\nSystem infos - assuming not that much impact on this, I still work with both R7/R8. Same plugins for both\n\n\nRhino 7 SR34 2023-9-24 (Rhino 7, 7.34.23267.11001, Git hash:master @ a37d83041828484840f2448d5b3e3770e46694f9)\nLicense type: Commercial, build 2023-09-24\nLicense details: LAN Zoo Network Node\n\nWindows 11 (10.0.26100 SR0.0) or greater (Physical RAM: 63Gb)\n\nComputer platform: LAPTOP  - P...",
  "code_blocks": [
    {
      "code": "# -*- coding: utf-8 -*-\nimport scriptcontext as sc\nimport Rhino, System, os\n\ndef export_to_jpg(layouts, folder, dpi=150):\n    if not layouts:\n        print(\"No layouts to export to JPG.\")\n        return\n\n    for layout in layouts:\n        layout_name = layout.MainViewport.Name\n        filename = \"{}.jpg\".format(layout_name)\n        full_path = os.path.join(folder, filename)\n\n        print(\"Exporting JPG:\", layout_name)\n\n        settings = Rhino.Display.ViewCaptureSettings(layout, dpi)\n        bitmap = Rhino.Display.ViewCapture.CaptureToBitmap(settings)\n\n        if bitmap:\n            bitmap.SetResolution(dpi, dpi)\n            bitmap.Save(full_path, System.Drawing.Imaging.ImageFormat.Jpeg)\n            print(\"✔ JPG saved:\", full_path)\n        else:\n            print(\"✖ Failed to export JPG:\", layout_name)\n\ndef main():\n    # Get all layouts\n    pages = sc.doc.Views.GetPageViews()\n    if not pages:\n        print(\"No layouts found.\")\n        return\n\n    # Default folder = Downloads\n    folder_name = os.path.join(os.path.expanduser(\"~\"), \"Downloads\")\n\n    # Run export\n    export_to_jpg(pages, folder_name, dpi=150)\n\n    # Try to open the folder in Explorer/Finder\n    try:\n        os.startfile(folder_name)\n    except:\n        pass\n\nif __name__ == \"__main__\":\n    main()",
      "language": "python",
      "author": "Amy_Song",
      "post_number": 1,
      "is_solution": false
    },
    {
      "code": "Rhino 7 SR34 2023-9-24 (Rhino 7, 7.34.23267.11001, Git hash:master @ a37d83041828484840f2448d5b3e3770e46694f9)\nLicense type: Commercial, build 2023-09-24\nLicense details: LAN Zoo Network Node\n\nWindows 11 (10.0.26100 SR0.0) or greater (Physical RAM: 63Gb)\n\nComputer platform: LAPTOP  - Plugged in [97% battery remaining]\n\nHybrid graphics configuration.\n  Primary display: Intel(R) Arc(TM) Pro Graphics (Intel) Memory: 2GB, Driver date: 2-26-2025 (M-D-Y).\n    > Integrated graphics device with 4 adapter port(s)\n        - Secondary monitor is laptop's integrated screen or built-in port\n        - Windows Main Display attached to adapter port #1\n        - Secondary monitor attached to adapter port #2\n  Primary OpenGL: NVIDIA GeForce RTX 4070 Laptop GPU (NVidia) Memory: 8GB, Driver date: 8-7-2025 (M-D-Y). OpenGL Ver: 4.6.0 NVIDIA 580.97\n    > Integrated accelerated graphics device (shares primary device ports)\n        - Video pass-through to primary display device\n\nOpenGL Settings\n  Safe mode: Off\n  Use accelerated hardware modes: On\n  Redraw scene when viewports are exposed: On\n  Graphics level being used: OpenGL 4.6 (primary GPU's maximum)\n  \n  Anti-alias mode: 4x\n  Mip Map Filtering: Linear\n  Anisotropic Filtering Mode: High\n  \n  Vendor Name: NVIDIA Corporation\n  Render version: 4.6\n  Shading Language: 4.60 NVIDIA\n  Driver Date: 8-7-2025\n  Driver Version: 32.0.15.8097\n  Maximum Texture size: 32768 x 32768\n  Z-Buffer depth: 24 bits\n  Maximum Viewport size: 32768 x 32768\n  Total Video Memory: 8188 MB\n\nRhino plugins that do not ship with Rhino\n  C:\\Program Files\\Enscape\\Enscape.Rhino.Plugin-net48\\Enscape.Rhino7.Plugin.dll\t\"Enscape.Rhino7.Plugin\"\t4.5.0.485\n  C:\\Users\\SongR\\AppData\\Local\\MotifPlugins\\1.7.1380\\RhinoPlugin7\\Motif.Plugin.Rhino7.dll\t\"Motif.Plugin.Rhino7Base\"\t1.7.1380.0\n  C:\\Users\\SongR\\OneDrive - Perkins and Will\\Desktop\\Script+Tool\\blockeditnew20230807\\BlockEditNew.rhp\t\"BlockEdit\"\t1.0.0.0\n  c:\\Program Files\\Solemma\\ClimateStudio\\bin\\ClimateStudioRhino7.rhp\t\"ClimateStudioRhino7\"\t2.1.9190.15522\n\nRhino plugins that ship with Rhino\n  C:\\Program Files\\Rhino 7\\Plug-ins\\Commands.rhp\t\"Commands\"\t7.34.23267.11001\n  C:\\Program Files\\Rhino 7\\Plug-ins\\rdk.rhp\t\"Renderer Development Kit\"\t\n  C:\\Program Files\\Rhino 7\\Plug-ins\\RhinoScript.rhp\t\"RhinoScript\"\t\n  C:\\Program Files\\Rhino 7\\Plug-ins\\RPC.rhp\t\"RPC\"\t\n  C:\\Program Files\\Rhino 7\\Plug-ins\\RhinoBonusTools.rhp\t\"Rhino Bonus Tools\"\t\n  C:\\Program Files\\Rhino 7\\Plug-ins\\RhinoRenderCycles.rhp\t\"Rhino Render\"\t7.34.23267.11001\n  C:\\Program Files\\Rhino 7\\Plug-ins\\RhinoRender.rhp\t\"Legacy Rhino Render\"\t\n  C:\\Program Files\\Rhino 7\\Plug-ins\\rdk_etoui.rhp\t\"RDK_EtoUI\"\t7.34.23267.11001\n  C:\\Program Files\\Rhino 7\\Plug-ins\\rdk_ui.rhp\t\"Renderer Development Kit UI\"\t\n  C:\\Program Files\\Rhino 7\\Plug-ins\\NamedSnapshots.rhp\t\"Snapshots\"\t\n  C:\\Program Files\\Rhino 7\\Plug-ins\\IronPython\\RhinoDLR_Python.rhp\t\"IronPython\"\t7.34.23267.11001\n  C:\\Program Files\\Rhino 7\\Plug-ins\\RhinoCycles.rhp\t\"RhinoCycles\"\t7.34.23267.11001\n  C:\\Program Files\\Rhino 7\\Plug-ins\\Toolbars\\Toolbars.rhp\t\"Toolbars\"\t7.34.23267.11001\n  C:\\Program Files\\Rhino 7\\Plug-ins\\3dxrhino.rhp\t\"3Dconnexion 3D Mouse\"\t\n  C:\\Program Files\\Rhino 7\\Plug-ins\\Displacement.rhp\t\"Displacement\"",
      "language": "python",
      "author": "Amy_Song",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "file-io",
    "geometry",
    "materials",
    "python"
  ],
  "has_accepted_answer": false,
  "category_id": 11,
  "posts_count": 2,
  "views": 57
}