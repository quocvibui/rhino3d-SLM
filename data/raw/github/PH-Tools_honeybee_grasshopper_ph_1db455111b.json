{
  "source_url": "https://github.com/PH-Tools/honeybee_grasshopper_ph/blob/c433bc8e66f3a51fd05ee4c485f4c54c03d2a569/honeybee_grasshopper_ph/src/HBPH%20Installer.py",
  "repo": "PH-Tools/honeybee_grasshopper_ph",
  "repo_stars": 6,
  "repo_description": "Honeybe-PH plugin for Rhino / Grasshopper ",
  "license": "GPL-3.0",
  "filepath": "honeybee_grasshopper_ph/src/HBPH Installer.py",
  "instruction": "This component installs/updates all of the 'Honeybee-PH' plugin libraries for Ladybug Tools.\nPlease make sure that you have Ladybug-Tools with Honeybee-Energy ALREADY fully installed...",
  "code": "#\n# Honeybee-PH: A Plugin for adding Passive-House data to LadybugTools Honeybee-Energy Models\n# \n# This component is part of the PH-Tools toolkit <https://github.com/PH-Tools>.\n# \n# Copyright (c) 2022, PH-Tools and bldgtyp, llc <phtools@bldgtyp.com> \n# Honeybee-PH is free software; you can redistribute it and/or modify \n# it under the terms of the GNU General Public License as published \n# by the Free Software Foundation; either version 3 of the License, \n# or (at your option) any later version. \n# \n# Honeybee-PH is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of \n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the \n# GNU General Public License for more details.\n# \n# For a copy of the GNU General Public License\n# see <https://github.com/PH-Tools/honeybee_ph/blob/main/LICENSE>.\n# \n# @license GPL-3.0+ <http://spdx.org/licenses/GPL-3.0+>\n#\n\"\"\"\nThis component installs/updates all of the 'Honeybee-PH' plugin libraries for Ladybug Tools.\nPlease make sure that you have Ladybug-Tools with Honeybee-Energy ALREADY fully installed BEFORE\nproceeding with this installation. Make sure you are connected to the internet in \norder to download the latest version of the plugin libraries and components.\n-\nThis tool will download and install several new libraries into the Ladybug-Tools\npython interpreter, and will download and install new Grasshopper components which\nwill be added to your Rhino / Grasshopper installation.\n-\nEM June 27, 2024\n    Args:\n        _install: (bool) Set to True to install Honeybee-PH on your computer.\n        \n        _hbph_ver: (str): The Version number of the Honeybee-PH package to install from PyPi.\n            Note that if you leave this input empty, the latest version will be installed. For \n            more details on honeybee-ph version, see https://pypi.org/project/honeybee-ph/\n       \n        _phx_ver: (str): The Version number of the PHX package to install from PyPi.\n            Note that if you leave this input empty, the latest version will be installed. For \n            more details on honeybee-ph version, see https://pypi.org/project/PHX/\n\"\"\"\n\nCOMPONENT = ghenv.Component # type: ignore\nCOMPONENT.Name = 'HBPH Installer'\nCOMPONENT.NickName = 'HBPHInstall'\nCOMPONENT.Message = 'JUN_27_2024'\nCOMPONENT.Category = 'Honeybee-PH'\nCOMPONENT.SubCategory = '00 | Utils'\nCOMPONENT.AdditionalHelpFromDocStrings = '0'\n\ntry:\n    COMPONENT.ToggleObsolete(False)\nexcept AttributeError:\n    pass # Rhino 7\n    \nimport os\nimport sys\nimport json\nimport subprocess\n\ntry:\n    import ctypes\nexcept:\n    pass # MacOs\n\ntry:\n    from typing import Optional, Tuple\nexcept ImportError:\n    pass # IronPython 2.7\n\ntry:\n    from exceptions import IOError # type: ignore\nexcept ImportError:\n    pass # IronPython 2.7\n\ntry:\n    import Rhino # type: ignore\nexcept ImportError:\n    pass # Outside Rhino/Grasshopper\n\ntry:\n    from Grasshopper.Folders import UserObjectFolders # type: ignore\nexcept ImportError:\n    pass # Outside Rhino/Grasshopper\n\ntry:\n    #from ladybug_rhino.versioning import change\n    from ladybug_rhino import grasshopper as lbt_gh\n    from ladybug_rhino.config import folders as lbr_folders\n    lbr_loaded = True\nexcept ImportError as e:\n    lbr_loaded = False\n    msg =   '\\nFailed to import ladybug_rhino:\\n'\\\n            'Please make sure Ladybug and Honeybee are installed properly before proceeding.\\n\\t{}'.format(e)\n    raise ImportError(msg)\n\ntry:\n    from ladybug import futil\nexcept ImportError as e:\n    msg =   '\\nFailed to import ladybug.futil:\\n'\\\n            'Please make sure Ladybug and Honeybee are installed properly before proceeding.\\n\\t{}'.format(e)\n    raise ImportError(msg)\n\ntry:\n    from honeybee.config import folders as hb_folders\nexcept ImportError as e:\n    msg =   '\\nFailed to import honeybee.config.folders:\\n'\\\n            'Please make sure Ladybug and Honeybee are installed properly before proceeding.\\n\\t{}'.format(e)\n    raise ImportError(msg)\n\n\n\n# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n# -- Required Versions\nMIN_VER_RHINO = (8, 9)\nMIN_VER_LBT_GH = (1, 8, 30)\n\n\n# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n# -- System Check\n\n\ndef is_windows_user_admin():\n    # type: () -> bool\n    \"\"\"For Windows only, return True if the user opened Rhino 'As Administrator' and False if not.\"\"\"\n    if (os.name != 'nt'): # In case used on MacOs\n        return True\n    \n    try:\n        mode = ctypes.windll.shell32.IsUserAnAdmin() != 0\n    except Exception as e:\n        raise Exception(e)\n    \n    if mode != 0:\n        return True\n    else:\n        return False\n\ndef user_system_meets_min_rhino_version(_min_version_allowed):\n    # type: (Tuple[int, int]) -> bool\n    \"\"\"Return True if the current Rhino version meets the minimum compatibility requirements.\n    \n    Arguments:\n    ----------\n        * _min_version_allowed (Tuple[int, int]): The Minimum Rhino version compatible\n            with Honeybee-PH. \n    \n    Returns:\n    --------\n        * (bool)\n    \"\"\"\n    \n    # -- Only check against Major / Minor version\n    rh_min_version_allowed = (_min_version_allowed[0], _min_version_allowed[1])\n    rh_version_found = (Rhino.RhinoApp.Version.Major, Rhino.RhinoApp.Version.Minor)\n    \n    # ---------------------------------------------------------------------------\n    print (\"Rhino version: {}.{}\".format(Rhino.RhinoApp.Version.Major, Rhino.RhinoApp.Version.Minor))\n    \n    if rh_version_found < rh_min_version_allowed:\n        return False\n    else:\n        \n        return True\n\ndef user_system_meets_min_LBT_version(_min_version_allowed):\n    # type: (Tuple[int, int, int]) -> bool\n    \"\"\"Return True if the installed LBT Grasshopper version meets the minimum compatibility requirements.\n    \n    Arguments:\n    ----------\n        * _min_version_allowed (Tuple[int, int]): The Minimum Ladybug Grasshopper version compatible\n            with Honeybee-PH. \n    \n    Returns:\n    --------\n        * (bool)\n    \"\"\"\n    # ---------------------------------------------------------------------------\n    lbt_gh = lbr_folders.lbt_grasshopper_version\n    if not lbt_gh:\n        msg = (\n            \"Error: Please make sure that you have Ladybug Tools and Honeybee installed \"\n            \"before proceeding with the installation. \\n\"\n            \"Cannot determine the Ladybug Tools version installed? \\n\"\n            \" - ladybug_rhino.config.lbt_grasshopper_version={} \\n\".format(lbt_gh)\n            )\n        print msg\n        raise Exception(msg)\n    \n    # ---------------------------------------------------------------------------\n    print(\"Ladybug-Tools-Grasshopper version: {}.{}.{}\".format(*lbt_gh))\n    \n    # ---------------------------------------------------------------------------\n    if lbt_gh < _min_version_allowed:\n        return False\n    else:\n        return True\n\ndef check_system_setup():\n    # type: () -> None\n    \"\"\"Provide messages related to System compatibility.\"\"\"\n    \n    print \"Rhino running in 'Admin' mode:\", is_windows_user_admin()\n    if not is_windows_user_admin():\n        msg = \" Error: This Honeybee-PH installer will only work if Rhino is started in 'Admin' mode.\\n\"\\\n                \"To proceed with the installation: \\n\"\\\n                \"Please close Rhino and re-open it by 'right-clicking' on the Rhino application, and selecting 'Run as Administrator'.\\n\"\\\n                \"Once you are in 'admin' mode, please re-open this installer and you will be able to continue with the Honeybee-PH Installation.\"\n        raise Exception(msg)\n    \n    if not user_system_meets_min_rhino_version(MIN_VER_RHINO):\n        msg = \"Error: Honeybee-PH requires Rhino version: \"\\\n            \"{}.{} or better. Please update Rhino before proceeding. \"\\\n            \"Got version: {}.{}\".format(\n                MIN_VER_RHINO[0],\n                MIN_VER_RHINO[1],\n                Rhino.RhinoApp.Version.Major,\n                Rhino.RhinoApp.Version.Minor,\n            )\n        print(msg)\n        raise Exception(msg)\n    \n    if not user_system_meets_min_LBT_version(MIN_VER_LBT_GH):\n        msg = \"Error: Honeybee-PH requires Ladybug-Tools version: \"\\\n            \"{}.{} or better. Please update Ladybug-Tools before proceeding. \"\\\n            \"Got version: {}.{}\".format(\n                MIN_VER_LBT_GH[0],\n                MIN_VER_LBT_GH[1],\n                lbr_folders.lbt_grasshopper_version[0],\n                lbr_folders.lbt_grasshopper_version[1],\n            )\n        print(msg)\n        raise Exception(msg)\n    \n    # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n    print \"Ladybug Tools Python .exe:\", hb_folders.python_exe_path\n    print \"Ladybug Tools Python packages:\", hb_folders.python_package_path\n\n\n# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n# -- PIP Install\n\n\ndef run_pip_command(python_exe, package_name, version=None, target=None, _env=None):\n    # type: (str, str, str, str, Optional[Dict]) -> str\n    \"\"\"Update or Install Python libraries using pip within a python subprocess.\n    \n    Args:\n        * python_exe (str): The path to the Python executable to be used for installation.\n        \n        * package_name (str): The name of the PyPI package to install\n        \n        * version (str): An optional string for the version of the package to install.\n        \n        * target (str): An optional target directory into which the package will be installed.\n        \n        * _env (Optional[Dict]): The OS Environment to be used for the Pip-Install\n    Returns:\n        * error_msg (str)\n    \"\"\"\n    \n    # Set the environment for pip install to fix Rhino-8 issues\n    if _env == None:\n        _env = os.environ\n        \n    # build up the command using the inputs\n    if version is not None:\n            package_name = '{}=={}'.format(package_name, version)\n    \n    cmds = [python_exe, '-m', 'pip', 'install', package_name]\n    \n    if version is None:\n        cmds.append('-U')\n    \n    if target is not None:\n        cmds.extend(['--target', target, '--upgrade'])\n\n    # execute the command and print any errors\n    print('Installing \"{}\" version via pip'.format(package_name))\n    \n    use_shell = True if os.name == 'nt' else False\n    \n    # Use the ENV passed in to fix any Rhino-8 issues\n    process = subprocess.Popen(\n        cmds, shell=use_shell, stdout=subprocess.PIPE, stderr=subprocess.PIPE, env=_env)\n    \n    output = process.communicate()\n    \n    stdout, stderr = output\n    \n    error_msg = 'Package \"{}\" may not have been updated correctly\\n' \\\n        'or its usage in the plugin may have changed. See pip stderr below:\\n' \\\n        '{}'.format(package_name, stderr)\n    \n    return error_msg\n\ndef update_pip(python_exe, _env=None):\n    # type: (str, Optional[Dict]) -> str\n    \"\"\"Update 'Pip' to avoid seeing those error.\n    \n    Args:\n        * python_exe (str): The path to the Python executable to be used for installation.\n        \n        * _env (Optional[Dict]): The OS Environment to be used for the Pip-Install\n    \n    Returns:\n        error_msg (str)\n    \"\"\"\n    \n    # Set the environment for pip install to fix Rhino-8 issues\n    if _env == None:\n        _env = os.environ\n        \n    # build up the command using the inputs\n    cmds = [python_exe, '-m', 'pip', 'install', '--upgrade', 'pip']\n    \n    # execute the command and print any errors\n    print('Updating Pip...')\n    \n    use_shell = True if os.name == 'nt' else False\n    \n    # Use the ENV passed in to fix any Rhino-8 issues\n    try:\n        process = subprocess.Popen(\n            cmds, shell=use_shell, stdout=subprocess.PIPE, stderr=subprocess.PIPE, env=_env)\n        \n        output = process.communicate()\n        \n        stdout, stderr = output\n        \n        error_msg = 'Command: {} may have failed for some reason'.format(cmds)\n    except Exception as e:\n        error_msg = e\n\n    return error_msg\n\ndef pip_install(_package_name, _package_version, _lbt_python_exe_path, _lbt_python_package_path, _package_install_folder_name=None, _env=None):\n    # type: (str, Optional[str], str, str, Optional[str], Optional[Dict]) -> None\n    \"\"\"PIP install a specified package from PyPi to the Ladybug Tools Python.\n    \n    Arguments:\n    ----------\n        * _package_name (str): The name of the package to install from PyPi\n        \n        * _package_version: (Optional[str]) The version of the package to install.\n            If None, the most recent version is installed.\n        \n        * _lbt_python_exe_path (str): The path to the Ladybug Tools python installation.\n        \n        * _lbt_python_package_path (str): The path to the Ladybug Tools python site-packages directory.\n        \n        * _package_install_folder_name (Optional[str]): An optional folder name for\n            the package once it is installed. This is used to verify installation went\n            correctly. Note that in many cases the install folder name will be \n            different than the package name (ie: \"honeybee-ph\" --> \"honeybee_ph\"). If None\n            is supplied, will try and automatically create the folder name by just replacing all\n            hyphens with underscores.\n        \n        * _env (Optional[Dict]): The OS Environment to use for the Pip-Install. This should have\n            \"PYTHONHOME\" set to: \"\" in order to avoid the Rhino Python-3 install issues.\n    Returns:\n    --------\n        * None\n    \"\"\"\n    \n    # Set the environment for pip install to fix Rhino-8 issues\n    if _env == None:\n        _env = os.environ\n    \n    if not _package_install_folder_name:\n        _package_install_folder_name = _package_name.replace(\"-\", \"_\")\n    \n    print '- '*50 \n    print 'Installing Python package: \"{}\" (v{}) to: {}'.format(_package_name, _package_version, _lbt_python_package_path) \n    print \"  _package_name=\", _package_name\n    print \"  _package_version=\", _package_version\n    print \"  _lbt_python_exe_path=\", _lbt_python_exe_path\n    print \"  _lbt_python_package_path=\", _lbt_python_package_path\n    print \"  _package_install_folder_name=\", _package_install_folder_name\n    print \"  _env['PYTHONHOME']=\", _env['PYTHONHOME'] \n    package_dist_folder_name = \"{}-{}.dist-info\".format(_package_install_folder_name, _package_version)\n    print \"package_dist_folder_name=\", package_dist_folder_name\n    package_dist_folder_path = os.path.join(_lbt_python_package_path, package_dist_folder_name)\n    print \"package_dist_folder_path=\", package_dist_folder_path\n    \n    stderr = run_pip_command(_lbt_python_exe_path, _package_name, _package_version, _env=_env)\n    \n    if os.path.isdir(package_dist_folder_path):\n        print(\"Package '{}' (v-{}) successfully installed to: {}\".format(_package_name, _package_version, _lbt_python_package_path))\n    else:\n        print(\"Could not find {}\".format(package_dist_folder_path))\n        print(\"Package '{}' (v-{}) failed to install to: {}\".format(_package_name, _package_version, _lbt_python_package_path))\n        lbt_gh.give_warning(COMPONENT, stderr)\n        print(stderr)\n\n\n# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n# -- GitHub\n\n\ndef copy_repo_contents_to_site_packages(_source_directory, _target_directory, _branch):\n    # type: (str, str, str) -> None\n    \"\"\"Copy a directory's contents to the Ladybug Tools site-packages directory.\n    \n    Arguments:\n    ----------\n        * _source_directory (str): The full path to the directory to copy the contents of.\n        \n        * _target_directory (str): The full path to the directory to copy to.\n    \n    Returns:\n    --------\n        * None\n    \"\"\"\n    \n    directories_to_exclude = {'.github', 'tests', 'docs', 'diagrams',} \n    for _dir in os.listdir(_source_directory):\n        src_dir = os.path.join(_source_directory, _dir)\n        \n        if _dir in directories_to_exclude: # don't copy any of these to site-packages\n            continue\n        \n        if not os.path.isdir(src_dir): # If the target folder doesn't exist already\n            continue\n        \n        print('Copying \"{}\" to:: {}'.format(_dir, _target_directory))\n        futil.copy_file_tree(src_dir, os.path.join(_target_directory, _dir))\n\ndef get_files_from_github_repo(_github_repo_name, _target_directory, _branch='main'):\n    # type: (str, str, str) -> None\n    \"\"\"Download, unzip and copy files from a GitHub repo into a target directory.\n    \n    Arguments:\n    ----------\n        * _github_repo_name (str): The name of the GitHub repo to download.\n        \n        * _target_directory (str): The full path of the directory to put the\n            downloaded files in.\n            \n        * _branch (str): default='main' The target branch name to download.\n    \n    Returns:\n    --------\n        * None\n    \"\"\"\n\n    # -------------------------------------------------------------------------\n    # -- Setup all the file and directory paths\n    github_url = \"https://github.com/PH-Tools/{}/archive/refs/heads/{}.zip\".format(_github_repo_name, _branch)\n    directory_to_download_to = hb_folders.python_package_path\n    name_of_zipfile_to_download = '{}.zip'.format(_github_repo_name)\n    downloaded_zip_file_path = os.path.join(directory_to_download_to, name_of_zipfile_to_download)\n    temp_unzip_directory = os.path.join(directory_to_download_to, \"{}-{}\".format(_github_repo_name, _branch))\n    \n    # -------------------------------------------------------------------------\n    #-- Try and download the Github Repo as a .zip file, then unzip the file\n    try:\n        print(\"- \"*25)\n        print(\"Downloading:: {}\\nto:: {}\".format(github_url, downloaded_zip_file_path))\n        futil.download_file_by_name(github_url, directory_to_download_to, name_of_zipfile_to_download, mkdir=True)\n        \n        print(\"Unzipping:: {}\\nto:: {}/\".format(downloaded_zip_file_path, temp_unzip_directory))\n        futil.unzip_file(downloaded_zip_file_path, directory_to_download_to, mkdir=True)\n    except IOError as e:\n        msg = (\n            \"There was an error downloading the {} package to your computer.\\n\"\n            \"If you have Ladybug Tools installed in you 'ProgramFiles' directory, (ie: if you \"\n            \"are using Pollination instead of the Food4Rhino LBT installer) you may \\n\"\n            \"need to run Rhino 'as administrator' in order to \"\n            \"install to this directory?\\n\".format(_github_repo_name)\n            )\n        raise IOError(msg)\n    except Exception as e:\n        msg = \"There was a error downloading {} to {} and unzipping the file \"\\\n            \"to {}.\\n{}\".format(github_url, downloaded_zip_file_path, temp_unzip_directory, e)\n        raise Exception(msg)\n\n\n    # -------------------------------------------------------------------------\n    # -- Copy the unzipped files/folders over to the Ladybug site-packages folder\n    copy_repo_contents_to_site_packages(temp_unzip_directory, _target_directory, _branch)\n    \n    \n    # -------------------------------------------------------------------------\n    # -- Cleanup: Remove the downloaded folder and zip file\n    print(\"Removing directory: {}\".format(temp_unzip_directory))\n    futil.nukedir(temp_unzip_directory, True)\n\n    print(\"Removing downloaded file: {}\".format(downloaded_zip_file_path))\n    os.remove(downloaded_zip_file_path)\n\ndef copy_grasshopper_components_to_UserObjects(_repo_name, _download_directory, _target_directory):\n    # type: (str, str, str) -> None\n    \"\"\"Copy all of the GH-User objects from the source dir over the Grasshopper UserObjects directory. \n\n    This is used when downloading from the \"honeybee_grasshopper_ph\" github repo, since the .ghuser objects \n    are nested down in the unzipped directory. This function should get called after download and unzip from \n    the \"honeybee_grasshopper_ph\" github repo.\n    \n    Arguments:\n    ---------- \n        * _repo_name (str): The name of the honeybee_grasshopper_ph repo.\n        \n        * _download_directory (str): The path to the download directory.\n        \n        * _target_directory (str): The Grasshopper UserObjects directory to copy to .ghuser files to.\n    \n    Returns:\n    --------\n        * None\n    \"\"\"\n    \n    repo_download_directory = os.path.join(_download_directory, _repo_name)\n    hbph_gh_source_folder = os.path.join(repo_download_directory, 'user_objects')\n    \n    if not os.path.isdir(hbph_gh_source_folder):\n        msg = (\n            \"Cannot find the Grasshopper Component directory: {}? Please be sure\"\n            \"you downloaded and unzipped the '{}' GitHub repo before trying to copy to\"\n            \"the Grasshopper UserObjects directory\".format(hbph_gh_source_folder, _repo_name)\n        )\n        print(msg)\n        return\n    \n    target = os.path.join(_target_directory[0], _repo_name)\n    \n    # -- Clean out any existing files in the target directory.\n    if os.path.exists(target):\n        for file_name in os.listdir(target):\n            file_path = os.path.join(target, file_name)\n            try:\n                if os.path.isfile(file_path):\n                    os.unlink(file_path)\n                elif os.path.isdir(file_path):\n                    shutil.rmtree(file_path)\n            except Exception as e:\n                print(\"Error deleting file or directory: {}\".format(e))\n\n    print('- '*25)\n    print('Copying downloaded Grasshopper Components from::\\n{} to::\\n{}'.format(hbph_gh_source_folder, target))\n    \n    futil.copy_file_tree(hbph_gh_source_folder, target, overwrite=True)\n    \n    print(\"Cleaning up and removing download directory: {}\".format(repo_download_directory))\n    futil.nukedir(repo_download_directory, True)\n\n\n# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n# -- Main\n\n\ndef install_honeybee_ph(_hbph_version, _phx_version, _hbph_gh_branch, _lbt_python_exe_path, _lbt_python_package_path, _env=None):\n    # type: (Optional[str], Optional[str], Optional[str], str, str, Optional[Dict]) -> None\n    \"\"\"Install Honeybee-PH and PHX Packages from PIP, then download Grasshopper components from Github.\n    \n    Arguments:\n    ----------\n        * _hbph_version (Optional[str]): The Honeybee-PH version to install from PyPi. If\n            None is supplied, will install the most recent.\n        \n        * _phx_version (Optional[str]): The PHX version to install from PyPi. If\n            None is supplied, will install the most recent.\n        \n        * _hbph_gh_branch (Optional[str]): The name of the 'honeybee_grasshopper_ph' Github branch to\n            install. If None is supplied, 'main' will be used.\n        \n        * _lbt_python_exe_path (str): The path to the Ladybug Tools python.exe\n        \n        * _lbt_python_package_path (str): The path to the Ladybug Tools python site-packages directory.\n        \n        * _env: The os.environ dict to use for pip-install\n    \n    Returns:\n    --------\n        * None\n    \"\"\"\n    \n    # Set the environment for pip install to fix Rhino-8 issues\n    if _env == None:\n        _env = os.environ\n    \n    # -------------------------------------------------------------------------\n    # Install the Honeybee-PH and PHX packages from PyPi\n    update_pip(_lbt_python_exe_path, _env=_env)\n    pip_install(\n        _package_name='honeybee-ph', \n        _package_version=_hbph_version,\n        _lbt_python_exe_path=_lbt_python_exe_path,\n        _lbt_python_package_path=_lbt_python_package_path,\n        _package_install_folder_name=None,\n        _env=_env\n    )\n    pip_install(\n        _package_name='phx', \n        _package_version=_phx_version,\n        _lbt_python_exe_path=_lbt_python_exe_path,\n        _lbt_python_package_path=_lbt_python_package_path,\n        _package_install_folder_name=None,\n        _env=_env\n    )\n    \n    # -------------------------------------------------------------------------\n    # -- Install the Honeybee-PH Grasshopper Components and Libraries from GitHub\n    get_files_from_github_repo(\n        _github_repo_name='honeybee_grasshopper_ph',\n        _target_directory=_lbt_python_package_path,\n        _branch=_hbph_gh_branch or 'main'\n    )\n    copy_grasshopper_components_to_UserObjects(\n        _repo_name='honeybee_grasshopper_ph',\n        _download_directory=_lbt_python_package_path,\n        _target_directory=UserObjectFolders\n    )\n    \n    # -------------------------------------------------------------------------\n    # -- Install the Honeybee-PH+ Grasshopper Components and Libraries from GitHub\n    get_files_from_github_repo(\n        _github_repo_name='honeybee_grasshopper_ph_plus',\n        _target_directory=_lbt_python_package_path,\n        _branch=_hbph_gh_branch or 'main'\n    )\n    copy_grasshopper_components_to_UserObjects(\n        _repo_name='honeybee_grasshopper_ph_plus',\n        _download_directory=_lbt_python_package_path,\n        _target_directory=UserObjectFolders\n    )\n    \n    # -------------------------------------------------------------------------\n    # Give a success message\n    print \"- \" * 50\n    msg = 'Honeybee-PH and PHX have been successfully installed!\\n'\\\n        'Please RESTART RHINO to being using the new components + libraries.'\n    print(msg)\n    lbt_gh.give_popup_message(msg, 'Installation Successful!')\n    \n    return None\n\n\n# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n\n\n# -- Required for Rhino 8, otherwise the new py3.9 hijacks the pip install\nCUSTOM_ENV = os.environ.copy()\nCUSTOM_ENV['PYTHONHOME'] = ''\n\ncheck_system_setup()\n\nif _install:\n    install_honeybee_ph(\n        _hbph_version=_hbph_version,\n        _phx_version=_phx_version,\n        _hbph_gh_branch=None,\n        _lbt_python_exe_path=hb_folders.python_exe_path,\n        _lbt_python_package_path=hb_folders.python_package_path,\n        _env=CUSTOM_ENV\n    )\nelse:\n    msg = 'Please:\\n'\\\n    '- Be sure you have already installed Ladybug Tools.\\n'\\\n    '- Are connected to the internet.\\n'\\\n    '- Set _install to \"True\" to install Honeybee-PH and all its dependencies on this system.'   \n    print(msg)",
  "language": "python",
  "imports": [
    "Rhino"
  ],
  "has_docstring": true
}