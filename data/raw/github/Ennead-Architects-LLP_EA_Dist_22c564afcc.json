{
  "source_url": "https://github.com/Ennead-Architects-LLP/EA_Dist/blob/635520d89b8308b78eabf5b60bb80121d0fa3838/Apps/_rhino/Render.tab/ai_render.button/view2render_left.py",
  "repo": "Ennead-Architects-LLP/EA_Dist",
  "repo_stars": 0,
  "repo_description": null,
  "license": "unknown",
  "filepath": "Apps/_rhino/Render.tab/ai_render.button/view2render_left.py",
  "instruction": "View2render left",
  "code": "__title__ = \"AiRenderingFromView\"\r\n__doc__ = \"\"\"Renders Rhino views using Stable Diffusion AI.\r\n\r\nCaptures current viewport and processes it through selected AI models.\r\nProvides extensive control over rendering style, mood, and architectural context.\r\n\"\"\"\r\n\r\n\r\nimport time\r\n\r\n\r\nimport Rhino # pyright: ignore\r\nimport scriptcontext as sc\r\nimport Eto # pyright: ignore\r\nimport os\r\nimport System # pyright: ignore\r\nimport random\r\n\r\nfrom EnneadTab import USER, ENVIRONMENT, NOTIFICATION, DATA_FILE, EXE, TIME, FOLDER\r\nfrom EnneadTab import LOG, ERROR_HANDLE\r\nfrom EnneadTab.RHINO import RHINO_UI\r\n\r\nMODEL_DICT = {0: \"runwayml/stable-diffusion-v1-5\"}\r\n# get all file in a folder\r\nMODEL_FOLDER = os.path.join(ENVIRONMENT.L_DRIVE_HOST_FOLDER, \"04_AI\", \"Stable Diffusion_Model\")  # \"S:\\SD-Model\"\r\nfiles = [file for file in os.listdir(MODEL_FOLDER) if file != \"source\"]\r\n\r\n# https://civitai.com/?tag=buildings\r\nAPPROVED_MODEL = [\"architecturerealmix_v10\",\r\n                  \"xsarchitectural_v11\",\r\n                  \"xsarchitecturalv3com_v3\",\r\n                  \"productDesign_eddiemauro20\",\r\n                  \"MrMcFanyongV1512_mrMcFanyongV1512\",\r\n                  \"majicmixRealistic_v6\",\r\n                  \"lofi_v3\",\r\n                  \"landscapesupermix_v2\",\r\n                  \"interiordesignsuperm_v2\",\r\n                  \"dvarchMultiPrompt_dvarchExterior\",\r\n                  \"colorful_v31\",\r\n                  \"cetusMix_Whalefall2\",\r\n                  \"yqModernexclusive_v10\"]\r\n\r\nUNAPPROVED_MODEL = [file for file in files if file not in APPROVED_MODEL]\r\nfiles = [\"---- base pipeline above ----\"] + APPROVED_MODEL + \\\r\n    [\"---- archi good above, less good below ----\"] + UNAPPROVED_MODEL\r\n\"\"\"\r\nunknown:\r\n\r\n\r\nbad ones:\r\nttslbArchiV1_v10\r\n\r\n\"\"\"\r\n\r\n\r\n\"\"\"\r\nNote to furture\r\n\r\n do a test runner to try all the pipline model\r\n   and give a list that cannot work and model that can work\r\n\"\"\"\r\n\r\n\r\nif not USER.IS_DEVELOPER:\r\n    files = [file for file in files if file in APPROVED_MODEL]\r\nfor i, model in enumerate(files):\r\n\r\n    # remove the extenion in model name\r\n    # model = model.split(\".\")[0]\r\n    MODEL_DICT[i + 1] = model  # os.path.join(folder, model)\r\n# MODEL_DICT[len(MODEL_DICT.keys())] = \"stabilityai\\stable-diffusion-2-1\"\r\n# print MODEL_DICT\r\n\r\nPROMPT_DICT = {}\r\nPROMPT_DICT[\"00_general_mode\"] = [\"Exterior\",\r\n                                  \"Interior\",\r\n                                  \"Site Plan\",\r\n                                  \"Floor Plan\",\r\n                                  \"Elevation\"]\r\n\r\nPROMPT_DICT[\"01_style_mode\"] = [\"Professional Architecture Rendering\",\r\n                                \"Architecture Diagram\",\r\n                                \"Architectural Photography\",\r\n                                \"Architecture Illustration\",\r\n                                \"Architectural physical model\"]\r\nPROMPT_DICT[\"02_typology_mode\"] = [\"Residential Building\",\r\n                                   \"Office Building\",\r\n                                   \"Industrial Building\",\r\n                                   \"Office Space\",\r\n                                   \"Industrial Space\",\r\n                                   \"Residential Space\",\r\n                                   \"Train Station\",\r\n                                   \"Museum\",\r\n                                   \"City Plaza\",\r\n                                   \"High School\",\r\n                                   \"Univeristy\",\r\n                                   \"Playground\",\r\n                                   \"Retail\",\r\n                                   \"Shopping Center\",\r\n                                   \"Storefront Shopping\",\r\n                                   \"Waterfront parking\",\r\n                                   \"Parking garage\"]\r\nPROMPT_DICT[\"03_scale_mode\"] = [\"Villa\",\r\n                                \"Lowrise\",\r\n                                \"Highrise\",\r\n                                \"Super Tall\",\r\n                                \"Skyscraper\",\r\n                                \"Town House\",\r\n                                \"Master Plannings\",\r\n                                \"City\",\r\n                                \"Planet\",\r\n                                \"Stars\",\r\n                                \"Intersteller\"]\r\n\r\nPROMPT_DICT[\"04_reference_mode\"] = [\"archdaily.com\",\r\n                                    \"pritzker winner\",\r\n                                    \"award-winning\",\r\n                                    \"MOMA\",\r\n                                    \"Iwan Baan\",\r\n                                    \"NASA\",\r\n                                    \"Aliens\"]\r\nPROMPT_DICT[\"05_design_mode\"] = [\"Modern\",\r\n                                 \"Classic\",\r\n                                 \"Traditional\",\r\n                                 \"Artistic\",\r\n                                 \"Modern Art\",\r\n                                 \"Minimalism\",\r\n                                 \"Organic\",\r\n                                 \"Very Organic\",\r\n                                 \"Sharp Edges\"]\r\n\r\nPROMPT_DICT[\"10_lighting_mode\"] = [\"Natrual light\",\r\n                                   \"Sun light\",\r\n                                   \"HDR\",\r\n                                   \"HDR+\",\r\n                                   \"Morning Light\",\r\n                                   \"Sunset lighting\",\r\n                                   \"Dusk Light\",\r\n                                   \"Dramatic Lighting\"]\r\nPROMPT_DICT[\"11_wheather_mode\"] = [\"Sunny\",\r\n                                   \"Cloudy\",\r\n                                   \"Rainy\",\r\n                                   \"Windy\",\r\n                                   \"Snowy\",\r\n                                   \"After Rain\",\r\n                                   \"Foggy\"]\r\nPROMPT_DICT[\"12_color_mode\"] = [\"Black and White\",\r\n                                \"All white material\",\r\n                                \"accent orange color\"]\r\n\r\nPROMPT_DICT[\"20_country_mode\"] = [\"Canada\",\r\n                                  \"United States\",\r\n                                  \"Mexico\",\r\n                                  \"United Kingdom\",\r\n                                  \"France\",\r\n                                  \"Germany\",\r\n                                  \"Italy\",\r\n                                  \"Spain\",\r\n                                  \"Australia\",\r\n                                  \"Japan\",\r\n                                  \"Singapore\",\r\n                                  \"China\"]\r\nPROMPT_DICT[\"21_city_mode\"] = [\"City\",\r\n                               \"city center\",\r\n                               \"Suburbs\",\r\n                               \"Towns\",\r\n                               \"Villages\",\r\n                               \"Urban\",\r\n                               \"park\",\r\n                               \"urban plaza\"]\r\nPROMPT_DICT[\"22_region_mode\"] = [\"North America\",\r\n                                 \"South America\",\r\n                                 \"Europe\",\r\n                                 \"Asia\",\r\n                                 \"Africa\",\r\n                                 \"Australia\",\r\n                                 \"Antarctica\"]\r\n\r\nPROMPT_DICT[\"30_mood_mode\"] = [\"Happy\",\r\n                               \"Sad\",\r\n                               \"Angry\",\r\n                               \"Surprised\",\r\n                               \"Disgusted\",\r\n                               \"Fearful\",\r\n                               \"Neutral\",\r\n                               \"Peaceful\",\r\n                               \"Exciting\",\r\n                               \"futuristic\",\r\n                               \"dreammy\"]\r\nPROMPT_DICT[\"31_people_mode\"] = [\"Crowded\",\r\n                                 \"No people\",\r\n                                 \"Office people\",\r\n                                 \"Party people\",\r\n                                 \"pedestrian friendly\"]\r\nPROMPT_DICT[\"32_age_mode\"] = [\"Young\",\r\n                              \"Middle aged\",\r\n                              \"Old\",\r\n                              \"brand new\",\r\n                              \"future\"]\r\n\r\nPROMPT_DICT[\"40_material_mode\"] = [\"Wood\",\r\n                                   \"Yellow Copper\",\r\n                                   \"Blue Plastic\",\r\n                                   \"Blurry Glass\",\r\n                                   \"Reflective glass\",\r\n                                   \"Fine Leather\",\r\n                                   \"Cloth\",\r\n                                   \"Fabric\", \"Paper\"]\r\n\r\nPROMPT_DICT[\"99_must_have\"] = [\"Best Quality\",\r\n                               \"Very Detailed\",\r\n                               \"Fine texture\"]\r\n\r\n\r\nclass ViewCaptureDialog(Eto.Forms.Form):\r\n\r\n    # Class initializer\r\n    def __init__(self):\r\n        # Initialize dialog box\r\n        self.Title = 'View2Ai Rendering.'\r\n        self.Padding = Eto.Drawing.Padding(10)\r\n        # Create a table layout and add all the controls\r\n        layout = Eto.Forms.DynamicLayout()\r\n        layout.Padding = Eto.Drawing.Padding(10)\r\n        layout.Spacing = Eto.Drawing.Size(5, 5)\r\n        layout.AddSeparateRow(None, self.CreateLogoImage())\r\n        layout.AddRow(self.CreateFolderButtons())\r\n        layout.AddRow(self.CreateLabel())\r\n        layout.AddRow(self.CreateImageView())\r\n        layout.AddRow(None)  # spacer\r\n        layout.AddRow(self.CreateInputBox())  # spacer\r\n        layout.AddRow(self.CreateButtons())\r\n        # Set the dialog content\r\n        self.Content = layout\r\n        self.capture_view()\r\n\r\n        self.Closed += self.OnFormClosed\r\n        \r\n        \r\n        RHINO_UI.apply_dark_style(self)\r\n\r\n        # Form Closed event handler\r\n    def OnFormClosed(self, sender, e):\r\n\r\n        self.Close()\r\n\r\n    def CreateLogoImage(self):\r\n        self.logo = Eto.Forms.ImageView()\r\n\r\n        self.FOLDER_PRIMARY = r\"L:\\4b_Applied Computing\\03_Rhino\\00_Asset Library\"\r\n        self.FOLDER_APP_IMAGES = r\"{}\\Database\\app images\".format(\r\n            self.FOLDER_PRIMARY)\r\n        self.LOGO_IMAGE = r\"{}\\Ennead_Architects_Logo.png\".format(\r\n            self.FOLDER_APP_IMAGES)\r\n        temp_bitmap = Eto.Drawing.Bitmap(self.LOGO_IMAGE)\r\n        self.logo.Image = temp_bitmap.WithSize(200, 30)\r\n        return self.logo\r\n\r\n    # Create the dialog label\r\n\r\n    def CreateLabel(self):\r\n        self.m_label = Eto.Forms.Label(Text='Click the \"Capture\" button...')\r\n        return self.m_label\r\n\r\n    # Create the dialog image list\r\n\r\n    def CreateImageView(self):\r\n        self.m_image_view = Eto.Forms.ImageView()\r\n        self.initial_w, self.initial_h = 500, 400\r\n        self.m_image_view.Size = Eto.Drawing.Size(\r\n            self.initial_w, self.initial_h)\r\n        self.m_image_view.Image = None\r\n\r\n        return self.m_image_view\r\n\r\n    def CreateFolderButtons(self):\r\n        layout = Eto.Forms.DynamicLayout()\r\n        self.bt_open_folder = Eto.Forms.Button(Text='Open OutputFolder')\r\n        self.bt_open_folder.Click += self.OnOpenFolderButtonClick\r\n\r\n        bt_test_model = Eto.Forms.Button(Text=\"Test Unapproved Models\")\r\n        bt_test_model.Click += self.OnTestModelButtonClick\r\n        if USER.IS_DEVELOPER:\r\n            layout.AddSeparateRow(None, bt_test_model,  self.bt_open_folder)\r\n        else:\r\n            layout.AddSeparateRow(None, self.bt_open_folder)\r\n        return layout\r\n\r\n    @property\r\n    def sample_prompt(self):\r\n        # \"architecture exterior rendering, professional, archdaily.com, japanese architects, peaceful, few people, city center, after rain, dusk, high resolution, european modern architects, very detailed, natural lighting, award-winning, highest quality, sci-fi, natural material.\"\r\n        sample_prompt = \"\"\r\n        for mode in sorted(PROMPT_DICT.keys()):\r\n            # random sample from list\r\n            sample_count = 1\r\n            if mode == \"99_must_have\":\r\n                sample_count = 2\r\n            elif mode == \"40_material_mode\":\r\n                sample_count = 3\r\n            values = random.sample(PROMPT_DICT[mode], sample_count)\r\n            for value in values:\r\n                sample_prompt += \"{}, \".format(value)\r\n\r\n        return sample_prompt.rstrip(\", \")\r\n\r\n    def CreateInputBox(self):\r\n        layout = Eto.Forms.DynamicLayout()\r\n\r\n        # multiline_textbox = Eto.Forms.TextArea()\r\n        # multiline_textbox.Text = \"Hello, world!\"\r\n        # multiline_textbox.Size = Eto.Drawing.Size(200, 200)\r\n        # layout.AddRow(multiline_textbox)\r\n        label = Eto.Forms.Label(Text='Pick a Model:')\r\n        label2 = Eto.Forms.Label(\r\n            Text='Rendering will happen in the background and will take GPU resource.\\nBut your Rhino is free to continue working.')\r\n        self.cb_model = Eto.Forms.ComboBox()\r\n        self.cb_model.DataStore = MODEL_DICT.values()\r\n        # get the key of the dict whose value is \"architecturerealmix_v10\"\r\n        self.cb_model.SelectedIndex = MODEL_DICT.keys(\r\n        )[MODEL_DICT.values().index(\"architecturerealmix_v10\")]\r\n        # self.cb_model.SelectedIndex = 1\r\n        layout.AddSeparateRow(label, self.cb_model)\r\n        layout.AddSeparateRow(label2)\r\n\r\n        label = Eto.Forms.Label(Text='\\nEnter below the positive prompts:')\r\n        layout.AddRow(label)\r\n        self.tbox_positive_prompts = Eto.Forms.TextArea()\r\n        self.tbox_positive_prompts.Size = Eto.Drawing.Size(500, 100)\r\n        self.tbox_positive_prompts.Text = self.sample_prompt\r\n        layout.AddRow(self.tbox_positive_prompts)\r\n\r\n        layout.AddRow(None)\r\n        label = Eto.Forms.Label(Text='\\nEnter below the negative prompts:')\r\n        layout.AddRow(label)\r\n        self.tbox_negative_prompts = Eto.Forms.TextArea()\r\n        self.tbox_negative_prompts.Size = Eto.Drawing.Size(500, 50)\r\n        self.tbox_negative_prompts.Text = \"cropped, out of frame, worst quality, low quality, jpeg artifacts, ugly, blurry, bad anatomy, bad proportions\"\r\n        layout.AddRow(self.tbox_negative_prompts)\r\n\r\n        layout.AddRow(None)\r\n        label = Eto.Forms.Label(Text='Num of Output Images: ')\r\n        self.tbox_num_of_img = Eto.Forms.TextBox()\r\n        self.tbox_num_of_img.Text = '4'\r\n        self.tbox_num_of_img.TextAlignment = Eto.Forms.TextAlignment .Center\r\n        self.tbox_num_of_img.Width = 30\r\n        label2 = Eto.Forms.Label(\r\n            Text='(Keep it low for best GPU performance.)')\r\n        layout.AddSeparateRow(label, self.tbox_num_of_img, None, label2)\r\n\r\n        layout.AddRow(None)\r\n        label = Eto.Forms.Label(Text='Resolution: W x H: ')\r\n        self.tbox_width = Eto.Forms.TextBox()\r\n        self.tbox_width.Text = '500'\r\n        self.tbox_width.TextAlignment = Eto.Forms.TextAlignment .Center\r\n        self.tbox_width.Width = 40\r\n        self.tbox_height = Eto.Forms.TextBox()\r\n        self.tbox_height.Text = '400'\r\n        self.tbox_height.TextAlignment = Eto.Forms.TextAlignment .Center\r\n        self.tbox_height.Width = 40\r\n        layout.AddSeparateRow(label, self.tbox_width, Eto.Forms.Label(\r\n            Text=' x '), self.tbox_height, None)\r\n\r\n        layout.AddRow(None)\r\n        label = Eto.Forms.Label(Text='Step of Iteration: ')\r\n        self.tbox_iteration = Eto.Forms.TextBox()\r\n        self.tbox_iteration.Text = '50'\r\n        self.tbox_iteration.TextAlignment = Eto.Forms.TextAlignment .Center\r\n        self.tbox_iteration.Width = 30\r\n\r\n        label2 = Eto.Forms.Label(Text='Similarity: ')\r\n        self.weight_slider = Eto.Forms.Slider()\r\n        self.weight_slider.MaxValue = 100\r\n        self.weight_slider.MinValue = 0\r\n        self.weight_slider.Value = 50\r\n        self.weight_slider.SnapToTick = True\r\n        self.weight_slider.TickFrequency = 10\r\n        self.weight_slider.ValueChanged += self.OnSliderChanged\r\n        self.weight_slider_label = Eto.Forms.Label(\r\n            Text='{}%'.format(self.weight_slider.Value))\r\n        layout.AddSeparateRow(label, self.tbox_iteration, None,\r\n                              label2, self.weight_slider, self.weight_slider_label)\r\n\r\n        layout.AddSeparateRow(None, Eto.Forms.Label(\r\n            Text=\"Note: If you want to export in high resolution, set output count to 1.\\nIf you want to export more output options, set the resolution to below 1000 in either direction.\"), None)\r\n\r\n        if USER.IS_DEVELOPER:\r\n            self.foundation_pipeline_list = Eto.Forms.RadioButtonList()\r\n            self.foundation_pipeline_list.Orientation = Eto.Forms.Orientation.Vertical\r\n            self.foundation_pipeline_list.DataStore = [\r\n                \"Edge Detection\", \"Style Match Reference Image\", \"In Paint\"]\r\n            self.foundation_pipeline_list.SelectedValue = self.foundation_pipeline_list.DataStore[\r\n                0]\r\n            self.foundation_pipeline_list.SelectedValueChanged += self.foundation_pipeline_changed\r\n            self.bt_load_external_image = Eto.Forms.Button(\r\n                Text='Load External Image')\r\n            layout.AddSeparateRow(\r\n                self.foundation_pipeline_list, None, self.bt_load_external_image)\r\n        return layout\r\n\r\n    # Create the dialog buttons\r\n\r\n    def CreateButtons(self):\r\n        # Create the default button\r\n        self.bt_capture = Eto.Forms.Button(Text='Update View Capture')\r\n        self.bt_capture.Click += self.OnCaptureButtonClick\r\n\r\n        self.bt_export = Eto.Forms.Button(Text='Send to AI')\r\n        self.bt_export.Click += self.OnExportButtonClick\r\n\r\n        # Create the abort button\r\n        self.AbortButton = Eto.Forms.Button(Text='Close')\r\n        self.AbortButton.Click += self.OnCloseButtonClick\r\n        # Create button layout\r\n        button_layout = Eto.Forms.DynamicLayout()\r\n        button_layout.Spacing = Eto.Drawing.Size(5, 5)\r\n\r\n        button_layout.AddRow(self.bt_capture, None,\r\n                             self.bt_export, self.AbortButton)\r\n\r\n        return button_layout\r\n\r\n    def OnOpenFolderButtonClick(self, sender, e):\r\n        try:\r\n            os.startfile(\"{}\\\\EnneadTab_Ai_Rendering\".format(\r\n                ENVIRONMENT.DB_FOLDER))\r\n        except:\r\n            print(\"Folder not exist, please wait\")\r\n\r\n    def capture_view(self):\r\n        # Capture the active view to a System.Eto.Drawing.Bitmap\r\n        view = sc.doc.Views.ActiveView\r\n        original_size = view.Size\r\n        w = int(self.tbox_width.Text)\r\n        h = int(self.tbox_height.Text)\r\n\r\n        if h != self.initial_h:\r\n            factor = float(h) / self.initial_h\r\n            h = self.initial_h\r\n            w = int(w / factor)\r\n        # if w > self.initial_w:\r\n        #     factor = w / self.initial_w\r\n        #     w = self.initial_w\r\n        #     h = int(h / factor)\r\n        view.Size = System.Drawing.Size(w, h)\r\n\r\n        self.m_image_view.Image = Rhino.UI.EtoExtensions.ToEto(\r\n            view.CaptureToBitmap())\r\n        self.m_image_view.Size = Eto.Drawing.Size(w, h)\r\n        view.Size = original_size\r\n        # Update the text label\r\n        self.m_label.Text = 'Captured view: {}'.format(\r\n            view.ActiveViewport.Name)\r\n        # Disable the default button\r\n        self.bt_capture.Enabled = True\r\n\r\n\r\n    def foundation_pipeline_changed(self, sender, e):\r\n        if self.foundation_pipeline_list.SelectedIndex != 0:\r\n            self.bt_load_external_image.Enabled = True\r\n        else:\r\n            self.bt_load_external_image.Enabled = False\r\n\r\n    # Capture button click handler\r\n\r\n\r\n    def OnCaptureButtonClick(self, sender, e):\r\n        self.capture_view()\r\n\r\n\r\n    def OnExportButtonClick(self, sender, e):\r\n        self.session = time.strftime(\"%Y%m%d-%H%M%S\")\r\n        self.save_capture_to_file()\r\n        self.send_data()\r\n\r\n    # Close button click handler\r\n    def OnCloseButtonClick(self, sender, e):\r\n        self.Close()\r\n\r\n    def OnSliderChanged(self, sender, e):\r\n        self.weight_slider_label.Text = '{}%'.format(self.weight_slider.Value)\r\n\r\n\r\n    def OnTestModelButtonClick(self, sender, e):\r\n        print(UNAPPROVED_MODEL)\r\n\r\n        for i, model in enumerate(UNAPPROVED_MODEL):\r\n            print(\"{}/{}--testing model: {}\".format(i +\r\n                  1, len(UNAPPROVED_MODEL), model))\r\n            self.session = \"Model Test_{}\".format(\r\n                time.strftime(\"%Y%m%d-%H%M%S\"))\r\n            self.cb_model.SelectedIndex = MODEL_DICT.keys(\r\n            )[MODEL_DICT.values().index(model)]\r\n            self.save_capture_to_file()\r\n            self.send_data()\r\n            time.sleep(2)\r\n\r\n    @property\r\n    def input_image_filename(self):\r\n        main_folder = FOLDER.DUMP_FOLDER\r\n        session_folder = main_folder + \\\r\n            \"\\\\EnneadTab_Ai_Rendering\\\\Session_{}\".format(self.session)\r\n        if not os.path.exists(session_folder):\r\n            os.makedirs(session_folder)\r\n\r\n        return os.path.join(session_folder, \"Original.jpeg\")\r\n\r\n    # Returns the captured image\r\n    def Image(self):\r\n\r\n        return self.m_image_view.Image\r\n\r\n    def Close(self):\r\n        # Dispose of the form and remove it from the sticky dictionary\r\n        if sc.sticky.has_key('EA_AI_RENDER_CAPTURE_FORM'):\r\n            form = sc.sticky['EA_AI_RENDER_CAPTURE_FORM']\r\n            if form:\r\n                form.Dispose()\r\n                form = None\r\n            sc.sticky.Remove('EA_AI_RENDER_CAPTURE_FORM')\r\n\r\n    def save_capture_to_file(self):\r\n        view = sc.doc.Views.ActiveView\r\n        view_capture = Rhino.Display.ViewCapture()\r\n        # view_capture.Width = view.ActiveViewport.Size.Width\r\n        # view_capture.Height = view.ActiveViewport.Size.Height\r\n        view_capture.Width = int(self.tbox_width.Text)\r\n        view_capture.Height = int(self.tbox_height.Text)\r\n        view_capture.ScaleScreenItems = False\r\n        view_capture.DrawAxes = False\r\n        view_capture.DrawGrid = False\r\n        view_capture.DrawGridAxes = False\r\n        view_capture.TransparentBackground = False\r\n        bitmap = view_capture.CaptureToBitmap(view)\r\n\r\n        bitmap.Save(self.input_image_filename,\r\n                    System.Drawing.Imaging.ImageFormat.Jpeg)\r\n\r\n    def send_data(self):\r\n        data = dict()\r\n        data[\"session\"] = self.session\r\n        data[\"input_image\"] = self.input_image_filename\r\n        # r\"C:\\Users\\szhang\\github\\EnneadTab-for-AI\\output\\working draft\\imgs\\IN\\input.jpg\"\r\n\r\n        # <<<<>>>><<<<>>>> change this to the address of python<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\r\n        data[\"controlnet_model\"] = \"lllyasviel/sd-controlnet-canny\"\r\n        #data[\"controlnet_model\"] = os.path.join(ENVIRONMENT.L_DRIVE_HOST_FOLDER, \"SD-Model\", \"sd-controlnet-canny\")\r\n\r\n        data[\"pipeline_model\"] = MODEL_DICT.get(self.cb_model.SelectedIndex, None)\r\n        if data[\"pipeline_model\"] is None:\r\n            NOTIFICATION.messenger(\"AI Model not selected!\")\r\n            \r\n            return\r\n        if self.cb_model.SelectedIndex != 0:\r\n            data[\"pipeline_model\"] = MODEL_FOLDER + \\\r\n                \"\\\\\" + data[\"pipeline_model\"]\r\n        print(data[\"pipeline_model\"])\r\n\r\n        data[\"positive_prompt\"] = self.tbox_positive_prompts.Text\r\n        data[\"negative_prompt\"] = self.tbox_negative_prompts.Text\r\n        data[\"number_of_output\"] = int(self.tbox_num_of_img.Text)\r\n        data[\"desired_resolution\"] = [\r\n            int(self.tbox_width.Text), int(self.tbox_height.Text)]\r\n        data[\"iteration\"] = int(self.tbox_iteration.Text)\r\n        data[\"control_net_weight\"] = self.weight_slider.Value/100.0\r\n\r\n        if USER.IS_DEVELOPER:\r\n            if self.foundation_pipeline_list.SelectedIndex == 0:\r\n                data[\"foundation_pipeline\"] = \"control_net\"\r\n            elif self.foundation_pipeline_list.SelectedIndex == 1:\r\n                data[\"foundation_pipeline\"] = \"img2img\"\r\n                # to be changed later\r\n                data[\"reference_image\"] = \"C:\\\\Users\\\\szhang\\\\Desktop\\\\revit logo.png\"\r\n            elif self.foundation_pipeline_list.SelectedIndex == 2:\r\n                data[\"foundation_pipeline\"] = \"in_paint\"\r\n                # to be changed later\r\n                data[\"in_paint_mask_img\"] = \"C:\\\\Users\\\\szhang\\\\Desktop\\\\revit logo.png\"\r\n\r\n        data[\"direction\"] = \"IN\"\r\n\r\n        DATA_FILE.set_data(\r\n            data, \"AI_RENDER_DATA_{}\".format(TIME.get_formatted_current_time()))\r\n\r\n        NOTIFICATION.messenger(\"Render Job Enqueued!\")\r\n\r\n\r\n\r\n\r\n@LOG.log(__file__, __title__)\r\n@ERROR_HANDLE.try_catch_error()\r\ndef view2render():\r\n    # See if the form is already visible\r\n    if sc.sticky.has_key('EA_AI_RENDER_CAPTURE_FORM'):\r\n        print(\"form is already exisit\")\r\n        return\r\n\r\n    # Create and show form\r\n    form = ViewCaptureDialog()\r\n    form.Owner = Rhino.UI.RhinoEtoApp.MainWindow\r\n    form.Show()\r\n    # Add the form to the sticky dictionary so it\r\n    # survives when the main function ends.\r\n    sc.sticky['EA_AI_RENDER_CAPTURE_FORM'] = form\r\n\r\n    if USER.IS_DEVELOPER:\r\n        is_testing_new_engine = False\r\n\r\n        if is_testing_new_engine:\r\n            return\r\n\r\n    EXE.try_open_app(\"EA_AI_CONVERTER_0.2.6\")\r\n\r\n\r\n\r\nif __name__ == \"__main__\":\r\n    view2render()",
  "language": "python",
  "imports": [
    "Rhino",
    "scriptcontext"
  ],
  "has_docstring": false
}