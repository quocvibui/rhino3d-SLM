{
  "source_url": "https://github.com/Ennead-Architects-LLP/EA_Dist/blob/635520d89b8308b78eabf5b60bb80121d0fa3838/Apps/lib/EnneadTab/RHINO/RHINO_ALIAS.py",
  "repo": "Ennead-Architects-LLP/EA_Dist",
  "repo_stars": 0,
  "repo_description": null,
  "license": "unknown",
  "filepath": "Apps/lib/EnneadTab/RHINO/RHINO_ALIAS.py",
  "instruction": "Rhino alias",
  "code": "\r\nimport os\r\n\r\nimport ENVIRONMENT\r\nimport DATA_FILE\r\n\r\n\r\nimport rhinoscriptsyntax as rs\r\nimport Rhino # pyright: ignore\r\n\r\ndef remove_invalid_alias():\r\n    exisitng_alias = rs.AliasNames()\r\n    for alias in exisitng_alias:\r\n        exisiting_macro = rs.AliasMacro(alias)\r\n        if \"RunPythonScript\" not in exisiting_macro:\r\n            continue\r\n        exisiting_full_path = exisiting_macro.split('_-RunPythonScript \"')[1].split('\"')[0]\r\n        if not os.path.exists(exisiting_full_path):\r\n            rs.DeleteAlias(alias)\r\n\r\ndef register_alias_set():\r\n    remove_invalid_alias()\r\n\r\n    exisitng_alias = rs.AliasNames()\r\n    \r\n    data = DATA_FILE.get_data(ENVIRONMENT.KNOWLEDGE_RHINO_FILE, is_local=True)\r\n\r\n    for root, dirs, files in os.walk(ENVIRONMENT.RHINO_FOLDER):\r\n        for file in files:\r\n            if file.endswith(\".py\"):\r\n                full_path = os.path.join(root, file)\r\n                # print (full_path)\r\n                # print(full_path.split(\"_rhino\\\\\")[1])\r\n\r\n                \r\n                if full_path.split(ENVIRONMENT.RHINO_FOLDER_KEYNAME + \"\\\\\")[1] not in data.keys():\r\n                    continue\r\n                \r\n\r\n\r\n                alias_list = data.get(full_path.split(ENVIRONMENT.RHINO_FOLDER_KEYNAME + \"\\\\\")[1]).get('alias')\r\n\r\n\r\n                if not isinstance(alias_list, list):\r\n                    alias_list = [alias_list]\r\n\r\n                for alias in alias_list:\r\n                    if not alias:\r\n                        continue\r\n\r\n                    # Determine the actual alias name that will be registered\r\n                    if alias == alias.upper():\r\n                        actual_alias = alias\r\n                    else:\r\n                        actual_alias = ENVIRONMENT.PLUGIN_ABBR + \"_\" + alias\r\n                    \r\n                    # Check if alias already exists\r\n                    if rs.IsAlias(actual_alias):\r\n                        existing_macro = rs.AliasMacro(actual_alias)\r\n                        # If it's already pointing to this script, skip\r\n                        if full_path in existing_macro:\r\n                            continue\r\n                        # If user has a personal alias (not EA_ prefixed) with same name, skip to avoid overwriting\r\n                        if ENVIRONMENT.PLUGIN_ABBR + \"_\" not in actual_alias:\r\n                            continue\r\n                        # For EA_ aliases, we'll update them if they point to a different script\r\n\r\n                    script_content = '! _-RunPythonScript \"{}\"'.format(full_path)\r\n                    if os.path.exists(full_path):\r\n                        if alias == alias.upper():\r\n                            rs.AddAlias(alias, script_content)\r\n                        else:\r\n                            rs.AddAlias(ENVIRONMENT.PLUGIN_ABBR + \"_\" + alias, script_content)\r\n\r\n\r\ndef register_shortcut(key, command):\r\n    \"\"\"for full list\r\n    https://developer.rhino3d.com/api/rhinocommon/rhino.applicationsettings.shortcutkey\r\n    \"\"\"\r\n    keyboard_setting = Rhino.ApplicationSettings.ShortcutKeySettings\r\n    keyboard_setting.SetMacro(Rhino.ApplicationSettings.ShortcutKey[key], \r\n                              command)\r\n\r\n    \r\n",
  "language": "python",
  "imports": [
    "Rhino",
    "rhinoscriptsyntax"
  ],
  "has_docstring": false
}