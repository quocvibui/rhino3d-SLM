{
  "source_url": "https://github.com/fstwn/pyembroideryGH/blob/ee7fd47316b364962a69976b4168ce9fef2702cf/usrobj_src/pyembroideryGH_PatternWrite.py",
  "repo": "fstwn/pyembroideryGH",
  "repo_stars": 11,
  "repo_description": "Set of UserObjects enabling Grasshopper to directly read, write and manipulate various kinds of embroidery formats. It is based on an IronPython-compatible fork of the original pyembroidery library.",
  "license": "MIT",
  "filepath": "usrobj_src/pyembroideryGH_PatternWrite.py",
  "instruction": "Writes one or many embroidery patterns to one or many files. If multiple\npatterns are supplied but only one filepath, additional filepaths in the\nsame folder with the indices of the pattern as suffix...",
  "code": "\"\"\"\nWrites one or many embroidery patterns to one or many files. If multiple\npatterns are supplied but only one filepath, additional filepaths in the\nsame folder with the indices of the pattern as suffix will be created!\n---\nSupported file formats are:\n*.pec, *.pes, *.exp, *.dst, *.jef, *.vp3, *.csv, *.xxx, *.sew, *.u01, *.shv,\n*.10o, *.100, *.bro, *.dat, *.dsb, *.dsz, *.emd, *.exy, *.fxy, *.gt, *.inb,\n*.tbf, *.ksm, *.tap, *.stx, *.phb, *.phc, *.new, *.max, *.mit, *.pcd, *.pcq,\n*.pcm, *.pcs, *.jpx, *.stc, *.zxy, *.pmv, *.png, *.txt, *.gcode, *.hus, *.edr,\n*.col, *.inf, *.json\n    Inputs:\n        Pattern: One or several embroidery patterns as pyembroidery.EmbPattern \n                 instances.\n                 {item, EmbPattern}\n        FilePath: The Filepath(s) of the file(s) to be written\n        Execute: Connect a Boolean Button here, press that button to\n        write the files.\n    Remarks:\n        Author: Max Eschenbach\n        License: MIT License\n        Version: 201030\n\"\"\"\n\n# PYTHON STANDARD LIBRARY IMPORTS\nfrom __future__ import division\nfrom os import path\n\n# GHPYTHON SDK IMPORTS\nfrom ghpythonlib.componentbase import executingcomponent as component\nimport Grasshopper, GhPython\nimport System\nimport Rhino\nimport rhinoscriptsyntax as rs\n\n# ADDITIONAL RHINO IMPORTS\nfrom scriptcontext import sticky as st\n\n# GHENV COMPONENT SETTINGS\nghenv.Component.Name = \"PatternWrite\"\nghenv.Component.NickName = \"PW\"\nghenv.Component.Category = \"pyembroideryGH\"\nghenv.Component.SubCategory = \"1 Input/Output\"\n\n# LOCAL MODULE IMPORTS\ntry:\n    import pyembroidery\nexcept ImportError:\n    errMsg = (\"The pyembroidery python module seems to be not correctly \" +\n              \"installed! Please make sure the module is in you search \" +\n              \"path, see README for instructions!.\")\n    raise ImportError(errMsg)\n\nclass PatternWrite(component):\n    \n    def RunScript(self, Pattern, FilePath, Execute):\n        # check supported formats\n        supported = [d[\"extension\"] for d in pyembroidery.supported_formats()]\n        supported = [\".\" + ext for ext in supported]\n        supported = {ext : True for ext in supported}\n        \n        # verify pattern and filepaths\n        if Pattern and FilePath:\n            # make info message\n            if len(Pattern) > len(FilePath):\n                rml = self.RuntimeMessageLevel.Remark\n                imsg = (\"List of supplied filepaths does not suffice. \" +\n                        \"Additional filepaths will be constructed based on \" +\n                        \"the last one to write all patterns!\")\n                self.AddRuntimeMessage(rml, imsg)\n            \n            # loop over patterns and verify/construct filepaths\n            for i, pat in enumerate(Pattern):\n                # if there is a valid supplied filepath\n                if i <= len(FilePath) -1:\n                    # normalize path and get extension\n                    fp = path.normpath(FilePath[i].strip(\"\\n\\r\"))\n                    ext = path.splitext(fp)[1]\n                    # if format in not supported, add warning\n                    if ext not in supported:\n                        rml = self.RuntimeMessageLevel.Warning\n                        errMsg = (\"Format with extension '{}' is not a \" + \n                                  \"supported file format! Please check the \" + \n                                  \"description for a list of supported \" +\n                                  \"formats. This pattern will not be written!\")\n                        errMsg = errMsg.format(ext)\n                        self.AddRuntimeMessage(rml, errMsg)\n                        continue\n                else:\n                    fp = path.normpath(FilePath[-1].strip(\"\\n\\r\"))\n                    fp, ext = path.splitext(fp)\n                    # if format in not supported, add warning\n                    if ext not in supported:\n                        rml = self.RuntimeMessageLevel.Warning\n                        errMsg = (\"Format with extension '{}' is not a \" + \n                                  \"supported file format! Please check the \" + \n                                  \"description for a list of supported \" +\n                                  \"formats. This pattern will not be written!\")\n                        errMsg = errMsg.format(ext)\n                        self.AddRuntimeMessage(rml, errMsg)\n                        continue\n                    # alter filepath to avoid overwriting original files\n                    fp = fp + \" ({})\"\n                    fp = fp.format(i - len(FilePath) + 1) + ext\n                \n                # write on execute\n                if Execute:\n                    pyembroidery.write(pat, fp)\n        else:\n            rml = self.RuntimeMessageLevel.Warning\n            if not Pattern: \n                errMsg = \"Input Pattern failed to collect data!\"\n                self.AddRuntimeMessage(rml, errMsg)\n            if not FilePath:\n                errMsg = \"Input FilePath failed to collect data!\"\n                self.AddRuntimeMessage(rml, errMsg)\n",
  "language": "python",
  "imports": [
    "Rhino",
    "ghpythonlib",
    "rhinoscriptsyntax",
    "scriptcontext"
  ],
  "has_docstring": true
}