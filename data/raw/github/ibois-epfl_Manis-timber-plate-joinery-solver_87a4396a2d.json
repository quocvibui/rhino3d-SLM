{
  "source_url": "https://github.com/ibois-epfl/Manis-timber-plate-joinery-solver/blob/9b0d22db181d4f55f01816440a5c0a31cda502bc/Gh%20compilation%20files/text.py",
  "repo": "ibois-epfl/Manis-timber-plate-joinery-solver",
  "repo_stars": 12,
  "repo_description": "A grasshopper plugin to create joints between timber panels and export CNC toolpath and robot trajectories for fully automated workflow from design to fabrication to assembly.",
  "license": "MIT",
  "filepath": "Gh compilation files/text.py",
  "instruction": "Export a text file.",
  "code": "\"\"\"Export a text file.\"\"\"\r\n\r\nfrom ghpythonlib.componentbase import dotnetcompiledcomponent as component\r\nimport Grasshopper, GhPython\r\nimport System\r\nimport os\r\nimport datetime\r\n\r\n__author__ = \"Nicolas Rogeau\"\r\n__laboratory__ = \"IBOIS, Laboratory for Timber Construction\" \r\n__university__ = \"EPFL, Ecole Polytechnique Federale de Lausanne\"\r\n__funding__ = \"NCCR Digital Fabrication, ETH Zurich\"\r\n__version__ = \"2021.09\"\r\n\r\nclass MyComponent(component):\r\n    def __new__(cls):\r\n        instance = Grasshopper.Kernel.GH_Component.__new__(cls,\r\n            \"Export Text File\", \"TextOut\", \"\"\"Export a text file.\"\"\", \"Manis\", \"Utility\")\r\n        return instance\r\n    \r\n    def get_ComponentGuid(self):\r\n        return System.Guid(\"02ba4a11-7b1c-48b3-8376-55637e7a1ed2\")\r\n    \r\n    def SetUpParam(self, p, name, nickname, description):\r\n        p.Name = name\r\n        p.NickName = nickname\r\n        p.Description = description\r\n        p.Optional = True\r\n    \r\n    def RegisterInputParams(self, pManager):\r\n        p = Grasshopper.Kernel.Parameters.Param_Boolean()\r\n        self.SetUpParam(p, \"run\", \"run\", \"Export file if True.\")\r\n        p.Access = Grasshopper.Kernel.GH_ParamAccess.item\r\n        self.Params.Input.Add(p)\r\n        \r\n        p = Grasshopper.Kernel.Parameters.Param_String()\r\n        self.SetUpParam(p, \"text\", \"text\", \"Text to export.\")\r\n        p.Access = Grasshopper.Kernel.GH_ParamAccess.list\r\n        self.Params.Input.Add(p)\r\n        \r\n        p = Grasshopper.Kernel.Parameters.Param_String()\r\n        self.SetUpParam(p, \"folder\", \"folder\", \"Folder path.\")\r\n        p.Access = Grasshopper.Kernel.GH_ParamAccess.item\r\n        self.Params.Input.Add(p)\r\n        \r\n        p = Grasshopper.Kernel.Parameters.Param_String()\r\n        self.SetUpParam(p, \"name\", \"name\", \"File name.\")\r\n        p.Access = Grasshopper.Kernel.GH_ParamAccess.item\r\n        self.Params.Input.Add(p)\r\n        \r\n        p = Grasshopper.Kernel.Parameters.Param_String()\r\n        self.SetUpParam(p, \"extension\", \"extension\", \"(Optional) Custom file extension.\")\r\n        p.Access = Grasshopper.Kernel.GH_ParamAccess.item\r\n        self.Params.Input.Add(p)\r\n        \r\n        p = Grasshopper.Kernel.Parameters.Param_Boolean()\r\n        self.SetUpParam(p, \"date\", \"date\", \"(Optional) Add the date of today to the file name.\")\r\n        p.Access = Grasshopper.Kernel.GH_ParamAccess.item\r\n        self.Params.Input.Add(p)\r\n        \r\n        p = Grasshopper.Kernel.Parameters.Param_Boolean()\r\n        self.SetUpParam(p, \"x\", \"incremental\", \"(Optional) Check for existing file with the same name and increment if necessary.\")\r\n        p.Access = Grasshopper.Kernel.GH_ParamAccess.item\r\n        self.Params.Input.Add(p)\r\n        \r\n    \r\n    def RegisterOutputParams(self, pManager):\r\n        pass    \r\n    def SolveInstance(self, DA):\r\n        p0 = self.marshal.GetInput(DA, 0)\r\n        p1 = self.marshal.GetInput(DA, 1)\r\n        p2 = self.marshal.GetInput(DA, 2)\r\n        p3 = self.marshal.GetInput(DA, 3)\r\n        p4 = self.marshal.GetInput(DA, 4)\r\n        p5 = self.marshal.GetInput(DA, 5)\r\n        p6 = self.marshal.GetInput(DA, 6)\r\n        result = self.RunScript(p0, p1, p2, p3, p4, p5, p6)\r\n\r\n        \r\n    def get_Internal_Icon_24x24(self):\r\n        o = \"iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAJOgAACToAYJjBRwAAACKSURBVEhL7c3RCoQwDETR/v9Pq7dOSoygFDrggweGrhM2aT+3Ta8NB6xH4oDtyAZeZbl+APxWbvJwOlnqLzReg33KUAcj0We5rwmp61Sf6jeie5pV9Mr7Acz2YHbk/UB0T7OKXrn+Od4w+w06pVO9BvuUIZfTyVK/jFZ7lsO6HNblsC6HdfkXtLYDh4phuyx2L58AAAAASUVORK5CYII=\"\r\n        return System.Drawing.Bitmap(System.IO.MemoryStream(System.Convert.FromBase64String(o)))\r\n\r\n\r\n    def RunScript(self, run, text, folder, name, extension, date, incremental):\r\n\r\n        inc = incremental\r\n        ext = extension\r\n\r\n        if run is True:\r\n\r\n            # gh doc path\r\n            ghP = self.LocalScope.ghdoc.Path\r\n\r\n            # folder and file name\r\n            if name == None: name = 'this_script_has_no_name'\r\n            if folder == None: folder = os.path.dirname(os.path.realpath(ghP))\r\n            outputName = folder + '\\\\' + str(name) \r\n\r\n            # date\r\n            if date is True:\r\n                date = datetime.datetime.today()\r\n                outputName += '_' + str(date.year) + '_' + str(date.month) + '_' + str(date.day)\r\n\r\n            # extension\r\n            if ext == None: ext = '.txt'\r\n\r\n            # avoid overwrite\r\n            if inc is True:\r\n                i = 0\r\n                iter = outputName + '_' + str(i) \r\n                while  os.path.exists(iter + str(ext)) and i<100: #safety\r\n                        i += 1\r\n                        iter = outputName + '_' + str(i)\r\n                outputName = iter\r\n            outputName += str(ext)\r\n\r\n            # create file\r\n            myFile = open(outputName,'w')\r\n\r\n            # pass values to file\r\n            if text != None: \r\n                for i in range(len(text)):\r\n                    myFile.write(str(text[i]))\r\n                    if i != len(text)-1:\r\n                        myFile.write('\\n')\r\n\r\n            # close file\r\n            myFile.close()\r\n\r\n            # confirm file write\r\n            if os.stat(outputName).st_size > 0:\r\n                print('File successfully written as ' + outputName)\r\n            else:\r\n                print('output file is empty - check your values')\r\n\r\n        return \r\n\r\nclass AssemblyInfo(GhPython.Assemblies.PythonAssemblyInfo):\r\n    def get_AssemblyName(self):\r\n        return \"Text File Output\"\r\n    \r\n    def get_AssemblyDescription(self):\r\n        return \"\"\"\"\"\"\r\n\r\n    def get_AssemblyVersion(self):\r\n        return \"0.1\"\r\n\r\n    def get_AuthorName(self):\r\n        return \"Nicolas Rogeau\"\r\n    \r\n    def get_Id(self):\r\n        return System.Guid(\"bc9186be-9321-4eb3-ba5e-58a615f66a50\")",
  "language": "python",
  "imports": [
    "ghpythonlib"
  ],
  "has_docstring": true
}