{
  "source_url": "https://github.com/fstwn/pyembroideryGH/blob/ee7fd47316b364962a69976b4168ce9fef2702cf/usrobj_src/pyembroideryGH_DeconstructThread.py",
  "repo": "fstwn/pyembroideryGH",
  "repo_stars": 11,
  "repo_description": "Set of UserObjects enabling Grasshopper to directly read, write and manipulate various kinds of embroidery formats. It is based on an IronPython-compatible fork of the original pyembroidery library.",
  "license": "MIT",
  "filepath": "usrobj_src/pyembroideryGH_DeconstructThread.py",
  "instruction": "Deconstructs a thread by retrieving all of its relevant data.\nThe thread has to be supplied as an instance of pyembroidery.EmbThread.\n    Inputs:\n        Thread: The thread of a stitch/pattern as an...",
  "code": "\"\"\"\nDeconstructs a thread by retrieving all of its relevant data.\nThe thread has to be supplied as an instance of pyembroidery.EmbThread.\n    Inputs:\n        Thread: The thread of a stitch/pattern as an instance of\n                pyembroidery.EmbThread.\n                {tree, EmbThread}\n    Output:\n        ColorRGB: The color of the thread as a System.Drawing.Color RGB Color.\n                  {tree, System.Drawing.Color}\n        Description: The color of the thread as pyembroidery color string.\n                     {tree, str}\n        CatalogNr: The catalogue number of the thread.\n                   {tree, int}\n        Details: The details of the thread if present, otherwise Null.\n                 {tree, ?}\n        Brand: The brand of the thread if present, othwerise Null.\n               {tree, str}\n        Chart: The chart of the thread if present, otherwise Null.\n               {tree, string}\n        Weight: The weight of the thread if present, otherwise Null.\n                {tree, ?}\n    Remarks:\n        Author: Max Eschenbach\n        License: MIT License\n        Version: 201030\n\"\"\"\n\n# PYTHON STANDARD LIBRARY IMPORTS\nfrom __future__ import division\n\n# GHPYTHON SDK IMPORTS\nfrom ghpythonlib.componentbase import executingcomponent as component\nimport Grasshopper, GhPython\nimport System\nimport Rhino\nimport rhinoscriptsyntax as rs\n\n# THIRD PARTY MODULE IMPORTS\nimport System.Drawing.Color as SysColor\n\n# GHENV COMPONENT SETTINGS \nghenv.Component.Name = \"DeconstructThread\"\nghenv.Component.NickName = \"DT\"\nghenv.Component.Category = \"pyembroideryGH\"\nghenv.Component.SubCategory = \"2 Pattern Analysis\"\n\n# LOCAL MODULE IMPORTS\ntry:\n    import pyembroidery\nexcept ImportError:\n    errMsg = (\"The pyembroidery python module seems to be not correctly \" +\n              \"installed! Please make sure the module is in you search \" +\n              \"path, see README for instructions!.\")\n    raise ImportError(errMsg)\n\nclass DeconstructThread(component):\n    \n    def RunScript(self, ThreadTree):\n        # initialize ouputs as DataTrees\n        ColorRGB = Grasshopper.DataTree[object]()\n        Description = Grasshopper.DataTree[object]()\n        CatalogNr = Grasshopper.DataTree[object]()\n        Details = Grasshopper.DataTree[object]()\n        Brand = Grasshopper.DataTree[object]()\n        Chart = Grasshopper.DataTree[object]()\n        Weight = Grasshopper.DataTree[object]()\n        \n        # only execute if there is a thread supplied to begin with\n        if ThreadTree != None and ThreadTree.DataCount:\n           # loop over branches of the thread tree\n            for i, branch in enumerate(ThreadTree.Branches):\n                branch_path = ThreadTree.Path(i)\n                \n                # loop over all items in branch\n                for j, thread in enumerate(branch):\n                    if isinstance(thread, pyembroidery.EmbThread):\n                        ColorRGB.Add(SysColor.FromArgb(255,\n                                                      thread.get_red(),\n                                                      thread.get_green(),\n                                                      thread.get_blue()),\n                                                      branch_path)\n                        Description.Add(thread.description, branch_path)\n                        CatalogNr.Add(thread.catalog_number, branch_path)\n                        Details.Add(thread.details, branch_path)\n                        Brand.Add(thread.brand, branch_path)\n                        Chart.Add(thread.chart, branch_path)\n                        Weight.Add(thread.weight, branch_path)\n                    else:\n                        rml = self.RuntimeMessageLevel.Warning\n                        errMsg = (\"Thread '{}' at branch {}, index {} \" +\n                                  \"is not a valid instance of \" +\n                                  \"pyembroidery.EmbThread! A Null item will \" +\n                                  \"be inserted into the output tree!\")\n                        errMsg = errMsg.format(thread, i, j)\n                        self.AddRuntimeMessage(rml, errMsg)\n                        ColorRGB.Add(None, branch_path)\n                        Description.Add(None, branch_path)\n                        CatalogNr.Add(None, branch_path)\n                        Details.Add(None, branch_path)\n                        Brand.Add(None, branch_path)\n                        Chart.Add(None, branch_path)\n                        Weight.Add(None, branch_path)\n        else:\n            rml = self.RuntimeMessageLevel.Warning\n            errMsg = \"Input Thread failed to collect data!\"\n            self.AddRuntimeMessage(rml, errMsg)\n        \n        # return outputs if you have them; here I try it for you:\n        return ColorRGB, Description, CatalogNr, Details, Brand, Chart, Weight\n",
  "language": "python",
  "imports": [
    "Rhino",
    "ghpythonlib",
    "rhinoscriptsyntax"
  ],
  "has_docstring": true
}