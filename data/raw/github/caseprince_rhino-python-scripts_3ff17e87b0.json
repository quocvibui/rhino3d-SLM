{
  "source_url": "https://github.com/caseprince/rhino-python-scripts/blob/639ae6ea1dd6cc00408db4f7a97ae689e61fc589/spiral-lamp-shade.py",
  "repo": "caseprince/rhino-python-scripts",
  "repo_stars": 0,
  "repo_description": "Parametric lampshades for 3D Printing in RhinoScript",
  "license": "unknown",
  "filepath": "spiral-lamp-shade.py",
  "instruction": "Spiral lamp shade",
  "code": "import rhinoscriptsyntax as rs\nimport Rhino.Geometry as rg\n\ndef box2pt(p1, p2):\n    pt0 = p1\n    pt1 = rs.coerce3dpoint([p2[0], p1[1], p1[2]])\n    pt2 = rs.coerce3dpoint([p2[0], p2[1], p1[2]])\n    pt3 = rs.coerce3dpoint([p1[0], p2[1], p1[2]])\n    pt4 = rs.coerce3dpoint([p1[0], p1[1], p2[2]])\n    pt5 = rs.coerce3dpoint([p2[0], p1[1], p2[2]])\n    pt6 = p2\n    pt7 = rs.coerce3dpoint([p1[0], p2[1], p2[2]])\n\n    return rs.AddBox([pt0, pt1, pt2, pt3, pt4, pt5, pt6, pt7])\n\ndef reset():\n    arr1 = rs.AllObjects()\n    if arr1: rs.DeleteObjects(arr1)\n    # rs.Command(\"ClearAllMeshes\")\n    rs.Command(\"ClearUndo\")\n\n# reset()\n\nw = 140 # unit width\nh = 13  # unit height\nd = 7.857 # distance\nt = .508 * 2 # unit thickness\nct = .6 # cap thickness\nc = 43  # count\ntwist = 180\n\nc1 = w/2;\nc2 = c1 - t;\nc3 = (w/2) - h;\n\nbox_neg = box2pt([-c2, -c2, 0], [c2, c2, h])\nbox_bottom_neg = box2pt([-c2, -c2, 0 + ct], [c2, c2, h + (ct*2)])\nbox_bottom_neg2 = box2pt([-c3, -c3, 0], [c3, c3, h])\n\nbox_top_neg = box2pt([-c2, -c2, 0 - ct], [c2, c2, h - ct])\nbox_top_neg2 = box2pt([-c3, -c3, 0], [c3, c3, h])\n\nbox = box2pt([-c1, -c1, 0], [c1, c1, h])\nbox_bottom = rs.BooleanDifference([box], [box_bottom_neg, box_bottom_neg2])[0]\nbox = box2pt([-c1, -c1, 0], [c1, c1, h])\nbox_middle = rs.BooleanDifference([box], [box_neg])[0]\nbox = box2pt([-c1, -c1, 0], [c1, c1, h])\nbox_top = rs.BooleanDifference([box], [box_top_neg, box_top_neg2])[0]\n\nfor i in range(c):\n    vector = rs.VectorCreate([0,0,i*d], [0,0,0])\n    if i == 0:\n        b = rs.CopyObject(box_bottom, vector)\n    elif i == c - 1:\n        b = rs.CopyObject(box_top, vector)\n    else:\n        b = rs.CopyObject(box_middle, vector)\n\n    rs.RotateObject(b, [0,0,0], (i/(c-1))*twist, rg.Vector3d.ZAxis)\n\nrs.DeleteObjects([box_bottom, box_top, box_middle])\n\n\n# [inefficent] support\n\n# sup = box2pt([-1, -1, 0], [1, 1, 1])\n\n# for i in range(c - 1):\n#     if i == c - 2:\n#         box_neg = box2pt([-c2 + t, -c2 + t, 0], [c2-t, c2-t, h * (i + 1)])\n#     else:\n#         box_neg = box2pt([-c2, -c2, 0], [c2, c2, h * (i + 1)])\n#     box = box2pt([-c1, -c1, 0], [c1, c1, d * (i + 1)])\n#     box_sup = rs.BooleanDifference([box], [box_neg])[0]\n#     # rs.MoveObject(box_sup, [0, 0, (i+1)*d])\n#     rs.RotateObject(box_sup, [0,0,0], ((i+1)/(c-1))*twist, rg.Vector3d.ZAxis)\n#     sup = rs.BooleanUnion([box_sup, sup])[0]\n\n\n# plane = rs.WorldXYPlane()\n# w_top = w - (h*2)\n# rect_top = rs.AddRectangle( plane, w_top, w_top )\n# rs.MoveObject(rect_top, [w_top/-2, w_top/-2, h])\n# w_bottom = w - (t*4)\n# rect_bottom = rs.AddRectangle( plane, w_bottom, w_bottom )\n# rs.MoveObject(rect_bottom, [w_bottom/-2, w_bottom/-2, 0])\n# rail =  rs.AddLine([0, 0,0], [0,0,h])\n\n# top_sup_neg = rs.AddSweep1(rail, [rect_bottom, rect_top], True)\n# rs.CapPlanarHoles(top_sup_neg)\n\n# box = box2pt([-c1 + t, -c1 + t, 0], [c1 - t, c1 - t, h - ct])\n# support_top = rs.BooleanDifference([box], [top_sup_neg])[0]\n\n# rs.MoveObject(support_top, [0,0, ((c-1) * d)])\n",
  "language": "python",
  "imports": [
    "Rhino",
    "Rhino.Geometry",
    "rhinoscriptsyntax"
  ],
  "has_docstring": false
}