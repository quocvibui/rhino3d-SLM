{
  "source_url": "https://github.com/dtbinh/T1_python-exercises/blob/f4710c3dc2ba8ddb3e3e9069ab8d65df674463ab/07_ur_online/shifted_frames_setup/compas/packages/compas_fabrication/fabrication/grasshopper/utilities/drawing.py",
  "repo": "dtbinh/T1_python-exercises",
  "repo_stars": 0,
  "repo_description": null,
  "license": "unknown",
  "filepath": "07_ur_online/shifted_frames_setup/compas/packages/compas_fabrication/fabrication/grasshopper/utilities/drawing.py",
  "instruction": "This file resembles the file in compas_rhino.utilities.drawing.py\nHowever all layer, name, color, attributes, etc. are removed.",
  "code": "\"\"\"\nThis file resembles the file in compas_rhino.utilities.drawing.py\nHowever all layer, name, color, attributes, etc. are removed.\n\"\"\"\nfrom __future__ import print_function\n\n\ntry:\n    import rhinoscriptsyntax as rs\n    import scriptcontext as sc\n\n    from System.Collections.Generic import List\n    from System.Enum import ToObject\n    from System.Array import CreateInstance\n    \n    from Rhino.Geometry import Point3d\n    from Rhino.Geometry import Vector3d\n    from Rhino.Geometry import Line\n    from Rhino.Geometry import Polyline\n    from Rhino.Geometry import PolylineCurve\n    from Rhino.Geometry import GeometryBase\n    from Rhino.Geometry import Brep\n    from Rhino.Geometry import Cylinder\n    from Rhino.Geometry import Circle\n    from Rhino.Geometry import Plane\n    from Rhino.Geometry import PipeCapMode\n    from Rhino.Geometry import Curve\n    from Rhino.Geometry import Sphere\n    from Rhino.Geometry import Mesh\n    from Rhino.Geometry import Vector3f, Point2f\n\n    TOL = sc.doc.ModelAbsoluteTolerance\n\nexcept ImportError:\n    import platform\n    if platform.python_implementation() == 'IronPython':\n        raise\n    \n__author__     = ['Romana Rust', ]\n__email__      = 'rust@arch.ethz.ch'\n\n\n\ndef xdraw_frame(frame):\n    \"\"\"Draw frame.\n    \"\"\"\n    pt  = Point3d(*frame.point)\n    xaxis = Vector3d(*frame.xaxis)\n    yaxis = Vector3d(*frame.yaxis)\n    return Plane(pt, xaxis, yaxis)\n\ndef xdraw_points(points):\n    \"\"\"Draw points.\n    \"\"\"\n    rg_points = []\n    for p in iter(points):\n        pos   = p['pos']\n        rg_points.append(Point3d(*pos))\n    return rg_points\n\n\ndef xdraw_lines(lines):\n    \"\"\"Draw lines.\n    \"\"\"\n    rg_lines = []\n    for l in iter(lines):\n        sp    = l['start']\n        ep    = l['end']\n        rg_lines.append(Line(Point3d(*sp), Point3d(*ep)))\n    return rg_lines\n\n\ndef xdraw_polylines(polylines):\n    \"\"\"Draw polylines.\n    \"\"\"\n    rg_polylines = []\n    for p in iter(polylines):\n        points = p['points']\n        poly = Polyline([Point3d(*xyz) for xyz in points])\n        poly.DeleteShortSegments(TOL)\n        rg_polylines.append(poly)\n    return rg_polylines\n\n\ndef xdraw_faces(faces, srf=None, u=10, v=10, trim=True, tangency=True, spacing=0.1, flex=1.0, pull=1.0):\n    \"\"\"Draw polygonal faces as Breps.\n    \"\"\"\n    rg_breps = []\n    for f in iter(faces):\n        points  = f['points']\n        corners = [Point3d(*point) for point in points]\n        pcurve  = PolylineCurve(corners)\n        geo     = List[GeometryBase](1)\n        geo.Add(pcurve)\n        p = len(points)\n        if p == 4:\n            brep = Brep.CreateFromCornerPoints(Point3d(*points[0]),\n                                               Point3d(*points[1]),\n                                               Point3d(*points[2]),\n                                               TOL)\n        elif p == 5:\n            brep = Brep.CreateFromCornerPoints(Point3d(*points[0]),\n                                               Point3d(*points[1]),\n                                               Point3d(*points[2]),\n                                               Point3d(*points[3]),\n                                               TOL)\n        else:\n            brep = Brep.CreatePatch(geo, u, v, TOL)\n        if not brep:\n            continue\n        rg_breps.append(brep)\n    return rg_breps\n        \ndef xdraw_cylinders(cylinders, cap=False):\n    rg_cylinders = []\n    for c in iter(cylinders):\n        start  = c['start']\n        end    = c['end']\n        radius = c['radius']\n        if radius < TOL:\n            continue\n        base     = Point3d(*start)\n        normal   = Point3d(*end) - base\n        height   = normal.Length\n        if height < TOL:\n            continue\n        plane    = Plane(base, normal)\n        circle   = Circle(plane, radius)\n        cylinder = Cylinder(circle, height)\n        brep     = cylinder.ToBrep(cap, cap)\n        if not brep:\n            continue\n        rg_cylinders.append(brep)\n    return rg_cylinders\n\ndef xdraw_pipes(pipes, cap=2, fit=1.0):\n    rg_pipes = []\n    abs_tol = TOL\n    ang_tol = sc.doc.ModelAngleToleranceRadians\n    for p in pipes:\n        points  = p['points']\n        radius  = p['radius']\n        params  = [0.0, 1.0]\n        cap     = ToObject(PipeCapMode, cap)\n        if type(radius) in (int, float):\n            radius = [radius] * 2\n        radius = [float(r) for r in radius]\n        rail   = Curve.CreateControlPointCurve([Point3d(*xyz) for xyz in points])\n        breps  = Brep.CreatePipe(rail, params, radius, 1, cap, fit, abs_tol, ang_tol)\n        rg_pipes += breps\n    return rg_pipes\n\n\ndef xdraw_spheres(spheres):\n    rg_sheres = []\n    for s in iter(spheres):\n        pos    = s['pos']\n        radius = s['radius'] \n        rg_sheres.append(Sphere(Point3d(*pos), radius))\n    return rg_sheres\n\n\ndef xdraw_mesh(vertices, faces, vertex_normals=None, texture_coordinates=None, vertex_colors=None):\n    \"\"\"Draw mesh.\n    \"\"\"\n    # TODO: This should move to compas/compas_grasshoper/utilities/drawing.py. \n    # TODO: This function is mainly a copy of rhinoscriptsyntax.AddMesh, just without scriptcontext adding.\n    \n    mesh = Mesh()\n    for a, b, c in vertices: \n        mesh.Vertices.Add(a, b, c)\n    for face in faces:\n        if len(face)<4:\n            mesh.Faces.AddFace(face[0], face[1], face[2])\n        else:\n            mesh.Faces.AddFace(face[0], face[1], face[2], face[3])\n    \n    if vertex_normals:\n        count = len(vertex_normals)\n        normals = CreateInstance(Vector3f, count)\n        for i, normal in enumerate(vertex_normals):\n            normals[i] = Vector3f(normal[0], normal[1], normal[2])\n        mesh.Normals.SetNormals(normals)\n        \n    if texture_coordinates:\n        count = len(texture_coordinates)\n        tcs = CreateInstance(Point2f, count)\n        for i, tc in enumerate(texture_coordinates):\n            tcs[i] = Point2f(tc[0], tc[1])\n        mesh.TextureCoordinates.SetTextureCoordinates(tcs)\n    \n    if vertex_colors:\n        for i, color in vertex_colors.iteritems():\n            color = rs.coercecolor(color)\n            mesh.VertexColors.SetColor(i, color)\n            \n    return mesh\n\ndef draw_network(network):\n    \"\"\"Draw a network data structure in Grasshopper.\n\n    \"\"\"\n    points = []\n    for key, attr in network.vertices_iter(True):\n        points.append({\n            'pos'  : network.vertex_coordinates(key),\n        })\n\n    lines = []\n    for u, v, attr in network.edges_iter(True):\n        lines.append({\n            'start': network.vertex_coordinates(u),\n            'end'  : network.vertex_coordinates(v),\n        })\n\n    points_rg   = xdraw_points(\n        points\n    )\n    lines_rg    = xdraw_lines(\n        lines\n    )\n    \n    return points_rg, lines_rg\n\n# ==============================================================================\n# Debugging\n# ==============================================================================\n\nif __name__ == '__main__':\n\n    pass\n",
  "language": "python",
  "imports": [
    "Rhino",
    "Rhino.Geometry",
    "rhinoscriptsyntax",
    "scriptcontext"
  ],
  "has_docstring": true
}