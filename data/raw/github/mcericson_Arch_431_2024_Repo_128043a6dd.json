{
  "source_url": "https://github.com/mcericson/Arch_431_2024_Repo/blob/1ef730ba3ba0d133c12706bc222a2bc84d19a5fe/03_04/project_folder/image_analysis_tutorial.py",
  "repo": "mcericson/Arch_431_2024_Repo",
  "repo_stars": 0,
  "repo_description": null,
  "license": "unknown",
  "filepath": "03_04/project_folder/image_analysis_tutorial.py",
  "instruction": "mark ericson 10/17/2023 This program translates images into geometry.",
  "code": "#mark ericson\n#10/17/2023\n#This program translates images into geometry.\n\n\n#imports------------------------------------\n\nimport rhinoscriptsyntax as rs\nimport System.Drawing.Bitmap as Bitmap\nimport box_tools as bt\nimport color_tools as ct\nimport viewport_tools as vt\nfrom imp import reload\n\nreload(bt)\n\n\n#definitions---------------------------------\n\ndef point_attractor(original_point, attractor_point, magnitude):\n    new_point = rs.AddPoint(attractor_point)\n    vector_1 = rs.VectorCreate(new_point, original_point)\n    vector_2 = rs.VectorUnitize(vector_1)\n    vector_3 = rs.VectorScale(vector_2, magnitude)\n    moved_point = rs.MoveObject(original_point, vector_3)\n    return moved_point\n\n\ndef assign_material_color(object, color):\n    rh_color = rs.CreateColor(color)\n    rs.AddMaterialToObject(object)\n    index = rs.ObjectMaterialIndex(object)\n    rs.MaterialColor(index, rh_color)\n    rs.ObjectColor(object, rh_color)\n\ndef image_to_coordinates(file_path, resolution):\n    img = Bitmap.FromFile(file_path)\n    \n    width  = img.Width\n    height = img.Height\n    \n    w_step = int(width/resolution)\n    h_step = int(height/resolution)\n    \n    pixel_dim = w_step, h_step\n    \n    colors = []\n    locations = []\n    for i in range(0, width, w_step):\n        for j in range(0, height, h_step):\n            x = i\n            y = j\n            location = (x, y, 0)\n            r, g, b, a = img.GetPixel(x, y)\n            locations.append(location)\n            colors.append((r, g, b, a))\n    locations.reverse()\n\n    return locations, colors, pixel_dim\n\ndef image_to_geometry(image_path, resolution, geometry = 'point'):\n    rs.EnableRedraw(False)\n    image_data = image_to_coordinates(image_path, resolution)\n    \n    points = image_data[0]\n    colors = image_data[1]\n    w, l = image_data[2]\n    attractor_point = rs.GetPoint()\n    for i in range(len(points)):\n        if geometry == 'point':\n            point = rs.AddPoint(points[i])\n            assign_material_color(point, colors[i])\n        if geometry == 'box':\n            r, g, b, a  = colors[i]\n            point_a = rs.AddPoint(points[i])\n            point_b = point_attractor(point_a, attractor_point, 1000)\n            point_c = rs.PointCoordinates(point_b)\n            box = bt.base_box(point_c, b+ 10 , w, l)\n            assign_material_color(box, colors[i])\n        if geometry == 'line':\n            r, g, b, a = colors[i]\n            x, y, z = points[i]\n            point_a = (x, y, z)\n            point_b = (x + r, y + g, z + b)\n            line = rs.AddLine(point_a, point_b)\n            assign_material_color(line, colors[i])\n        if geometry == 'point_attractor':\n            point_a = rs.AddPoint(points[i])\n            point_b = point_attractor(point_a, attractor_point, 1000)\n            np = rs.AddPoint(point_b)\n            assign_material_color(point_b, colors[i])\n\n#main---------------------------------------------------\n\ndef main():\n    view_name = 'new_top'\n\n    file_path = 'web_mountains_small.jpg'\n    image_to_geometry(file_path, 50, 'box')\n#    vt.create_parallel_view(view_name,(1000,1000))\n#    vt.set_axon_view(45, 120, view_name)\n#    rs.ZoomExtents()\n#    vt.capture_view(2.0, 'line_test', 'line_tests')\n\n\nmain()",
  "language": "python",
  "imports": [
    "rhinoscriptsyntax"
  ],
  "has_docstring": true
}