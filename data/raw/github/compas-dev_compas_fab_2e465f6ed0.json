{
  "source_url": "https://github.com/compas-dev/compas_fab/blob/431e82c810ea299b9727b010b73a39abc73c5d62/src/compas_fab/ghpython/reachabilitymapobject.py",
  "repo": "compas-dev/compas_fab",
  "repo_stars": 124,
  "repo_description": "Robotic fabrication package for the COMPAS Framework.",
  "license": "MIT",
  "filepath": "src/compas_fab/ghpython/reachabilitymapobject.py",
  "instruction": "Reachabilitymapobject",
  "code": "from compas.colors import ColorMap\nfrom compas.scene import SceneObject\nfrom compas_ghpython.scene import GHSceneObject\n\n\nclass ReachabilityMapObject(GHSceneObject):\n    \"\"\"Scene object for drawing a reachability map.\n\n    Parameters\n    ----------\n    reachability_map : :class:`compas_robots.ReachabilityMap`\n        Robot model.\n    **kwargs : dict, optional\n        Additional keyword arguments.\n    \"\"\"\n\n    def __init__(self, reachability_map, **kwargs):\n        super(ReachabilityMapObject, self).__init__(**kwargs)\n        self.reachability_map = reachability_map\n\n    def draw_frames(self, ik_index=None):\n        \"\"\"Returns the frames of the reachability map.\n\n        Parameters\n        ----------\n        ik_index : int, optional\n            If passed, returns only the reachable frames at a given IK index. For a 6-axis industrial robot this\n            index reaches from 0 to 7 (8 solutions).\n        \"\"\"\n        from ghpythonlib.treehelpers import list_to_tree\n\n        if ik_index is None:\n            xframes = []\n            for frames in self.reachability_map.frames:\n                xframes.append([])\n                for frame in frames:\n                    xframes[-1].append(SceneObject(frame).draw())\n            xframes = list_to_tree(xframes)\n            return xframes\n        else:\n            frames, _ = self.reachability_map.reachable_frames_and_configurations_at_ik_index(ik_index)\n            return [SceneObject(f).draw() for f in frames]\n\n    def draw(self, colormap=\"viridis\"):\n        return self.draw_cloud(colormap)\n\n    def draw_cloud(self, colormap=\"viridis\", points=None):\n        \"\"\"Returns the points and colors to create a point cloud.\n\n        The colors are calculated on the score at the respective frame. If the\n        frames are a 2D list, the point of the first frame of the list is used.\n\n        Parameters\n        ----------\n        colormap : str, optional\n            The colormap for the point cloud.\n        points : list of :class:`compas.geometry.Points`, optional\n            Points to override the points from the reachability map.\n        \"\"\"\n\n        from System.Drawing import Color\n\n        points = points or self.reachability_map.points\n\n        xpoints = []\n        for pt in points:\n            xpoints.extend(SceneObject(pt).draw())\n\n        colors = []\n        cmap = ColorMap.from_mpl(colormap)\n        score = self.reachability_map.score\n        minv, maxv = min(score), max(score)\n\n        for num in score:\n            color = cmap(num, minv, maxv)\n            r, g, b, a = color.rgba255\n            rcolor = Color.FromArgb(a, r, g, b)\n            colors.append(rcolor)\n\n        return xpoints, colors\n",
  "language": "python",
  "imports": [
    "ghpythonlib"
  ],
  "has_docstring": false
}