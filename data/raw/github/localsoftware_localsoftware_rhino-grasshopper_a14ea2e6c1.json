{
  "source_url": "https://github.com/localsoftware/localsoftware_rhino-grasshopper/blob/4aafec57e33b9f09cce6fd73dcda12b17cf794a5/python/MakeMaterial.py",
  "repo": "localsoftware/localsoftware_rhino-grasshopper",
  "repo_stars": 0,
  "repo_description": null,
  "license": "BSD-2-Clause",
  "filepath": "python/MakeMaterial.py",
  "instruction": "Creates a new Material.",
  "code": "\"\"\"Creates a new Material.\n\nReturns a new Material, a Render Material and a GH Preview Material using the parameters set as inputs.\nTo bake into Rhino you need to use the 'Bake with Attributes' LocalCode component. The material will be baked into a layer.\nBased on the work of Chris Hanley.\n\n    Typical usage:\n        Input a name and a diffuse color and create a material.\n        The rest of the inputs are optional.\n        Use the 'Material' output to assign the material to a geometry.\n        Plug the 'GHMaterial' output to a 'Preview' component to visualize your material on GH objects.\n\n    Inputs:\n        Name: name string\n        diffuseColor: diffuse color\n        specularColor: specular color\n        emissioColor: emission color\n        transparency: transparency from 0 to 1\n        reflectionRange: reflection range from 0 to 1\n        glossiness: glossiness from 0 to 1\n\n    Outputs:\n        Material: Render material for Rhino geometry\n        GHMaterial: Material for GH preview \"\"\"\n\n__author__ = \"palomagr\"\n__version__ = \"2020.07.09\"\n\n# ghenv.Component.Name = \"Make Material\"\n# ghenv.Component.NickName = \"Make Material\"\n\nfrom ghpythonlib.componentbase import executingcomponent as component\nimport Grasshopper, GhPython\nimport System\nimport Rhino\nimport rhinoscriptsyntax as rs\nimport Grasshopper as gh\nimport scriptcontext as sc\n\n\nclass MyComponent(component):\n\n    def RunScript(self, Name, diffuseColor, specularColor, emissionColor, transparency,\n                  reflectionRange, glossiness, create):\n        GHMaterial = None\n        Material = None\n        newMat = ''\n\n        if create:\n            sc.doc = Rhino.RhinoDoc.ActiveDoc\n            num = sc.doc.RenderMaterials.Count\n\n            for i in range(num):\n                mat_from_table = rs.MaterialName(i)\n                if Name == mat_from_table:\n                    rs.ResetMaterial(i)\n                    newMat = sc.doc.Materials[i]\n                else:\n                    newMat = Rhino.DocObjects.Material()\n\n            Reflection = min(max(reflectionRange, 0), 1);\n            Smoothness = min(max(glossiness, 0), 1);\n\n            if Name != '':\n                newMat.Name = Name\n            else:\n                newMat.Name = 'custom'\n\n            if diffuseColor != None:\n                newMat.DiffuseColor = diffuseColor\n            else:\n                newMat.DiffuseColor = [255, 255, 255]\n\n            if specularColor != None:\n                newMat.SpecularColor = specularColor\n                newMat.ReflectionColor = specularColor\n\n            if emissionColor != None:\n                newMat.EmissionColor = emissionColor\n\n            if transparency != None:\n                newMat.Transparency = transparency\n\n            if glossiness != None:\n                newMat.ReflectionGlossiness = Smoothness\n\n            newMat.Reflectivity = Reflection\n            newMat.AmbientColor = diffuseColor\n            material_gh = Rhino.Render.RenderMaterial.CreateBasicMaterial(newMat)\n            GHMaterial = gh.Kernel.Types.GH_Material(material_gh)  # GH preview material\n            Material = material_gh  # Rhino Material\n\n        # return outputs if you have them; here I try it for you:\n        return (Material, GHMaterial)\n",
  "language": "python",
  "imports": [
    "Rhino",
    "ghpythonlib",
    "rhinoscriptsyntax",
    "scriptcontext"
  ],
  "has_docstring": true
}