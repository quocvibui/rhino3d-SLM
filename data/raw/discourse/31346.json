{
  "source_url": "https://discourse.mcneel.com/t/script-wont-run-in-a-button-but-works-fine-in-editor/31346",
  "topic_id": 31346,
  "title": "Script won't run in a button, but works fine in editor",
  "question": "Hi \n@stevebaer\n\n\nDo you have any idea why this works fine in the editor, but won’t work in a button with -_RunPythonScript () ?\n\nIs\n\n\n\n\nimport rhinoscriptsyntax as rs\nimport scriptcontext\n\n\ndef Draw_Hatch(pts):\n\n    while True:\n        rs.Sleep(10)\n        newPt=rs.GetPoint()\n        if newPt:\n            try:\n                rs.DeleteObject(tmpCrv)\n            except:\n                rs.Sleep(10)\n            pts.append(newPt)\n            if len(pts)>1:\n                tmpPts=list(pts)\n                if len(pts)>2:\n                    tmpPts.append(tmpPts[0])\n                tmpCrv=rs.AddPolyline(tmpPts)\n\n        else:\n            return tmpCrv\n            break      #get out of the loop\n\nif __name__ == \"__main__\":\n\n    pts=[]\n    crv=Draw_Hatch(pts)\n    if rs.IsCurve(crv):\n        if rs.IsCurveClosed(crv):\n            newHatch=rs.AddHatch(crv)\n            rs.DeleteObject(crv)\n            rs.SelectObject(newHatch)\n\n\n\nIt seems like it doesn’t support “definitions” because this works just fine in a button:\n\n\n-_RunPythonScript (\n\nimport rhinoscriptsyntax as rs\nimport scriptcontext\n\n\npts=[]\n\n\n\nwhile True:\n    rs.Sleep(10)\n    newPt=rs.GetPoint()\n    if newPt:\n        try:\n            rs.DeleteObject(tmpCrv)\n        except:\n            rs.Sleep(10)\n        pts.append(newPt)\n        if len(pts)>1:\n            tmpPts=list(pts)\n            if len(pts)>2:\n                tmpPts.append(tmpPts[0])\n            tmpCrv=rs.AddPolyline(tmpPts)\n\n    else:\n        break      #get out of the loop\n\n\n\n\nif rs.IsCurve(tmpCrv):\n    if rs.IsCurveClosed(tmpCrv):\n        newHatch=rs.AddHatch(tmpCrv)\n        rs.DeleteObject(tmpCrv)\n        rs.SelectObject(newHatch)\n\n)",
  "code_blocks": [
    {
      "code": "import rhinoscriptsyntax as rs\nimport scriptcontext\n\n\ndef Draw_Hatch(pts):\n\n    while True:\n        rs.Sleep(10)\n        newPt=rs.GetPoint()\n        if newPt:\n            try:\n                rs.DeleteObject(tmpCrv)\n            except:\n                rs.Sleep(10)\n            pts.append(newPt)\n            if len(pts)>1:\n                tmpPts=list(pts)\n                if len(pts)>2:\n                    tmpPts.append(tmpPts[0])\n                tmpCrv=rs.AddPolyline(tmpPts)\n\n        else:\n            return tmpCrv\n            break      #get out of the loop\n\nif __name__ == \"__main__\":\n\n    pts=[]\n    crv=Draw_Hatch(pts)\n    if rs.IsCurve(crv):\n        if rs.IsCurveClosed(crv):\n            newHatch=rs.AddHatch(crv)\n            rs.DeleteObject(crv)\n            rs.SelectObject(newHatch)",
      "language": "python",
      "author": "Holo",
      "post_number": 1,
      "is_solution": false
    },
    {
      "code": "-_RunPythonScript (\n\nimport rhinoscriptsyntax as rs\nimport scriptcontext\n\n\npts=[]\n\n\n\nwhile True:\n    rs.Sleep(10)\n    newPt=rs.GetPoint()\n    if newPt:\n        try:\n            rs.DeleteObject(tmpCrv)\n        except:\n            rs.Sleep(10)\n        pts.append(newPt)\n        if len(pts)>1:\n            tmpPts=list(pts)\n            if len(pts)>2:\n                tmpPts.append(tmpPts[0])\n            tmpCrv=rs.AddPolyline(tmpPts)\n\n    else:\n        break      #get out of the loop\n\n\n\n\nif rs.IsCurve(tmpCrv):\n    if rs.IsCurveClosed(tmpCrv):\n        newHatch=rs.AddHatch(tmpCrv)\n        rs.DeleteObject(tmpCrv)\n        rs.SelectObject(newHatch)\n\n)",
      "language": "python",
      "author": "Holo",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "file-io",
    "geometry",
    "python",
    "rhinoscriptsyntax"
  ],
  "has_accepted_answer": false,
  "category_id": 11,
  "posts_count": 5,
  "views": 1046
}