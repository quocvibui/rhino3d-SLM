{
  "source_url": "https://github.com/TTM-KK/TimberFormOptimization/blob/a728057ff3bfbfb7995b309e835a6278a6e86fcc/GA/temp/Evaluate_temp.py",
  "repo": "TTM-KK/TimberFormOptimization",
  "repo_stars": 0,
  "repo_description": "This is a Form Generate Project, using non preform timber.",
  "license": "unknown",
  "filepath": "GA/temp/Evaluate_temp.py",
  "instruction": "Evaluate temp",
  "code": "import Rhino\nimport scriptcontext\nimport rhinoscriptsyntax as rs\n\n\ndef overlap_num2_for_check(tim_number, instance_pop):\n    intersect_num = 0\n    for i in range(tim_number):\n        tim = instance_pop.timber_list[i].center_line\n        tim_end_1 = tim.PointAtEnd\n        tim_start_1 = tim.PointAtStart\n        tim_line = Rhino.Geometry.Line(tim_end_1, tim_start_1)\n        for j in range(tim_number):\n            if j == i:\n                continue\n            else:\n                tim_other = instance_pop.timber_list[j].center_line\n                tim_end = tim_other.PointAtEnd\n                tim_start = tim_other.PointAtStart\n                tim_other_line = Rhino.Geometry.Line(tim_end, tim_start)\n\n                distance = tim_line.MinimumDistanceTo(tim_other_line)\n\n                if distance < instance_pop.timber_list[i].section_length/2 + instance_pop.timber_list[j].\\\n                        section_length/2 + 50:\n                    intersect_num = intersect_num + 1\n                else:\n                    # intersect_num = intersect_num + 1\n                    continue\n    return intersect_num\n\n\ndef overlap_length(tim_number, instance_pop):\n    '''\n    :param tim_number: 1つの個体に使用する木材の本数\n    :param instance_pop: Generate クラスインスタンス\n    :return: surface同士のintersection部のcurveの長さの合計値。\n    '''\n    cur_length = 0\n    for i in range(tim_number):\n        tim1_srf = instance_pop.used_list[i].surface\n        for j in range(tim_number):\n            if i != j:\n                tim2_srf = instance_pop.used_list[j].surface\n                flag = rs.IntersectBreps(tim1_srf, tim2_srf)\n                if flag is None:\n                    continue\n                else:\n                    for k in range(len(flag)):\n                        cur_length = cur_length + rs.CurveLength(flag[k])\n\n    return cur_length\n\n\ndef overlap_num_rhinocommon(tim_number, instance_pop):  # Evaluate the Intersection number -----> type is int\n    '''\n    intersection を使用しているため非常に遅く使えない。\n    :param tim_number:\n    :param instance_pop:\n    :return:\n    '''\n    tolerance = scriptcontext.doc.ModelAbsoluteTolerance\n\n    intersect_num = 0\n    for i in range(tim_number):\n        # tim = rhutil.coercebrep(instance_pop.used_list[i].surface)\n        tim = instance_pop.used_list[i].surface\n\n        for j in range(tim_number):\n\n            if j == i:\n                continue\n            else:\n                # tim_other = rhutil.coercebrep(instance_pop.used_list[j].surface)\n                tim_other = instance_pop.used_list[j].surface\n\n                rc = Rhino.Geometry.Intersect.Intersection.BrepBrep(tim, tim_other, tolerance)\n\n                if rc is None:\n                    continue\n\n                else:\n\n                    out_curves = rc[1]\n                    merged_curves = Rhino.Geometry.Curve.JoinCurves(out_curves, 2.1 * tolerance)\n\n                    list_length = len(merged_curves)\n                    # print(\"list_length\", list_length)\n                    # print(merged_curves)\n                    # input(\"dd\")\n                    for k in range(list_length):\n                        intersect_num = intersect_num + 1\n\n    return intersect_num\n\n\ndef overlap_num(tim_number, instance_pop):  # Evaluate the Intersection number -----> type is int\n\n    intersect_num = 0\n    for i in range(tim_number):\n        tim = instance_pop.used_list[i].surface\n        for j in range(tim_number):\n\n            if j == i:\n                continue\n            else:\n                tim_other = instance_pop.used_list[j].surface\n                flag = rs.IntersectBreps(tim, tim_other)\n                if flag is None:\n                    continue\n\n                if rs.IsCurve(flag[0]):\n                    intersect_num = intersect_num + 1\n\n                    for k in range(len(flag)):\n                        rs.DeleteObject(flag[k])\n\n    return intersect_num\n",
  "language": "python",
  "imports": [
    "Rhino",
    "Rhino.Geometry",
    "rhinoscriptsyntax",
    "scriptcontext"
  ],
  "has_docstring": false
}