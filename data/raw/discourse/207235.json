{
  "source_url": "https://discourse.mcneel.com/t/compiling-gh-cpython-component/207235",
  "topic_id": 207235,
  "title": "Compiling GH cpython component?",
  "question": "Hello! I had some cool ironpython components in Rhino7 that, when compiled, had some neat UI features like buttons. Now with the cpython component, there is no option I can see to compile the component, and the CreateAttributes() override doesn’t seem to do anything. Is there any way to get this working?\n\n\nThanks in advance!\n\n\nhere’s some sample code:\n\n\nimport Grasshopper, GhPython\nimport Rhino\nimport System\n\n\nclass Button_UI(Grasshopper.Kernel.Attributes.GH_ComponentAttributes): # inherits all methods of GH_ComponentAttributes\n    def __init__(self, owner):\n        super(Button_UI, self).__init__(owner)\n        self.component = owner\n        self.button_down = False\n                \n    def Layout(self): # override inherited method Layout\n        Grasshopper.Kernel.Attributes.GH_ComponentAttributes.Layout(self) # run render before changing the definition\n        component_rect = Grasshopper.Kernel.GH_Convert.ToRectangle(self.Bounds) #System.Drawing.Rectangle \n        component_rect.Height += 22\n        self.button_rect = System.Drawing.Rectangle(component_rect.X, component_rect.Bottom-22, component_rect.Width, 22)\n        self.button_rect.Inflate(-2, -2)\n        Bounds = component_rect\n        self.Bounds=Bounds\n        ButtonBounds = self.button_rect\n        self.ButtonBounds=ButtonBounds\n            \n    def Render(self,canvas, graphics, channel): # Override Render method\n        Grasshopper.Kernel.Attributes.GH_ComponentAttributes.Render(self, canvas, graphics, channel) # run render before changing the definition\n        if channel == Grasshopper.GUI.Canvas.GH_CanvasChannel.Objects:\n            color = Grasshopper.GUI.Canvas.GH_Palette.Grey if self.button_down else Grasshopper.GUI.Canvas.GH_Palette.Black\n            button = Grasshopper.GUI.Canvas.GH_Capsule.CreateTextCapsule(self.ButtonBounds, self.ButtonBounds, color, \"Button\", 2, 0)\n            button.Render(graphics, self.Selected, self.Owner.Locked, False)\n            button.Dispose()\n            \n    def R...",
  "code_blocks": [
    {
      "code": "import Grasshopper, GhPython\nimport Rhino\nimport System\n\n\nclass Button_UI(Grasshopper.Kernel.Attributes.GH_ComponentAttributes): # inherits all methods of GH_ComponentAttributes\n    def __init__(self, owner):\n        super(Button_UI, self).__init__(owner)\n        self.component = owner\n        self.button_down = False\n                \n    def Layout(self): # override inherited method Layout\n        Grasshopper.Kernel.Attributes.GH_ComponentAttributes.Layout(self) # run render before changing the definition\n        component_rect = Grasshopper.Kernel.GH_Convert.ToRectangle(self.Bounds) #System.Drawing.Rectangle \n        component_rect.Height += 22\n        self.button_rect = System.Drawing.Rectangle(component_rect.X, component_rect.Bottom-22, component_rect.Width, 22)\n        self.button_rect.Inflate(-2, -2)\n        Bounds = component_rect\n        self.Bounds=Bounds\n        ButtonBounds = self.button_rect\n        self.ButtonBounds=ButtonBounds\n            \n    def Render(self,canvas, graphics, channel): # Override Render method\n        Grasshopper.Kernel.Attributes.GH_ComponentAttributes.Render(self, canvas, graphics, channel) # run render before changing the definition\n        if channel == Grasshopper.GUI.Canvas.GH_CanvasChannel.Objects:\n            color = Grasshopper.GUI.Canvas.GH_Palette.Grey if self.button_down else Grasshopper.GUI.Canvas.GH_Palette.Black\n            button = Grasshopper.GUI.Canvas.GH_Capsule.CreateTextCapsule(self.ButtonBounds, self.ButtonBounds, color, \"Button\", 2, 0)\n            button.Render(graphics, self.Selected, self.Owner.Locked, False)\n            button.Dispose()\n            \n    def RespondToMouseDown(self,sender,e):\n        if e.Button == System.Windows.Forms.MouseButtons.Left:\n            rec = self.button_rect\n            pt = System.Drawing.Point.Round(e.CanvasLocation)\n            if not self.button_down:\n                if pt.X > rec.X and pt.X < rec.X+rec.Width and pt.Y > rec.Y and pt.Y < rec.Y+rec.Height:\n                    self.button_down = True\n                    self.component.OnDisplayExpired(False)\n                    return  Grasshopper.GUI.Canvas.GH_ObjectResponse.Capture\n        return super(Button_UI, self).RespondToMouseDown(sender, e)\n        \n    def RespondToMouseUp(self,sender,e):\n        if e.Button == System.Windows.Forms.MouseButtons.Left:\n            if self.button_down:\n                self.button_down = False\n                self.component.OnDisplayExpired(False)\n                rec = self.button_rect\n                pt = System.Drawing.Point.Round(e.CanvasLocation)\n                if pt.X > rec.X and pt.X < rec.X+rec.Width and pt.Y > rec.Y and pt.Y < rec.Y+rec.Height:\n                    self.component.click_response()\n            \n            return  Grasshopper.GUI.Canvas.GH_ObjectResponse.Release\n        return super(Button_UI, self).RespondToMouseUp(sender, e)\n        \n\nclass MyComponent(Grasshopper.Kernel.GH_ScriptInstance):\n    def __init__(self):\n        super().__init__()\n        self.update = False\n        self.value = 0\n    \n    def CreateAttributes(self): # Override inherited method create attributes\n        self.m_attributes=Button_UI(self) \n            \n    def RunScript(self, x, y):\n        if self.update:\n            self.value += x\n            self.update = False\n        return self.value\n                \n    def click_response(self):\n        self.update = True\n        self.ExpireSolution(True)",
      "language": "python",
      "author": "OBucklin",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "file-io",
    "geometry",
    "grasshopper",
    "materials",
    "python"
  ],
  "has_accepted_answer": false,
  "category_id": 8,
  "posts_count": 2,
  "views": 70
}