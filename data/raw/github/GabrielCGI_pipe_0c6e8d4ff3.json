{
  "source_url": "https://github.com/GabrielCGI/pipe/blob/83403152db2222f3a02f99c2ed3155509b0453e9/rhino/export_layer.py",
  "repo": "GabrielCGI/pipe",
  "repo_stars": 0,
  "repo_description": "Bloom pipeline ",
  "license": "unknown",
  "filepath": "rhino/export_layer.py",
  "instruction": "Export layer",
  "code": "import os\nimport scriptcontext\nimport rhinoscriptsyntax as rs\n\n\n\n# this function via mcneel/rhinoscriptsyntax\n#https://github.com/mcneel/rhinoscriptsyntax/blob/master/Scripts/rhinoscript/layer.py\ndef layerNames(sort=False):\n    rc = []\n    for layer in scriptcontext.doc.Layers:\n        if not layer.IsDeleted: rc.append(layer.FullPath)\n    if sort: rc.sort()\n    return rc\n\n\n\ndef GetOBJSettings():\n    e_str = \"_Geometry=_Mesh \"\n    e_str+= \"_EndOfLine=CRLF \"\n    e_str+= \"_ExportRhinoObjectNames=2 \"\n    e_str+= \"_ExportGroupNameLayerNames=1\"\n    e_str+= \"_ExportMeshTextureCoordinates=_Yes \"\n    e_str+= \"_ExportMeshVertexNormals=_No \"\n    e_str+= \"_CreateNGons=_No \"\n    e_str+= \"_ExportMaterialDefinitions=_No \"\n    e_str+= \"_YUp=_Yes \"\n    e_str+= \"_WrapLongLines=Yes \"\n    e_str+= \"_VertexWelding=_Welded \"\n    e_str+= \"_WritePrecision=17 \"\n    e_str+= \"_Enter \"\n\n    e_str+= \"_DetailedOptions \"\n    e_str+= \"_JaggedSeams=_No \"\n    e_str+= \"_PackTextures=_No \"\n    e_str+= \"_Refine=_Yes \"\n    e_str+= \"_SimplePlane=_No \"\n\n    e_str+= \"_AdvancedOptions \"\n    e_str+= \"_Angle=50 \"\n    e_str+= \"_AspectRatio=0 \"\n    e_str+= \"_Distance=0.0\"\n    e_str+= \"_Density=0 \"\n    e_str+= \"_Density=0.45 \"\n    e_str+= \"_Grid=0 \"\n    e_str+= \"_MaxEdgeLength=0 \"\n    e_str+= \"_MinEdgeLength=0.0001 \"\n\n    e_str+= \"_Enter _Enter\"\n\n    return e_str\n\n\n\n\n\nfileName = rs.DocumentName()\nfilePath = r\"I:\\dubuis_2312\\assets\\ch_mtCalibre\\raw\\\\\"\n\narrLayers = layerNames(False)\n\nsettingsList = {\n    'GetOBJSettings': GetOBJSettings,\n}\n\n\ndef initExportByLayer(fileType=\"obj\", visibleonly=False, byObject=False):\n    for layerName in arrLayers:\n        layer = scriptcontext.doc.Layers.FindByFullPath(layerName, True)\n        if layer >= 0:\n            layer = scriptcontext.doc.Layers[layer]\n            save = True;\n            if visibleonly:\n                if not layer.IsVisible:\n                    save = False\n            if  rs.IsLayerEmpty(layerName):\n                save = False\n            if save:\n                cutName = layerName.split(\"::\")\n                cutName = cutName[len(cutName)-1]\n                objs = scriptcontext.doc.Objects.FindByLayer(cutName)\n                if len(objs) > 0:\n                    if byObject:\n                        i=0\n                        for obj in objs:\n                            i= i+1\n                            saveObjectsToFile(cutName+\"_\"+str(i), [obj], fileType)\n                    else:\n                        saveObjectsToFile(cutName, objs, fileType)\n\n\n\ndef saveObjectsToFile(name, objs, fileType):\n    rs.EnableRedraw(False)\n    if len(objs) > 0:\n        settings = settingsList[\"Get\"+fileType.upper()+\"Settings\"]()\n        rs.UnselectAllObjects()\n        for obj in objs:\n            obj.Select(True)\n        name = \"\".join(name.split(\" \"))\n        command = '-_Export \"{}{}{}\" {}'.format(filePath, name, \".\"+fileType.lower(), settings)\n        rs.Command(command, True)\n        rs.EnableRedraw(True)\n\n\ninitExportByLayer(\"obj\",True, False)\n",
  "language": "python",
  "imports": [
    "rhinoscriptsyntax",
    "scriptcontext"
  ],
  "has_docstring": false
}