{
  "source_url": "https://github.com/gudairen/INFO-ring/blob/a2765cccc09cb5c3e7053c22cffdee1e49fe8c30/src/grasshopperAuto.py",
  "repo": "gudairen/INFO-ring",
  "repo_stars": 5,
  "repo_description": null,
  "license": "MIT",
  "filepath": "src/grasshopperAuto.py",
  "instruction": "Grasshopper auto",
  "code": "import rhino3dm\r\nimport requests\r\nimport base64\r\nimport json\r\nimport compute_rhino3d.Util\r\n\r\n\r\ndef process_grasshopper(CorX, CorY, CorZ, output_file_path, Inner, Outer, Height, NodeSize, StrutSize, KinkAngle):\r\n    compute_rhino3d.Util.url = \"http://127.0.0.1:6500/\"\r\n    compute_rhino3d.Util.authToken = \"\"\r\n\r\n    post_url = compute_rhino3d.Util.url + \"grasshopper\"\r\n    gh_file = open(\"./ring.ghx\", mode=\"r\", encoding=\"utf-8-sig\").read()\r\n    data_bytes = gh_file.encode(\"utf-8\")\r\n    encoded = base64.b64encode(data_bytes)\r\n    decoded = encoded.decode(\"utf-8\")\r\n\r\n    payload = {\r\n        \"algo\": decoded,\r\n        \"pointer\": None,\r\n        \"values\": [\r\n            {\r\n                \"ParamName\": \"RH_IN:CorX\",\r\n                \"InnerTree\": {\r\n                    \"{ 0; }\": [\r\n                        {\r\n                            \"type\": \"System.Double\",  # Changed from System.String to System.Double\r\n                            \"data\": x  # Directly passing the numerical value\r\n                        } for x in CorX\r\n                    ]\r\n                }\r\n            },\r\n            {\r\n                \"ParamName\": \"RH_IN:CorY\",\r\n                \"InnerTree\": {\r\n                    \"{ 0; }\": [\r\n                        {\r\n                            \"type\": \"System.Double\",  # Changed from System.String to System.Double\r\n                            \"data\": y  # Directly passing the numerical value\r\n                        } for y in CorY\r\n                    ]\r\n                }\r\n            },\r\n            {\r\n                \"ParamName\": \"RH_IN:CorZ\",\r\n                \"InnerTree\": {\r\n                    \"{ 0; }\": [\r\n                        {\r\n                            \"type\": \"System.Double\",  # Changed from System.String to System.Double\r\n                            \"data\": z  # Directly passing the numerical value\r\n                        } for z in CorZ\r\n                    ]\r\n                }\r\n            },\r\n            {\r\n                \"ParamName\": \"RH_IN:Inner\",\r\n                \"InnerTree\": {\r\n                    \"{ 0; }\": [\r\n                        {\r\n                            \"type\": \"System.Double\",  # Changed from System.String to System.Double\r\n                            \"data\": Inner  # Directly passing the numerical value\r\n                        }\r\n                    ]\r\n                }\r\n            },\r\n            {\r\n                \"ParamName\": \"RH_IN:Outer\",\r\n                \"InnerTree\": {\r\n                    \"{ 0; }\": [\r\n                        {\r\n                            \"type\": \"System.Double\",  # Changed from System.String to System.Double\r\n                            \"data\": Outer  # Directly passing the numerical value\r\n                        }\r\n                    ]\r\n                }\r\n            },\r\n            {\r\n                \"ParamName\": \"RH_IN:Height\",\r\n                \"InnerTree\": {\r\n                    \"{ 0; }\": [\r\n                        {\r\n                            \"type\": \"System.Double\",  # Changed from System.String to System.Double\r\n                            \"data\": Height  # Directly passing the numerical value\r\n                        }\r\n                    ]\r\n                }\r\n            },\r\n            {\r\n                \"ParamName\": \"RH_IN:NodeSize\",\r\n                \"InnerTree\": {\r\n                    \"{ 0; }\": [\r\n                        {\r\n                            \"type\": \"System.Double\",  # Changed from System.String to System.Double\r\n                            \"data\": NodeSize  # Directly passing the numerical value\r\n                        }\r\n                    ]\r\n                }\r\n            },\r\n            {\r\n                \"ParamName\": \"RH_IN:StrutSize\",\r\n                \"InnerTree\": {\r\n                    \"{ 0; }\": [\r\n                        {\r\n                            \"type\": \"System.Double\",  # Changed from System.String to System.Double\r\n                            \"data\": StrutSize  # Directly passing the numerical value\r\n                        }\r\n                    ]\r\n                }\r\n            },\r\n            {\r\n                \"ParamName\": \"RH_IN:KinkAngle\",\r\n                \"InnerTree\": {\r\n                    \"{ 0; }\": [\r\n                        {\r\n                            \"type\": \"System.Double\",  # Changed from System.String to System.Double\r\n                            \"data\": KinkAngle  # Directly passing the numerical value\r\n                        }\r\n                    ]\r\n                }\r\n            }\r\n\r\n        ]\r\n    }\r\n\r\n    response = requests.post(post_url, json=payload)\r\n    res = response.content.decode(\"utf-8\")\r\n    res = json.loads(res)\r\n    values = res[\"values\"]\r\n    model = rhino3dm.File3dm()\r\n    for val in values:\r\n        paramName = val['ParamName']\r\n        print(paramName)\r\n        innerTree = val['InnerTree']\r\n        for key, innerVals in innerTree.items():\r\n            print(key)\r\n            for innerVal in innerVals:\r\n                data = json.loads(innerVal['data'])\r\n                geo = rhino3dm.CommonObject.Decode(data)\r\n                model.Objects.Add(geo)\r\n    model.Write(output_file_path)\r\n",
  "language": "python",
  "imports": [
    "rhino3dm"
  ],
  "has_docstring": false
}