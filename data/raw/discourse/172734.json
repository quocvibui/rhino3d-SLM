{
  "source_url": "https://discourse.mcneel.com/t/error-code-script-link-offset-curve/172734",
  "topic_id": 172734,
  "title": "Error code script link \"Offset-Curve\"",
  "question": "in Rh8 lasted update using new script editor, there are some problems with this code linked. . .\n\n\n\n\n\n\n\n\nwww.rhino3d.com\n\n\n\n\n\n\nOffset Curve\n\n\nDemonstrates how to offset curves to one side or another by a distance.\n\n\n\n\n\n\n\n\n\n\n\n\nfrom Rhino import *\nfrom Rhino.DocObjects import *\nfrom Rhino.Geometry import *\nfrom Rhino.Input import *\nfrom Rhino.Commands import *\nfrom scriptcontext import doc\nimport rhinoscriptsyntax as rs\n \ndef RunCommand():\n    rs, obj_ref = RhinoGet.GetOneObject(\"Select Curve\", False, ObjectType.Curve)\n    if rs != Result.Success:\n        return rs\n    curve = obj_ref.Curve()\n    if curve == None:\n        return Result.Nothing\n \n    rs, point = RhinoGet.GetPoint(\"Select Side\", False)\n    if rs != Result.Success:\n        return rs\n    if point == Point3d.Unset:\n        return Result.Nothing\n \n    curves = curve.Offset(point, Vector3d.ZAxis, 1.0, doc.ModelAbsoluteTolerance, CurveOffsetCornerStyle.None)\n \n    for offset-curve in curves:\n        doc.Objects.AddCurve(offset-curve)\n \n    doc.Views.Redraw()\n    return Result.Success\n \nif __name__ == \"__main__\":\n    RunCommand()\n\n\n\nin Py2\n\nthe first problem, the editor pointed out to me:\n\nthis \noffset-curve\n syntax is not accepted\n\n\noffset_curve\n or \noffsetcurve\n is accepted\n\nthe rest of the script then works\n\n\nin Py3\n\naside from the above,\n\n\nWhile adapting the code, it gave me a second error:\n\n\nimport rhinoscriptsyntax as rs\n \ndef RunCommand():\n    rs, obj_ref = RhinoGet.GetOneObject(\"Select Curve\", False, ObjectType.Curve)\n    if rs != Result.Success:\n        return rs\n\n\n\nrs of the curve object, have been exchanged with the alias import rs\n\n\nand correcting this is also simple\n\n\nbut still in Py3 I get this other error “I don’t understand why this happens”\n\n\nThis string doesn’t accept me:\n\n\ncurves = curve.Offset(point, Vector3d.ZAxis, 1.0, doc.ModelAbsoluteTolerance, CurveOffsetCornerStyle.None)\n\n\n\nin Py3 I get an error with \nCurveOffsetCornerStyle.None\n while in Py2 this doesn’t happen\n\n\nif I change the choi...",
  "code_blocks": [
    {
      "code": "from Rhino import *\nfrom Rhino.DocObjects import *\nfrom Rhino.Geometry import *\nfrom Rhino.Input import *\nfrom Rhino.Commands import *\nfrom scriptcontext import doc\nimport rhinoscriptsyntax as rs\n \ndef RunCommand():\n    rs, obj_ref = RhinoGet.GetOneObject(\"Select Curve\", False, ObjectType.Curve)\n    if rs != Result.Success:\n        return rs\n    curve = obj_ref.Curve()\n    if curve == None:\n        return Result.Nothing\n \n    rs, point = RhinoGet.GetPoint(\"Select Side\", False)\n    if rs != Result.Success:\n        return rs\n    if point == Point3d.Unset:\n        return Result.Nothing\n \n    curves = curve.Offset(point, Vector3d.ZAxis, 1.0, doc.ModelAbsoluteTolerance, CurveOffsetCornerStyle.None)\n \n    for offset-curve in curves:\n        doc.Objects.AddCurve(offset-curve)\n \n    doc.Views.Redraw()\n    return Result.Success\n \nif __name__ == \"__main__\":\n    RunCommand()",
      "language": "python",
      "author": "0904",
      "post_number": 1,
      "is_solution": false
    },
    {
      "code": "import rhinoscriptsyntax as rs\n \ndef RunCommand():\n    rs, obj_ref = RhinoGet.GetOneObject(\"Select Curve\", False, ObjectType.Curve)\n    if rs != Result.Success:\n        return rs",
      "language": "python",
      "author": "0904",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "file-io",
    "geometry",
    "python",
    "rhinocommon",
    "rhinoscriptsyntax"
  ],
  "has_accepted_answer": false,
  "category_id": 11,
  "posts_count": 3,
  "views": 200
}