{
  "source_url": "https://github.com/augmentedfabricationlab/workshop_aaec_revamp/blob/679d39d31bbc9c21c5a1def21abba0cb955ad301/rhino/Surface_Reconstruction/Libraries/volvox0110/Volvox_Python.py",
  "repo": "augmentedfabricationlab/workshop_aaec_revamp",
  "repo_stars": 2,
  "repo_description": "repository for the AAEC Autumn School 2022 Workshop, organized by TRR277 Additive Manufacturing in Construction. Organizers: Noor Khader, Lukas Lachmayer, and Gido Dielemans.",
  "license": "MIT",
  "filepath": "rhino/Surface_Reconstruction/Libraries/volvox0110/Volvox_Python.py",
  "instruction": "Volvox python",
  "code": "ï»¿\"\"\"\nThis creates a command line link to CloudCompare.\nwww.CloudComapare.org\nhttp://www.danielgm.net/cc/doc/wiki/index.php5?title=CommandLine\n\"\"\"\n\nimport sys\nimport System.IO\nsys.path.append(str(System.IO.Directory.GetParent(System.IO.Directory.GetCurrentDirectory())) + '\\Plug-ins\\IronPython\\Lib')\n\nimport subprocess\nimport os\nimport shutil\nimport glob\n\nimport clr\nclr.AddReferenceToFileAndPath(os.path.join(System.IO.Directory.GetCurrentDirectory(), 'RhinoCommon.dll'))\nimport Rhino as rc\n\n\nclass CloudCompare:\n    def __init__(self):\n        self.dir = os.path.normpath('C:\\\\Program Files\\\\CloudCompare')\n    \n    def open(self, filePath):\n        \"\"\"\n        Open in CloudCompare.\n        \"\"\"\n        if os.path.isdir(self.dir) == True:\n            #run CloudCompare cmd line\n            Args = self.dir + '\\CloudCompare ' + filePath\n            P = subprocess.Popen(Args , cwd=self.dir)\n            #P.wait()\n        else:\n            return 'CloudCompare missing. Install CloudCompare in ' + self.dir\n\n    def CCcommand(self, commands):\n        \"\"\"\n        write commands for CloudCompare.\n        \"\"\"\n        if os.path.isdir(self.dir) == True:\n            #create command string\n            command = str()\n            for com in commands:\n                command = command + com + ' '\n            #run CloudCompare cmd line\n            Args = self.dir + '\\CloudCompare ' + command\n            P = subprocess.Popen(Args , cwd=self.dir)\n            P.wait()\n            \n            return 'Done. Find the output next to the input file.'\n        else:\n            return 'CloudCompare missing. Install CloudCompare in ' + self.dir\n\n    def CCcommandE57(self, filePath, commands, outName):\n        \"\"\"\n        write commands for CloudCompare.\n        \"\"\"\n        if os.path.isdir(self.dir) == True:\n            #create command string\n            command = str()\n            for com in commands:\n                command = command + com + ' '\n            print command\n            #run CloudCompare cmd line\n            Args = self.dir + '\\CloudCompare -SILENT -O ' + filePath + ' -NO_TIMESTAMP -C_EXPORT_FMT E57 -AUTO_SAVE OFF ' + command + ' -SAVE_CLOUDS ALL_AT_ONCE' \n            P = subprocess.Popen(Args , cwd=self.dir)\n            P.wait()\n        \n            #filePath for output file of CloudCommpare\n            tmpFilePath = os.path.join(os.path.dirname(filePath), 'AllClouds.e57')\n            \n            #outputFilePath\n            outputFilePath = os.path.join(os.path.dirname(filePath), outName + '.e57')\n            \n            #Rename (and move) tmpFilePath\n            shutil.move(tmpFilePath, outputFilePath)\n            \n            return outputFilePath\n        else:\n            return 'CloudCompare missing. Install CloudCompare in ' + self.dir\n\n    def CCcommandXYZ(self, filePath, commands, outName):\n        \"\"\"\n        write commands for CloudCompare.\n        \"\"\"\n        if os.path.isdir(self.dir) == True:\n            #create command string\n            command = str()\n            for com in commands:\n                command = command + com + ' '\n            print command\n            #run CloudCompare cmd line\n            Args = self.dir + '\\CloudCompare -SILENT -O ' + filePath + ' -NO_TIMESTAMP -C_EXPORT_FMT ASC -EXT xyz -AUTO_SAVE OFF -MERGE_CLOUDS ' + command + ' -SAVE_CLOUDS' \n            P = subprocess.Popen(Args , cwd=self.dir)\n            P.wait()\n        \n            #filePath for output file of CloudCommpare\n            tmpFilePath = max(glob.iglob(os.path.splitext(filePath)[0]+'*.xyz'), key=os.path.getctime)\n            \n            #outputFilePath\n            outputFilePath = os.path.join(os.path.dirname(filePath), outName + '.xyz')\n            \n            #Rename (and move) tmpFilePath\n            shutil.move(tmpFilePath, outputFilePath)\n            \n            return outputFilePath\n        else:\n            return 'CloudCompare missing. Install CloudCompare in ' + self.dir\n\n\n    def toXYZ(self, filePath):\n        \"\"\"\n        Merge and exports an XYZ file through CloudCompare.\n        \"\"\"\n        if os.path.isdir(self.dir) == True:\n            #run CloudCompare cmd line\n            Args = self.dir + '\\CloudCompare -SILENT -O ' + filePath + ' -NO_TIMESTAMP -C_EXPORT_FMT ASC -EXT xyz -MERGE_CLOUDS' \n            P = subprocess.Popen(Args , cwd=self.dir)\n            P.wait()\n        \n            #filePath for output file of CloudCommpare\n            tmpFilePath = os.path.splitext(filePath)[0] + '_MERGED.xyz'\n            \n            #outputFilePath\n            outputFilePath = os.path.splitext(filePath)[0] + '.xyz' #os.path.join(os.path.dirname(filePath), outName + '.xyz')\n            \n            #Rename (and move) tmpFilePath\n            shutil.move(tmpFilePath, outputFilePath)\n            \n            return outputFilePath\n        else:\n            return 'CloudCompare missing. Install CloudCompare in ' + self.dir\n\n\n    def SubsampleSpatial(self, filePath, distance, outName):\n        \"\"\"\n        Spatially subsamples point cloud through CloudCompare and outputs a filepath.\n        Args:   filePath: file to subsample. dist: Distance between points to aim for through the subsampling. outName: name for new file\n        Returns:    filePath: file path to new in same directory as input file\n        \"\"\"\n        if os.path.isdir(self.dir) == True:\n            #run CloudCompare cmd line\n            Args = self.dir + '\\CloudCompare -SILENT -O ' + filePath + ' -NO_TIMESTAMP -C_EXPORT_FMT E57 -AUTO_SAVE OFF -SS SPATIAL ' + str(distance) + ' -SAVE_CLOUDS ALL_AT_ONCE' \n            P = subprocess.Popen(Args , cwd=self.dir)\n            P.wait()\n        \n            #filePath for output file of CloudCommpare\n            tmpFilePath = os.path.join(os.path.dirname(filePath), 'AllClouds.e57')\n            \n            #outputFilePath\n            outputFilePath = os.path.join(os.path.dirname(filePath), outName + '.e57')\n            \n            #Rename (and move) tmpFilePath\n            shutil.move(tmpFilePath, outputFilePath)\n            \n            return outputFilePath\n        else:\n            return 'CloudCompare missing. Install CloudCompare in ' + self.dir\n\n    def SubsampleRandom(self, filePath, amount, outName):\n        \"\"\"\n        Randomly subsamples point cloud through CloudCompare and outputs a filepath\n        Args:   filePath: file to subsample. amount: Amount of points per scan. outName: name for new file\n        Returns:    filePath: file path to new in same directory as input file\n        \"\"\"\n        if os.path.isdir(self.dir) == True:\n            #run CloudCompare cmd line\n            Args = self.dir + '\\CloudCompare -SILENT -O ' + filePath + ' -NO_TIMESTAMP -C_EXPORT_FMT E57 -AUTO_SAVE OFF -SS RANDOM ' + str(amount) + ' -SAVE_CLOUDS ALL_AT_ONCE' \n            P = subprocess.Popen(Args , cwd=self.dir)\n            P.wait()\n           \n            #filePath for output file of CloudCommpare\n            tmpFilePath = os.path.join(os.path.dirname(filePath), 'AllClouds.e57')\n           \n            #outputFilePath\n            outputFilePath = os.path.join(os.path.dirname(filePath), outName + '.e57')\n            \n            #Rename (and move) tmpFilePath\n            shutil.move(tmpFilePath, outputFilePath)\n            \n        #Output\n            return outputFilePath\n        else:\n            return 'CloudCompare missing. Install CloudCompare in ' + self.dir\n",
  "language": "python",
  "imports": [
    "Rhino",
    "RhinoCommon"
  ],
  "has_docstring": false
}