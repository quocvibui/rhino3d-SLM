{
  "source_url": "https://discourse.mcneel.com/t/addloftsrf-not-working/82755",
  "topic_id": 82755,
  "title": "AddLoftSrf not working",
  "question": "Hey guys, Iâ€™m basically trying to loft some curves and just cannot figure out why my lofts wont come out clean. I got my lofts, but they are like twisted or something, almost as if its skipping the mid curve. The curve in the middle is usually smaller than the first two curves which is why I used length to identify it.\n\n\nimport rhinoscriptsyntax as rs\nfrom Rhino.Geometry import *\nimport System.Drawing.Color as color\nimport Rhino\nimport time\nimport math\nimport sys\nsys.path.append(\"C:\\\\BMIRhinoTools\\\\Source\")\nimport MO\nimport System.Drawing.Bitmap as BM\nimport utility as rhutil\n\ndef preloft(curves):\n    plane = rs.WorldZXPlane()\n    bbox2 = rs.BoundingBox(curves)\n    cur_cen = (bbox2[0]+bbox2[6])*0.5\n    a  = rs.AddPoint(cur_cen)\n    b = rs.VectorCreate([0,0,20],[0,0,0])\n    c = rs.VectorCreate([20,0,0],[0,0,0])\n    d = rs.VectorCreate([-20,0,0],[0,0,0])\n    point1 = rs.CopyObject(a,b)\n    point2 = rs.CopyObject(a,c)\n    point3 = rs.CopyObject(a,d)\n    boundary = rs.AddCircle3Pt(point1,point2,point3)\n    return (boundary)\n\n\ninputc = rs.ObjectsByLayer(\"NewNostrils\",rs.filter.curve)\n\nbound = preloft(inputc)\nsurface = rs.AddPlanarSrf(bound)\nrs.DeleteObject(bound)\n\nright_nostril =[]\nleft_nostril =[]\n\nfor i in inputc:\n    bbox = rs.BoundingBox(i)\n    cent = (bbox[0]+bbox[6])*0.5\n    if cent.X>0:\n        left_nostril.append(i)\n    else:\n        right_nostril.append(i)\n\n\n#gettherightcurves\nlower_right_curve = rs.PointClosestObject([0,0,-10],right_nostril)[0]\nlower_left_curve = rs.PointClosestObject([0,0,-10],left_nostril)[0]\ntop_right_curve = rs.PointClosestObject([0,0,20],right_nostril)[0]\ntop_left_curve = rs.PointClosestObject([0,0,20],left_nostril)[0]\n\n#getthecurvelenght\nlowleft_len = rs.CurveLength(lower_left_curve)\ntopleft_len = rs.CurveLength(top_left_curve)\nlowright_len = rs.CurveLength(lower_right_curve)\ntopright_len = rs.CurveLength(top_right_curve)\n\n#getthemiddlecurves\nmid_left_curve =[]\nmid_right_curve =[]\n\nfor cur_a in left_nostril:\n    if rs.CurveLength(cur_a) <...",
  "code_blocks": [
    {
      "code": "for cur in inputc:\nint = rs.CurveSurfaceIntersection(cur,surface)\nparam = int[0][6]\nrs.CurveSeam(cur,param)\nif(not rs.CurveDirectionsMatch(cur,inputc[0])):\nrs.ReverseCurve(cur)",
      "language": "python",
      "author": "ZKislost",
      "post_number": 4,
      "is_solution": false
    },
    {
      "code": "import rhinoscriptsyntax as rs\nfrom Rhino.Geometry import *\nimport System.Drawing.Color as color\nimport Rhino\nimport time\nimport math\nimport sys\nsys.path.append(\"C:\\\\BMIRhinoTools\\\\Source\")\nimport MO\nimport System.Drawing.Bitmap as BM\nimport utility as rhutil\n\ndef preloft(curves):\n    plane = rs.WorldZXPlane()\n    bbox2 = rs.BoundingBox(curves)\n    cur_cen = (bbox2[0]+bbox2[6])*0.5\n    a  = rs.AddPoint(cur_cen)\n    b = rs.VectorCreate([0,0,20],[0,0,0])\n    c = rs.VectorCreate([20,0,0],[0,0,0])\n    d = rs.VectorCreate([-20,0,0],[0,0,0])\n    point1 = rs.CopyObject(a,b)\n    point2 = rs.CopyObject(a,c)\n    point3 = rs.CopyObject(a,d)\n    boundary = rs.AddCircle3Pt(point1,point2,point3)\n    return (boundary)\n\n\ninputc = rs.ObjectsByLayer(\"NewNostrils\",rs.filter.curve)\n\nbound = preloft(inputc)\nsurface = rs.AddPlanarSrf(bound)\nrs.DeleteObject(bound)\n\nright_nostril =[]\nleft_nostril =[]\n\nfor i in inputc:\n    bbox = rs.BoundingBox(i)\n    cent = (bbox[0]+bbox[6])*0.5\n    if cent.X>0:\n        left_nostril.append(i)\n    else:\n        right_nostril.append(i)\n\n\n#gettherightcurves\nlower_right_curve = rs.PointClosestObject([0,0,-10],right_nostril)[0]\nlower_left_curve = rs.PointClosestObject([0,0,-10],left_nostril)[0]\ntop_right_curve = rs.PointClosestObject([0,0,20],right_nostril)[0]\ntop_left_curve = rs.PointClosestObject([0,0,20],left_nostril)[0]\n\n#getthecurvelenght\nlowleft_len = rs.CurveLength(lower_left_curve)\ntopleft_len = rs.CurveLength(top_left_curve)\nlowright_len = rs.CurveLength(lower_right_curve)\ntopright_len = rs.CurveLength(top_right_curve)\n\n#getthemiddlecurves\nmid_left_curve =[]\nmid_right_curve =[]\n\nfor cur_a in left_nostril:\n    if rs.CurveLength(cur_a) < lowleft_len and rs.CurveLength(cur_a) < topleft_len:\n        mid_left_curve.append(cur_a)\n\nfor cur_b in right_nostril:\n    if rs.CurveLength(cur_b) < lowright_len and rs.CurveLength(cur_b) < topright_len:\n        mid_right_curve.append(cur_b)\n\n#Startlofting\nfor cur in inputc:\n    int = rs.CurveSurfaceIntersection(cur,surface)\n    param = int[0][6]\n    rs.CurveSeam(cur,param)\n    if(not rs.CurveDirectionsMatch(cur,inputc[0])):\n        rs.ReverseCurve(cur)\n\n#LoftCurves\nrs.DeleteObject(surface)\nrightLoft = rs.AddLoftSrf((top_right_curve,mid_right_curve[0],lower_right_curve),None,None,1,1,155)[0]\nlefttLoft = rs.AddLoftSrf((top_left_curve,mid_left_curve[0],lower_left_curve),None,None,1,1,155)[0]",
      "language": "python",
      "author": "ZKislost",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "file-io",
    "geometry",
    "layers",
    "python",
    "rhinocommon",
    "rhinoscriptsyntax"
  ],
  "has_accepted_answer": false,
  "category_id": 11,
  "posts_count": 8,
  "views": 977
}