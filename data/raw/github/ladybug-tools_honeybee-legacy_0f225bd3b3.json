{
  "source_url": "https://github.com/ladybug-tools/honeybee-legacy/blob/bd62af4862fe022801fb87dbc8794fdf1dff73a9/src/Honeybee_Lookup%20EnergyPlus%20Folder.py",
  "repo": "ladybug-tools/honeybee-legacy",
  "repo_stars": 129,
  "repo_description": ":bee: Honeybee is a free and open source plugin to connect Grasshopper3D to EnergyPlus, Radiance, Daysim and OpenStudio for building energy and daylighting simulation",
  "license": "NOASSERTION",
  "filepath": "src/Honeybee_Lookup EnergyPlus Folder.py",
  "instruction": "Search Energy Simulation Folder\n-\nProvided by Honeybee 0.0.66\n    \n    Args:\n        _studyFolder: Path to base study folder. It can be a single simulation folder or a folder containing subfolders...",
  "code": "# Lookup EnergyPlus Folder\n# \n# Honeybee: A Plugin for Environmental Analysis (GPL) started by Mostapha Sadeghipour Roudsari\n# \n# This file is part of Honeybee.\n# \n# Copyright (c) 2013-2020, Abraham Yezioro <ayez@ar.technion.ac.il> and Chris Mackey <chris@ladybug.tools>\n# Honeybee is free software; you can redistribute it and/or modify \n# it under the terms of the GNU General Public License as published \n# by the Free Software Foundation; either version 3 of the License, \n# or (at your option) any later version. \n# \n# Honeybee is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of \n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the \n# GNU General Public License for more details.\n# \n# You should have received a copy of the GNU General Public License\n# along with Honeybee; If not, see <http://www.gnu.org/licenses/>.\n# \n# @license GPL-3.0+ <http://spdx.org/licenses/GPL-3.0+>\n\n\"\"\"\nSearch Energy Simulation Folder\n-\nProvided by Honeybee 0.0.66\n    \n    Args:\n        _studyFolder: Path to base study folder. It can be a single simulation folder or a folder containing subfolders produced by parametric simulations\n        studyType_: Input for Honeybee EnergyPlus study type:\n                    1 > Energy Plus\n                    2 > OpenStudio\n        refresh_: Refresh\n    Returns:\n        idfFiles: The file path of the Input Data File (idf) file that has been generated on your machine.\n        osmFiles: The file path of the OpenStudio Model (osm) file that has been generated on your machine.\n        resultFileAddress: The file path of the Comma-Separated Values file (csv)  result file that has been generated on your machine.\n        scheduleCsvFiles: The file paths to any CSV schedules in the study folder.\n        rddFiles: The file path of the Report Data Dictionary (rdd) file that has been generated on your machine.\n        errFiles: The file path of the Error (err) file that has been generated on your machine.\n        eioFiles: The file path of the EnergyPlus Invariant Output (eio) file that has been generated on your machine.\n        esoFiles: The file path of the EnergyPlus Simulation Output (eso) result file that has been generated on your machine.\n        sqlFiles: The file path of the Structured Query Language (sql) result file that has been generated on your machine.\n\"\"\"\nghenv.Component.Name = \"Honeybee_Lookup EnergyPlus Folder\"\nghenv.Component.NickName = 'LookupFolder_EnergyPlus'\nghenv.Component.Message = 'VER 0.0.66\\nJUL_07_2020'\nghenv.Component.IconDisplayMode = ghenv.Component.IconDisplayMode.application\nghenv.Component.Category = \"HB-Legacy\"\nghenv.Component.SubCategory = \"10 | Energy | Energy\"\n#compatibleHBVersion = VER 0.0.56\\nFEB_01_2015\n#compatibleLBVersion = VER 0.0.59\\nFEB_01_2015\ntry: ghenv.Component.AdditionalHelpFromDocStrings = \"4\"\nexcept: pass\n\nimport scriptcontext as sc\nimport os\nimport System\nimport Grasshopper.Kernel as gh\nfrom Grasshopper import DataTree\nfrom Grasshopper.Kernel.Data import GH_Path\nfrom pprint import pprint\nidfFiles = []\nresultFileAddress = []\nscheduleCsvFiles = []\nrddFiles = []\nerrFiles = []\neioFiles = []\nesoFiles = []\nsqlFiles = []\nosmFiles = []\n\n\ndef main(studyFolder, subFoldersOS):\n    msg = str.Empty\n    \n    lb_preparation = sc.sticky[\"ladybug_Preparation\"]()\n    hb_serializeObjects = sc.sticky[\"honeybee_SerializeObjects\"]\n    hb_readAnnualResultsAux = sc.sticky[\"honeybee_ReadAnnualResultsAux\"]()\n    ##analysisTypesDict = sc.sticky[\"honeybee_DLAnalaysisTypes\"]\n    if studyFolder==None:\n        msg = \" \"\n        return msg, None\n        \n    if not os.path.isdir(studyFolder):\n        msg = \"Can't find \" + studyFolder\n        return msg, None\n    \n    fileNames   = os.listdir(studyFolder)\n    fileNames.sort()\n    if subFoldersOS == \"None\":\n        for fileName in fileNames:\n            if fileName.lower().endswith(\".idf\"):\n                idfFiles.append(os.path.join(studyFolder, fileName))\n            elif fileName.lower().endswith(\".csv\") and not fileName.endswith(\"sz.csv\") and not \"SCH\" in fileName and not \"INTGAIN\" in fileName and not fileName.endswith(\"Table.csv\"):\n                resultFileAddress.append(os.path.join(studyFolder, fileName))\n            elif fileName.lower().endswith(\".csv\") and not fileName.endswith(\"sz.csv\") and (\"SCH\" in fileName or \"INTGAIN\" in fileName):\n                scheduleCsvFiles.append(os.path.join(studyFolder, fileName))\n            elif fileName.lower().endswith(\".rdd\"):\n                rddFiles.append(os.path.join(studyFolder, fileName))\n            elif fileName.lower().endswith(\".err\"):\n                errFiles.append(os.path.join(studyFolder, fileName))\n            elif fileName.lower().endswith(\".eio\"):\n                eioFiles.append(os.path.join(studyFolder, fileName))\n            elif fileName.lower().endswith(\".eso\"):\n                esoFiles.append(os.path.join(studyFolder, fileName))\n            elif fileName.lower().endswith(\".sql\"):\n                sqlFiles.append(os.path.join(studyFolder, fileName))\n    elif subFoldersOS == \"OS\":\n        for fileName in os.listdir(studyFolder):\n            if fileName.lower().endswith(\".osm\"):\n                osmFiles.append(os.path.join(studyFolder, fileName))\n    else:\n        fileNamesOS = os.listdir(subFoldersOS)\n        fileNamesOS.sort()\n        for fileName in fileNames:\n            if fileName.lower().endswith(\".osm\"):\n                osmFiles.append(os.path.join(studyFolder, fileName))\n        for fileName in fileNamesOS:\n            if fileName.lower().endswith(\".idf\"):\n                idfFiles.append(os.path.join(subFoldersOS, fileName))\n            elif fileName.lower().endswith(\".csv\") and not fileName.endswith(\"sz.csv\") and not \"SCH\" in fileName and not \"INTGAIN\" in fileName and not fileName.endswith(\"Table.csv\"):\n                resultFileAddress.append(os.path.join(subFoldersOS, fileName))\n            elif fileName.lower().endswith(\".csv\") and not fileName.endswith(\"sz.csv\") and (\"SCH\" in fileName or \"INTGAIN\" in fileName):\n                scheduleCsvFiles.append(os.path.join(subFoldersOS, fileName))\n            elif fileName.lower().endswith(\".rdd\"):\n                rddFiles.append(os.path.join(subFoldersOS, fileName))\n            elif fileName.lower().endswith(\".err\"):\n                errFiles.append(os.path.join(subFoldersOS, fileName))\n            elif fileName.lower().endswith(\".eio\"):\n                eioFiles.append(os.path.join(subFoldersOS, fileName))\n            elif fileName.lower().endswith(\".eso\"):\n                esoFiles.append(os.path.join(subFoldersOS, fileName))\n            elif fileName.lower().endswith(\".sql\"):\n                sqlFiles.append(os.path.join(subFoldersOS, fileName))\n        \n    return msg, [idfFiles, resultFileAddress, scheduleCsvFiles, rddFiles, errFiles, eioFiles, esoFiles, sqlFiles, osmFiles]\n    \nstudyTypes = {\n        1: \"EnergyPlus\",\n        2: \"OpenStudio\"\n        }\n    \nsubFolders   = []\n#subFoldersOS = []\n\n\n#If Honeybee or Ladybug is not flying or is an older version, give a warning.\ninitCheck = True\n\nw = gh.GH_RuntimeMessageLevel.Warning\n\n#Ladybug check.\nif not sc.sticky.has_key('ladybug_release') == True:\n    initCheck = False\n    print \"You should first let Ladybug fly...\"\n    ghenv.Component.AddRuntimeMessage(w, \"You should first let Ladybug fly...\")\nelse:\n    try:\n        if not sc.sticky['ladybug_release'].isCompatible(ghenv.Component): initCheck = False\n        if sc.sticky['ladybug_release'].isInputMissing(ghenv.Component): initCheck = False\n    except:\n        initCheck = False\n        warning = \"You need a newer version of Ladybug to use this compoent.\" + \\\n        \"Use updateLadybug component to update userObjects.\\n\" + \\\n        \"If you have already updated userObjects drag Ladybug_Ladybug component \" + \\\n        \"into canvas and try again.\"\n        ghenv.Component.AddRuntimeMessage(w, warning)\n#Honeybee check.\nif not sc.sticky.has_key('honeybee_release') == True:\n    initCheck = False\n    print \"You should first let Honeybee fly...\"\n    ghenv.Component.AddRuntimeMessage(w, \"You should first let Honeybee fly...\")\nelse:\n    try:\n        if not sc.sticky['honeybee_release'].isCompatible(ghenv.Component): initCheck = False\n    except:\n        initCheck = False\n        warning = \"You need a newer version of Honeybee to use this compoent.\" + \\\n        \"Use updateHoneybee component to update userObjects.\\n\" + \\\n        \"If you have already updated userObjects drag Honeybee_Honeybee component \" + \\\n        \"into canvas and try again.\"\n        ghenv.Component.AddRuntimeMessage(w, warning)\n\n\n\nif _studyFolder!=None and os.path.isdir(_studyFolder) and initCheck == True:    \n    # check if the type is provided\n    if studyType_ == None:\n        studyType_ = 2\n    try:\n        dirNames = os.listdir(_studyFolder)\n        dirNames.sort()\n        for dirName in dirNames: \n            ##print 'dirName1: ', dirName\n            if dirName == studyTypes[studyType_]:# Check if the inputFolder has a \"EnergyPlus\" directory. if so use this only inputFolder\n                subFolders.append(os.path.join(_studyFolder, dirName))\n                print 'Found it ... found it in 1'\n                break\n        else:\n            for dirName in dirNames: # This is the name for EACH case\n                if os.path.isdir(os.path.join(_studyFolder, dirName, studyTypes[studyType_])):\n                    ##aa = os.path.join(_studyFolder, dirName, studyTypes[studyType_])   ####\n                    subFolders.append(os.path.join(_studyFolder, dirName, studyTypes[studyType_]))\n                    ##print 'Found it ... found it in 2\\t', aa    # This is the FOR block where files are found\n                    \n        ################################################################\n        ### Now find the directories and files relevant to studyType ###\n        ################################################################\n        for studyTypeName in subFolders:\n            studyFolder = studyTypeName\n            subFoldersOS = \"OS\"\n            if studyType_ == 1: # EnergyPlus\n                subFoldersOS = \"None\"\n            elif studyType_ == 2: # OpenStudio\n                dirOSNames = os.listdir(studyFolder)\n                dirOSNames.sort()\n                for dirOSName in dirOSNames: \n                    if os.path.isdir(os.path.join(studyFolder, dirOSName, \"ModelToIdf\")):\n                        subFoldersOS = os.path.join(studyFolder, dirOSName, \"ModelToIdf\")\n            \n            res = main(studyFolder, subFoldersOS)\n            \n            if res != -1:\n                msg, results = res\n                \n                if msg!=str.Empty:\n                    ghenv.Component.AddRuntimeMessage(gh.GH_RuntimeMessageLevel.Warning, msg)\n                else:\n                    idfFiles, resultFileAddress, scheduleCsvFiles, rddFiles, errFiles, eioFiles, esoFiles, sqlFiles, osmFiles = results\n    except:\n        warning = \"Please provide a valid studyType! See hint\"\n        w = gh.GH_RuntimeMessageLevel.Warning\n        ghenv.Component.AddRuntimeMessage(w, warning)\n",
  "language": "python",
  "imports": [
    "scriptcontext"
  ],
  "has_docstring": true
}