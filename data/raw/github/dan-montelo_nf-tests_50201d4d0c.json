{
  "source_url": "https://github.com/dan-montelo/nf-tests/blob/6f8f8a0b22d756c2a23611494194f51848c9a27b/cpi_Northern_Flicker.py",
  "repo": "dan-montelo/nf-tests",
  "repo_stars": 0,
  "repo_description": null,
  "license": "unknown",
  "filepath": "cpi_Northern_Flicker.py",
  "instruction": "Cpi northern flicker",
  "code": "import scriptcontext as sc\nimport math\nimport System\nimport System.Collections.Generic\nimport Rhino\nimport clr\nimport rhinoscriptsyntax as rs\nimport measures\n\n\nclr.AddReference(\"NorthernFlicker\")\nfrom NorthernFlicker.MVVM.Model import TimberElement\n\nAttributes_of_TimberElement = [\n    'ABox', 'ABoxDiagonal', 'Axes', 'BBoxVolume', 'Copy', 'Depth', 'Description',\n    'Dispose', 'Duplicate', 'ElementSubType', 'ElementType', 'End', 'Equals', 'Extract',\n    'FacesArea', 'FromJson', 'GetHashCode', 'GetType', 'InvalidLog', 'Length',\n    'MemberwiseClone', 'MoveUserDataFrom', 'MoveUserDataTo', 'Name', 'NeedsUpdate',\n    'OnDuplicate', 'OnPropertyChanged', 'OnTransform', 'Origin', 'OriginalLayerName',\n    'PropertyChanged', 'Read', 'RefSurfaceIndex', 'RefSurfacePlane', 'ReferenceEquals',\n    'ShouldWrite', 'ThrowOnInvalidPropertyName', 'ToJson', 'ToString', 'Transform',\n    'TrySetBBoxVolume', 'TrySetElementSubType', 'TrySetElementType', 'TrySetEnd',\n    'TrySetFacesArea', 'TrySetHeight', 'TrySetLength', 'TrySetOrigin', 'TrySetRefSurfacePlane',\n    'TrySetVolume', 'TrySetWidth', 'Volume', 'Width', 'Write', '__class__', '__delattr__',\n    '__doc__', '__enter__', '__exit__', '__format__', '__getattribute__', '__hash__',\n    '__init__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__',\n    '__sizeof__', '__str__', '__subclasshook__']\n\n\ntimber_colors = {\n\"HorizontalPanel\": (255, 127, 0),\n\"VerticalPanel\": (191, 63, 255),\n\"InclinedPanel\": (191, 63, 63),\n\"Beam\": (0, 0, 255),\n\"InclinedBeam\": (0, 255, 0),\n\"Column\": (255, 191, 0)\n}\n\n\nsteel_colors = {\n    \"Beam\": (205, 179, 139),\n    \"Column\": (105, 105, 105),\n    \"InclinedBeam\": (0, 105, 105),\n    \"HorizontalPanel\": (205, 112, 84),\n    \"VerticalPanel\": (205, 112, 84),\n    \"InclinedPanel\": (205, 112, 84),\n    \"Connector\": (0, 255, 255),\n    \"HorizontalPlate\": (63, 191, 191),\n    \"VerticalPlate\": (127, 255, 191),\n    \"InclinedPlate\": (255, 0, 255)\n}\n\ndef try_get_nf_data(rh_obj):\n    if rh_obj and rh_obj.Geometry.HasUserData:\n        user_data_list = rh_obj.Geometry.UserData\n        for user_data in user_data_list:\n            if isinstance(user_data, TimberElement):\n                # Print all available attributes of TimberElement\n                #attributes = dir(user_data)\n                #print(\"Attributes of TimberElement:\\n\", attributes)\n                \n                ref_plane = user_data.RefSurfacePlane\n                axis_lines = user_data.Axes                \n                origin_pt = ref_plane.Origin\n                #rs.AddPoint(origin_pt)\n                len_pt = origin_pt + ref_plane.XAxis             \n                dep_pt = origin_pt + ref_plane.ZAxis\n                \n                input_str = \"{} {} {}\".format(origin_pt, len_pt, dep_pt)\n                \n                rs.UnselectAllObjects()\n                rs.SelectObject(obj_id)\n                rs.Command(\"SetCadworkAxes \" + input_str)\n                rs.UnselectAllObjects()\n\n\n                \n                vo_dict = measures.Measures.VolumeMeasures(obj_id) \n                measure_dict = measures.Measures.LengthMeasures(obj_id)\n                \n\n                # Assuming measure_dict and vol_dict are already defined\n                for k, v in vo_dict.items():\n                    rs.SetUserText(obj_id, str(k), str(v))\n\n                for k, v in measure_dict.items():\n                    rs.SetUserText(obj_id, str(k), str(v))\n                \n                rs.SetUserText(obj_id,\"GN_LOD_representation\",\"300\")\n\n                if \"GLU\" in vo_dict[\"MA_Description\"] and \"Planar\" in str(user_data.ElementType):\n                    print (\"You are trying to set a linear material on a planar element\")\n                    #return\n\n                if \"CLT\" in vo_dict[\"MA_Description\"] and (\"Linear\" in str(user_data.ElementType)):\n                    print (\"You are trying to set a planar material on a linear element\")\n                    #return\n\n\n                if \"STEEL\" in vo_dict[\"MA_Description\"]:\n                    color = steel_colors.get(str(user_data.ElementSubType))\n                    rs.ObjectColor(obj_id,color)\n                else:\n                    color = timber_colors.get(str(user_data.ElementSubType))\n                    rs.ObjectColor(obj_id,color)\n                \n                \n                \n                \n                rs.SetUserText(obj_id,\"KS_SUB_ID\",str(user_data.ElementSubType))\n                #transform = rs.XformChangeBasis(rs.WorldXYPlane(),ref_plane)\n                #rs.TransformObject(obj_id,transform,True)             \n                \n\n                \n\n                \n                # Assuming `user_data` is an object with attributes Width, Depth, Length, and BBoxVolume\n                nf_data =   \"ElementSubType : \" + str(user_data.ElementSubType) + \"\\n\" + \\\n                            \"ElementType : \" + str(user_data.ElementType) + \"\\n\" + \\\n                            \"OriginalLayerName : \" + str(user_data.OriginalLayerName) + \"\\n\" + \\\n                            \"Width : \" + str(user_data.Width) + \"\\n\" + \\\n                            \"Depth : \" + str(user_data.Depth) + \"\\n\" + \\\n                            \"Length : \" + str(user_data.Length) + \"\\n\" + \\\n                            \"BBoxVolume : \" + str(user_data.BBoxVolume)\n                return True, nf_data\n    return False, \"Failed to retrieve any NF data\"\n\nobj_ids = rs.GetObjects(\"Select objects\")\n\nno_data = []\nif obj_ids:\n    for obj_id in obj_ids:\n        rs.SelectObject(obj_id)\n        rs.Command(\"DestroyTimber\")\n        rs.Command(\"CreateTimber\")\n        obj = rs.coercerhinoobject(obj_id)\n        if obj:\n            success, message = try_get_nf_data(obj)\n            if success:\n                print(message)\n            else:\n                no_data.append(obj_id)\nelse:\n    print(\"No objects selected.\")\n\nif no_data:\n    rs.SelectObjects(no_data)\n    rs.MessageBox(\"Active objects don't have NF data\")\n    \n    \n",
  "language": "python",
  "imports": [
    "Rhino",
    "rhinoscriptsyntax",
    "scriptcontext"
  ],
  "has_docstring": false
}