{
  "source_url": "https://discourse.mcneel.com/t/rhinocommon-api-for-intersection-between-two-surfaces-ver7/134103",
  "topic_id": 134103,
  "title": "RhinoCommon API for Intersection between two surfaces (ver7)",
  "question": "Hi, I’ve got a problem when I tried to intersect two surfaces.\n\nI attached some pictures as below.\n\n\n#1:\n intersection surfaces\n\n\n#2\n, \n#3:\n unexpected results\n\n\n#4:\n expected result\n\n\n#\n1\n. Two surfaces to get an intersection curve\n\n\n\n\nimage\n1790×1262 73.8 KB\n\n\n\n\n#2\n. Intersection result by using Solid → Intersection or Rhno.Geometry.Intersect.SurfaceSurfce of RhinoCommon (Selection of two surfaces and an intersection curve)\n\n\n\n\nimage\n904×524 22.3 KB\n\n\n\n\n#3\n. Intersection result by using Solid → Intersection (Selection of an intersection curve)\n\n\n\n\nimage\n814×484 47.7 KB\n\n\n\n\n#4\n. Intersection result by using “IntersectTwoSets” Command or “Curve->Curve from objects->Intersection of two sets”\n\n\n\n\nimage\n794×540 49.6 KB\n\n\n\n\nI’ve tried to get an intersection curve of two surfaces by using Solid->Intersection in Rhino App and Rhno.Geometry.Intersect.SurfaceSurfce of RhinoCommon, but results were not what I expected. (See \n#2\n and \n#3\n)\n\nBy the way, I can get the good result as depicted \n#4\n if I use “IntersectTwoSets” command in Rhino App.\n\nEventually, I am finding out the RhinoCommon function that works the same way with “IntersectTwoSets”.\n\nI will very appreciate if somebody help me.",
  "code_blocks": [
    {
      "code": "import Rhino\nimport scriptcontext as sc\n\ndef test_intersect_breps():\n    go = Rhino.Input.Custom.GetObject()\n    go.SetCommandPrompt('Select two surfaces to intersect')\n    go.GeometryFilter = Rhino.DocObjects.ObjectType.Surface\n    go.SubObjectSelect = False\n    go.GetMultiple(2, 2)\n    if go.CommandResult() != Rhino.Commands.Result.Success:\n        return\n    \n    brep0 = go.Object(0).Brep()\n    brep1 = go.Object(1).Brep()\n    if not brep0 or not brep1:\n        return\n        \n    rc, curves, points = Rhino.Geometry.Intersect.Intersection.BrepBrep(brep0, brep1, sc.doc.ModelAbsoluteTolerance)\n    if rc:\n        for c in curves:\n            sc.doc.Objects.AddCurve(c)\n        for p in points:\n            sc.doc.Objects.AddPoint(p)\n    sc.doc.Views.Redraw()\n\nif __name__ == \"__main__\":\n    test_intersect_breps()",
      "language": "python",
      "author": "dale",
      "post_number": 4,
      "is_solution": false
    },
    {
      "code": "public class IntersectionTest : Command\n{\n    public IntersectionTest()\n    {\n        Instance = this;\n    }\n\n    ///<summary>The only instance of the MyCommand command.</summary>\n    public static IntersectionTest Instance { get; private set; }\n\n    public override string EnglishName => \"IntersectionTest\";\n\n    protected override Result RunCommand(RhinoDoc doc, RunMode mode)\n    {\n        // TODO: complete command.\n        Rhino.Input.Custom.GetObject go = new Rhino.Input.Custom.GetObject();\n        go.SetCommandPrompt(\"select surfaces to intersect\");\n        go.GeometryFilter = Rhino.DocObjects.ObjectType.Surface;\n        go.SubObjectSelect = false;\n        go.EnablePressEnterWhenDonePrompt(true);\n        go.GetMultiple(2,2);\n        if (go.CommandResult() != Rhino.Commands.Result.Success)\n            return go.CommandResult();\n        Rhino.DocObjects.ObjRef objRef1 = go.Object(0);\n        Rhino.DocObjects.ObjRef objRef2 = go.Object(1);\n        Brep brep1 = go.Object(0).Brep(); // objRef2.Brep();\n        Brep brep2 = go.Object(1).Brep(); // objRef2.Brep();\n        double tolerance = doc.ModelAbsoluteTolerance;\n        Curve[] intersectionCurves;\n        Point3d[] intersectionPoints;\n        if(!Rhino.Geometry.Intersect.Intersection.BrepBrep(\n            brep1, \n            brep2, \n            tolerance, \n            out intersectionCurves, \n            out intersectionPoints))\n        {\n            return Result.Failure;\n        }\n        foreach(Curve curve in intersectionCurves)\n        {\n            doc.Objects.Add(curve);\n        }\n        doc.Views.Redraw();\n\n        return Result.Success;\n    }\n}",
      "language": "csharp",
      "author": "user1723",
      "post_number": 5,
      "is_solution": false
    }
  ],
  "tags": [
    "csharp",
    "file-io",
    "geometry",
    "python",
    "rhinocommon",
    "selection"
  ],
  "has_accepted_answer": false,
  "category_id": 3,
  "posts_count": 6,
  "views": 1497
}