{
  "source_url": "https://github.com/ed-p-may/LBT-2-PH/blob/3c2bbdf0cb26deb92d36b870aeb920cbc31d8da2/ghuser_py/LBT2PH%20XL%20Read%20from%20Workbook.py",
  "repo": "ed-p-may/LBT-2-PH",
  "repo_stars": 12,
  "repo_description": "LBT2PH is a free toolkit for creating PHPP energy models from Ladybug Tools v1.0+ definitions.",
  "license": "GPL-3.0",
  "filepath": "ghuser_py/LBT2PH XL Read from Workbook.py",
  "instruction": "Read a list of fields from an Excel workbook.\nTo configure this module, provide three comma separated lists of the same length \nfor the sheet name, cell name, and the label of the result....",
  "code": "#\n# LBT2PH: A Plugin for creating Passive House Planning Package (PHPP) models from LadybugTools. Created by blgdtyp, llc\n# \n# This component is part of the PH-Tools toolkit <https://github.com/PH-Tools>.\n# \n# Copyright (c) 2020, bldgtyp, llc <phtools@bldgtyp.com> \n# LBT2PH is free software; you can redistribute it and/or modify \n# it under the terms of the GNU General Public License as published \n# by the Free Software Foundation; either version 3 of the License, \n# or (at your option) any later version. \n# \n# LBT2PH is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of \n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the \n# GNU General Public License for more details.\n# \n# For a copy of the GNU General Public License\n# see <http://www.gnu.org/licenses/>.\n# \n# @license GPL-3.0+ <http://spdx.org/licenses/GPL-3.0+>\n#\n\"\"\"\nRead a list of fields from an Excel workbook.\nTo configure this module, provide three comma separated lists of the same length \nfor the sheet name, cell name, and the label of the result. Alternatively, use \nthe form entry option.\n-\nOriginal component design by Jack Hymowitz <https://github.com/jackhymowitz>, \nPinacle Scholar Summer Research Student, Stevens Institute of Technology\n-\nMarch 1, 2021\n    Args:\n        excel: A running excel instance\n        sheets: A comma separated list of the worksheet to read from for each output.\n        fields: A comma separated list of the cells to read for each output\n        labels: A comma separated list of what to  label each read cell\n    Returns:\n        data: The values of the requested fields in a list of length-2 tuple (label, value)\n        text: The information from data written out to a string.\n\"\"\"\n\nfrom System import Object\nfrom Grasshopper import DataTree\nfrom Grasshopper.Kernel.Data import GH_Path\n\nfrom ghpythonlib.componentbase import executingcomponent as component\nimport Grasshopper, GhPython\nimport System\nimport Rhino\nimport rhinoscriptsyntax as rs\nimport scriptcontext as sc\nimport Grasshopper.Kernel as ghK\nfrom math import floor,log10\n\nimport LBT2PH.__versions__\nreload(LBT2PH.__versions__)\n\nghenv.Component.Name = \"LBT2PH XL Read from Workbook\"\nLBT2PH.__versions__.set_component_params(ghenv, dev=False)\n#-------------------------------------------------------------------------------\n\nclass MyComponent(component):\n    \n    def doRead(self, excel, sheets, fields, labels):\n        if sheets:\n            sheetsList=sheets.split(\",\")\n            fieldsList=fields.split(\",\")\n            labelsList=labels.split(\",\")\n            \n            if len(sheetsList) != len(fieldsList) or len(sheetsList) != len(labelsList):\n                msg1 = \"Fields and Labels don't match!\"\n                ghenv.Component.AddRuntimeMessage(ghK.GH_RuntimeMessageLevel.Error, msg1)\n                return (None,None)\n            \n            labelList=[]\n            for i in range(len(sheetsList)):\n                labelList.append([labelsList[i],sheetsList[i],fieldsList[i]])\n        else:\n            if not \"displayFields\" in sc.sticky:\n                #msg1 = \"No Fields Found!\"\n                #ghenv.Component.AddRuntimeMessage(ghK.GH_RuntimeMessageLevel.Error, msg1)\n                #return (None,None)\n                #Default, verification page\n                labelList=[\n                    [\"TFA\",\"Verification\",\"I34\"],\n                    [\"Heating Demand\",\"Verification\",\"I35\"],\n                    [\"Heating Load\",\"Verification\",\"I36\"],\n                    [\"Cooling + Dehum Demand\",\"Verification\",\"I38\"],\n                    [\"Cooling Load\",\"Verification\",\"I39\"],\n                    [\"Frequency of Overheating\",\"Verification\",\"I40\"],\n                    [\"Frequency of excessively high humidity\",\"Verification\",\"I41\"],\n                    [\"Pressurization test result\",\"Verification\",\"I43\"],\n                    [\"Non-Renewable PE\",\"Verification\",\"I53\"],\n                    [\"PER Demand\",\"Verification\",\"I55\"],\n                    [\"PER\",\"Verification\",\"I56\"],\n                    [\"Heating Total\",\"Heating\",\"O27\"],\n                    [\"Cooling Total\",\"Cooling\",\"O28\"]\n                    ]\n            else:\n                labelList=sc.sticky[\"displayFields\"]\n        \n        data = DataTree[Object]() \n        text = \"\"\n        \n        for i, cell in enumerate(labelList):\n            label=cell[0].strip()\n            sheet=cell[1].strip()\n            field=cell[2].strip()\n            \n            if sheet in excel.sheets_dict:\n                val=excel.sheets_dict[sheet].Range[field].Value2\n                \n                if(type(val).__name__==\"float\" and val!=0): #Round to 4 significant figures\n                    val=str(round(val,3-int(floor(log10(abs(val))))))\n                data.Add(label, GH_Path(i))\n                data.Add(val, GH_Path(i))\n                text+=str(label)+\": \"+str(val)+\"\\n\"\n        \n        return (data, text)\n    \n    def RunScript(self, excel, sheets, fields, labels):\n        if excel and excel.active_workbook and excel.sheets_dict:\n            return self.doRead(excel, sheets, fields, labels)\n        \n        msg1 = \"No Excel Instance!\"\n        ghenv.Component.AddRuntimeMessage(ghK.GH_RuntimeMessageLevel.Warning, msg1)\n        \n        return (None, None)\n",
  "language": "python",
  "imports": [
    "Rhino",
    "ghpythonlib",
    "rhinoscriptsyntax",
    "scriptcontext"
  ],
  "has_docstring": true
}