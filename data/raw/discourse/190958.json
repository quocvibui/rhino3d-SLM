{
  "source_url": "https://discourse.mcneel.com/t/need-some-help-to-understand-why-i-got-a-grasshopper-breakpoint/190958",
  "topic_id": 190958,
  "title": "Need some help to understand why I got a Grasshopper Breakpoint",
  "question": "Hello World,\n\n\nI need some help to figure out was it going on behind the hood, so I can debug my code properly, I would appreciate any insight.\n\n\nI am pretty sure this can be categorized as a grasshopper bug, but it is also possible that I just lack the knowledge to properly apply this concept.\n\n\nI got the following Grasshopper breakpoint message: Grasshopper undo recording threw an exception source parameter is not linked to target parameter.\n\n\nHere is a screenshot with some details.\n\n\nSlidersModifiedBug\n1197×1203 94.8 KB\n\n\nHere is the GH File:\n\n\nSlidersModifiedBug_v1.gh\n (17.9 KB)\n\n\nTo recreate this bug just open the file and move the sliders in the “Merger Input Lenghts”, and then continue to move the sliders in the “Input: Sliders” group. The trick for triggering this bug is if you actually type a value on the slider and press “enter”, instead of dragging the slider with the mouse.\n\n\nI tried to record this, but for some reason windows does not register the additional window of the Grasshopper Breakpoint (eventhough it did show on my screen when recordin), but if it help anyone understand what I mean, this is the videorecording and just follow the same steps as I do… \n\n\n\n\nAnother weird thing is that this bug happens more often on the sliders between 10 and 50, I don’t know if that gives any useful clues.\n\n\nAnyways, I know it is a long shot, but I really wanted this functionality to ease the user interface with my grasshopper definition.\n\n\nIf there is anything I can do to help and make clearer the bug that I’m trying to point out (since it triggers in such weird conditions), just let me know.\n\n\nAgain, if anyone has any input, I would appreciate it!\n\n\nEdit: Removed the DLL from the GH file.",
  "code_blocks": [
    {
      "code": "using System;\nusing System.Collections;\nusing System.Collections.Generic;\n\nusing Rhino;\nusing Rhino.Geometry;\n\nusing Grasshopper;\nusing Grasshopper.Kernel;\nusing Grasshopper.Kernel.Data;\nusing Grasshopper.Kernel.Types;\nusing Grasshopper.Kernel.Special;\nusing System.Linq;\nusing Grasshopper.Kernel.Parameters;\nusing System.Reflection;\n\n/// <summary>\n/// This class will be instantiated on demand by the Script component.\n/// </summary>\npublic class Script_Instance : GH_ScriptInstance\n{\n  \n  /// <summary>\n  /// Gets the current iteration count. The first call to RunScript() is associated with Iteration==0.\n  /// Any subsequent call within the same solution will increment the Iteration count.\n  /// </summary>\n  private readonly int Iteration;\n\n  /// <summary>\n  /// This procedure contains the user code. Input parameters are provided as regular arguments,\n  /// Output parameters as ref arguments. You don't have to assign output parameters,\n  /// they will have a default value.\n  /// </summary>\n  private void RunScript(bool Reset, List<int> Merges)\n  {\n    //--------------------------------------------------------------------------------------------------------------------------------------------------\\\\\n    //---------------------------------------------------------- Code: Create Sliders for each segment -------------------------------------------------\\\\\n    //--------------------------------------------------------------------------------------------------------------------------------------------------\\\\\n    if (Reset || (_mergeParams.Count == 0 && _sliders.Count == 0))\n    {\n      // Clear Previous Data Sets\n      _mergeParams.Clear();\n      _sliders.Clear();\n\n      // Set New Data Sets\n      FindMergers(this.Component, this.GrasshopperDocument, ref _mergeParams);\n      FindSliders(this.Component, this.GrasshopperDocument, ref _sliders);\n    }\n\n    // Schedule Solution to update Grasshopper Canvas\n    this.GrasshopperDocument.ScheduleSolution(10, (GH_Document.GH_ScheduleDelegate)((d) =>\n    {\n      // Initializze Global Counter\n      int counter = 0;\n\n      // Connect Slider to Merger\n      for (int i = 0; i < Merges.Count; i++)\n      {\n        IGH_Param ejeMergeParam = _mergeParams[mergeParamsBaseName + i.ToString()] as IGH_Param;\n        ejeMergeParam.Sources.Clear();\n\n        for (int j = 0; j < Merges[i]; j++)\n        {\n          GH_NumberSlider iSlider = _sliders[counter.ToString()] as GH_NumberSlider;\n\n          ejeMergeParam.AddSource(iSlider, j);\n          counter++;\n        }\n      }\n    }));\n  }\n\n  // <Custom additional code> \n  // Define OuterScope Variables\n  Dictionary<string, IGH_DocumentObject> _mergeParams = new Dictionary<string, IGH_DocumentObject>();\n  Dictionary<string, IGH_DocumentObject> _sliders = new Dictionary<string, IGH_DocumentObject>();\n\n  string mergeParamsBaseName = \"Merge #\";\n\n\n  private bool FindMergers(IGH_Component ghComponent, GH_Document ghDocument , ref Dictionary<string, IGH_DocumentObject> mergeParams)\n  {\n    try\n    {\n      // Iterate over all objects in the document\n      foreach (var obj in ghDocument.Objects)\n      {\n        // Check if the object is a group\n        if (obj.GetType() == new GH_Group().GetType())\n        {\n          // Extract the group object\n          GH_Group parentGroup = (GH_Group)obj;\n\n          // Check if the group contains the component (verifying if the group is the correct one)\n          if (parentGroup.ObjectIDs.Contains(ghComponent.InstanceGuid) && parentGroup.NickName == \"Process: Mergers\")\n          {\n            // Find mergers in Parent Group and Add to Dictionary\n            foreach(Guid id in parentGroup.ObjectIDs)\n            {\n              var groupObj = this.GrasshopperDocument.FindObject(id, false);\n              if (!(groupObj == null) && groupObj is Param_Number) mergeParams[groupObj.NickName] = groupObj;\n            }\n          }\n        }\n      }\n      return true;\n    }\n\n    catch (Exception)\n    {\n      ghComponent.AddRuntimeMessage(GH_RuntimeMessageLevel.Warning, \"Failed to find Merger Components.\");\n      return false;\n    }\n  }\n\n\n  private bool FindSliders(IGH_Component ghComponent, GH_Document ghDocument, ref Dictionary<string, IGH_DocumentObject> mergeParams)\n  {\n    try\n    {\n      // Iterate over all objects in the document\n      foreach (var obj in ghDocument.Objects)\n      {\n        // Check if the object is a group\n        if (obj.GetType() == new GH_Group().GetType())\n        {\n          // Extract the group object\n          GH_Group parentGroup = (GH_Group)obj;\n\n          // Check if the group contains the component (verifying if the group is the correct one)\n          if (parentGroup.NickName == \"Input: Sliders\")\n          {\n            // Find mergers in Parent Group and Add to Dictionary\n            foreach (Guid id in parentGroup.ObjectIDs)\n            {\n              var groupObj = this.GrasshopperDocument.FindObject(id, false);\n              if (!(groupObj == null) && groupObj is GH_NumberSlider) mergeParams[groupObj.NickName] = groupObj;\n            }\n          }\n        }\n      }\n      return true;\n    }\n    catch (Exception)\n    {\n      ghComponent.AddRuntimeMessage(GH_RuntimeMessageLevel.Warning, \"Failed to find Merger Components.\");\n      return false;\n    }\n  }\n  // </Custom additional code> \n}",
      "language": "csharp",
      "author": "CallumSykes",
      "post_number": 3,
      "is_solution": false
    }
  ],
  "tags": [
    "csharp",
    "file-io",
    "geometry",
    "grasshopper",
    "python",
    "rhinocommon",
    "transformation"
  ],
  "has_accepted_answer": false,
  "category_id": 8,
  "posts_count": 20,
  "views": 378
}