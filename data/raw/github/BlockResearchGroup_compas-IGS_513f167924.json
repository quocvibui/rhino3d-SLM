{
  "source_url": "https://github.com/BlockResearchGroup/compas-IGS/blob/be44e0ba12ce1156015b02b0ab9dd61c8006fc85/src/compas_igs/forms/edgeattributes.py",
  "repo": "BlockResearchGroup/compas-IGS",
  "repo_stars": 1,
  "repo_description": "Rhino plugin for Interactive Graphic Statics using an algebraic graph-based approach to graphic statics",
  "license": "MIT",
  "filepath": "src/compas_igs/forms/edgeattributes.py",
  "instruction": "Edgeattributes",
  "code": "import ast\nfrom typing import Any\n\nimport Eto.Drawing  # type: ignore\nimport Eto.Forms  # type: ignore\nimport Rhino  # type: ignore\nimport Rhino.UI  # type: ignore\n\nfrom .attribute import Attribute\n\n\nclass EdgeAttributesForm(Eto.Forms.Dialog[bool]):\n    def __init__(\n        self,\n        attributes: list[Attribute],\n        edges: dict[tuple[int, int], Any],\n        title: str = \"Edge Attributes\",\n        width: int = 500,\n        height: int = 500,\n    ) -> None:\n        super().__init__()\n\n        def on_cell_formatting(sender, e):\n            if not e.Column.Editable:\n                e.ForegroundColor = Eto.Drawing.Colors.Gray\n\n            is_external = False\n            is_ind = False\n            is_compression = False\n            is_tension = False\n\n            for index, model in enumerate(self.attributes):\n                value = e.Item.GetValue(index + 2)\n                value = ast.literal_eval(value)\n\n                if model.name == \"f\":\n                    is_compression = value < 0\n                    is_tension = value > 0\n\n                elif model.name == \"is_external\":\n                    is_external = value\n\n                elif model.name == \"is_ind\":\n                    is_ind = value\n\n            if is_ind:\n                e.BackgroundColor = Eto.Drawing.Colors.Cyan\n                e.ForegroundColor = Eto.Drawing.Colors.White\n            elif is_external:\n                e.BackgroundColor = Eto.Drawing.Colors.Green\n                e.ForegroundColor = Eto.Drawing.Colors.White\n            elif is_compression:\n                e.BackgroundColor = Eto.Drawing.Colors.Blue\n                e.ForegroundColor = Eto.Drawing.Colors.White\n            elif is_tension:\n                e.BackgroundColor = Eto.Drawing.Colors.Red\n                e.ForegroundColor = Eto.Drawing.Colors.White\n\n        self.attributes = attributes\n        self.edges = edges\n\n        self.Title = title\n        self.Padding = Eto.Drawing.Padding(0)\n        self.Resizable = True\n        self.MinimumSize = Eto.Drawing.Size(0.5 * width, 0.5 * height)\n        self.ClientSize = Eto.Drawing.Size(width, height)\n\n        self.table = Eto.Forms.GridView()\n        self.table.ShowHeader = True\n        self.table.GridLines = Eto.Forms.GridLines.Horizontal\n        self.table.CellFormatting += on_cell_formatting\n\n        # index column\n        column = Eto.Forms.GridColumn()\n        column.HeaderText = \"Index\"\n        column.Editable = False\n        column.Expand = False\n        column.Width = 48\n        column.DataCell = Eto.Forms.TextBoxCell(0)\n        self.table.Columns.Add(column)\n\n        # edge column\n        column = Eto.Forms.GridColumn()\n        column.HeaderText = \"Edge\"\n        column.Editable = False\n        column.Expand = True\n        column.Width = 48\n        column.DataCell = Eto.Forms.TextBoxCell(1)\n        self.table.Columns.Add(column)\n\n        # attribute columns\n        for index, model in enumerate(self.attributes):\n            column = Eto.Forms.GridColumn()\n            column.HeaderText = model.text\n            column.Editable = model.editable\n            column.Expand = model.expand\n            if model.width != 0:\n                column.Width = model.width\n            column.DataCell = Eto.Forms.TextBoxCell(index + 2)\n            self.table.Columns.Add(column)\n\n        # edge data rows\n        rows = []\n        for index, edge in enumerate(self.edges):\n            values = [repr(index), repr(edge)]\n            for model in self.attributes:\n                value = self.edges[edge][model.name]\n                if not model.editable and model.value is float:\n                    value = round(value, 3)\n                values.append(repr(value))\n            row = Eto.Forms.GridItem()\n            row.Values = values\n            rows.append(row)\n        self.table.DataStore = rows\n\n        layout = Eto.Forms.DynamicLayout()\n        layout.BeginVertical(Eto.Drawing.Padding(0, 0, 0, 0), Eto.Drawing.Size(0, 0), True, True)\n        layout.AddRow(self.table)\n        layout.EndVertical()\n        layout.BeginVertical(Eto.Drawing.Padding(12, 18, 12, 24), Eto.Drawing.Size(6, 0), False, False)\n        layout.AddRow(None, self.ok, self.cancel)\n        layout.EndVertical()\n\n        self.Content = layout\n\n    @property\n    def ok(self):\n        self.DefaultButton = Eto.Forms.Button()\n        self.DefaultButton.Text = \"OK\"\n        self.DefaultButton.Click += self.on_ok\n        return self.DefaultButton\n\n    def on_ok(self, sender, event):\n        self.Close(True)\n\n    @property\n    def cancel(self):\n        self.AbortButton = Eto.Forms.Button()\n        self.AbortButton.Text = \"Cancel\"\n        self.AbortButton.Click += self.on_cancel\n        return self.AbortButton\n\n    def on_cancel(self, sender, event):\n        self.Close(False)\n\n    @property\n    def edgedata(self):\n        edges = {}\n        for row in self.table.DataStore:\n            edge = ast.literal_eval(row.getValue(1))\n            edges[edge] = {}\n            for i, model in enumerate(self.attributes):\n                if model.editable:\n                    edges[edge][model.name] = ast.literal_eval(row.GetValue(2 + i))\n                else:\n                    edges[edge][model.name] = self.edges[edge][model.name]\n        return edges\n\n    def show(self):\n        return self.ShowModal(Rhino.UI.RhinoEtoApp.MainWindow)\n",
  "language": "python",
  "imports": [
    "Rhino"
  ],
  "has_docstring": false
}