{
  "source_url": "https://discourse.mcneel.com/t/get-point-in-pointcloud-by-index/37468",
  "topic_id": 37468,
  "title": "Get point in pointcloud by index",
  "question": "I’ve been using rhino.geometry.pointcloud to do closest point calculations, but closestpoint() only returns an index. How do I extract a pointcloud \npoint\n by index? I’m trying to get the first, second and third closest points- maybe there is a faster way? I’m scripting via GhPython.\n\n\n        import Rhino.Geometry as rg\n       \n        #basept and mypoints are supplied\n        ptcloud=rg.PointCloud(mypoints)\n        closestpt=[]\n        index=[]\n        dist=[]\n        for i in range(3): #repeat 3 times\n            index.append(_ptcloud.ClosestPoint(basept))\n            closestpt.append(ptcloud.GetPoints()[index[-1]])\n            dist.append(rg.Point3d.DistanceTo(_pt,closestpt[-1]))\n            ptcloud.RemoveAt(index[-1])\n\n\n\nI’m doing this for thousands of base points and pointclouds. GetPoints() seems to be slowing things down, especially since it is getting all points when I only need one.\n\n\nCould rg.PointCloud.Item be a solution? It does not take any arguments though…",
  "code_blocks": [
    {
      "code": "import Rhino.Geometry as rg\n       \n        #basept and mypoints are supplied\n        ptcloud=rg.PointCloud(mypoints)\n        closestpt=[]\n        index=[]\n        dist=[]\n        for i in range(3): #repeat 3 times\n            index.append(_ptcloud.ClosestPoint(basept))\n            closestpt.append(ptcloud.GetPoints()[index[-1]])\n            dist.append(rg.Point3d.DistanceTo(_pt,closestpt[-1]))\n            ptcloud.RemoveAt(index[-1])",
      "language": "python",
      "author": "lawrenceyy",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "csharp",
    "file-io",
    "geometry",
    "grasshopper",
    "python",
    "rhinocommon",
    "transformation"
  ],
  "has_accepted_answer": false,
  "category_id": 11,
  "posts_count": 5,
  "views": 1452
}