{
  "source_url": "https://github.com/localsoftware/localsoftware_rhino-grasshopper/blob/4aafec57e33b9f09cce6fd73dcda12b17cf794a5/python/PickleData.py",
  "repo": "localsoftware/localsoftware_rhino-grasshopper",
  "repo_stars": 0,
  "repo_description": null,
  "license": "BSD-2-Clause",
  "filepath": "python/PickleData.py",
  "instruction": "Serializes Rhino data into a binary file.",
  "code": "\"\"\"Serializes Rhino data into a binary file.\n\nExports geometry into Python pickles that can be imported again later.\nPickles are a faster, lighter, and more efficient way to manage files than Rhino files.\nGeometry is serialized into pickles, which is a Python binary file.\nBased on the work of Jackie Berry.\n\n    Typical usage:\n        Plug in the geometry you want to export into the data input of the component.\n        The geometry should be flattened. Plug in a slider or number to the siteNumber input of the component.\n        Pickle’s numbers always need to start with number one. This will name the pickle according to a specific site.\n        If you’re only working with one site, you can leave the siteNumber empty. Use a panel to type a layer name for the geometry you are exporting.\n        Plug the panel into the layer input of the component. Specify a path for the pickles. This will be the folder where the pickles will be exported to.\n        Finally plug a boolean toggle component to the write input of the component and set it to 'True'.\n\n\n    Inputs:\n        data: geometry or data to serialize\n        siteNumber: local code site number (optional)\n        path: path of directory for target binary file.\n        layer: name of file\n        Write: boolean\n\n    Outputs:\n        geometry: a data tree with serialized geometry\"\"\"\n\n__author__ = \"palomagr\"\n__version__ = \"2020.07.09\"\n\n#ghenv.Component.Name = \"Pickle Data\"\n#ghenv.Component.NickName = \"Pickle Data\"\n\nfrom ghpythonlib.componentbase import executingcomponent as component\nimport Grasshopper, GhPython, System, Rhino, os\nimport rhinoscriptsyntax as rs\nimport scriptcontext as sc\nimport cPickle as pickle\n\nclass MyComponent(component):\n\n    def RunScript(self, data, siteNumber, layer, path, write):\n        geometry = None\n        if path!=None and len(data)>0 and layer!=None and write==True:\n            try:\n                if siteNumber!=None:\n                    filename = os.path.join(path,str(int(siteNumber))+layer)\n                else:\n                    filename = os.path.join(path,layer)\n\n                f = open(filename, 'wb')\n                pickle.dump(data, f, -1)\n\n                f.close()\n                fcheck = open(filename,'rb')\n                geometry = pickle.load(fcheck)\n                if len(geometry)>0:\n                    print \"file pickled successfully.\"\n                else:\n                    print \"the file didn't save correctly, check your input data.\"\n                fcheck.close()\n            except:\n                print \"There was a problem saving the file. \\nThe path your provided may be invalid.\"\n\n        else:\n            if not len(data)>0:\n                geometry = \"please add data or geometry you want to pickle.\"\n            if layer==None:\n                geometry = \"please provide target file layer name.\"\n            if path==None:\n                geometry = \"please provide target directory for pickle file.\"\n            if write!=True:\n                geometry = \"set write to True to save the file.\"\n            else:\n                geometry = \"something else went wrong, please check your inputs.\"\n\n        # return outputs if you have them; here I try it for you:\n        return geometry\n",
  "language": "python",
  "imports": [
    "ghpythonlib",
    "rhinoscriptsyntax",
    "scriptcontext"
  ],
  "has_docstring": true
}