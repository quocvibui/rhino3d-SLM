{
  "source_url": "https://discourse.mcneel.com/t/viewcapturesettings-not-captured/208808",
  "topic_id": 208808,
  "title": "ViewCaptureSettings - not captured",
  "question": "Hi guys.\n\n\nWhen i capture screenshot of what is inside of rectangle, it not take me 3D text tag .\n\n\nIt capture this.\n\n\nobrazek\n787×538 65.4 KB\n\n\nAnd I need this.\n\n\nobrazek\n645×448 37.6 KB\n\n\nHave you any idea what to change to capture it ?\n\n\nThank you\n\n\nscreenRectCapture.gh\n (4.6 KB)\n\n\nimport Rhino.Display as rd\nimport scriptcontext as sc\nimport System, operator\n\n\nghenv.Component.Message = \"CaptureRect\"\n\n\ndef CaptureRect():\n    view = sc.doc.Views.ActiveView\n    size = System.Drawing.Size(rect.Width*20, rect.Height*20) \n\n    settings = rd.ViewCaptureSettings(view, size, 300) #view, size, dpi\n    settings.SetWindowRect(rect.Corner(1), rect.Corner(3))\n    settings.RasterMode = True\n    settings.DrawGrid = False\n    settings.DrawAxis = False\n    settings.DrawBackground = True\n\n    bitmap = rd.ViewCapture.CaptureToBitmap(settings)\n    if bitmap:\n        bitmap.Save(path)\n\n\nif save:\n    CaptureRect()",
  "code_blocks": [
    {
      "code": "import Rhino.Display as rd\nimport scriptcontext as sc\nimport System, operator\n\n\nghenv.Component.Message = \"CaptureRect\"\n\n\ndef CaptureRect():\n    view = sc.doc.Views.ActiveView\n    size = System.Drawing.Size(rect.Width*20, rect.Height*20) \n\n    settings = rd.ViewCaptureSettings(view, size, 300) #view, size, dpi\n    settings.SetWindowRect(rect.Corner(1), rect.Corner(3))\n    settings.RasterMode = True\n    settings.DrawGrid = False\n    settings.DrawAxis = False\n    settings.DrawBackground = True\n\n    bitmap = rd.ViewCapture.CaptureToBitmap(settings)\n    if bitmap:\n        bitmap.Save(path)\n\n\nif save:\n    CaptureRect()",
      "language": "python",
      "author": "Karel_Pěnička",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "file-io",
    "python"
  ],
  "has_accepted_answer": false,
  "category_id": 11,
  "posts_count": 2,
  "views": 49
}