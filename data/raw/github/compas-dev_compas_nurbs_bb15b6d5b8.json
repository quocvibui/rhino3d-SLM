{
  "source_url": "https://github.com/compas-dev/compas_nurbs/blob/a64f3a024d660d4df40a6d5838fbc14c1421d873/src/compas_nurbs/ghpython/geometry.py",
  "repo": "compas-dev/compas_nurbs",
  "repo_stars": 12,
  "repo_description": "NURBS for COMPAS",
  "license": "MIT",
  "filepath": "src/compas_nurbs/ghpython/geometry.py",
  "instruction": "Geometry",
  "code": "import compas\nfrom compas_nurbs import Curve\nfrom compas_nurbs import RationalCurve\nfrom compas_nurbs import Surface\nfrom compas_nurbs import RationalSurface\nfrom compas_nurbs.utilities import reshape\n\nif compas.RHINO:\n    from compas_rhino.geometry import RhinoCurve as BaseRhinoCurve\n    from compas_rhino.geometry import RhinoSurface as BaseRhinoSurface\n\n    class RhinoCurve(BaseRhinoCurve):\n\n        @classmethod\n        def from_geometry(cls, geometry):\n            curve = cls()\n            curve.geometry = geometry\n            return curve\n\n        def to_compas(self):\n            control_points = [[p.X, p.Y, p.Z] for p in self.geometry.Points]\n            knot_vector = [k for k in self.geometry.Knots]\n            knot_vector = [knot_vector[0]] + knot_vector + [knot_vector[-1]]\n            weights = [p.Weight for p in self.geometry.Points]\n            if all([w == 1. for w in weights]):\n                return Curve(control_points, self.geometry.Degree, knot_vector)\n            else:\n                return RationalCurve(control_points, self.geometry.Degree, knot_vector, weights=weights)\n\n    class RhinoSurface(BaseRhinoSurface):\n\n        @classmethod\n        def from_geometry(cls, geometry):\n            surface = cls()\n            surface.geometry = geometry\n            return surface\n\n        def to_compas(self):\n            surface = self.geometry\n            knot_vector_u = list(surface.KnotsU)\n            knot_vector_v = list(surface.KnotsV)\n            knot_vector_u = [knot_vector_u[0]] + knot_vector_u + [knot_vector_u[-1]]\n            knot_vector_v = [knot_vector_v[0]] + knot_vector_v + [knot_vector_v[-1]]\n            knot_vector = knot_vector_u, knot_vector_v\n            degree = surface.Degree(0), surface.Degree(1)\n            points = [[p.X, p.Y, p.Z] for p in surface.Points]\n            weights = [p.Weight for p in surface.Points]\n            count_u = surface.Points.CountU\n            count_v = surface.Points.CountV\n            points = reshape(points, (count_u, count_v))\n            if all([w == 1. for w in weights]):\n                return Surface(points, degree, knot_vector)\n            else:\n                weights = reshape(weights, (count_u, count_v))\n                return RationalSurface(points, degree, knot_vector, weights=weights)\n",
  "language": "python",
  "imports": [],
  "has_docstring": false
}