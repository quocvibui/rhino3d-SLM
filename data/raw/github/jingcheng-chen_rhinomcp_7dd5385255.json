{
  "source_url": "https://github.com/jingcheng-chen/rhinomcp/blob/615f0eae092d3d129f07fde519b28ca10d31dd6e/rhino_mcp_server/static/light.py",
  "repo": "jingcheng-chen/rhinomcp",
  "repo_stars": 299,
  "repo_description": "RhinoMCP connects Rhino 3D to AI Agent through the Model Context Protocol (MCP)",
  "license": "Apache-2.0",
  "filepath": "rhino_mcp_server/static/light.py",
  "instruction": null,
  "code": "import math\n\nimport Rhino.Geometry\n\nimport scriptcontext\n\nimport rhinocompat as compat\nfrom rhinoscript import utility as rhutil\n\n\ndef __coercelight(id, raise_if_missing=False):\n    light = rhutil.coercegeometry(id)\n    if isinstance(light, Rhino.Geometry.Light): return light\n    if raise_if_missing: raise ValueError(\"unable to retrieve light from %s\"%id)\n\n\ndef AddDirectionalLight(start_point, end_point):\n    \"\"\"Adds a new directional light object to the document\n    Parameters:\n      start_point(point): starting point of the light\n      end_point (point): ending point and direction of the light\n    Returns:\n      (guid): identifier of the new object if successful\n    Example:\n      import rhinoscriptsyntax as rs\n      end = rs.GetPoint(\"End of light vector direction\")\n      if end:\n          start = rs.GetPoint(\"Start of light vector direction\", end)\n          if start: rs.AddDirectionalLight( start, end )\n    See Also:\n      IsDirectionalLight\n    \"\"\"\n    start = rhutil.coerce3dpoint(start_point, True)\n    end = rhutil.coerce3dpoint(end_point, True)\n    light = Rhino.Geometry.Light()\n    light.LightStyle = Rhino.Geometry.LightStyle.WorldDirectional\n    light.Location = start\n    light.Direction = end-start\n    index = scriptcontext.doc.Lights.Add(light)\n    if index<0: raise Exception(\"unable to add light to LightTable\")\n    rc = scriptcontext.doc.Lights[index].Id\n    scriptcontext.doc.Views.Redraw()\n    return rc\n\n\ndef AddLinearLight(start_point, end_point, width=None):\n    \"\"\"Adds a new linear light object to the document\n    Parameters:\n      start_point (point): starting point of the light\n      end_point (point): ending point and direction of the light\n      width (number): width of the light\n    Returns:\n      guid: identifier of the new object if successful\n      None: on error\n    Example:\n      import rhinoscriptsyntax as rs\n      start = rs.GetPoint(\"Light origin\")\n      if start:\n          end = rs.GetPoint(\"Light length and direction\", start)\n          if end: rs.AddLinearLight(start, end)\n    See Also:\n      IsLinearLight\n    \"\"\"\n    start = rhutil.coerce3dpoint(start_point, True)\n    end = rhutil.coerce3dpoint(end_point, True)\n    if width is None:\n        radius=0.5\n        units = scriptcontext.doc.ModelUnitSystem\n        if units!=compat.ENUM_NONE(Rhino.UnitSystem):\n            scale = Rhino.RhinoMath.UnitScale(Rhino.UnitSystem.Inches, units)\n            radius *= scale\n        width = radius\n    light = Rhino.Geometry.Light()\n    light.LightStyle = Rhino.Geometry.LightStyle.WorldLinear\n    light.Location = start\n    v = end-start\n    light.Direction = v\n    light.Length = light.Direction\n    light.Width = -light.Width\n    plane = Rhino.Geometry.Plane(light.Location, light.Direction)\n    xaxis = plane.XAxis\n    xaxis.Unitize()\n    plane.XAxis = xaxis\n    light.Width = xaxis * min(width, v.Length/20)\n    #light.Location = start - light.Direction\n    index = scriptcontext.doc.Lights.Add(light)\n    if index<0: raise Exception(\"unable to add light to LightTable\")\n    rc = scriptcontext.doc.Lights[index].Id\n    scriptcontext.doc.Views.Redraw()\n    return rc\n\n\ndef AddPointLight(point):\n    \"\"\"Adds a new point light object to the document\n    Parameters:\n      point (point): the 3d location of the point\n    Returns:\n      guid: identifier of the new object if successful\n    Example:\n      import rhinoscriptsyntax as rs\n      point = rs.GetPoint(\"Point light location\")\n      if point: rs.AddPointLight(point)\n    See Also:\n      IsPointLight\n    \"\"\"\n    point = rhutil.coerce3dpoint(point, True)\n    light = Rhino.Geometry.Light()\n    light.LightStyle = Rhino.Geometry.LightStyle.WorldPoint\n    light.Location = point\n    index = scriptcontext.doc.Lights.Add(light)\n    if index<0: raise Exception(\"unable to add light to LightTable\")\n    rc = scriptcontext.doc.Lights[index].Id\n    scriptcontext.doc.Views.Redraw()\n    return rc\n\n\ndef AddRectangularLight(origin, width_point, height_point):\n    \"\"\"Adds a new rectangular light object to the document\n    Parameters:\n      origin (point): 3d origin point of the light\n      width_point (point): 3d width and direction point of the light\n      height_point (point): 3d height and direction point of the light\n    Returns:\n      guid: identifier of the new object if successful\n    Example:\n      import rhinoscriptsyntax as rs\n      rect = rs.GetRectangle(2)\n      if rect: rs.AddRectangularLight( rect[0], rect[1], rect[3] )\n    See Also:\n      IsRectangularLight\n    \"\"\"\n    origin = rhutil.coerce3dpoint(origin, True)\n    ptx = rhutil.coerce3dpoint(width_point, True)\n    pty = rhutil.coerce3dpoint(height_point, True)\n    length = pty-origin\n    width = ptx-origin\n    normal = Rhino.Geometry.Vector3d.CrossProduct(width, length)\n    normal.Unitize()\n    light = Rhino.Geometry.Light()\n    light.LightStyle = Rhino.Geometry.LightStyle.WorldRectangular\n    light.Location = origin\n    light.Width = width\n    light.Length = length\n    light.Direction = normal\n    index = scriptcontext.doc.Lights.Add(light)\n    if index<0: raise Exception(\"unable to add light to LightTable\")\n    rc = scriptcontext.doc.Lights[index].Id\n    scriptcontext.doc.Views.Redraw()\n    return rc\n\n\ndef AddSpotLight(origin, radius, apex_point):\n    \"\"\"Adds a new spot light object to the document\n    Parameters:\n      origin (point): 3d origin point of the light\n      radius (number):  radius of the cone\n      apex_point (point): 3d apex point of the light\n    Returns:\n      guid: identifier of the new object\n    Example:\n      import rhinoscriptsyntax as rs\n      radius = 5.0\n      origin = rs.GetPoint(\"Base of cone\")\n      if origin:\n          apex = rs.GetPoint(\"End of cone\", origin)\n          if apex: rs.AddSpotLight(origin, radius, apex)\n    See Also:\n      IsSpotLight\n      SpotLightHardness\n      SpotLightShadowIntensity\n    \"\"\"\n    origin = rhutil.coerce3dpoint(origin, True)\n    apex_point = rhutil.coerce3dpoint(apex_point, True)\n    if radius<0: radius=1.0\n    light = Rhino.Geometry.Light()\n    light.LightStyle = Rhino.Geometry.LightStyle.WorldSpot\n    light.Location = apex_point\n    light.Direction = origin-apex_point\n    light.SpotAngleRadians = math.atan(radius / (light.Direction.Length))\n    light.HotSpot = 0.50\n    index = scriptcontext.doc.Lights.Add(light)\n    if index<0: raise Exception(\"unable to add light to LightTable\")\n    rc = scriptcontext.doc.Lights[index].Id\n    scriptcontext.doc.Views.Redraw()\n    return rc\n\n\ndef EnableLight(object_id, enable=None):\n    \"\"\"Enables or disables a light object\n    Parameters:\n      object_id (guid): the light object's identifier\n      enable (bool, optional): the light's enabled status\n    Returns:\n      bool: if enable is not specified, the current enabled status\n      bool: if enable is specified, the previous enabled status\n      None: on error\n    Example:\n      import rhinoscriptsyntax as rs\n      id = rs.GetObject(\"Select light\", rs.filter.light)\n      if id: rs.EnableLight( id, False )\n    See Also:\n      IsLight\n      IsLightEnabled\n      LightColor\n      LightCount\n      LightName\n      LightObjects\n    \"\"\"\n    light = __coercelight(object_id, True)\n    rc = light.IsEnabled\n    if enable is not None and enable!=rc:\n        light.IsEnabled = enable\n        id = rhutil.coerceguid(object_id)\n        if not scriptcontext.doc.Lights.Modify(id, light):\n            return scriptcontext.errorhandler()\n        scriptcontext.doc.Views.Redraw()\n    return rc\n\n\ndef IsDirectionalLight(object_id):\n    \"\"\"Verifies a light object is a directional light\n    Parameters:\n      object_id (guid): the light object's identifier\n    Returns:\n      bool: True or False\n    Example:\n      import rhinoscriptsyntax as rs\n      id = rs.GetObject(\"Select a light\", rs.filter.light)\n      if rs.IsDirectionalLight(id):\n          print(\"The object is a directional light.\")\n      else:\n          print(\"The object is not a directional light.\")\n    See Also:\n      AddDirectionalLight\n    \"\"\"\n    light = __coercelight(object_id, True)\n    return light.IsDirectionalLight\n\n\ndef IsLight(object_id):\n    \"\"\"Verifies an object is a light object\n    Parameters:\n      object_id (guid): the light object's identifier\n    Returns:\n      bool: True or False\n    Example:\n      import rhinoscriptsyntax as rs\n      id = rs.GetObject(\"Select a light\")\n      if rs.IsLight(id):\n          print(\"The object is a light.\")\n      else:\n          print(\"The object is not a light.\")\n    See Also:\n      EnableLight\n      IsLightEnabled\n      LightColor\n      LightCount\n      LightName\n      LightObjects\n    \"\"\"\n    light = __coercelight(object_id, False)\n    return light is not None\n\n\ndef IsLightEnabled(object_id):\n    \"\"\"Verifies a light object is enabled\n    Parameters:\n      object_id (guid): the light object's identifier\n    Returns:\n      bool: True or False\n    Example:\n      import rhinoscriptsyntax as rs\n      id = rs.GetObject(\"Select a light\", rs.filter.light)\n      if rs.IsLightEnabled(id):\n          print(\"The light is enabled (on).\")\n      else:\n          print(\"The light is disabled (off).\")\n    See Also:\n      EnableLight\n      IsLight\n      LightColor\n      LightCount\n      LightName\n      LightObjects\n    \"\"\"\n    light = __coercelight(object_id, True)\n    return light.IsEnabled\n\n\ndef IsLightReference(object_id):\n    \"\"\"Verifies a light object is referenced from another file\n    Parameters:\n      object_id (guid): the light object's identifier\n    Returns:\n      bool: True or False\n    Example:\n      import rhinoscriptsyntax as rs\n      id = rs.GetObject(\"Select a light\", rs.filter.light)\n      if rs.IsLightReference(id):\n          print(\"The light is a reference object.\")\n      else:\n          print(\"The light is not a reference object.\")\n    See Also:\n      IsObjectReference\n    \"\"\"\n    light = __coercelight(object_id, True)\n    return light.IsReference\n\n\ndef IsLinearLight(object_id):\n    \"\"\"Verifies a light object is a linear light\n    Parameters:\n      object_id (guid): the light object's identifier\n    Returns:\n      bool: True or False\n    Example:\n      import rhinoscriptsyntax as rs\n      id = rs.GetObject(\"Select a light\", rs.filter.light)\n      if rs.IsLinearLight(id):\n          print(\"The object is a linear light.\")\n      else:\n          print(\"The object is not a linear light.\")\n    See Also:\n      AddLinearLight\n    \"\"\"\n    light = __coercelight(object_id, True)\n    return light.IsLinearLight\n\n\ndef IsPointLight(object_id):\n    \"\"\"Verifies a light object is a point light\n    Parameters:\n      object_id (guid): the light object's identifier\n    Returns:\n      bool: True or False\n    Example:\n      import rhinoscriptsyntax as rs\n      id = rs.GetObject(\"Select a light\", rs.filter.light)\n      if rs.IsPointLight(id):\n          print(\"The object is a point light.\")\n      else:\n          print(\"The object is not a point light.\")\n    See Also:\n      AddPointLight\n    \"\"\"\n    light = __coercelight(object_id, True)\n    return light.IsPointLight\n\n\ndef IsRectangularLight(object_id):\n    \"\"\"Verifies a light object is a rectangular light\n    Parameters:\n      object_id (guid): the light object's identifier\n    Returns:\n      bool: True or False\n    Example:\n      import rhinoscriptsyntax as rs\n      id = rs.GetObject(\"Select a light\", rs.filter.light)\n      if rs.IsRectangularLight(id):\n          print(\"The object is a rectangular light.\")\n      else:\n          print(\"The object is not a rectangular light.\")\n    See Also:\n      AddRectangularLight\n    \"\"\"\n    light = __coercelight(object_id, True)\n    return light.IsRectangularLight\n\n\ndef IsSpotLight(object_id):\n    \"\"\"Verifies a light object is a spot light\n    Parameters:\n      object_id (guid): the light object's identifier\n    Returns:\n      bool: True or False\n    Example:\n      import rhinoscriptsyntax as rs\n      id = rs.GetObject(\"Select a light\", rs.filter.light)\n      if rs.IsSpotLight(id):\n          print(\"The object is a spot light.\")\n      else:\n          print(\"The object is not a spot light.\")\n    See Also:\n      AddSpotLight\n      SpotLightHardness\n      SpotLightShadowIntensity\n    \"\"\"\n    light = __coercelight(object_id, True)\n    return light.IsSpotLight\n\n\ndef LightColor(object_id, color=None):\n    \"\"\"Returns or changes the color of a light\n    Parameters:\n      object_id (guid): the light object's identifier\n      color (color, optional): the light's new color\n    Returns:\n      color: if color is not specified, the current color\n      color: if color is specified, the previous color\n    Example:\n      import rhinoscriptsyntax as rs\n      id = rs.GetObject(\"Select a light\", rs.filter.light)\n      if id: rs.LightColor( id, (0,255,255) )\n    See Also:\n      EnableLight\n      IsLight\n      IsLightEnabled\n      LightCount\n      LightName\n      LightObjects\n    \"\"\"\n    light = __coercelight(object_id, True)\n    rc = light.Diffuse\n    if color:\n        color = rhutil.coercecolor(color, True)\n        if color!=rc:\n            light.Diffuse = color\n            id = rhutil.coerceguid(object_id, True)\n            if not scriptcontext.doc.Lights.Modify(id, light):\n                return scriptcontext.errorhandler()\n            scriptcontext.doc.Views.Redraw()\n    return rc\n\n\ndef LightCount():\n    \"\"\"Returns the number of light objects in the document\n    Returns:\n      number: the number of light objects in the document\n    Example:\n      import rhinoscriptsyntax as rs\n      print(\"There are {} lights\".format(rs.LightCount()))\n    See Also:\n      EnableLight\n      IsLight\n      IsLightEnabled\n      LightColor\n      LightName\n      LightObjects\n    \"\"\"\n    return scriptcontext.doc.Lights.Count\n\n\ndef LightDirection(object_id, direction=None):\n    \"\"\"Returns or changes the direction of a light object\n    Parameters:\n      object_id (guid): the light object's identifier\n      direction (vector, optional): the light's new direction\n    Returns:\n      vector: if direction is not specified, the current direction\n      vector: if direction is specified, the previous direction\n    Example:\n      import rhinoscriptsyntax as rs\n      id = rs.GetObject(\"Select a light\", rs.filter.light)\n      if id: print( rs.LightDirection(id) )\n    See Also:\n      IsLight\n      LightLocation\n    \"\"\"\n    light = __coercelight(object_id, True)\n    rc = light.Direction\n    if direction:\n        direction = rhutil.coerce3dvector(direction, True)\n        if direction!=rc:\n            light.Direction = direction\n            id = rhutil.coerceguid(object_id, True)\n            if not scriptcontext.doc.Lights.Modify(id, light):\n                return scriptcontext.errorhandler()\n            scriptcontext.doc.Views.Redraw()\n    return rc\n\n\ndef LightLocation(object_id, location=None):\n    \"\"\"Returns or changes the location of a light object\n    Parameters:\n      object_id (guid): the light object's identifier\n      location (point, optional): the light's new location\n    Returns:\n      point: if location is not specified, the current location\n      point: if location is specified, the previous location\n    Example:\n      import rhinoscriptsyntax as rs\n      id = rs.GetObject(\"Select a light\", rs.filter.light)\n      if id: rs.AddPoint( rs.LightLocation(id) )\n    See Also:\n      IsLight\n      LightDirection\n    \"\"\"\n    light = __coercelight(object_id, True)\n    rc = light.Location\n    if location:\n        location = rhutil.coerce3dpoint(location, True)\n        if location!=rc:\n            light.Location = location\n            id = rhutil.coerceguid(object_id, True)\n            if not scriptcontext.doc.Lights.Modify(id, light):\n                return scriptcontext.errorhandler()\n            scriptcontext.doc.Views.Redraw()\n    return rc\n\n\ndef LightName(object_id, name=None):\n    \"\"\"Returns or changes the name of a light object\n    Parameters:\n      object_id (guid): the light object's identifier\n      name (str, optional): the light's new name\n    Returns:\n      str: if name is not specified, the current name\n      str: if name is specified, the previous name\n    Example:\n      import rhinoscriptsyntax as rs\n      id = rs.GetObject(\"Select a light\", rs.filter.light)\n      if id:\n          name = rs.GetString(\"New light name\")\n          if name: rs.LightName(id, name)\n    See Also:\n      EnableLight\n      IsLight\n      IsLightEnabled\n      LightColor\n      LightCount\n      LightObjects\n    \"\"\"\n    light = __coercelight(object_id, True)\n    rc = light.Name\n    if name and name!=rc:\n        light.Name = name\n        id = rhutil.coerceguid(object_id, True)\n        if not scriptcontext.doc.Lights.Modify(id, light):\n            return scriptcontext.errorhandler()\n        scriptcontext.doc.Views.Redraw()\n    return rc\n\n\ndef LightObjects():\n    \"\"\"Returns list of identifiers of light objects in the document\n    Returns:\n      list(guid, ...): the list of identifiers of light objects in the document\n    Example:\n      import rhinoscriptsyntax as rs\n      lights = rs.LightObjects()\n      if lights:\n          rs.AddLayer( \"Lights\" )\n          for light in lights: rs.ObjectLayer( light, \"Lights\" )\n    See Also:\n      EnableLight\n      IsLight\n      IsLightEnabled\n      LightColor\n      LightCount\n      LightName\n    \"\"\"\n    count = scriptcontext.doc.Lights.Count\n    rc = []\n    for i in range(count):\n        rhlight = scriptcontext.doc.Lights[i]\n        if not rhlight.IsDeleted: rc.append(rhlight.Id)\n    return rc\n\n\ndef RectangularLightPlane(object_id):\n    \"\"\"Returns the plane of a rectangular light object\n    Parameters:\n      object_id (guid): the light object's identifier\n    Returns:\n      plane: the plane if successful\n      None: on error\n    Example:\n      import rhinoscriptsyntax as rs\n      id = rs.GetObject(\"Select a rectangular light\", rs.filter.light)\n      if id:\n          rc = rs.RectangularLightPlane(id)\n          if rc:\n              plane, extents = rc\n              rs.AddPlaneSurface( plane, extents[0], extents[1] )\n    See Also:\n      IsRectangularLight\n    \"\"\"\n    light = __coercelight(object_id, True)\n    if light.LightStyle!=Rhino.Geometry.LightStyle.WorldRectangular:\n        return scriptcontext.errorhandler()\n    location = light.Location\n    length = light.Length\n    width = light.Width\n    direction = light.Direction\n    plane = Rhino.Geometry.Plane(location, length, width)\n    return plane, (length.Length, width.Length)\n\n\ndef SpotLightHardness(object_id, hardness=None):\n    \"\"\"Returns or changes the hardness of a spot light. Spotlight hardness\n    controls the fully illuminated region.\n    Parameters:\n      object_id (guid): the light object's identifier\n      hardness (number, optional): the light's new hardness\n    Returns:\n      number: if hardness is not specified, the current hardness\n      number: if hardness is specified, the previous hardness\n    Example:\n      import rhinoscriptsyntax as rs\n      id = rs.GetObject(\"Select a light\", rs.filter.light)\n      if id: rs.SpotLightHardness(id, 0.75)\n    See Also:\n      AddSpotLight\n      IsSpotLight\n      SpotLightRadius\n      SpotLightShadowIntensity\n    \"\"\"\n    light = __coercelight(object_id, True)\n    if light.LightStyle!=Rhino.Geometry.LightStyle.WorldSpot:\n        return scriptcontext.errorhandler()\n    rc = light.HotSpot\n    if hardness and hardness!=rc:\n        light.HotSpot = hardness\n        id = rhutil.coerceguid(object_id, True)\n        if not scriptcontext.doc.Lights.Modify(id, light):\n            return scriptcontext.errorhandler()\n        scriptcontext.doc.Views.Redraw()\n    return rc\n\n\ndef SpotLightRadius(object_id, radius=None):\n    \"\"\"Returns or changes the radius of a spot light.\n    Parameters:\n      object_id (guid): the light object's identifier\n      radius (number, optional): the light's new radius\n    Returns:\n      number: if radius is not specified, the current radius\n      number: if radius is specified, the previous radius\n    Example:\n      import rhinoscriptsyntax as rs\n      id = rs.GetObject(\"Select a light\", rs.filter.light)\n      if id: rs.SpotLightRadius(id, 5.0)\n    See Also:\n      AddSpotLight\n      IsSpotLight\n      SpotLightHardness\n      SpotLightShadowIntensity\n    \"\"\"\n    light = __coercelight(object_id, True)\n    if light.LightStyle!=Rhino.Geometry.LightStyle.WorldSpot:\n        return scriptcontext.errorhandler()\n    radians = light.SpotAngleRadians\n    rc = light.Direction.Length * math.tan(radians)\n    if radius and radius!=rc:\n        radians = math.atan(radius/light.Direction.Length)\n        light.SpotAngleRadians = radians\n        id = rhutil.coerceguid(object_id, True)\n        if not scriptcontext.doc.Lights.Modify(id, light):\n            return scriptcontext.errorhandler()\n        scriptcontext.doc.Views.Redraw()\n    return rc\n\n\ndef SpotLightShadowIntensity(object_id, intensity=None):\n    \"\"\"Returns or changes the shadow intensity of a spot light.\n    Parameters:\n      object_id (guid): the light object's identifier\n      intensity (number, optional): the light's new intensity\n    Returns:\n      number: if intensity is not specified, the current intensity\n      number: if intensity is specified, the previous intensity\n    Example:\n      import rhinoscriptsyntax as rs\n      id = rs.GetObject(\"Select a light\", rs.filter.light)\n      if id: rs.SpotLightShadowIntensity(id, 0.75)\n    See Also:\n      AddSpotLight\n      IsSpotLight\n      SpotLightHardness\n      SpotLightRadius\n    \"\"\"\n    light = __coercelight(object_id, True)\n    if light.LightStyle!=Rhino.Geometry.LightStyle.WorldSpot:\n        return scriptcontext.errorhandler()\n    rc = light.SpotLightShadowIntensity\n    if intensity and intensity!=rc:\n        light.SpotLightShadowIntensity = intensity\n        id = rhutil.coerceguid(object_id, True)\n        if not scriptcontext.doc.Lights.Modify(id, light):\n            return scriptcontext.errorhandler()\n        scriptcontext.doc.Views.Redraw()\n    return rc\n",
  "language": "python",
  "imports": [
    "Rhino",
    "Rhino.Geometry",
    "rhinoscriptsyntax",
    "scriptcontext"
  ],
  "has_docstring": false
}