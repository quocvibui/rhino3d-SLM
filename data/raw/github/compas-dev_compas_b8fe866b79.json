{
  "source_url": "https://github.com/compas-dev/compas/blob/HEAD/src/compas_rhino/geometry/booleans.py",
  "repo": "compas-dev/compas",
  "repo_stars": 352,
  "repo_description": "Main library of the COMPAS framework and CAD integrations for Rhino/GH and Blender.",
  "license": "MIT",
  "filepath": "src/compas_rhino/geometry/booleans.py",
  "instruction": "Booleans",
  "code": "from __future__ import absolute_import\nfrom __future__ import division\nfrom __future__ import print_function\n\nimport Rhino  # type: ignore\n\nfrom compas.plugins import plugin\n\n\n@plugin(category=\"booleans\", requires=[\"Rhino\"])\ndef boolean_union_mesh_mesh(A, B, remesh=False):\n    \"\"\"Compute the boolean union of two triangle meshes.\n\n    Parameters\n    ----------\n    A : tuple[sequence[[float, float, float] | :class:`compas.geometry.Point`], sequence[[int, int, int]]]\n        The vertices and faces of mesh A.\n    B : tuple[sequence[[float, float, float] | :class:`compas.geometry.Point`], sequence[[int, int, int]]]\n        The vertices and faces of mesh B.\n    remesh : bool, optional\n        If True, remesh the result.\n\n    Returns\n    -------\n    sequence[[float, float, float]]\n        The vertices of the boolean union.\n    sequence[[int, int, int]]\n        The faces of the boolean union.\n\n    \"\"\"\n    return _boolean_operation(A, B, lambda a, b: Rhino.Geometry.Mesh.CreateBooleanUnion([a, b]))\n\n\nboolean_union_mesh_mesh.__plugin__ = True\n\n\n@plugin(category=\"booleans\", requires=[\"Rhino\"])\ndef boolean_difference_mesh_mesh(A, B, remesh=False):\n    \"\"\"Compute the boolean difference of two triangle meshes.\n\n    Parameters\n    ----------\n    A : tuple[sequence[[float, float, float] | :class:`compas.geometry.Point`], sequence[[int, int, int]]]\n        The vertices and faces of mesh A.\n    B : tuple[sequence[[float, float, float] | :class:`compas.geometry.Point`], sequence[[int, int, int]]]\n        The vertices and faces of mesh B.\n    remesh : bool, optional\n        If True, remesh the result.\n\n    Returns\n    -------\n    sequence[[float, float, float]]\n        The vertices of the boolean difference.\n    sequence[[int, int, int]]\n        The faces of the boolean difference.\n\n    \"\"\"\n    return _boolean_operation(A, B, lambda a, b: Rhino.Geometry.Mesh.CreateBooleanDifference([a], [b]))\n\n\nboolean_difference_mesh_mesh.__plugin__ = True\n\n\n@plugin(category=\"booleans\", requires=[\"Rhino\"])\ndef boolean_intersection_mesh_mesh(A, B, remesh=False):\n    \"\"\"Compute the boolean intersection of two triangle meshes.\n\n    Parameters\n    ----------\n    A : tuple[sequence[[float, float, float] | :class:`compas.geometry.Point`], sequence[[int, int, int]]]\n        The vertices and faces of mesh A.\n    B : tuple[sequence[[float, float, float] | :class:`compas.geometry.Point`], sequence[[int, int, int]]]\n        The vertices and faces of mesh B.\n    remesh : bool, optional\n        If True, remesh the result.\n\n    Returns\n    -------\n    sequence[[float, float, float]]\n        The vertices of the boolean intersection.\n    sequence[[int, int, int]]\n        The faces of the boolean intersection.\n\n    \"\"\"\n    return _boolean_operation(A, B, lambda a, b: Rhino.Geometry.Mesh.CreateBooleanIntersection([a], [b]))\n\n\nboolean_intersection_mesh_mesh.__plugin__ = True\n\n\ndef _boolean_operation(A, B, method):\n    meshes = []\n    for vertices, faces in [A, B]:\n        mesh = Rhino.Geometry.Mesh()\n        for x, y, z in vertices:\n            mesh.Vertices.Add(x, y, z)\n        for face in faces:\n            mesh.Faces.AddFace(*face)\n        meshes.append(mesh)\n    mesh_a, mesh_b = meshes\n\n    result = method(mesh_a, mesh_b)\n\n    # Rhino SDK returns None on failure\n    if not result:\n        return None\n\n    vertices = []\n    faces = []\n\n    for mesh in result:\n        for face in mesh.Faces:\n            reindexed_face = [v + len(vertices) for v in (face.A, face.B, face.C)]\n            faces.append(reindexed_face)\n\n        vertices += ((v.X, v.Y, v.Z) for v in mesh.Vertices)\n\n    return vertices, faces\n",
  "language": "python",
  "imports": [
    "Rhino",
    "Rhino.Geometry"
  ],
  "has_docstring": false
}