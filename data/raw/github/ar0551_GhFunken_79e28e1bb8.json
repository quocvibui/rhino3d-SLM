{
  "source_url": "https://github.com/ar0551/GhFunken/blob/f302bf61eef96c30d149aa022f2b3adea5c76927/src/ghComp/Funken_Analog%20Write.py",
  "repo": "ar0551/GhFunken",
  "repo_stars": 4,
  "repo_description": "Grasshopper interface for Funken Serial Protocol Toolkit",
  "license": "GPL-3.0",
  "filepath": "src/ghComp/Funken_Analog Write.py",
  "instruction": "Write an analog value on a PWM pin (mirrors the Arduino analogWrite method).\n-\nProvided by Funken 0.3\n    Args:\n        PIN: The number of the pin where to write.\n        VAL: The value to write. It...",
  "code": "#########################################################################\n##                            COMPONENT INFO                           ##\n#########################################################################\n\n\"\"\"\nWrite an analog value on a PWM pin (mirrors the Arduino analogWrite method).\n-\nProvided by Funken 0.3\n    Args:\n        PIN: The number of the pin where to write.\n        VAL: The value to write. It can be an Integer between 0-255.\n        SET: True to write the value to the Arduino pin.\n        PORT: Serial port to send the message [Default is the first port available].\n        ID: ID of the device [Default is the first device available].\n    Returns:\n        _COMM: Funken command.\n        _PORT: Serial port where the message was sent (for daisy-chaining). \n        _ID: Device ID (for daisy-chaining). \n\"\"\"\n\nghenv.Component.Name = \"Funken_Analog Write\"\nghenv.Component.NickName = 'AnalogWrite'\nghenv.Component.Message = 'VER 0.3.3'\nghenv.Component.IconDisplayMode = ghenv.Component.IconDisplayMode.application\nghenv.Component.Category = \"Funken\"\nghenv.Component.SubCategory = \"1 | Arduino\"\ntry: ghenv.Component.AdditionalHelpFromDocStrings = \"3\"\nexcept: pass\n\nimport scriptcontext as sc\nimport Grasshopper as gh\nimport time\n\ndef main(pin, value, set, port, id):\n    \n    if sc.sticky.has_key(\"pyFunken\") == False:\n        check_data = False\n        msg = \"No serial object available. Have you opened the serial port?\"\n        ghenv.Component.AddRuntimeMessage(gh.Kernel.GH_RuntimeMessageLevel.Warning, msg)\n        return\n    \n    if pin is None:\n        check_data = False\n        msg = \"No pin provided.\"\n        ghenv.Component.AddRuntimeMessage(gh.Kernel.GH_RuntimeMessageLevel.Warning, msg)\n        return\n    \n    if value is None:\n        value = 0\n    \n    if set is None:\n        set = False\n    \n    if port is None:\n        if len(sc.sticky[\"pyFunken\"].com_ports) == 0:\n            msg = \"No serial connection available. Did you connect open the serial port?\"\n            ghenv.Component.AddRuntimeMessage(gh.Kernel.GH_RuntimeMessageLevel.Warning, msg)\n            return\n        else:\n            port = sc.sticky[\"pyFunken\"].com_ports[0]\n    \n    if id is None:\n        if len(sc.sticky['pyFunken'].ser_conn[port].devices_ids) == 0:\n            msg = \"No device available. Did you connect an Arduino-compatible device and registered it?\"\n            ghenv.Component.AddRuntimeMessage(gh.Kernel.GH_RuntimeMessageLevel.Warning, msg)\n            return\n        else:\n            id = sc.sticky['pyFunken'].ser_conn[port].devices_ids[0]\n    \n    comm = \"AW \" + str(PIN) + \" \" + str(value) + \"\\n\"\n    if set:\n        sc.sticky['pyFunken'].send_command(comm, port, id)\n    \n    return comm, port, id\n\nresult = main(PIN, VAL, SET, PORT, ID)\n\nif result is not None:\n    _COMM = result[0]\n    _PORT = result[1]\n    _ID = result[2]",
  "language": "python",
  "imports": [
    "scriptcontext"
  ],
  "has_docstring": true
}