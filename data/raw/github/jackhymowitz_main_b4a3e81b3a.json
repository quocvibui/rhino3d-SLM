{
  "source_url": "https://github.com/jackhymowitz/main/blob/7325131db23094f1a28bd184b6a68f864f41a729/01_GH_Components/py/BT_CreateNewPHPPVentDuct.py",
  "repo": "jackhymowitz/main",
  "repo_stars": 0,
  "repo_description": "IDF2PH is a free open source toolkit for working with E+ and PHPP Energy Models",
  "license": "GPL-3.0",
  "filepath": "01_GH_Components/py/BT_CreateNewPHPPVentDuct.py",
  "instruction": "Collects and organizes data for a duct for a Ventilation System.\r\r\n-\r\r\nEM Feb. 25, 2020\r\r\n    Args:\r\r\n        ductLength_: <Optional> Input either a number for the length of the duct from the...",
  "code": "#\r\r\n# IDF2PHPP: A Plugin for exporting an EnergyPlus IDF file to the Passive House Planning Package (PHPP). Created by blgdtyp, llc\r\r\n# \r\r\n# This component is part of IDF2PHPP.\r\r\n# \r\r\n# Copyright (c) 2020, bldgtyp, llc <info@bldgtyp.com> \r\r\n# IDF2PHPP is free software; you can redistribute it and/or modify \r\r\n# it under the terms of the GNU General Public License as published \r\r\n# by the Free Software Foundation; either version 3 of the License, \r\r\n# or (at your option) any later version. \r\r\n# \r\r\n# IDF2PHPP is distributed in the hope that it will be useful,\r\r\n# but WITHOUT ANY WARRANTY; without even the implied warranty of \r\r\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the \r\r\n# GNU General Public License for more details.\r\r\n# \r\r\n# For a copy of the GNU General Public License\r\r\n# see <http://www.gnu.org/licenses/>.\r\r\n# \r\r\n# @license GPL-3.0+ <http://spdx.org/licenses/GPL-3.0+>\r\r\n#\r\r\n\"\"\"\r\r\nCollects and organizes data for a duct for a Ventilation System.\r\r\n-\r\r\nEM Feb. 25, 2020\r\r\n    Args:\r\r\n        ductLength_: <Optional> Input either a number for the length of the duct from the Ventilation Unit to the building enclusure, or geometry representing the duct (curve / line)\r\r\n        ductWidth_: <Optional> Input the diameter (mm) of the duct. Default is 101mm (4\")\r\r\n        insulThickness_: <Optional> Input the thickness (mm) of insulation on the duct. Default is 52mm (2\")\r\r\n        insulConductivity_: <Optional> Input the Lambda value (W/m-k) of the insualtion. Default is 0.04 W/mk (Fiberglass)\r\r\n    Returns:\r\r\n        hrvDuct_: A Duct object for the Ventilation System. Connect to the 'hrvDuct_01_' or 'hrvDuct_02_' input on the 'Create Vent System' to build a PHPP-Style Ventialtion System.\r\r\n\"\"\"\r\r\n\r\r\nghenv.Component.Name = \"BT_CreateNewPHPPVentDuct\"\r\r\nghenv.Component.NickName = \"Vent Duct\"\r\r\nghenv.Component.Message = 'FEB_25_2020'\r\r\nghenv.Component.IconDisplayMode = ghenv.Component.IconDisplayMode.application\r\r\nghenv.Component.Category = \"BT\"\r\r\nghenv.Component.SubCategory = \"01 | Model\"\r\r\n\r\r\nimport rhinoscriptsyntax as rs\r\r\nimport ghpythonlib.components as gh\r\r\nimport scriptcontext as sc\r\r\n\r\r\n# Classes and Defs\r\r\npreview = sc.sticky['Preview']\r\r\nPHPP_Sys_Duct = sc.sticky['PHPP_Sys_Duct']\r\r\n\r\r\ndef getDuctLength(ductLength_):\r\r\n    # Find the Duct length\r\r\n    # Takes eiether a list of numbers (panel)\r\r\n    # Or a Rhino curve object representing the path of the duct\r\r\n    if len(ductLength_)>0:\r\r\n        lengthsList = []\r\r\n        for each in ductLength_:\r\r\n            try:\r\r\n                # if its a number input, just take that\r\r\n                lengthsList.append(float(each))\r\r\n            except:\r\r\n                # if it isn't a number, try finding geometry\r\r\n                try:\r\r\n                    crv = rs.coercecurve(each)\r\r\n                    lengthsList.append(gh.Length(crv))\r\r\n                except:\r\r\n                    pass\r\r\n        lenM = sum(lengthsList)\r\r\n    else:\r\r\n        lenM = 5\r\r\n    \r\r\n    return lenM\r\r\n\r\r\nhrvDuct_ = PHPP_Sys_Duct(\r\r\n        getDuctLength(ductLength_),\r\r\n        ductWidth_ if ductWidth_ else 104,\r\r\n        insulThickness_ if insulThickness_ else 52,\r\r\n        insulConductivity_ if insulConductivity_ else 0.04 )\r\r\n\r\r\npreview(hrvDuct_)\r\n",
  "language": "python",
  "imports": [
    "ghpythonlib",
    "rhinoscriptsyntax",
    "scriptcontext"
  ],
  "has_docstring": true
}