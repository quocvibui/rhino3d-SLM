{
  "source_url": "https://github.com/PH-Tools/honeybee_grasshopper_ph_plus/blob/b89f9887488d9c10eb732ffafe910cec70be0752/honeybee_ph_plus_rhino/gh_compo_io/hb_tools/generate_polygon2d_from_faces.py",
  "repo": "PH-Tools/honeybee_grasshopper_ph_plus",
  "repo_stars": 2,
  "repo_description": "Additional Honeybe-PH Grasshopper Components",
  "license": "GPL-3.0",
  "filepath": "honeybee_ph_plus_rhino/gh_compo_io/hb_tools/generate_polygon2d_from_faces.py",
  "instruction": "GHCompo Interface: HBPH+ - Get Face Polygon2Ds in Ref. Space.",
  "code": "# -*- coding: utf-8 -*-\n# -*- Python Version: 2.7 -*-\n\n\"\"\"GHCompo Interface: HBPH+ - Get Face Polygon2Ds in Ref. Space.\"\"\"\n\ntry:\n    from typing import Any, Dict, Generator, List, Optional, Tuple\nexcept ImportError:\n    pass  # IronPython 2.7\n\ntry:\n    from Grasshopper import DataTree  # type: ignore\n    from Grasshopper.Kernel.Data import GH_Path  # type: ignore\n    from System import Object  # type: ignore\nexcept:\n    raise ImportError(\"Failed to import Grasshopper\")\n\ntry:\n    from Rhino.Geometry import Brep, Point3d  # type: ignore\nexcept ImportError:\n    raise ImportError(\"Failed to import Rhino\")\n\ntry:\n    from ladybug_geometry.geometry2d.polygon import Polygon2D\n    from ladybug_geometry.geometry3d.face import Face3D\n    from ladybug_geometry.geometry3d.plane import Plane\nexcept ImportError as e:\n    raise ImportError(\"Failed to import ladybug_geometry\")\n\ntry:\n    from honeybee import face\nexcept ImportError as e:\n    raise ImportError(\"Failed to import honeybee\")\n\ntry:\n    from honeybee_ph_utils import polygon2d_tools\nexcept ImportError:\n    raise ImportError(\"Failed to import honeybee_ph_utils\")\n\ntry:\n    from honeybee_ph_rhino import gh_io\nexcept ImportError:\n    raise ImportError(\"Failed to import honeybee_ph_rhino\")\n\n\nclass GHCompo_GeneratePolygon2DFromHBFaces(object):\n    def __init__(self, _IGH, _hb_faces, _tolerance, *args, **kwargs):\n        # type: (gh_io.IGH,List[face.Face], Optional[float], List[Any], Dict[str, Any]) -> None\n        self.IGH = _IGH\n        self.hb_faces = _hb_faces or []\n        self.tolerance = _tolerance or self.IGH.ghdoc.ModelAbsoluteTolerance\n\n    @property\n    def lbt_face3Ds(self):\n        # type: () -> List[Face3D]\n        \"\"\"Return the LBT-Face3Ds of all the HB-Faces.\"\"\"\n        return [f.geometry for f in self.hb_faces]\n\n    @property\n    def lbt_poly2Ds(self):\n        # type: () -> List[Polygon2D]\n        \"\"\"Return the Polygon2Ds of all the LBT-Face3Ds.\"\"\"\n        return [f.geometry.polygon2d for f in self.hb_faces]\n\n    @property\n    def lbt_face3D_planes(self):\n        # type: () -> List[Plane]\n        \"\"\"Return the Planes of all the HB-Faces.\"\"\"\n        return [f.geometry.plane for f in self.hb_faces]\n\n    @property\n    def reference_plane(self):\n        # type: () -> Plane\n        \"\"\"Return the reference plane to be used for all the Polygon2Ds created.\n\n        This is always the plane of the first face input.\n        \"\"\"\n\n        return self.lbt_face3Ds[0].plane\n\n    def generate_starting_breps(self):\n        # type: () -> DataTree[Brep]\n        \"\"\"Generate the starting Rhino breps for the component (for preview).\"\"\"\n\n        starting_polygons_ = DataTree[Brep]()\n        for i, _face3D in enumerate(self.lbt_face3Ds):\n            starting_polygons_.Add(\n                self.IGH.ghc.BoundarySurfaces(\n                    self.IGH.ghc.PolyLine((Point3d(v.x, v.y, v.z) for v in _face3D.vertices), True)\n                ),\n                GH_Path(i),\n            )\n        return starting_polygons_\n\n    def generate_result_breps(self, polygons_in_ref_space_):\n        # type: (List[Polygon2D]) -> DataTree[Brep]\n        \"\"\"Generate the resulting (translated) Rhino breps for the component (for preview).\"\"\"\n\n        rhino_breps_ = DataTree[Brep]()\n        for i, p in enumerate(polygons_in_ref_space_):\n            rhino_breps_.Add(\n                self.IGH.ghc.BoundarySurfaces(self.IGH.ghc.PolyLine((Point3d(v.x, v.y, 0) for v in p.vertices), True)),\n                GH_Path(i),\n            )\n\n        return rhino_breps_\n\n    def run(self):\n        # type: () -> Tuple[List[Polygon2D], DataTree[Brep], DataTree[Brep]]\n        \"\"\"Run the component and return the results.\n\n        Returns:\n        --------\n            * Tuple:\n                * [0] - (List[Polygon2D]) List of generated LBT-Polygon2Ds in the reference plane\n                * [1] - (DataTree[Brep]) Starting Rhino breps (*)for preview)\n                * [2] - (DataTree[Brep]) Resulting Rhino breps (for preview)\n        \"\"\"\n        # ---------------------------------------------------------------------\n        # -- Get all the LBT-Face3D Polygon2Ds in the same Plane-space\n        translated_polygon2Ds = []  # type: List[Polygon2D]\n        for face3D_poly_2D, face3D_plane in zip(self.lbt_poly2Ds, self.lbt_face3D_planes):\n            translated_polygon2Ds.append(\n                polygon2d_tools.translate_polygon2D(face3D_poly_2D, face3D_plane, self.reference_plane, self.tolerance)\n            )\n\n        # ---------------------------------------------------------------------\n        # -- Generate the preview breps for troubleshooting\n        starting_breps = self.generate_starting_breps()\n        result_breps = self.generate_result_breps(translated_polygon2Ds)\n\n        return (translated_polygon2Ds, starting_breps, result_breps)\n",
  "language": "python",
  "imports": [
    "Rhino",
    "Rhino.Geometry"
  ],
  "has_docstring": true
}