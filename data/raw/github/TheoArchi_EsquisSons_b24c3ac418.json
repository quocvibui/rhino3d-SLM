{
  "source_url": "https://github.com/TheoArchi/EsquisSons/blob/00d1b02f7ce3e190b5c4c3429d3e84756c29bfdb/WIP_ESQUISSONS%20PYTHON%20FILES/Built-in-Sound.py",
  "repo": "TheoArchi/EsquisSons",
  "repo_stars": 3,
  "repo_description": "Esquissons is a grasshopper plugin which help you to design with sound ;)",
  "license": "NOASSERTION",
  "filepath": "WIP_ESQUISSONS PYTHON FILES/Built-in-Sound.py",
  "instruction": "EsquisSons Built-in Sounds provides some basic sounds to start your sketch\r\nUse a value list to visualize sound names\r\n-\r\nAAU / Theo Marchal / BETA VERSION / AVRIL2020\r\nWith the Contribution of Manon...",
  "code": "\"\"\"EsquisSons Built-in Sounds provides some basic sounds to start your sketch\r\nUse a value list to visualize sound names\r\n-\r\nAAU / Theo Marchal / BETA VERSION / AVRIL2020\r\nWith the Contribution of Manon COUTIER & Domitille GRANDJEAN\"\"\"\r\n\r\nfrom ghpythonlib.componentbase import executingcomponent as component\r\nimport Grasshopper, GhPython\r\nimport System\r\nimport Rhino\r\nimport rhinoscriptsyntax as rs\r\nimport Grasshopper.Kernel as gh\r\n\r\n\r\nclass BuiltInSounds(component):\r\n\r\n    def RunScript(self, valuelist_gh):\r\n\r\n        # block init\r\n        __author__ = \"theomarchal\"\r\n        self.Params.Input[\r\n            0].Description = \"Connect here a Value List component (from Grasshopper) and then select the sound you want to use\"\r\n        self.Params.Output[0].Description = \"Connect to the source_path input from the Source component (EsquisSons)\"\r\n        self.Name = \"Built-in Sounds\"\r\n        self.NickName = \"Sounds\"\r\n        self.Message = \"EsquisSons V3\"\r\n        self.Category = \"EsquisSons\"\r\n        self.SubCategory = \"2/ Options\"\r\n\r\n        # - source_list : a list of every name of Grasshopper pre-installed sounds\r\n        source_list = ['Bells', 'Birds', 'Fountain', 'Playground', 'Urban', 'talk', 'cherokee', 'FemVoice',\r\n                       'BusyAvenue', 'rainstick', 'duduk', 'anton', 'vibes-a1']\r\n\r\n        # check valuelist_gh\r\n        if valuelist_gh is None:\r\n            self.AddRuntimeMessage(gh.GH_RuntimeMessageLevel.Warning,\r\n                                   'You must connect a Value List to choose from the built-in sounds')\r\n\r\n        # access to the objects connected to the block on the document\r\n        # - document : grasshopper document where the block is used\r\n        # - value_list : objects connected to the block\r\n        document = self.OnPingDocument()\r\n        value_list = None\r\n        for object in document.ActiveObjects():\r\n            if self.DependsOn(object):\r\n                value_list = object\r\n\r\n        # apply the source_list to the Value List connected to the block,\r\n        # so the user can choose a Grasshopper sound from the Grasshopper Value List\r\n\r\n        if value_list is not None:\r\n            # creation of a list of the names of the items already in value_list\r\n            # raise an exception if the value_list has no attributes ListItems,\r\n            # i.e. if the value_list is not a Grasshopper Value List\r\n            # - list_names : list of name of every item from value_list\r\n            list_names = []\r\n            try:\r\n                for item in value_list.ListItems:\r\n                    list_names.append(item.Name)\r\n            except:\r\n                raise Exception('You must connect a Value List to valuelist_gh')\r\n\r\n            # if list_names is different from the source_list, then the source_list must be applied\r\n            if set(list_names) != set(source_list):\r\n                # clear the value_list\r\n                value_list.ListItems.Clear()\r\n                # create a new value list with items name = path\r\n                # - path : the name of the sound in quotes\r\n                for name in source_list:\r\n                    path = '\"{}\"'.format(name)\r\n                    value_list.ListItems.Add(Grasshopper.Kernel.Special.GH_ValueListItem(name, path))\r\n\r\n                # update of value_list\r\n                value_list.SelectItem(1)\r\n                value_list.Attributes.ExpireLayout()\r\n                value_list.Attributes.PerformLayout()\r\n\r\n        # source_path is the value chosen from valuelist_gh\r\n        source_path = valuelist_gh\r\n\r\n        return source_path\r\n",
  "language": "python",
  "imports": [
    "Rhino",
    "ghpythonlib",
    "rhinoscriptsyntax"
  ],
  "has_docstring": true
}