{
  "source_url": "https://discourse.mcneel.com/t/interactive-palette-color-of-materials-for-display-color-and-layer-color/156820",
  "topic_id": 156820,
  "title": "Interactive Palette Color of materials for Display Color and Layer Color",
  "question": "This script was conceived for use the interactive palette color of materials to edit the Display Color and Layer Color in Shaded Mode.\n\n\nAll work occurs in Shaded Mode or any other mods without support displaying the render materials.\n\n\n\n\n\n\nHow it should work.\n\n\nThe selected object should be switched temporarily to the Rended mode. Inside the script actions something like this: _Setobjectdisplaymode _pause “Rended”.\n\nAnd necessary to create a new Custom material. Take an RGB from the current display color with the material settings matches your Shaded Mode settings. And temporarily give this material to the object.\n\n\nI have default settings:\n\n\nMaterial name = ShadedMode\n\n\nMaterial type = Custom\n\n\nMaterial color = Current RGB by Display Color\n \n(if the start be next time)\n\n\nGloss Finish = 50\n\n\nReflectivity = 0\n\n\nTransparency = 0\n\n\nEnvironment = 30\n\n\nMap =  \"C:\\Program Files\\Rhino 7\\System\\rhino_shaded_mode_emap_background.png\"\n\n\nYou may have other settings. Material settings you can see below:\n\n\nOptions - View - Dysplay Modes - Shadeed - Shading Settings - Custom Object Attributes Settings.\n\nThen new Custom material will be displayed according to your Saded Mode settings.\n\n\nTo simulate the material that is used the Shaded Mode, is only suitable the Custom Type. I tried all the types, but only Custom has an Environment option that creates lighting in Shaded Mode. All other types are not suitable for simulating the material that use Shaded Mode.\n\n\nI’ve been fought for two days to create a Custom Type, but I didn’t succeed in anything sensible. I read all the topics on the forum related to the creation the material, but didn’t find a suitable Custom Material code to be use for modifications.\n\nThe forum has several beautiful codes with attributes by \n@nathanletwory\n but it for Physically Based, Plastic and Double Sided for metals.\n\n\n\n\n\n\n\n\ngithub.com\n\n\n\n\n\n\nGitHub - jesterKing/rhipy at f27e7a6fd7dc29fa384c95f1ed14c4b135fd7e86\n\n\nf27e7a6fd7dc29fa384c95f1ed14c4b135fd7e86\n\n\nPy...",
  "code_blocks": [
    {
      "code": "import System\nimport Rhino.Display\nimport Rhino.Render\n\nimport scriptcontext\nimport random\n\n# get object selection\nobject_selection = [ob for ob in scriptcontext.doc.Objects if ob.IsSelected(False)]\n\n# only if we have a selection do the work\nif object_selection:\n    # create material\n    render_material = Rhino.Render.RenderContent.Create(\n        System.Guid(\"E6CD1973-B739-496E-AB69-32957FA48492\"),\n        Rhino.Render.RenderContent.ShowContentChooserFlags.None,\n        scriptcontext.doc)\n    render_material.BeginChange(Rhino.Render.RenderContent.ChangeContexts.Program)\n    render_material.Name = \"Double-Sided Material \" + System.Guid.NewGuid().ToString()\n    \n    front_material = Rhino.Render.RenderContent.Create(\n        Rhino.Render.RenderMaterial.MetalMaterialGuid,\n        render_material,\n        \"front\",\n        Rhino.Render.RenderContent.ShowContentChooserFlags.None,\n        scriptcontext.doc)\n    \n    back_material = Rhino.Render.RenderContent.Create(\n        Rhino.Render.RenderMaterial.PlasterMaterialGuid,\n        render_material,\n        \"back\",\n        Rhino.Render.RenderContent.ShowContentChooserFlags.None,\n        scriptcontext.doc)\n    random_color1 = Rhino.Display.Color4f(\n        random.random(),\n        random.random(),\n        random.random(),\n        1.0)\n    random_color2 = Rhino.Display.Color4f(\n        random.random(),\n        random.random(),\n        random.random(),\n        1.0)\n    # set color for front material\n    front_material.BeginChange(Rhino.Render.RenderContent.ChangeContexts.Program)\n    front_material.SetParameter(\"color\", random_color1)\n    # set color for back material\n    back_material.BeginChange(Rhino.Render.RenderContent.ChangeContexts.Program)\n    back_material.SetParameter(\"color\", random_color2)\n    render_material.EndChange()\n    \n    # assign\n    for ob in object_selection:\n        print(\"Adding material\", render_material.Name, \"to\", ob)\n        ob.RenderMaterial = render_material\n        ob.CommitChanges()",
      "language": "python",
      "author": "leex",
      "post_number": 1,
      "is_solution": false
    },
    {
      "code": "import Rhino\nimport scriptcontext \nimport rhinoscriptsyntax as rs\nimport random\n\nmatname = \"ShadedMode\"\ntexture = \"C:\\Program Files\\Rhino 7\\System\\rhino_shaded_mode_emap_background.png\"\n\nmat = Rhino.DocObjects.Material()\nmat.Name = matname\nrendmat = Rhino.Render.RenderMaterial.CreateBasicMaterial(mat)\nscriptcontext.doc.RenderMaterials.Add(rendmat)",
      "language": "python",
      "author": "leex",
      "post_number": 1,
      "is_solution": false
    },
    {
      "code": "import rhinoscriptsyntax as rs\n\ndef ObjMatColorToObjDispColor():\n    objs=rs.GetObjects(\"Select objects to process\",preselect=True)\n    if not objs: return\n    \n    for obj in objs:\n        mat_source=rs.ObjectMaterialSource(obj)\n        if mat_source==0:\n            #material source is by layer\n            #get the object's layer material index in the materials table\n            layer=rs.ObjectLayer(obj)\n            idx=rs.LayerMaterialIndex(layer)\n        elif mat_source==1:\n            #material source is by object\n            #get the object material's index in the materials table\n            idx=rs.ObjectMaterialIndex(obj)\n            \n        #get the color of the material by looking it up via its index\n        mat_color = rs.MaterialColor(idx)\n        if mat_color:\n            #convert object DISPLAY color source to 'by object'\n            rs.ObjectColorSource(obj,1)\n            #apply the color to the object\n            if mat_color: rs.ObjectColor(obj, mat_color)\n\nObjMatColorToObjDispColor()",
      "language": "python",
      "author": "leex",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "file-io",
    "layers",
    "materials",
    "python",
    "rhinoscriptsyntax",
    "selection"
  ],
  "has_accepted_answer": false,
  "category_id": 11,
  "posts_count": 1,
  "views": 534
}