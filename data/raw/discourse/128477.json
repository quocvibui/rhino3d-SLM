{
  "source_url": "https://discourse.mcneel.com/t/python-in-dynamo-vs-ghpython-revit-api/128477",
  "topic_id": 128477,
  "title": "Python in Dynamo vs GHPython - Revit API",
  "question": "Hello,\n\n\nI am trying to implement some automation with Rhino.Inside.Revit through GHPython to programmatically open a Revit model (Revit 2020). I found a Dynamo Python script at the link below, and it works fine to open a Revit document:\n\n\n\n\n\n\nDynamo – 19 Mar 19\n\n\n\n\n\n\n\n\nopenDocumentFile\n\n\nHi @Yien I hope you’re well.  Try this:  import clr  clr.AddReference('RevitServices') import RevitServices from RevitServices.Persistence import DocumentManager  clr.AddReference('RevitAPI') import Autodesk from Autodesk.Revit.DB import *  doc =...\n\n\n\n\n\n\n\n\n\n\n\n\nHowever, when I try to implement this in GHPython, it throws the following error:\n\n\n\n\nimage\n673×616 23.4 KB\n\n\n\n\nAdditionally, when I use the CovertUserVisiblePathToModelPath method in GHPython, it returns a FilePath rather than a ModelPath.\n\n\nAny ideas what the differences are between Dynamo running the script vs GHPython? Any assistance is appreciated!\n\n\nThanks,\n\nJoseph",
  "code_blocks": [
    {
      "code": "using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Windows.Forms;\nusing Grasshopper.GUI;\nusing Grasshopper.Kernel;\nusing Grasshopper.Kernel.Data;\nusing RhinoInside.Revit.External.DB.Extensions;\nusing DB = Autodesk.Revit.DB;\n\nnamespace RhinoInside.Revit.GH.Parameters\n{\n  public class Document : PersistentParam<Types.IGH_Document>\n  {\n    public override Guid ComponentGuid => new Guid(\"F3427D5C-3793-4E32-B219-8172D56EF04C\");\n    public override GH_Exposure Exposure => GH_Exposure.quarternary;\n    protected override string IconTag => \"D\";\n\n    public Document() : base(\"Document\", \"DOC\", \"Contains a collection of Revit documents\", \"Params\", \"Revit Primitives\")\n    { }",
      "language": "csharp",
      "author": "jfreund",
      "post_number": 3,
      "is_solution": false
    }
  ],
  "tags": [
    "csharp",
    "file-io",
    "grasshopper",
    "python"
  ],
  "has_accepted_answer": true,
  "category_id": 111,
  "posts_count": 4,
  "views": 1181
}