{
  "source_url": "https://discourse.mcneel.com/t/lineardimension-in-rhino-common-bug-in-wip/46406",
  "topic_id": 46406,
  "title": "LinearDimension in Rhino Common bug in WIP?",
  "question": "Hi,\n\n\nI’m using Rhino WIP 6.0.17206.9241, 07/25/2017.\n\nI found the \nLinearDimension\n in RhinoCommon doesn’t work in this version.\n\nWhich caused all the related functions in rhino python and grasshopper not working.\n\nThe same script will work in Rhino 5.\n\n\nThe created linear dimensions exist in the rhino document because if you do “SelDim” you can find them, but they are invisible nor do them have right properties (location, length… etc)\n\n\nThanks",
  "code_blocks": [
    {
      "code": "import Rhino\nimport scriptcontext\nimport System.Guid\n\ndef AddLinearDimension2():\n    origin = Rhino.Geometry.Point3d(1,1,0)\n    offset = Rhino.Geometry.Point3d(11,1,0)\n    pt = Rhino.Geometry.Point3d((offset.X-origin.X)/2.0,3,0)\n    plane = Rhino.Geometry.Plane.WorldXY\n    plane.Origin = origin\n\n    rc, u, v = plane.ClosestParameter(origin)\n    ext1 = Rhino.Geometry.Point2d(u,v)\n    rc, u, v = plane.ClosestParameter(offset)\n    ext2 = Rhino.Geometry.Point2d(u,v)\n    rc, u, v = plane.ClosestParameter(pt)\n    linePt = Rhino.Geometry.Point2d(u,v)\n\n    dimension = Rhino.Geometry.LinearDimension(plane, ext1, ext2, linePt)\n    if scriptcontext.doc.Objects.AddLinearDimension(dimension)!=System.Guid.Empty:\n        scriptcontext.doc.Views.Redraw()\n        return Rhino.Commands.Result.Success\n    return Rhino.Commands.Result.Failure\n\nif __name__==\"__main__\":\n    AddLinearDimension2()",
      "language": "python",
      "author": "Yuheng_Ouyang",
      "post_number": 3,
      "is_solution": false
    },
    {
      "code": "import Rhino\nimport scriptcontext as sc\n\nstyle = sc.doc.DimStyles.Current;\nplane = Rhino.Geometry.Plane.WorldXY\np0 = plane.Origin\np1 = Rhino.Geometry.Point3d(10.0, 0.0, 0.0)\np2 = Rhino.Geometry.Point3d(10.0, 5.0, 0.0)\ndim = Rhino.Geometry.LinearDimension.Create(\n    Rhino.Geometry.AnnotationType.Aligned, \n    style, \n    plane, \n    plane.XAxis, \n    p0, p1, p2, 0.0)\n    \nsc.doc.Objects.Add(dim);\nsc.doc.Views.Redraw();",
      "language": "python",
      "author": "dale",
      "post_number": 4,
      "is_solution": false
    }
  ],
  "tags": [
    "csharp",
    "file-io",
    "geometry",
    "grasshopper",
    "python",
    "rhinocommon"
  ],
  "has_accepted_answer": false,
  "category_id": 11,
  "posts_count": 5,
  "views": 1010
}