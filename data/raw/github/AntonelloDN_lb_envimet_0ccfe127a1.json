{
  "source_url": "https://github.com/AntonelloDN/lb_envimet/blob/f49c125fcf2cc2dd9deaab3ae220523a805a0247/src/Ladybug_ENVI-Met%20Results%20Reader.py",
  "repo": "AntonelloDN/lb_envimet",
  "repo_stars": 4,
  "repo_description": "ï»¿lb_envimet: a series of components to connect Ladybug and Gismo to Envimet for urban microclimatic analysis",
  "license": "GPL-3.0",
  "filepath": "src/Ladybug_ENVI-Met Results Reader.py",
  "instruction": "This component generate readable output files of ENVI-Met v4.0 for Ladybug.\r\n-\r\nComponent mainly based...",
  "code": "# ENVI-Met Results Reader\r\n#\r\n# Ladybug: A Plugin for Environmental Analysis (GPL) started by Mostapha Sadeghipour Roudsari\r\n# \r\n# This file is part of Ladybug.\r\n# \r\n# Copyright (c) 2013-2018, Antonello Di Nunzio <antonellodinunzio@gmail.com> \r\n# Ladybug is free software; you can redistribute it and/or modify \r\n# it under the terms of the GNU General Public License as published \r\n# by the Free Software Foundation; either version 3 of the License, \r\n# or (at your option) any later version. \r\n# \r\n# Ladybug is distributed in the hope that it will be useful,\r\n# but WITHOUT ANY WARRANTY; without even the implied warranty of \r\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the \r\n# GNU General Public License for more details.\r\n# \r\n# You should have received a copy of the GNU General Public License\r\n# along with Ladybug; If not, see <http://www.gnu.org/licenses/>.\r\n# \r\n# @license GPL-3.0+ <http://spdx.org/licenses/GPL-3.0+>\r\n\r\n\r\n\"\"\"\r\nThis component generate readable output files of ENVI-Met v4.0 for Ladybug.\r\n-\r\nComponent mainly based on:\r\nhttps://www.researchgate.net/publication/281031049_Outdoor_Comfort_the_ENVI-BUG_tool_to_evaluate_PMV_values_point_by_point\r\n-\r\nSpecial thanks goes to MIT.\r\n-\r\nProvided by Ladybug 0.0.65\r\n    \r\n    Args:\r\n        _outputFolder: ENVI-Met output folder path. E.g. 'C:\\...\\\\NewSimulation_output'\r\n        _studyFolder_: ENVI-Met sub-folder, connect a number from 0 to 4. Default value is 0.\r\n        -\r\n        0 = atmosphere\r\n        1 = pollutants\r\n        2 = radiation\r\n        3 = soil\r\n        4 = surface\r\n        _selectItem_: Connect a Grasshopper Domain (A, B) which represent the range of files you want to read. Plug a panel to 'outputFiles' to see right indices.\r\n        -\r\n        Default value is just the first file (0), the first file in ENVI-Met model folder.\r\n        _variable_: Select one variable.\r\n        -\r\n        1 = Flow u (m/s)\r\n        2 = Flow v (m/s)\r\n        3 = Flow w (m/s)\r\n        4 = Wind Speed (m/s)\r\n        5 = Wind Speed Change ()\r\n        6 = Wind Direction (deg)\r\n        7 = Pressure Perturbation (Diff)\r\n        8 = Air Temperature (C)\r\n        9 = Air Temperature Delta (K)\r\n        10 = Air Temperature Change (K/h)\r\n        11 = Spec. Humidity (g/kg)\r\n        12 = Relative Humidity ()\r\n        13 = TKE (m/m)\r\n        14 = Dissipation (m/m)\r\n        15 = Vertical Exchange Coef. Impuls (m/s)\r\n        16 = Horizontal Exchange Coef. Impuls (m/s)\r\n        17 = Vegetation LAD (m/m)\r\n        18 = Direct Sw Radiation (W/m)\r\n        19 = Diffuse Sw Radiation (W/m)\r\n        20 = Reflected Sw Radiation (W/m)\r\n        21 = Temperature Flux (Km/s)\r\n        22 = Vapour Flux (g/kgm/s)\r\n        23 = Water on Leafes (g/m)\r\n        24 = Leaf Temperature (C)\r\n        25 = Local Mixing Length (m)\r\n        26 = Mean Radiant Temp. (C)\r\n        27 = TKE normalised 1D ( )\r\n        28 = Dissipation normalised 1D ( )\r\n        29 = Km normalised 1D ( )\r\n        30 = TKE Mechanical Turbulence Prod. ( )\r\n        31 = Stomata Resistance (s/m)\r\n        32 = CO2 (mg/m3)\r\n        33 = CO2 (ppm)\r\n        34 = Plant CO2 Flux (mg/kgm/s)\r\n        35 = Div Rlw Temp change (K/h)\r\n        ---------------: (...)\r\n        _runIt: Set to \"True\" to run the component and perform ENVI-Met data visualization.\r\n    Returns:\r\n        readMe!: ...\r\n        outputFiles: File list that you can read.\r\n        resultFileAddress: Connect this output to \"ENVI-Met visualizer\".\r\n\"\"\"\r\n\r\nghenv.Component.Name = \"Ladybug_ENVI-Met Results Reader\"\r\nghenv.Component.NickName = 'ENVI-MetResultsReader'\r\nghenv.Component.Message = 'VER 0.0.65\\nJUL_28_2017'\r\nghenv.Component.IconDisplayMode = ghenv.Component.IconDisplayMode.application\r\nghenv.Component.Category = \"Ladybug\"\r\nghenv.Component.SubCategory = \"7 | WIP\"\r\n#compatibleLBVersion = VER 0.0.59\\nFEB_01_2015\r\ntry: ghenv.Component.AdditionalHelpFromDocStrings = \"1\"\r\nexcept: pass\r\n\r\n\r\nimport os\r\nimport re\r\nimport sys\r\nimport collections\r\nimport threading\r\nimport scriptcontext as sc\r\nimport Grasshopper.Kernel as gh\r\n##################LB ENVI_MET###################\r\nuserPath = os.getenv(\"APPDATA\")\r\npath = os.path.join(userPath, \"lb_envimet\")\r\nsys.path.append(path)\r\nfrom envimetStuff import readEnvimet\r\n################################################\r\n\r\n\r\nstudyFolderDict = {'0':'atmosphere', '1':'pollutants', '2':'radiation', '3':'soil', '4':'surface'}\r\n\r\n\r\ninputsDict = {\r\n0: [\"_outputFolder\", \"ENVI-Met output folder path. E.g. 'C:\\...\\\\NewSimulation_output'.\"],\r\n1: [\"_studyFolder_\", \"ENVI-Met sub-folder, connect a number from 0 to 4. Default value is 0.\\n-\\n0 = atmosphere\\n1 = pollutants\\n2 = radiation\\n3 = soil\\n4 = surface\"],\r\n2: [\"_selectItem_\", \"Connect a Grasshopper Domain (A, B) which represent the range of files you want to read. Plug a panel to 'outputFiles' to see right indices.\\n\" + \\\r\n\"-\\nDefault value is just the first file (0), the first file in ENVI-Met model folder.\"],\r\n3: [\"_variable_\", \"Select one variable.\\n-\\n\" + \\\r\n\"1 = Flow u (m/s)\\n2 = Flow v (m/s)\\n3 = Flow w (m/s)\\n4 = Wind Speed (m/s)\\n5 = Wind Speed Change ()\\n6 = Wind Direction (deg)\\n7 = Pressure Perturbation (Diff)\\n\"+ \\\r\n\"8 = Air Temperature (C)\\n9 = Air Temperature Delta (K)\\n10 = Air Temperature Change (K/h)\\n11 = Spec. Humidity (g/kg)\\n12 = Relative Humidity ()\\n\" + \\\r\n\"13 = TKE (m/m)\\n14 = Dissipation (m/m)\\n15 = Vertical Exchange Coef. Impuls (m/s)\\n16 = Horizontal Exchange Coef. Impuls (m/s)\\n17 = Vegetation LAD (m/m)\\n\"+ \\\r\n\"18 = Direct Sw Radiation (W/m)\\n19 = Diffuse Sw Radiation (W/m)\\n20 = Reflected Sw Radiation (W/m)\\n21 = Temperature Flux (Km/s)\\n22 = Vapour Flux (g/kgm/s)\\n\"+ \\\r\n\"23 = Water on Leafes (g/m)\\n24 = Leaf Temperature (C)\\n25 = Local Mixing Length (m)\\n26 = Mean Radiant Temp. (C)\\n27 = TKE normalised 1D ( )\\n28 = Dissipation normalised 1D ( )\\n\"+ \\\r\n\"29 = Km normalised 1D ( )\\n30 = TKE Mechanical Turbulence Prod. ( )\\n31 = Stomata Resistance (s/m)\\n32 = CO2 (mg/m3)\\n33 = CO2 (ppm)\\n34 = Plant CO2 Flux (mg/kgm/s)\\n35 = Div Rlw Temp change (K/h)\"],\r\n4: [\"---------------\", \"(...)\"],\r\n5: [\"_runIt\", \"Set to \\\"True\\\" to run the component and perform ENVI-Met data visualization.\"]\r\n}\r\n\r\notherFolderDict = {\r\n'0': \"Select one variable.\\n-\\n\" + \\\r\n\"1 = Flow u (m/s)\\n2 = Flow v (m/s)\\n3 = Flow w (m/s)\\n4 = Wind Speed (m/s)\\n5 = Wind Speed Change ()\\n6 = Wind Direction (deg)\\n7 = Pressure Perturbation (Diff)\\n\"+ \\\r\n\"8 = Air Temperature (C)\\n9 = Air Temperature Delta (K)\\n10 = Air Temperature Change (K/h)\\n11 = Spec. Humidity (g/kg)\\n12 = Relative Humidity ()\\n\" + \\\r\n\"13 = TKE (m/m)\\n14 = Dissipation (m/m)\\n15 = Vertical Exchange Coef. Impuls (m/s)\\n16 = Horizontal Exchange Coef. Impuls (m/s)\\n17 = Vegetation LAD (m/m)\\n\"+ \\\r\n\"18 = Direct Sw Radiation (W/m)\\n19 = Diffuse Sw Radiation (W/m)\\n20 = Reflected Sw Radiation (W/m)\\n21 = Temperature Flux (Km/s)\\n22 = Vapour Flux (g/kgm/s)\\n\"+ \\\r\n\"23 = Water on Leafes (g/m)\\n24 = Leaf Temperature (C)\\n25 = Local Mixing Length (m)\\n26 = Mean Radiant Temp. (C)\\n27 = TKE normalised 1D ( )\\n28 = Dissipation normalised 1D ( )\\n\"+ \\\r\n\"29 = Km normalised 1D ( )\\n30 = TKE Mechanical Turbulence Prod. ( )\\n31 = Stomata Resistance (s/m)\\n32 = CO2 (mg/m3)\\n33 = CO2 (ppm)\\n34 = Plant CO2 Flux (mg/kgm/s)\\n35 = Div Rlw Temp change (K/h)\",\r\n'1': \"Select one variable.\\n-\\n\" + \\\r\n\"1 = Objects\\n2 = Flow u (m/s)\\n3 = Flow v (m/s)\\n4 = Flow w (m/s)\\n5 = Wind Speed (m/s)\\n6 = Wind Speed Change ()\\n7 = Wind Direction (deg)\\n8 = Pot. Temperature (K)\\n9 Spec. Humidity (g/kg)\\n\"+ \\\r\n\"10 = Relative Humidity ()\\n11 = Vertical Exchange Coef. Impuls (m/s)\\n12 = Horizontal Exchange Coef. Impuls (m/s)\\n13 = PM2.5 Concentration (g/m3)\\n14 PM2.5 Source (g/s)\\n15 = PM2.5 Deposition velocity  (mm/s)\\n\"+ \\\r\n\"16 = PM2.5 Total Deposed Mass (g/m2)\\n17 = PM2.5 Reaction Term ()\",\r\n'2': \"Select one variable.\\n-\\n\" + \\\r\n\"1 = Q_sw Direct (W/m)\\n2 = Q_sw Direct Relative ()\\n3 = Q_sw Diffuse (W/m)\\n4 = Q_sw Reflected Upper Hemisphere (W/m)\\n5 = Q_sw Reflected Lower Hemisphere (W/m)\\n6 = Q_lw  Upper Hemisphere (W/m)\\n7 = Q_lw  Lower Hemisphere (W/m)\\n\"+ \\\r\n\"8 = ViewFactor Up Sky ( )\\n9 = ViewFactor Up Buildings ( )\\n10 = ViewFactor Up Vegetation ( )\\n11 = ViewFactor Up Soil ( )\\n12 = ViewFactor Down Sky ( )\\n13 = ViewFactor Down Buildings ( )\\n14 = ViewFactor Down Vegetation ( )\\n15 = ViewFactor Down Soil ( )\",\r\n'3': \"Select one variable.\\n-\\n\" + \\\r\n\"0 = Temperature (C)\\n1 = Volumetic Water Content (m3 H20/m3)\\n2 = Relative Soil Wetness related to sat ()\\n3 = Local RAD (normalized) (m/m)\\n4 = Local RAD Owner ()\\n5 = Root Water Uptake (g H20/m31/s)\",\r\n'4': \"Select one variable.\\n-\\n\" + \\\r\n\"0 =  Index Surface Grid ()\\n1 = Soil Profile Type ()\\n2 = z Topo (m)\\n3 = Surface inclination ()\\n4 = Surface exposition ()\\n5 = Shadow Flag ()\\n6 = T Surface (C)\\n7 = T Surface Diff. (K)\\n8 = T Surface Change (K/h)\\n9 = q Surface (g/kg)\\n\"+ \\\r\n\"10 = uv above Surface (m/s)\\n11 = Sensible heat flux (W/m2)\\n12 = Exchange Coeff. Heat (m2/s)\\n13 = Latent heat flux (W/m2)\\n14 = Soil heat Flux (W/m2)\\n15 = Q_Sw Direct Horizontal (W/m2)\\n16 = Q_Sw Diffuse Horizontal (W/m2)\\n\"+ \\\r\n\"17 = Q_Sw Reflected Received Horizontal (W/m2)\\n18 = Lambert Factor ()\\n19 = Q_Lw emitted (W/m2)\\n20 = Q_Lw budget (W/m2)\\n21 = Q_Lw from Sky (W/m2)\\n22 = Q_Lw from Buildings  (W/m2)\\n23 = Q_Lw from Vegetation  (W/m2)\\n\" + \\\r\n\"24 = Q_Lw Sum all Fluxes (W/m2)\\n25 = Water Flux (g/(m2s))\\n26 = SkyViewFaktor ()\\n27 = Building Height (m)\\n28 = Surface Albedo ()\\n29 = Deposition Speed (mm/s)\\n30 = Mass Deposed (g/m2)\\n31 = z node Biomet ()\\n\"+ \\\r\n\"32 = z Biomet (m)\\n33 = T Air Biomet (C)\\n34 = q Air Biomet (g/kg)\\n35 = TMRT Biomet (C)\\n36 = Wind Speed Biomet (m/s)\\n37 = Mass Biomet (ug/m3)\\n38 = Receptors ()\" \r\n}\r\n\r\nvariables = [{'1' : 'Flow u (m/s)',\r\n             '2' : 'Flow v (m/s)',\r\n             '3' : 'Flow w (m/s)',\r\n             '4' : 'Wind Speed (m/s)',\r\n             '5' : 'Wind Speed Change ()',\r\n             '6' : 'Wind Direction (deg)',\r\n             '7' : 'Pressure Perturbation (Diff)',\r\n             '8' : 'Air Temperature (C)',\r\n             '9' : 'Air Temperature Delta (K)',\r\n             '10' : 'Air Temperature Change (K/h)',\r\n             '11' : 'Spec. Humidity (g/kg)',\r\n             '12' : 'Relative Humidity ()',\r\n             '13': 'TKE (m/m)',\r\n             '14': 'Dissipation (m/m)',\r\n             '15' : 'Vertical Exchange Coef. Impuls (m/s)',\r\n             '16' : 'Horizontal Exchange Coef. Impuls (m/s)',\r\n             '17' : 'Vegetation LAD (m/m)',\r\n             '18' : 'Direct Sw Radiation (W/m)',\r\n             '19' : 'Diffuse Sw Radiation (W/m)',\r\n             '20' : 'Reflected Sw Radiation (W/m)',\r\n             '21' : 'Temperature Flux (Km/s)',\r\n             '22' : 'Vapour Flux (g/kgm/s)',\r\n             '23' : 'Water on Leafes (g/m)',\r\n             '24' : 'Leaf Temperature (C)',\r\n             '25' : 'Local Mixing Length (m)',\r\n             '26' : 'Mean Radiant Temp. (C)',\r\n             '27' : 'TKE normalised 1D ( )',\r\n             '28' : 'Dissipation normalised 1D ( )',\r\n             '29' : 'Km normalised 1D ( )',\r\n             '30' : 'TKE Mechanical Turbulence Prod. ( )',\r\n             '31' : 'Stomata Resistance (s/m)',\r\n             '32' : 'CO2 (mg/m3)',\r\n             '33' : 'CO2 (ppm)',\r\n             '34' : 'Plant CO2 Flux (mg/kgm/s)',\r\n             '35' : 'Div Rlw Temp change (K/h)'},\r\n             {'0' : 'z cart',\r\n             '1' : 'Objects',\r\n             '2' : 'Flow u (m/s)',\r\n             '3' : 'Flow v (m/s)',\r\n             '4' : 'Flow w (m/s)',\r\n             '5' : 'Wind Speed (m/s)',\r\n             '6' : 'Wind Speed Change ()',\r\n             '7' : 'Wind Direction (deg)',\r\n             '8' : 'Pot. Temperature (K)',\r\n             '9' : 'Spec. Humidity (g/kg)',\r\n             '10' : 'Relative Humidity ()',\r\n             '11' : 'Vertical Exchange Coef. Impuls (m/s)',\r\n             '12' : 'Horizontal Exchange Coef. Impuls (m/s)',\r\n             '13' : 'PM2.5 Concentration (g/m3)',\r\n             '14' : 'PM2.5 Source (g/s)',\r\n             '15' : 'PM2.5 Deposition velocity  (mm/s)',\r\n             '16' : 'PM2.5 Total Deposed Mass (g/m2)',\r\n             '17' : 'PM2.5 Reaction Term ()'},\r\n             {'1' : 'Q_sw Direct (W/m)',\r\n             '2' : 'Q_sw Direct Relative ()',\r\n             '3' : 'Q_sw Diffuse (W/m)',\r\n             '4' : 'Q_sw Reflected Upper Hemisphere (W/m)',\r\n             '5' : 'Q_sw Reflected Lower Hemisphere (W/m)',\r\n             '6' : 'Q_lw  Upper Hemisphere (W/m)',\r\n             '7' : 'Q_lw  Lower Hemisphere (W/m)',\r\n             '8' : 'ViewFactor Up Sky ( )',\r\n             '9' : 'ViewFactor Up Buildings ( )',\r\n             '10' : 'ViewFactor Up Vegetation ( )',\r\n             '11' : 'ViewFactor Up Soil ( )',\r\n             '12' : 'ViewFactor Down Sky ( )',\r\n             '13' : 'ViewFactor Down Buildings ( )',\r\n             '14' : 'ViewFactor Down Vegetation ( )',\r\n             '15' : 'ViewFactor Down Soil ( )'},\r\n             {'0' : 'Temperature (C)',\r\n             '1' : 'Volumetic Water Content (m3 H20/m3)',\r\n             '2' : 'Relative Soil Wetness related to sat ()',\r\n             '3' : 'Local RAD (normalized) (m/m)',\r\n             '4' : 'Local RAD Owner ()',\r\n             '5' : 'Root Water Uptake (g H20/m31/s)'},\r\n             {'0' : 'Index Surface Grid ()',\r\n             '1' : 'Soil Profile Type ()',\r\n             '2' : 'z Topo (m)',\r\n             '3' : 'Surface inclination ()',\r\n             '4' : 'Surface exposition ()',\r\n             '5' : 'Shadow Flag ()',\r\n             '6' : 'T Surface (C)',\r\n             '7' : 'T Surface Diff. (K)',\r\n             '8' : 'T Surface Change (K/h)',\r\n             '9' : 'q Surface (g/kg)',\r\n             '10' : 'uv above Surface (m/s)',\r\n             '11' : 'Sensible heat flux (W/m2)',\r\n             '12' : 'Exchange Coeff. Heat (m2/s)',\r\n             '13' : 'Latent heat flux (W/m2)',\r\n             '14' : 'Soil heat Flux (W/m2)',\r\n             '15' : 'Q_Sw Direct Horizontal (W/m2)',\r\n             '16' : 'Q_Sw Diffuse Horizontal (W/m2)',\r\n             '17' : 'Q_Sw Reflected Received Horizontal (W/m2)',\r\n             '18' : 'Lambert Factor ()',\r\n             '19' : 'Q_Lw emitted (W/m2)',\r\n             '20' : 'Q_Lw budget (W/m2)',\r\n             '21' : 'Q_Lw from Sky (W/m2)',\r\n             '22' : 'Q_Lw from Buildings  (W/m2)',\r\n             '23' : 'Q_Lw from Vegetation  (W/m2)',\r\n             '24' : 'Q_Lw Sum all Fluxes (W/m2)',\r\n             '25' : 'Water Flux (g/(m2s))',\r\n             '26' : 'SkyViewFaktor ()',\r\n             '27' : 'Building Height (m)',\r\n             '28' : 'Surface Albedo ()',\r\n             '29' : 'Deposition Speed (mm/s)',\r\n             '30' : 'Mass Deposed (g/m2)',\r\n             '31' : 'z node Biomet ()',\r\n             '32' : 'z Biomet (m)',\r\n             '33' : 'T Air Biomet (C)',\r\n             '34' : 'q Air Biomet (g/kg)',\r\n             '35' : 'TMRT Biomet (C)',\r\n             '36' : 'Wind Speed Biomet (m/s)',\r\n             '37' : 'Mass Biomet (ug/m3)',\r\n             '38' : 'Receptors ()'}]\r\n\r\n\r\ndef setComponentInputs(newText):\r\n    for input in range(6):\r\n        if input == 3:\r\n            ghenv.Component.Params.Input[input].NickName = '_variable_'\r\n            ghenv.Component.Params.Input[input].Name = '_variable_'\r\n            ghenv.Component.Params.Input[input].Description = newText\r\n        else:\r\n            ghenv.Component.Params.Input[input].NickName = inputsDict[input][0]\r\n            ghenv.Component.Params.Input[input].Name = inputsDict[input][0]\r\n            ghenv.Component.Params.Input[input].Description = inputsDict[input][1]\r\n\r\n\r\ndef restoreComponentInputs():\r\n    for input in range(6):\r\n        ghenv.Component.Params.Input[input].NickName = inputsDict[input][0]\r\n        ghenv.Component.Params.Input[input].Name = inputsDict[input][0]\r\n        ghenv.Component.Params.Input[input].Description = inputsDict[input][1]\r\n\r\n\r\ndef checkInputs(outputFolder):\r\n    if outputFolder == None:\r\n        return False\r\n    elif outputFolder:\r\n        return True\r\n\r\n\r\ndef ENVIparser(metaname, dataname, folder, variable, variableHeader, date):\r\n    print(threading.currentThread().getName())\r\n    # run envimet core\r\n    #variable = str(variable)\r\n    myFile = readEnvimet.ReadEnvimet(metaname)\r\n    cleanFile = myFile.readEnvimetNoBinaryFile(0)\r\n    writeCleanFile = myFile.writeReadebleEDXFile(folder, cleanFile, variable)\r\n   \r\n    file = myFile.writeReadebleTxt(folder, dataname, variableHeader, writeCleanFile, variable, date)\r\n    return file\r\n\r\n\r\ndef makeFolder(subFolder):\r\n    # make a folder\r\n    subFolder = subFolder + '\\\\'\r\n    appdata = os.getenv(\"APPDATA\")\r\n    try:\r\n        directory = os.path.join(appdata, \"Ladybug\\ENVIbug\", subFolder)\r\n        if not os.path.exists(directory):\r\n            os.makedirs(directory)\r\n    except:\r\n        directory = os.path.join(appdata[:3], \"Ladybug\\ENVIbug\", subFolder)\r\n        if not os.path.exists(directory):\r\n            os.makedirs(directory)\r\n    \r\n    return directory\r\n\r\n\r\ndef main():\r\n    if _selectItem_ == None: selectItem = [0, 0]\r\n    else: selectItem = _selectItem_\r\n    if _variable_ == None: variable = 2\r\n    else: variable = _variable_\r\n    \r\n    \r\n    try:\r\n        varStr = variables[int(k)][str(variable)]\r\n    except KeyError:\r\n        warning = \"Please, check '_variable_' input.\"\r\n        w = gh.GH_RuntimeMessageLevel.Warning\r\n        ghenv.Component.AddRuntimeMessage(w, warning)\r\n        return -1\r\n    print (\"variable: {}\".format(varStr))\r\n    \r\n    folderName = makeFolder(studyFolder)\r\n    \r\n    fileName = folderName + str(variable)+\".txt\"\r\n    \r\n    # folder\r\n    outputFolder = os.path.join(_outputFolder, studyFolder)\r\n    if not os.path.exists(outputFolder):\r\n        print(\"Please connect a valid path.\")\r\n        return -1\r\n    \r\n    listFile = os.listdir(outputFolder)\r\n    listFileW = [item[:-4] for item in listFile]\r\n    listFileW = [item for item, count in collections.Counter(listFileW).items() if count == 2 if 'CHECK' not in item]\r\n    outputFiles = sorted(listFileW)\r\n    \r\n    # prepare a list for files\r\n    files = []\r\n    \r\n    if _runIt:\r\n        \r\n        for i in xrange(selectItem[0], selectItem[1]+1):\r\n            \r\n            fileName = folderName + str(variable) + '_' + str(i) + \".txt\"\r\n            \r\n            try:\r\n                selItem = outputFiles[i]\r\n                \r\n            except IndexError:\r\n                print(\"There are just {} files in the folder.\".format(len(outputFiles)))\r\n                return -1\r\n            print(\"you are reading this file: {}\".format(selItem))\r\n            \r\n            metaname = os.path.join(outputFolder, outputFiles[i] + '.EDX')\r\n            dataname = os.path.join(outputFolder, outputFiles[i] + '.EDT')\r\n            \r\n            \r\n            t = threading.Thread(target = ENVIparser, args = (metaname, dataname, folderName, str(variable)  + '_' + str(i), varStr, selItem[-19:]))\r\n            t.setDaemon(True)\r\n            t.start()\r\n            t.join()\r\n            \r\n            if os.path.isfile(fileName):\r\n                files.append(fileName)\r\n            else:\r\n                print(\"File not found.\")\r\n                return -1\r\n                \r\n        return files, outputFiles\r\n    else:\r\n        print(\"Set runIt to True.\")\r\n        return None, outputFiles\r\n\r\n\r\ninitCheck = False\r\nif sc.sticky.has_key('ladybug_release'):\r\n    initCheck = True\r\n    try:\r\n        if not sc.sticky['ladybug_release'].isCompatible(ghenv.Component): initCheck = True\r\n    except:\r\n        initCheck = False\r\n        warning = \"You need a newer version of Ladybug to use this compoent.\" + \\\r\n        \"Use updateLadybug component to update userObjects.\\n\" + \\\r\n        \"If you have already updated userObjects drag Ladybug_Ladybug component \" + \\\r\n        \"into canvas and try again.\"\r\n        w = gh.GH_RuntimeMessageLevel.Warning\r\n        ghenv.Component.AddRuntimeMessage(w, warning)\r\n    lb_preparation = sc.sticky[\"ladybug_Preparation\"]()\r\nelse:\r\n    initCheck = False\r\n    print \"You should first let the Ladybug fly...\"\r\n    w = gh.GH_RuntimeMessageLevel.Warning\r\n    ghenv.Component.AddRuntimeMessage(w, \"You should first let the Ladybug fly...\")\r\n\r\n\r\ncheck = checkInputs(_outputFolder)\r\n\r\nif _studyFolder_ == None: studyFolder = studyFolderDict['0']\r\nelse:\r\n    try:\r\n        studyFolder = studyFolderDict[_studyFolder_]\r\n    except KeyError: studyFolder = studyFolderDict['0']\r\n\r\nprint(\"folder: {}\".format(studyFolder))\r\nfor key, item in studyFolderDict.items():\r\n    if item == studyFolder:\r\n        k = key\r\n\r\nif int(k) > 0: setComponentInputs(otherFolderDict[k])\r\nelse: restoreComponentInputs()\r\n\r\nif check and initCheck:\r\n    unitConversionFactor = lb_preparation.checkUnits()\r\n    result = main()\r\n    if result != -1:\r\n        resultFileAddress, outputFiles = result\r\n    else:\r\n        print(\"Something went wrong!\")\r\nelse:\r\n    pass\r\n    print(\"Please provide all inputs.\")",
  "language": "python",
  "imports": [
    "scriptcontext"
  ],
  "has_docstring": true
}