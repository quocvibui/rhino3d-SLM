{
  "source_url": "https://github.com/bsamiee/Parametric_Arsenal/blob/54ec3f5a7fc2c671cb7bc4601772820e625a1904/rhino/plugins/DocsPlease/commands/InspectDetailCamera.py",
  "repo": "bsamiee/Parametric_Arsenal",
  "repo_stars": 0,
  "repo_description": "Rhino 8 Plugins and Scripts - A comprehensive monorepo for architectural automation, parametric design, and creative workflows",
  "license": "MIT",
  "filepath": "rhino/plugins/DocsPlease/commands/InspectDetailCamera.py",
  "instruction": "Title         : InspectDetailCamera.py\nAuthor        : Bardia Samiee\nProject       : Parametric Forge\nLicense       : MIT\nPath          : rhino/plugins/DocsPlease/commands/InspectDetailCamera.py",
  "code": "\"\"\"\nTitle         : InspectDetailCamera.py\nAuthor        : Bardia Samiee\nProject       : Parametric Forge\nLicense       : MIT\nPath          : rhino/plugins/DocsPlease/commands/InspectDetailCamera.py\n\nDescription\n------------------------------------------------------------------------------\nInspects and captures camera metadata for all Detail Views on the active Layout.\n\"\"\"\n\nfrom __future__ import annotations\n\nimport rhinoscriptsyntax as rs\nimport scriptcontext as sc\nfrom libs.camera_tools import CameraTools\nfrom libs.command_framework import rhino_command\nfrom libs.constants import Strings\nfrom libs.exceptions import CameraError\n\n\n@rhino_command(requires_layout=True, undo_description=\"Capture Camera Metadata\", print_start=False, print_end=False)\ndef inspect_detail_cameras() -> None:\n    \"\"\"\n    Inspects and captures camera metadata for all Detail Views on the active Layout Page.\n\n    Raises:\n        CameraError: If camera metadata operations fail.\n    \"\"\"\n    print(\"\\n=== Inspect All Detail Cameras Script Started ===\\n\")\n\n    # Get active page view\n    pageview = sc.doc.Views.ActiveView\n\n    # Get all detail views on the layout\n    details = pageview.GetDetailViews()\n    if not details:\n        print(\"[INFO] No Detail Views found on this Layout.\")\n        return\n\n    print(f\"[INFO] Found {len(details)} Detail View(s) on Layout: '{pageview.PageName}'\\n\")\n\n    # Process each detail view\n    for idx, detail in enumerate(details):\n        detail_id = detail.Id\n        detail_name = rs.ObjectName(detail_id) or str(detail_id)\n\n        print(f\"\\n--- [{idx + 1}] Detail Name: {detail_name} ---\")\n\n        # Try to get existing camera metadata\n        try:\n            metadata = CameraTools.get_camera_metadata(detail_id)\n        except CameraError:\n            # No metadata exists, capture it\n            print(Strings.INFO_NO_CAMERA_METADATA)\n\n            try:\n                CameraTools.set_camera_metadata(detail_id)\n                metadata = CameraTools.get_camera_metadata(detail_id)\n            except CameraError as e:\n                print(f\"[ERROR] Failed to capture camera metadata: {e}\")\n                continue\n\n        # Display metadata\n        if metadata:\n            print(\"\\n--- Stored Camera Metadata ---\")\n            for key, value in metadata.items():\n                print(f\"{key} : {value}\")\n            print(\"--------------------------------\")\n\n    print(\"\\n=== Script Completed ===\\n\")\n\n\n# --- Rhino Plugin Entry Point -----------------------------------------------\ndef RunCommand(is_interactive: bool) -> int:\n    \"\"\"Rhino plugin entry point.\"\"\"\n    inspect_detail_cameras()\n    return 0\n\n\n# --- Script Entry Point -----------------------------------------------------\nif __name__ == \"__main__\":\n    inspect_detail_cameras()\n",
  "language": "python",
  "imports": [
    "rhinoscriptsyntax",
    "scriptcontext"
  ],
  "has_docstring": true
}