{
  "source_url": "https://github.com/KeithSloan/ladybug_freeCAD/blob/7b40cdc3178b4a1d533375b21132a82c2cc05fa2/ladybug_freeCAD/config.py",
  "repo": "KeithSloan/ladybug_freeCAD",
  "repo_stars": 0,
  "repo_description": "Ladybug FreeCAD",
  "license": "AGPL-3.0",
  "filepath": "ladybug_freeCAD/config.py",
  "instruction": "Ladybug_rhino configurations.",
  "code": "\"\"\"Ladybug_rhino configurations.\n\nGlobal variables such as tolerances, units and Rhino versions are stored here.\n\"\"\"\nimport os\n\ntry:\n    from ladybug.config import folders as lb_folders\nexcept ImportError as e:\n    raise ImportError('\\nFailed to import ladybug:\\n\\t{}'.format(e))\n\ntry:\n    import Rhino\n    rhino_version_str = str(Rhino.RhinoApp.Version)\n    rhino_version = tuple(int(n) for n in rhino_version_str.split('.'))\nexcept Exception:  # Rhino is unavailable; just use a placeholder\n    rhino_version = (7, 0)\n\ntry:  # Try to import tolerance from the active Rhino document\n    import scriptcontext\n    tolerance = scriptcontext.doc.ModelAbsoluteTolerance\n    angle_tolerance = scriptcontext.doc.ModelAngleToleranceDegrees\nexcept ImportError:  # No Rhino doc is available. Use Rhino's default.\n    tolerance = 0.01\n    angle_tolerance = 1.0  # default is 1 degree\n\nfrom .ghpath import find_grasshopper_userobjects, find_grasshopper_libraries\n\n\ndef conversion_to_meters():\n    \"\"\"Get the conversion factor to meters based on the current Rhino doc units system.\n\n    Returns:\n        A number for the conversion factor, which should be multiplied by all distance\n        units taken from Rhino geometry in order to convert them to meters.\n    \"\"\"\n    try:  # Try to import units from the active Rhino document\n        import scriptcontext\n        units = str(scriptcontext.doc.ModelUnitSystem).split('.')[-1]\n    except ImportError:  # No Rhino doc available. Default to the greatest of all units\n        units = 'Meters'\n\n    if units == 'Meters':\n        return 1.0\n    elif units == 'Millimeters':\n        return 0.001\n    elif units == 'Feet':\n        return 0.3048\n    elif units == 'Inches':\n        return 0.0254\n    elif units == 'Centimeters':\n        return 0.01\n    else:\n        raise ValueError(\n            \"You're kidding me! What units are you using?\" + units + \"?\\n\"\n            \"Please use Meters, Millimeters, Centimeters, Feet or Inches.\")\n\n\ndef units_system():\n    \"\"\"Get text for the current Rhino doc units system. (eg. 'Meters', 'Feet')\"\"\"\n    try:  # Try to import units from the active Rhino document\n        import scriptcontext\n        return str(scriptcontext.doc.ModelUnitSystem).split('.')[-1]\n    except ImportError:  # No Rhino doc available. Default to the greatest of all units\n        return 'Meters'\n\n\ndef units_abbreviation():\n    \"\"\"Get text for the current Rhino doc units abbreviation (eg. 'm', 'ft')\"\"\"\n    try:  # Try to import units from the active Rhino document\n        import scriptcontext\n        units = str(scriptcontext.doc.ModelUnitSystem).split('.')[-1]\n    except ImportError:  # No Rhino doc available. Default to the greatest of all units\n        units = 'Meters'\n\n    if units == 'Meters':\n        return 'm'\n    elif units == 'Millimeters':\n        return 'mm'\n    elif units == 'Feet':\n        return 'ft'\n    elif units == 'Inches':\n        return 'in'\n    elif units == 'Centimeters':\n        return 'cm'\n    else:\n        raise ValueError(\n            \"You're kidding me! What units are you using?\" + units + \"?\\n\"\n            \"Please use Meters, Millimeters, Centimeters, Feet or Inches.\")\n\n\nclass Folders(object):\n    \"\"\"Ladybug-rhino folders.\n\n    Properties:\n        * uo_folder\n        * gha_folder\n        * lbt_grasshopper_version\n        * lbt_grasshopper_version_str\n    \"\"\"\n\n    def __init__(self):\n        # find the location where the Grasshopper user objects are stored\n        self._uo_folder = find_grasshopper_userobjects()[-1]\n        self._gha_folder = find_grasshopper_libraries()[-1]\n        if os.name == 'nt':\n            # test to see if components live in the core installation\n            lbt_components = os.path.join(lb_folders.ladybug_tools_folder, 'grasshopper')\n            if os.path.isdir(lbt_components):\n                user_dir = os.path.join(self._uo_folder, 'ladybug_grasshopper')\n                if not os.path.isdir(user_dir):\n                    self._uo_folder = lbt_components\n                    self._gha_folder = lbt_components\n        self._lbt_grasshopper_version = None\n        self._lbt_grasshopper_version_str = None\n\n    @property\n    def uo_folder(self):\n        \"\"\"Get the path to the user object folder.\"\"\"\n        return self._uo_folder\n\n    @property\n    def gha_folder(self):\n        \"\"\"Get the path to the GHA Grasshopper component folder.\"\"\"\n        return self._gha_folder\n\n    @property\n    def lbt_grasshopper_version(self):\n        \"\"\"Get a tuple for the version of lbt-grasshopper (eg. (3, 8, 2)).\n\n        This will be None if the version could not be sensed.\n        \"\"\"\n        if self._lbt_grasshopper_version is None:\n            self._lbt_grasshopper_version_from_txt()\n        return self._lbt_grasshopper_version\n\n    @property\n    def lbt_grasshopper_version_str(self):\n        \"\"\"Get text for the full version of python (eg.\"3.8.2\").\n\n        This will be None if the version could not be sensed.\n        \"\"\"\n        if self._lbt_grasshopper_version_str is None:\n            self._lbt_grasshopper_version_from_txt()\n        return self._lbt_grasshopper_version_str\n\n    def _lbt_grasshopper_version_from_txt(self):\n        \"\"\"Get the LBT-Grasshopper version from the requirements.txt file in uo_folder.\n        \"\"\"\n        req_file = os.path.join(self._uo_folder, 'requirements.txt')\n        if os.path.isfile(req_file):\n            with open(req_file) as rf:\n                for row in rf:\n                    if row.startswith('lbt-grasshopper=='):\n                        lbt_ver = row.split('==')[-1].strip()\n                        try:\n                            self._lbt_grasshopper_version = \\\n                                tuple(int(i) for i in lbt_ver.split('.'))\n                            self._lbt_grasshopper_version_str = lbt_ver\n                        except Exception:\n                            pass  # failed to parse the version into values\n                        break\n\n\n\"\"\"Object possessing all key folders within the configuration.\"\"\"\nfolders = Folders()\n",
  "language": "python",
  "imports": [
    "Rhino",
    "scriptcontext"
  ],
  "has_docstring": true
}