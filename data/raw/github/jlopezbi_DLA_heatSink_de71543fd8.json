{
  "source_url": "https://github.com/jlopezbi/DLA_heatSink/blob/f082fb5c84ff5c72b0f1797b9d6370120bdfd9ad/branchingDLA.py",
  "repo": "jlopezbi/DLA_heatSink",
  "repo_stars": 5,
  "repo_description": "grow coral shapes",
  "license": "unknown",
  "filepath": "branchingDLA.py",
  "instruction": "DLA with branch thickening",
  "code": "#DLA with branch thickening\n\nimport rhinoscriptsyntax as rs\nimport random as rand\nimport math\nimport time\nimport Rhino\n\nclass node:\n    def __init__(self, posVec, parentID, radius):\n        self.posVec = posVec\n        self.parentID = parentID\n        self.radius = radius\n\n    def drawNode(self):\n        rs.AddPoint(self.posVec);\n        rs.AddTextDot(self.parentID,self.posVec);\n        \n    def increaseRadius(self, nodes):\n        \n        self.radius = self.radius + 1\n        if(self.parentID >= 0):\n            parentNode = nodes[self.parentID]\n            parentNode.increaseRadius(nodes)\n\ndef branchingDLA_MAIN():\n    #nodes = [ ]\n    #create root node\n    nodes = [node([0,0,0],0,1)]\n    rNodes = [rs.AddPoint(nodes[0].posVec)]\n    speed = .5 #rhino units per iteration\n    stickRange = 1.5\n    nThrows = 300\n    boundRadius = 10.0\n\n    rs.AddCircle([0,0,0],boundRadius)\n\n    for i in range(nThrows):\n        throwNode(nodes,speed,stickRange,rNodes,boundRadius)\n        \n\ndef randPntsTest(nodes,nThrows):\n    for i in range(nThrows):\n        x = rand.uniform(-10,10)\n        y = rand.uniform(-10,10)\n        posVec = rs.VectorCreate([0,0,0],[x,y,0])\n        n = node(posVec,i,i+1)\n        n.drawNode()\n        \ndef throwNode(nodes,speed,stickRange,rNodes,boundRadius):\n    #assumes time steps of 1\n    startPos = getBoundaryPos(boundRadius);\n    endPos = getBoundaryPos(boundRadius);\n    \n    direction = rs.VectorSubtract(endPos,startPos)\n    direction = rs.VectorUnitize(direction)\n    vel = rs.VectorScale(direction,speed);\n\n    currentPos = rs.VectorAdd(startPos,vel)\n\n    previewGeom = []\n\n    isTravelling = True\n    while(isTravelling):\n        time.sleep(0.0001)\n        for o in previewGeom: rs.DeleteObjects(o)\n        dist = rs.VectorLength(currentPos) #distance to origin\n        #check if particle went out of bounds\n        if(dist>boundRadius):\n            isTravelling = False\n        else:\n            previewGeom.append(drawPos(currentPos,stickRange))\n            for i in range(len(nodes)):\n                n = nodes[i]\n                if(inStickRange(currentPos,n,stickRange)):\n                    #GOT STUCK! add a new node at that position\n                    newNode = node(currentPos,i,1) #parent is idx of node stuck to, r = 1\n                    rs.AddLine(n.posVec,currentPos)\n                    nodes.append(newNode)\n                    #rNodes.append(rs.AddPoint(currentPos))\n                    isTravelling = False\n                    for o in previewGeom: rs.DeleteObjects(o)\n                    break\n            \n            currentPos = rs.VectorAdd(currentPos,vel)\n        Rhino.RhinoApp.Wait()\n\ndef drawPos(currentPos,stickRange):\n    tempGeom = []\n    tempGeom.append(rs.AddPoint(currentPos))\n    tempGeom.append(rs.AddCircle(currentPos,stickRange))\n    return tempGeom\n\ndef inStickRange(currentPos,node,stickRange):\n    assert(stickRange>0), \"stickRange must be greater than zero\"\n    nodePos = node.posVec\n    distVec = rs.VectorSubtract(nodePos,currentPos)\n    distance = rs.VectorLength(distVec)\n    return (distance <= stickRange)\n\ncurrentPos = rs.VectorCreate([1,0,0],[0,0,0])\nnode1 = node([0,0,0],0,10)\nassert (inStickRange(currentPos,node1,1) == True), \"inStickRange error\"\nassert (inStickRange(currentPos,node1,1.0000001) == True), \"inStickRange error\"\nassert (inStickRange(currentPos,node1,.999999) == False), \"inStickRange error\"\n    \ndef getBoundaryPos(radius):\n    angle = rand.uniform(0,2.0*math.pi)\n    x = radius*math.cos(angle)\n    y = radius*math.sin(angle)\n    z = 0;\n    \n    pos = rs.VectorCreate([0,0,0],[x,y,z])\n    return pos\n                                    \nif __name__==\"__main__\":\n    branchingDLA_MAIN()\n",
  "language": "python",
  "imports": [
    "Rhino",
    "rhinoscriptsyntax"
  ],
  "has_docstring": true
}