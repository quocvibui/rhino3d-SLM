{
  "source_url": "https://github.com/jdvargas12/LDM-3DP-Grasshopper-Plugin/blob/3a1c30f8bfd4c52ba2b4cc7af3c615daefb3ca39/v241001/03_G_Code_Export_240811.py",
  "repo": "jdvargas12/LDM-3DP-Grasshopper-Plugin",
  "repo_stars": 5,
  "repo_description": "This repository contains components and scripts for developing a Grasshopper plugin for 3D printing with LDM technologies like the WASP40100. The plugin facilitates G-code generation and path optimization for large-scale, clay-based, and viscous material printing.",
  "license": "unknown",
  "filepath": "v241001/03_G_Code_Export_240811.py",
  "instruction": "03 g code export 240811",
  "code": "ghenv.Component.Name = \"Save G-Code\"\nghenv.Component.Message = \"240811\"\n\n#region COMPONENT DESCRIPTION 240811\n\"\"\"\nComponent Name: Save G-Code\nComponent Version: 240811\n\nDescription:\nThis component saves a list of G-code strings to a specified file location on your system. \nIt provides functionality to name the file, choose a file extension (such as .gcode), \nand decide whether to override an existing file. The component is particularly useful \nfor finalizing and exporting G-code after generating it with Grasshopper-based 3D printing workflows.\n\nInputs:\n- g_code: (List of Strings) The G-code lines that you want to save to a file.\n- file_path: (String) The directory path where the file will be saved.\n- file_name: (String) The desired name of the file, without the extension.\n- file_extension: (String) The desired file extension, such as .gcode.\n- run: (Boolean) Triggers the file-saving operation. When set to True, the file is saved.\n- override: (Boolean) Determines whether an existing file with the same name should be overwritten. \n  If False and the file exists, a warning is displayed and the file is not saved.\n\nOutputs:\n- out: (None) This component does not produce an output, but it will display a message confirming the save \n  or showing an error if something goes wrong.\n\nUsage:\n1. Connect the G-code list to the g_code input.\n2. Specify the directory path and file name using the file_path and file_name inputs.\n3. Choose a file extension (e.g., .gcode).\n4. Set run to True to save the file.\n5. If you want to overwrite an existing file, set override to True.\n\nError Handling:\n- If the file already exists and override is set to False, a message box will appear warning that the file was not saved.\n- Any exceptions during the file-writing process will be printed in the console.\n\"\"\"\n#endregion\n\nimport os\nimport rhinoscriptsyntax as rs\n\n# Inputs\ng_code = g_code  # List of strings (G-code)\nfile_path = file_path  # Full directory path\nfile_name = file_name  # Desired file name without extension\nfile_extension = file_extension  # Desired file extension (e.g., \".gcode\")\nrun = run  # Boolean to trigger saving\noverride = override  # Boolean to allow file override\n\n# Initialize output\nout = None\n\nif run:\n    # Construct the full file path\n    full_file_path = os.path.join(file_path, file_name + file_extension)\n    \n    # Check if the file exists and if override is allowed\n    if not os.path.exists(full_file_path) or override:\n        try:\n            # Write the G-code to the file\n            with open(full_file_path, 'w') as file:\n                for line in g_code:\n                    file.write(line + '\\n')\n            print(f\"File {file_name} saved successfully at {full_file_path}\")\n        except Exception as e:\n            print(f\"Error: {str(e)}\")\n    else:\n        # Show a message box warning about the file already existing and override set to False\n        rs.MessageBox(f\"The file '{file_name}' already exists in the directory '{file_path}'. Please set override to True or change the file's name. No file was saved.\", 0, \"File Save Warning\")\n",
  "language": "python",
  "imports": [
    "rhinoscriptsyntax"
  ],
  "has_docstring": false
}