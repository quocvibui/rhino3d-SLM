{
  "source_url": "https://github.com/ladybug-tools/honeybee-legacy/blob/bd62af4862fe022801fb87dbc8794fdf1dff73a9/src/Honeybee_Label%20Zones.py",
  "repo": "ladybug-tools/honeybee-legacy",
  "repo_stars": 129,
  "repo_description": ":bee: Honeybee is a free and open source plugin to connect Grasshopper3D to EnergyPlus, Radiance, Daysim and OpenStudio for building energy and daylighting simulation",
  "license": "NOASSERTION",
  "filepath": "src/Honeybee_Label Zones.py",
  "instruction": "Use this component to lablel zones with their names in the Rhino scene.  This can help ensure that the correct names are assigned to each zone and can help keep track of zones and zone data...",
  "code": "# This component labels zones with their names in the Rhino scene.\n#\n# Honeybee: A Plugin for Environmental Analysis (GPL) started by Mostapha Sadeghipour Roudsari\n# \n# This file is part of Honeybee.\n# \n# Copyright (c) 2013-2020, Chris Mackey <Chris@MackeyArchitecture.com> \n# Honeybee is free software; you can redistribute it and/or modify \n# it under the terms of the GNU General Public License as published \n# by the Free Software Foundation; either version 3 of the License, \n# or (at your option) any later version. \n# \n# Honeybee is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of \n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the \n# GNU General Public License for more details.\n# \n# You should have received a copy of the GNU General Public License\n# along with Honeybee; If not, see <http://www.gnu.org/licenses/>.\n# \n# @license GPL-3.0+ <http://spdx.org/licenses/GPL-3.0+>\n\n\n\"\"\"\nUse this component to lablel zones with their names in the Rhino scene.  This can help ensure that the correct names are assigned to each zone and can help keep track of zones and zone data throughout analysis.\n-\nProvided by Honeybee 0.0.66\n    \n    Args:\n        _HBZones: The HBZones out of any of the HB components that generate or alter zones.  Note that these should ideally be the zones that are fed into the Run Energy Simulation component.  Zones read back into Grasshopper from the Import idf component will not align correctly with the EP Result data.\n        attribute_: A text string for the zone attribute that you are interested in lableing the zones with.  Possible inputs include \"name\", \"zoneProgram\", \"isConditioned\" or any other Honeybee attribute. Use the \"Honeybee_Zone Attribute List\" to see all possibilities.\n        textHeight_: An optional number for text height in Rhino model units that can be used to change the size of the label text in the Rhino scene.  The default is set based on the dimensions of the zones.\n        font_: An optional number that can be used to change the font of the label in the Rhino scene. The default is set to \"Verdana\".\n    Returns:\n        zoneTxtLabels: The label names of each of the connected zones.  Connect this ouput and the one bleow to a Grasshopper \"TexTag3D\" component to make your own lables.\n        labelBasePts: The basepoint of the text labels.  Use this along with the ouput above and a Grasshopper \"TexTag3D\" component to make your own lables.\n        brepTxtLabels: A set of surfaces indicating the names of each zone as they correspond to the branches in the EP results and the name of the zone in the headers of data.\n        zoneWireFrame: A list of curves representing the outlines of the zones.\n\"\"\"\n\nghenv.Component.Name = \"Honeybee_Label Zones\"\nghenv.Component.NickName = 'LabelZones'\nghenv.Component.Message = 'VER 0.0.66\\nJUL_07_2020'\nghenv.Component.IconDisplayMode = ghenv.Component.IconDisplayMode.application\nghenv.Component.Category = \"HB-Legacy\"\nghenv.Component.SubCategory = \"00 | Honeybee\"\n#compatibleHBVersion = VER 0.0.56\\nFEB_21_2016\n#compatibleLBVersion = VER 0.0.59\\nFEB_01_2015\ntry: ghenv.Component.AdditionalHelpFromDocStrings = \"5\"\nexcept: pass\n\n\nfrom System import Object\nfrom System import Drawing\nimport Grasshopper.Kernel as gh\nfrom Grasshopper import DataTree\nfrom Grasshopper.Kernel.Data import GH_Path\nimport Rhino as rc\nimport scriptcontext as sc\n\ntol = sc.doc.ModelAbsoluteTolerance\n\n\ndef copyHBZoneData():\n    hb_hive = sc.sticky[\"honeybee_Hive\"]()\n    zones = []\n    \n    for HZone in _HBZones:\n        zone = hb_hive.visualizeFromHoneybeeHive([HZone])[0]\n        zones.append(zone)\n    \n    sc.sticky[\"Honeybee_LabelZoneData\"] = zones\n\n\ndef setDefaults():\n    #Check the font and set a default one.\n    if font_ == None: font = \"Verdana\"\n    else: font = font_\n    \n    #Get the base points and come up with a default text size.\n    zoneCentPts = []\n    shortestDimensions = []\n    for HZone in _HBZones:\n        bBox = rc.Geometry.Box(HZone.GetBoundingBox(True))\n        shortestDimensions.extend([bBox.X[1]-bBox.X[0], bBox.Y[1]-bBox.Y[0], bBox.Z[1]-bBox.Z[0]])\n        zoneCentPts.append(bBox.Center)\n    \n    if textHeight_ == None:\n        shortestDimensions.sort()\n        shortDim = None\n        for dim in shortestDimensions:\n            if dim > sc.doc.ModelAbsoluteTolerance*50 and shortDim == None: shortDim = dim\n            else: pass\n        roughZoneNameLen = 10\n        textSize = shortDim/roughZoneNameLen\n    else:\n        textSize = textHeight_\n    \n    if attribute_ == None: attribute = \"name\"\n    else: attribute = attribute_\n    \n    return zoneCentPts, textSize, font, attribute\n\n\ndef main(hb_zones, basePts, textSize, font, attribute):\n    lb_visualization = sc.sticky[\"ladybug_ResultVisualization\"]()\n    hb_hvac = sc.sticky[\"honeybee_hvacProperties\"]()\n    \n    #Make lists to be filled.\n    zoneProperties =[]\n    wireFrames =[]\n    zoneNameLength = []\n    \n    #Get the zone properties.\n    for count, HZone in enumerate(hb_zones):\n        wireFrames.append(_HBZones[count].DuplicateEdgeCurves())\n        theProp = \"\"\n        try:\n            theProp = getattr(HZone, attribute)\n        except:\n            if attribute == \"zoneFloorArea\":\n                theProp = \"%.3f\"%HZone.getFloorArea()\n            elif attribute == \"zoneVolume\":\n                theProp = \"%.3f\"%HZone.getZoneVolume()\n        if attribute == \"HVACSystem\":\n            theProp = hb_hvac.sysDict[theProp.Index]\n        \n        if theProp == \"\":\n            theProp = \"Not Assigned\"\n        zoneProperties.append(str(theProp))\n        zoneNameLength.append(len(list(str(theProp))))\n    \n    #Adjust the position of the label base points depending on the length of the length of the zone name.\n    newPts = []\n    for ptCount, length in enumerate(zoneNameLength):\n        basePtMove = textSize*(length/2.1)\n        newPt = rc.Geometry.Point3d(basePts[ptCount].X-basePtMove, basePts[ptCount].Y, basePts[ptCount].Z)\n        newPts.append(newPt)\n\n    # Make the zone labels.\n    zoneLabels = lb_visualization.text2srf(zoneProperties, newPts, font, textSize)\n    \n    # If people are requesting to see the illuminace point, output a sphere for this point instead of the pt location text.\n    if attribute == \"illumCntrlSensorPt\":\n        zoneLabels = []\n        for count, pointText in enumerate(zoneProperties):\n            if pointText == 'None':\n                hb_zones[count].atuoPositionDaylightSensor()\n                sensPt = hb_zones[count].illumCntrlSensorPt\n                hb_zones[count].illumCntrlSensorPt = None\n            else:\n                ptCoordList = pointText.split(',')\n                sensPt = rc.Geometry.Point3d(float(ptCoordList[0]),float(ptCoordList[1]),float(ptCoordList[2]))\n            sensSphere = rc.Geometry.Sphere(sensPt, 0.1)\n            zoneLabels.append([sensSphere])\n    \n    return zoneProperties, zoneLabels, wireFrames, newPts\n\n\n#If Honeybee or Ladybug is not flying or is an older version, give a warning.\ninitCheck = True\nw = gh.GH_RuntimeMessageLevel.Warning\n\n#Ladybug check.\nif not sc.sticky.has_key('ladybug_release') == True:\n    initCheck = False\n    print \"You should first let Ladybug fly...\"\n    ghenv.Component.AddRuntimeMessage(w, \"You should first let Ladybug fly...\")\nelse:\n    try:\n        if not sc.sticky['ladybug_release'].isCompatible(ghenv.Component): initCheck = False\n        if sc.sticky['ladybug_release'].isInputMissing(ghenv.Component): initCheck = False\n    except:\n        initCheck = False\n        warning = \"You need a newer version of Ladybug to use this compoent.\" + \\\n        \"Use updateLadybug component to update userObjects.\\n\" + \\\n        \"If you have already updated userObjects drag Ladybug_Ladybug component \" + \\\n        \"into canvas and try again.\"\n        ghenv.Component.AddRuntimeMessage(w, warning)\n\n\n#Honeybee check.\nif not sc.sticky.has_key('honeybee_release') == True:\n    initCheck = False\n    print \"You should first let Honeybee fly...\"\n    ghenv.Component.AddRuntimeMessage(w, \"You should first let Honeybee fly...\")\nelse:\n    try:\n        if not sc.sticky['honeybee_release'].isCompatible(ghenv.Component): initCheck = False\n    except:\n        initCheck = False\n        warning = \"You need a newer version of Honeybee to use this compoent.\" + \\\n        \"Use updateHoneybee component to update userObjects.\\n\" + \\\n        \"If you have already updated userObjects drag Honeybee_Honeybee component \" + \\\n        \"into canvas and try again.\"\n        ghenv.Component.AddRuntimeMessage(w, warning)\n\n\nif _HBZones != [] and initCheck == True:\n    if _HBZones[0] != None:\n        copyHBZoneData()\n        hb_zoneData = sc.sticky[\"Honeybee_LabelZoneData\"]\n        \n        labelCentPts, textSize, font, attribute = setDefaults()\n        zoneTxtLabels, zoneTextLabels, wireFrames, labelBasePts = main(hb_zoneData, labelCentPts, textSize, font, attribute)\n        \n        #Unpack the data trees of curves and label text.\n        brepTxtLabels = DataTree[Object]()\n        zoneWireFrames = DataTree[Object]()\n        for listCount, lists in enumerate(zoneTextLabels):\n            for item in lists:\n                brepTxtLabels.Add(item, GH_Path(listCount))\n        for listCount, lists in enumerate(wireFrames):\n            for item in lists:\n                zoneWireFrames.Add(item, GH_Path(listCount))\n\n\n#Hide unwanted outputs\nghenv.Component.Params.Output[1].Hidden = True",
  "language": "python",
  "imports": [
    "Rhino",
    "scriptcontext"
  ],
  "has_docstring": true
}