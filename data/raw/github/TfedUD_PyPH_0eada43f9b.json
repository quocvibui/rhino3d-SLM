{
  "source_url": "https://github.com/TfedUD/PyPH/blob/87fe2ec207a8b0ddcd3fbb682ea71368c11b580a/PyPH_GH/ghuser_py/PyPH%20-%20Ventilation%20System.py",
  "repo": "TfedUD/PyPH",
  "repo_stars": 0,
  "repo_description": "Python toolkit for working with Passive House energy models",
  "license": "GPL-3.0",
  "filepath": "PyPH_GH/ghuser_py/PyPH - Ventilation System.py",
  "instruction": "Collects and organizes data for a simple fresh-air ventilation system (HRV/ERV). \nOutputs a 'ventilation' class object to apply to a HB Zone.\n-\nEM October 14, 2021\n    Args:\n        system_name_:...",
  "code": "#\n# PyPH: A Plugin for aadding Passive-House data to LadybugTools Models\n# \n# This component is part of the PH-Tools toolkit <https://github.com/PH-Tools>.\n# \n# Copyright (c) 2021, PH-Tools and bldgtyp, llc <phtools@bldgtyp.com> \n# PyPH is free software; you can redistribute it and/or modify \n# it under the terms of the GNU General Public License as published \n# by the Free Software Foundation; either version 3 of the License, \n# or (at your option) any later version. \n# \n# PyPH is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of \n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the \n# GNU General Public License for more details.\n# \n# For a copy of the GNU General Public License\n# see <https://github.com/PH-Tools/PyPH/blob/main/LICENSE>.\n# \n# @license GPL-3.0+ <http://spdx.org/licenses/GPL-3.0+>\n#\n\"\"\"\nCollects and organizes data for a simple fresh-air ventilation system (HRV/ERV). \nOutputs a 'ventilation' class object to apply to a HB Zone.\n-\nEM October 14, 2021\n    Args:\n        system_name_: <Optional> A name for the overall system. ie: 'ERV-1', \n            etc.. Will show up in the 'Additional Ventilation' worksheet as the \n            'Description of Ventilation Units' (E97-E107)\n        system_type_: Input Type. Either: \"1-Balanced PH ventilation with HR\n            [Default]\", \"2-Extract air unit\", \"3-Only window ventilation\"\n        vent_unit_: Input the HRV/ERV unit object. Connect to the 'ventUnit_' \n            output on the 'Ventilator' Component\n        duct_01_: Input the HRV/ERV Duct object. Connect to the 'hrvDuct_' \n            output on the 'Vent Duct' Component\n        duct_02_: Input the HRV/ERV Duct object. Connect to the 'hrvDuct_' \n            output on the 'Vent Duct' Component\n    Returns:\n        HB_rooms_: The Honeybee Room(s) with their PHX-Space Ventilation values modified.\n\"\"\"\n\nimport scriptcontext as sc\nimport Rhino as rh\nimport rhinoscriptsyntax as rs\nimport ghpythonlib.components as ghc\nimport Grasshopper as gh\n\nimport PHX\nimport PHX.spaces\nimport PHX.mechanicals.systems\nimport PHX.mechanicals.equipment\nimport PHX.mechanicals.distribution\nimport LBT_Utils\n\nimport PyPH_Rhino.ventilation\nimport PyPH_Rhino.gh_io\nfrom Grasshopper import DataTree\nfrom Grasshopper.Kernel.Data import GH_Path\nfrom System import Object\n\n\nimport PyPH_GH._component_info_\nreload(PyPH_GH._component_info_)\nghenv.Component.Name = \"PyPH - Ventilation System\"\nDEV = True\nPyPH_GH._component_info_.set_component_params(ghenv, dev='OCT_14_2021')\n\nif DEV:\n    reload(PHX)\n    reload(PHX.spaces)\n    reload(PHX.mechanicals.systems)\n    reload(PHX.mechanicals.equipment)\n    reload(PHX.mechanicals.distribution)\n    reload(LBT_Utils)\n    reload(PHX.serialization)\n    reload(PHX.serialization.to_dict)\n    reload(PHX.serialization.from_dict)\n    reload(PyPH_Rhino.ventilation) \n    reload(PyPH_Rhino.gh_io)\n\n\ndef default_list_item(_list, _branch_num):\n    #type: (list, int) -> Any\n    \"\"\"Try and return default list item if IndexError\"\"\"\n    \n    if not _list:\n        return None\n    \n    try:\n        return _list[_branch_num]\n    except IndexError as e:\n        \n        return _list[0]\n\n#-- Interface Object\n#-------------------------------------------------------------------------------\nIGH = PyPH_Rhino.gh_io.IGH( ghdoc, ghenv, sc, rh, rs, ghc, gh )\n\n\n#-- Build the new Vent System\n#-------------------------------------------------------------------------------\nHB_rooms_ = DataTree[Object]()\nfor i, branch in enumerate(_HB_rooms.Branches):\n    \n    new_system = PHX.mechanicals.systems.MechanicalSystem()\n    new_system.name = default_list_item(system_name_, i) or 'Unnamed Ventilation System'\n    \n    vent_unit = default_list_item(vent_unit_, i) or PHX.mechanicals.equipment.HVAC_Ventilator()\n    new_system.equipment_set.add_new_device_to_equipment_set( vent_unit )\n    new_system.system_usage.used_for_ventilation = True\n    #new_system.duct_01 = PyPH_Rhino.ventilation.create_duct(IGH, duct_01_, 'duct_01_')\n    #new_system.duct_02 = PyPH_Rhino.ventilation.create_duct(IGH, duct_02_, 'duct_02_')\n    \n    \n    #-- Add the HVAC-System to the Honeybee-Rooms\n    #-------------------------------------------------------------------------------\n    #branch_HB_rooms_ = []\n    for hb_room in branch:\n        new_hb_room = hb_room.duplicate()\n        \n        # -- Add the Mechanical System to the Room\n        new_hb_room = LBT_Utils.user_data.add_to_HB_Obj_user_data(new_hb_room,\n                                        new_system.to_dict(), 'mech_system_ventilation', _write_mode='overwrite')\n        \n        HB_rooms_.Add( new_hb_room, GH_Path(i) )\n    \n    PyPH_Rhino.gh_utils.object_preview(new_system)",
  "language": "python",
  "imports": [
    "Rhino",
    "ghpythonlib",
    "rhinoscriptsyntax",
    "scriptcontext"
  ],
  "has_docstring": true
}