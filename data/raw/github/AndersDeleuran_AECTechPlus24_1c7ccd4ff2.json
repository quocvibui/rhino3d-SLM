{
  "source_url": "https://github.com/AndersDeleuran/AECTechPlus24/blob/1c6ecd8208efc50843b14f890b68c95a837e3dac/Misc/src/ViewportCapturePNG.py",
  "repo": "AndersDeleuran/AECTechPlus24",
  "repo_stars": 34,
  "repo_description": "For sharing files with workshop participants at AECTech+ Barcelona 2024.",
  "license": "Apache-2.0",
  "filepath": "Misc/src/ViewportCapturePNG.py",
  "instruction": "Viewport capture png",
  "code": "ï»¿\"\"\"\nCapture the Rhino viewport to a PNG file. Places the image in a folder called\nCaptures in the same directory as the GH definition. Names the image the same as \nthe GH defintion followed by _hourMinuteSecond. Note: Do not use this script with\nthe GH button as this can freeze up the canvas.\n    Inputs:\n        Width: Width of PNG in pixels {item,int,optional}\n        Height: Height of PNG in pixels {item,int,optional}\n        Grid: Capture Rhino grid {item,bool,optional}\n        Axes: Capture Rhino world axes {item,bool,optional}\n        Open: Opens PNG in default application {item,bool,optional}\n        Write: Write the captured bitmap to PNG file {item,bool}\n    Outputs:\n        Path: Path of captured PNG {item,str}\n    Remarks:\n        Author: Anders Holden Deleuran\n        Version: 230830\n\"\"\"\n\nghenv.Component.Name = \"ViewportCapturePNG\"\nghenv.Component.NickName =\"VCPNG\"\n\nimport os\nimport datetime\nimport System\nimport scriptcontext as sc\nimport Rhino as rc\n\ndef checkOrMakeFolder():\n    \n    \"\"\" Check/makes a \"Captures\" folder in the GH def folder \"\"\"\n    \n    if ghdoc.Path:\n        folder = os.path.dirname(ghdoc.Path)\n        captureFolder = folder + \"\\\\Captures\"\n        if not os.path.isdir(captureFolder):\n            os.makedirs(captureFolder)\n        return captureFolder\n\ndef makeFileName():\n    \n    \"\"\" Make a string with the gh def name + current hourMinuteSecond \"\"\"\n    \n    # Make hour minute seconds string\n    n = datetime.datetime.now()\n    ho,mt,sc = str(n.hour),str(n.minute),str(n.second)\n    if len(ho) == 1:\n        ho = \"0\"+ ho\n    if len(mt) == 1:\n        mt = \"0\"+mt\n    if len(sc) == 1:\n        sc = \"0\"+ sc\n    hms = ho+mt+sc\n    \n    # Get name of GH def\n    ghDef = ghenv.LocalScope.ghdoc.Name.strip(\"*\")\n    \n    # Concatenate and return\n    fileName = ghDef + \"_\" + hms\n    \n    return fileName\n\ndef captureActiveViewToFile(width,height,path,grid,worldAxes,cplaneAxes):\n    \n    \"\"\" Capture active view to .PNG file at path \"\"\"\n    \n    # Define view capture settings (you might want to edit these)\n    vc = rc.Display.ViewCapture()\n    vc.Width = width\n    vc.Height = height\n    vc.DrawGrid = grid\n    vc.DrawGridAxes = grid\n    vc.DrawAxes = worldAxes\n    vc.TransparentBackground = False\n    vc.ScaleScreenItems = False\n    \n    # Perform the capture\n    try:\n        bitmap = vc.CaptureToBitmap(rc.RhinoDoc.ActiveDoc.Views.ActiveView)\n        System.Drawing.Bitmap.Save(bitmap,path)\n        rc.RhinoApp.WriteLine(path)\n        return path\n    except:\n        raise Exception(\"Capture failed, check path\")\n\n# Capture\nif Write:\n    if not Width:\n        Width = System.Windows.Forms.Screen.PrimaryScreen.WorkingArea.Width  \n    if not Height:\n        Height = System.Windows.Forms.Screen.PrimaryScreen.WorkingArea.Height\n    folder = checkOrMakeFolder()\n    fileName = makeFileName()\n    try:\n        path = os.path.join(folder,fileName + \".png\")\n        Path = captureActiveViewToFile(Width,Height,path,Grid,Axes,Grid)\n        if Open:\n            os.startfile(path)\n    except:\n        raise Exception(\" Capture failed, save the GH definition\")\nelse:\n    Path = []",
  "language": "python",
  "imports": [
    "Rhino",
    "scriptcontext"
  ],
  "has_docstring": false
}