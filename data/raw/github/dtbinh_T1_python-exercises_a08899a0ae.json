{
  "source_url": "https://github.com/dtbinh/T1_python-exercises/blob/f4710c3dc2ba8ddb3e3e9069ab8d65df674463ab/07_ur_online/shifted_frames_setup/compas/src/compas_rhino/ui/command.py",
  "repo": "dtbinh/T1_python-exercises",
  "repo_stars": 0,
  "repo_description": null,
  "license": "unknown",
  "filepath": "07_ur_online/shifted_frames_setup/compas/src/compas_rhino/ui/command.py",
  "instruction": "Command",
  "code": "from __future__ import print_function\n\ntry:\n    import rhinoscriptsyntax as rs\nexcept ImportError:\n    import platform\n    if platform.python_implementation() == 'IronPython':\n        raise\n\n\n__author__     = ['Tom Van Mele', 'Matthias Rippmann']\n__copyright__  = 'Copyright 2016, BLOCK Research Group - ETH Zurich'\n__license__    = 'MIT License'\n__email__      = 'vanmelet@ethz.ch'\n\n\n__all__ = ['Command', 'CommandLoop', 'command_line_menu']\n\n\nclass Command(object):\n    pass\n\n\nclass CommandLoop(object):\n    \"\"\"\"\"\"\n\n    def __init__(self):\n        self.options = None\n        self.default = None\n        self.option = None\n        self.message = None\n\n    def is_option(self):\n        if not self.option:\n            return False\n        if self.option not in self.options:\n            return False\n\n    def get_option(self):\n        self.option = rs.GetString(self.message, self.default, self.options)\n\n    def handle_option(self):\n        self.handlers[self.option]()\n\n    def loop(self):\n        while True:\n            self.get_option()\n            if not self.is_option():\n                return\n            self.handle_option()\n\n\ndef command_line_menu(interface):\n    \"\"\"Create a Rhino-style command line menu.\n\n    Parameters:\n        interface (dict) : A (nested) dictionary with interface options.\n            The structure of the dictionary is as follows:\n\n                interface['options'] := [...]\n                interface['message'] := '...'\n                interface['default'] := '...'\n                interface['show']    := '...'\n                interface['ID']      := '...'\n\n    Return:\n        str : The selected option.\n        None : If the command is interrupted, for example by pressing ``ESC``\n\n    Examples:\n\n        .. code-block:: python\n\n            # ...\n\n    \"\"\"\n    if rs.GetDocumentData(interface[\"ID\"], interface[\"ID\"]):\n        interface[\"default\"] = rs.GetDocumentData(interface[\"ID\"], interface[\"ID\"])\n    new_options = []\n    sub_menus = {}\n    for option in interface[\"options\"]:\n        if isinstance(option, basestring):\n            new_options.append(option)\n        else:\n            new_options.append(option[\"show\"])\n            sub_menus[option[\"show\"]] = option\n    result = rs.GetString(interface[\"message\"], interface[\"default\"], new_options)\n    interface[\"default\"] = result\n    rs.SetDocumentData(interface[\"ID\"], interface[\"ID\"], result)\n    if result in sub_menus:\n        result = command_line_menu(sub_menus[result])\n    return result\n\n\n# ==============================================================================\n# Debugging\n# ==============================================================================\n\nif __name__ == \"__main__\":\n\n    interface_3 = {\n        \"options\" : [\"sub_sub_option_1\", \"sub_sub_option_2\", ],\n        \"message\" : \"Select C\",\n        \"default\" : \"sub_sub_option_1\",\n        \"show\"    : \"sub_sub_menu\",\n        \"ID\"      : \"interface_3\",\n    }\n\n    interface_2 = {\n        \"options\" : [\"sub_option_1\", interface_3, ],\n        \"message\" : \"Select B\",\n        \"default\" : \"sub_option_1\",\n        \"show\"    : \"sub_menu\",\n        \"ID\"      : \"interface_2\",\n    }\n\n    interface_1 = {\n        \"options\" : [\"option_1\", \"option_2\", interface_2],\n        \"message\" : \"Select A\",\n        \"default\" : \"option_1\",\n        \"show\"    : None,\n        \"ID\"      : \"interface_1\"\n    }\n\n    print(command_line_menu(interface_1))\n",
  "language": "python",
  "imports": [
    "rhinoscriptsyntax"
  ],
  "has_docstring": false
}