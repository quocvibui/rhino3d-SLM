{
  "source_url": "https://github.com/StrucEng-Library-kfmresearch/strucenglib-snippets/blob/2e4b498eaa5b2928c1766e9ed99bf6493e5fe056/examples/Example_NLFE_frame_bridge.py",
  "repo": "StrucEng-Library-kfmresearch/strucenglib-snippets",
  "repo_stars": 1,
  "repo_description": "StrucEng Library (snippets) for Rhinoceros",
  "license": "unknown",
  "filepath": "examples/Example_NLFE_frame_bridge.py",
  "instruction": "------------------------------------------------------------------------------ ------------------------------------------------------------------------------ ------------------------------------------------------------------------------ Example_with_all_functionalities Author: Marius Weber (ETHZ, HSLU T&A) ------------------------------------------------------------------------------ ------------------------------------------------------------------------------ ------------------------------------------------------------------------------",
  "code": "\n# ------------------------------------------------------------------------------\n# ------------------------------------------------------------------------------\n# ------------------------------------------------------------------------------\n# Example_with_all_functionalities\n# Author: Marius Weber (ETHZ, HSLU T&A)\n# ------------------------------------------------------------------------------\n# ------------------------------------------------------------------------------\n# ------------------------------------------------------------------------------\n\n\n# Import packages\n# ------------------------------------------------------------------------------\n# ------------------------------------------------------------------------------\nfrom compas_fea.cad import rhino\nfrom compas_fea.structure import ElasticIsotropic\nfrom compas_fea.structure import MPCStiff\nfrom compas_fea.structure import CMMUsermat\nfrom compas_fea.structure import ElementProperties as Properties\nfrom compas_fea.structure import GeneralStep\nfrom compas_fea.structure import GravityLoad\nfrom compas_fea.structure import AreaLoad\nfrom compas_fea.structure import PointLoad\nfrom compas_fea.structure import GeneralDisplacement\nfrom compas_fea.structure import FixedDisplacement\nfrom compas_fea.structure import FixedDisplacementXX\nfrom compas_fea.structure import FixedDisplacementYY\nfrom compas_fea.structure import FixedDisplacementZZ\nfrom compas_fea.structure import PinnedDisplacement\nfrom compas_fea.structure import RollerDisplacementX\n#from compas_fea.structure import RollerDispslacementY\nfrom compas_fea.structure import RollerDisplacementZ\nfrom compas_fea.structure import RollerDisplacementXY\nfrom compas_fea.structure import RollerDisplacementYZ\nfrom compas_fea.structure import RollerDisplacementXZ\nfrom compas_fea.structure import ShellSection\nfrom compas_fea.structure import MPCSection\nfrom compas_fea.structure import Structure\n\nfrom strucenglib.prepost_functions import calc_loc_coor\nfrom strucenglib.prepost_functions import plot_loc_axes\nfrom strucenglib.prepost_functions import plot_nr_elem\nfrom strucenglib.prepost_functions import plot_nr_nodes\nfrom strucenglib.prepost_functions import area_load_generator_elements\nfrom strucenglib.prepost_functions import Normalspurbahnverkehr_load_generator\nfrom strucenglib.prepost_functions import verification\nfrom strucenglib.sandwichmodel import sandwichmodel_main as SMM\n\n\n# Geoemtrie/Sections/Materials/Properties/Constraints \n# ------------------------------------------------------------------------------\n# ------------------------------------------------------------------------------\n\n# Initialisieren\nname = 'NLFE'\npath = 'C:\\Temp\\\\'\nmdl = Structure(name=name, path=path)\n\n# Structure\nmdl = Structure(name=name, path=path)\n\n# Shell Elements\nrhino.add_nodes_elements_from_layers(mdl, mesh_type='ShellElement', layers=[ 'elset_deck', 'elset_wall_1', 'elset_wall_2'] ) \n\n# MPC Elements\nrhino.add_nodes_elements_from_layers(mdl, line_type='MPCElement', layers='elset_mpc')\n\n# Sets for constraints\nrhino.add_sets_from_layers(mdl, layers=[ 'nset_pinned' ] )\n\n# Nonlinear Materials\ngeo={'R_Rohr':-1, 'rho':0.0000025, 'oo':30, 'uu':30}\nconcrete={'beton':2, 'fcc':50, 'vc':0, 'ecu':-0.002, 'k_E':10000, 'theta_b0':2, 'theta_b1':1, 'k_riss':0, 'Entfestigung':0, 'lambdaTS':0.67, 'srmx':1, 'srmy':1, 'Begrenzung':2, 'KritQ':0, 'winkelD':45, 'k_vr':1, 'fswy':500}\nreinf_1L={'stahl':1,'zm':2,'fsy':500,'fsu':600,'esu':0.8,'esv':0.02,'Es':200000,'ka':-1,'kb':-1,'kc':-1,'as':1,'dm':20,'psi':-90}\nreinf_2L={'stahl':1,'zm':2,'fsy':600,'fsu':700,'esu':0.8,'esv':0.02,'Es':200000,'ka':-1,'kb':-1,'kc':-1,'as':1,'dm':20,'psi':0}\nreinf_3L={'stahl':1,'zm':2,'fsy':700,'fsu':800,'esu':0.8,'esv':0.02,'Es':200000,'ka':-1,'kb':-1,'kc':-1,'as':1,'dm':20,'psi':0}\nreinf_4L={'stahl':1,'zm':2,'fsy':800,'fsu':900,'esu':0.8,'esv':0.02,'Es':200000,'ka':-1,'kb':-1,'kc':-1,'as':1,'dm':20,'psi':-90}\n\nmdl.add(CMMUsermat(name='elset_deck_element_mat', geo=geo, concrete=concrete, reinf_1L=reinf_1L, reinf_2L=reinf_2L, reinf_3L=reinf_3L, reinf_4L=reinf_4L,)) \nmdl.add(CMMUsermat(name='elset_wall_1_element_mat', geo=geo, concrete=concrete, reinf_1L=reinf_1L, reinf_2L=reinf_2L, reinf_3L=reinf_3L, reinf_4L=reinf_4L,)) \nmdl.add(CMMUsermat(name='elset_wall_2_element_mat', geo=geo, concrete=concrete, reinf_1L=reinf_1L, reinf_2L=reinf_2L, reinf_3L=reinf_3L, reinf_4L=reinf_4L,)) \n\n# Shell Sections, Properties, additional Properties, set local coordiantes (The local z-axed is adjusted by using \"object direction\" in Rino) \n\nsemi_loc_coords=calc_loc_coor(layer='elset_deck', PORIG=[0,0,0],PXAXS=[1,0,0]) # use Rhino command EvaluatePt to get the world x,y,z coor for PORIG\nmdl.add(ShellSection(name='elset_deck_element_sec', t=400, semi_loc_coords=semi_loc_coords, nn=40, offset_mode='mid'))\nmdl.add(Properties(name='elset_deck_element_prop', material='elset_deck_element_mat', section='elset_deck_element_sec', elset='elset_deck'))\n\nsemi_loc_coords=calc_loc_coor(layer='elset_wall_1', PORIG=[0,0,-5400],PXAXS=[1,0,0]) # use Rhino command EvaluatePt to get the world x,y,z coor for PORIG \nmdl.add(ShellSection(name='elset_wall_1_element_sec', t=400, semi_loc_coords=semi_loc_coords, nn=40, offset_mode='mid'))\nmdl.add(Properties(name='elset_wall_1_element_prop', material='elset_wall_1_element_mat', section='elset_wall_1_element_sec', elset='elset_wall_1'))\n\nsemi_loc_coords=calc_loc_coor(layer='elset_wall_2', PORIG=[0,5400,-5400],PXAXS=[1,0,0]) # use Rhino command EvaluatePt to get the world x,y,z coor for PORIG\nmdl.add(ShellSection(name='elset_wall_2_element_sec', t=400, semi_loc_coords=semi_loc_coords, nn=40, offset_mode='mid'))\nmdl.add(Properties(name='elset_wall_2_element_prop', material='elset_wall_2_element_mat', section='elset_wall_2_element_sec', elset='elset_wall_2'))\n\n# MPC Materials\nmdl.add(MPCStiff(name='elset_mpc_element_mat'))\n\n# MPC Sections\nmdl.add(MPCSection(name='sec_mpc'))\nmdl.add(Properties(name='elset_mpc_element_prop', material='elset_mpc_element_mat', section='sec_mpc', elset='elset_mpc'))\n\n# Grafical plots \nplot_loc_axes(mdl, axes_scale=50) # Plot Local coordinates \nplot_nr_elem(mdl) # Plot Element Numbers\nplot_nr_nodes(mdl)  # Plot Node Numbers\n\n# Constrains (Displacements)\nmdl.add([GeneralDisplacement(name='nset_pinned_set_disp',  x=0, y=0, z=0, xx=0, yy=0, zz=0, nodes='nset_pinned'),])\n\n\n# Loads and steps\n# ------------------------------------------------------------------------------\n# ------------------------------------------------------------------------------\n\n# Gravity Loads\nmdl.add(GravityLoad(name='load_gravity',  x=0.0,  y=0.0,  z=1.0, elements=[ 'elset_deck' ] ))\n\n# Area Load\nloaded_element_numbers=area_load_generator_elements(mdl,layer='area_load_left') \nmdl.add(AreaLoad(name='area_load_left', elements=loaded_element_numbers,x=0,y=0,z=0.1)) \n \n\n# Steps\nmdl.add([\nGeneralStep(name='step_1',   displacements=[ 'nset_pinned_set_disp' ] ,  nlgeom=False),\nGeneralStep(name='step_2',  loads=['load_gravity'] ,   nlgeom=False, increments=1),\nGeneralStep(name='step_3',  loads=['area_load_left'] ,   nlgeom=False, increments=1),\n])\nmdl.steps_order = [ 'step_1', 'step_2', 'step_3' ] \n\n\n# Run analyses\n# ------------------------------------------------------------------------------\n# ------------------------------------------------------------------------------\nmdl.analyse_and_extract(software='ansys_sel', fields=[ 'u', 'sf', 's', 'eps', 'sig_sr'], lstep = ['step_3'], ansys_version='22') \n\n\n\n# Plot Results\n# ------------------------------------------------------------------------------\n# ------------------------------------------------------------------------------\n\n# Plot Results for step_3\nrhino.plot_data(mdl, lstep='step_3', field='uz', scale=10, cbar_size=1, source='CMMUsermat') # Ploten der Verformungen uz (Resultate: Knoten)\nrhino.plot_data(mdl, lstep='step_3', field='ux', cbar_size=1, source='CMMUsermat') # Ploten der Verformungen ux (Resultate: Knoten)\nrhino.plot_data(mdl, lstep='step_3', field='uy', cbar_size=1, source='CMMUsermat') # Ploten der Verformungen uy (Resultate: Knoten)\nrhino.plot_data(mdl, lstep='step_3', field='sf1', cbar_size=1, source='CMMUsermat') # Ploten der verallgemeinerten Spannungen (Resultate: Elementmitte)\nrhino.plot_data(mdl, lstep='step_3', field='sf2', cbar_size=1, source='CMMUsermat') # Ploten der verallgemeinerten Spannungen (Resultate: Elementmitte)\nrhino.plot_data(mdl, lstep='step_3', field='sf3', cbar_size=1, source='CMMUsermat') # Ploten der verallgemeinerten Spannungen (Resultate: Elementmitte)\nrhino.plot_data(mdl, lstep='step_3', field='sf4', cbar_size=1, source='CMMUsermat') # Ploten der verallgemeinerten Spannungen (Resultate: Elementmitte)\nrhino.plot_data(mdl, lstep='step_3', field='sf5', cbar_size=1, source='CMMUsermat') # Ploten der verallgemeinerten Spannungen (Resultate: Elementmitte)\nrhino.plot_data(mdl, lstep='step_3', field='sm1', cbar_size=1, source='CMMUsermat') # Ploten der verallgemeinerten Spannungen (Resultate: Elementmitte)\nrhino.plot_data(mdl, lstep='step_3', field='sm2', cbar_size=1, source='CMMUsermat') # Ploten der verallgemeinerten Spannungen (Resultate: Elementmitte)\nrhino.plot_data(mdl, lstep='step_3', field='sm3', cbar_size=1, source='CMMUsermat') # Ploten der verallgemeinerten Spannungen (Resultate: Elementmitte)\nrhino.plot_principal_stresses(mdl, step='step_3', shell_layer='top', scale=10**1, numeric='no', values='3') # Hauptspannungen 3 top (Resultate: Gauspunkte)\nrhino.plot_principal_stresses(mdl, step='step_3', shell_layer='top', scale=10**1, numeric='no', values='1') # Hauptspannungen 1 top (Resultate: Gauspunkte)\nrhino.plot_principal_stresses(mdl, step='step_3', shell_layer='bot', scale=10**1, numeric='no', values='3') # Hauptspannungen 3 bot (Resultate: Gauspunkte)\nrhino.plot_principal_stresses(mdl, step='step_3', shell_layer='bot', scale=10**1, numeric='no', values='1') # Hauptspannungen 1 bot (Resultate: Gauspunkte)\nrhino.plot_principal_strains(mdl, step='step_3', shell_layer='top', scale=10**5, numeric='no', values='3') # Hauptverzerrungen 3 top (Resultate: Gauspunkte)\nrhino.plot_principal_strains(mdl, step='step_3', shell_layer='top', scale=10**5, numeric='no', values='1') # Hauptverzerrungen 1 top (Resultate: Gauspunkte)\nrhino.plot_principal_strains(mdl, step='step_3', shell_layer='bot', scale=10**5, numeric='no', values='3') # Hauptverzerrungen 3 bot (Resultate: Gauspunkte)\nrhino.plot_principal_strains(mdl, step='step_3', shell_layer='bot', scale=10**5, numeric='no', values='1') # Hauptverzerrungen 1 bot (Resultate: Gauspunkte)\nrhino.plot_steel_stresses(mdl, step='step_3', Reinf_layer='RL_1', scale=1.3, numeric='no') # Stahlspannungen am Riss 1. Bewehrungslage (Resultate: Gauspunkte)\nrhino.plot_steel_stresses(mdl, step='step_3', Reinf_layer='RL_2', scale=1.3, numeric='no') # Stahlspannungen am Riss 2. Bewehrungslage (Resultate: Gauspunkte)\nrhino.plot_steel_stresses(mdl, step='step_3', Reinf_layer='RL_3', scale=1.3, numeric='no') # Stahlspannungen am Riss 3. Bewehrungslage (Resultate: Gauspunkte)\nrhino.plot_steel_stresses(mdl, step='step_3', Reinf_layer='RL_4', scale=1.3, numeric='no') # Stahlspannungen am Riss 4. Bewehrungslage (Resultate: Gauspunkte)\nrhino.plot_principal_shear(mdl, step='step_3', field='shear', cbar_size=0.5, scale=4, numeric='no', shear_verification='yes', D_max=32, tau_cd=1.4) # (Resultate: Gauspunkte)",
  "language": "python",
  "imports": [],
  "has_docstring": true
}