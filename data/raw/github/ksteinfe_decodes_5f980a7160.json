{
  "source_url": "https://github.com/ksteinfe/decodes/blob/b876d6d01ea23ccbf4558182582a822b008cf2b8/src/decodes/io/rhinoscript/document.py",
  "repo": "ksteinfe/decodes",
  "repo_stars": 43,
  "repo_description": "a platform agnostic generative design library for 3d designers",
  "license": "GPL-3.0",
  "filepath": "src/decodes/io/rhinoscript/document.py",
  "instruction": "Document",
  "code": "import scriptcontext\nimport Rhino\nimport System.Enum\n\ndef CreatePreviewImage(filename, view=None, size=None, flags=0, wireframe=False):\n    \"\"\"Creates a bitmap preview image of the current model\n    Parameters:\n      filename = name of the bitmap file to create\n      view[opt] = title of the view. If omitted, the active view is used\n      size[opt] = two integers that specify width and height of the bitmap\n      flags[opt] = Bitmap creation flags. Can be the combination of:\n          1 = honor object highlighting\n          2 = draw construction plane\n          4 = use ghosted shading\n      wireframe[opt] = If True then a wireframe preview image. If False,\n          a rendered image will be created\n    Returns:\n      True or False indicating success or failure\n    \"\"\"\n    rhview = scriptcontext.doc.Views.ActiveView\n    if view is not None:\n        rhview = scriptcontext.doc.Views.Find(view, False)\n        if rhview is None: return False\n    rhsize = rhview.ClientRectangle.Size\n    if size: rhsize = System.Drawing.Size(size[0], size[1])\n    ignore_highlights = (flags&1)!=1\n    drawcplane = (flags&2)==2\n    useghostedshading = (flags&4)==4\n    if wireframe:\n        return rhview.CreateWireframePreviewImage(filename, rhsize, ignore_highlights, drawcplane)\n    else:\n        return rhview.CreateShadedPreviewImage(filename, rhsize, ignore_highlights, drawcplane, useghostedshading)\n\n\ndef DocumentModified(modified=None):\n    \"\"\"Returns or sets the document's modified flag. This flag indicates whether\n    or not any changes to the current document have been made. NOTE: setting the\n    document modified flag to False will prevent the \"Do you want to save this\n    file...\" from displaying when you close Rhino.\n    Parameters:\n      modified [optional] = the modified state, either True or False\n    Returns:\n      if no modified state is specified, the current modified state\n      if a modified state is specified, the previous modified state\n    \"\"\"\n    oldstate = scriptcontext.doc.Modified\n    if modified is not None and modified!=oldstate:\n        scriptcontext.doc.Modified = modified\n    return oldstate\n\n\ndef DocumentName():\n    \"Returns the name of the currently loaded Rhino document (3DM file)\"\n    return scriptcontext.doc.Name\n\n\ndef DocumentPath():\n    \"Returns path of the currently loaded Rhino document (3DM file)\"\n    return scriptcontext.doc.Path\n\n\ndef EnableRedraw(enable=True):\n    \"\"\"Enables or disables screen redrawing\n    Returns:\n      previous screen redrawing state\n    \"\"\"\n    old = scriptcontext.doc.Views.RedrawEnabled\n    if old!=enable: scriptcontext.doc.Views.RedrawEnabled = enable\n    return old\n\n\ndef ExtractPreviewImage(filename, modelname=None):\n    \"\"\"Extracts the bitmap preview image from the specified model (.3dm)\n    Parameters:\n      filename = name of the bitmap file to create. The extension of\n         the filename controls the format of the bitmap file created.\n         (.bmp, .tga, .jpg, .jpeg, .pcx, .png, .tif, .tiff)\n      modelname [opt] = The model (.3dm) from which to extract the\n         preview image. If omitted, the currently loaded model is used.\n    Returns:\n      True or False indicating success or failure\n    \"\"\"\n    return scriptcontext.doc.ExtractPreviewImage(filename, modelname)\n\n\ndef IsDocumentModified():\n    \"Verifies that the current document has been modified in some way\"\n    return scriptcontext.doc.Modified\n\n\ndef Notes(newnotes=None):\n    \"\"\"Returns or sets the document's notes. Notes are generally created\n    using Rhino's Notes command\n    Parameters:\n      newnotes[opt] = new notes to set\n    Returns:\n      if newnotes is omitted, the current notes if successful\n      if newnotes is specified, the previous notes if successful\n    \"\"\"\n    old = scriptcontext.doc.Notes\n    if newnotes is not None: scriptcontext.doc.Notes = newnotes\n    return old\n\n\ndef ReadFileVersion():\n    \"\"\"Returns the file version of the current document. Use this function to\n    determine which version of Rhino last saved the document. Note, this\n    function will not return values from referenced or merged files.\n    \"\"\"\n    return scriptcontext.doc.ReadFileVersion()\n\n\ndef Redraw():\n    \"Redraws all views\"\n    scriptcontext.doc.Views.Redraw()\n\n\ndef UnitAbsoluteTolerance(tolerance=None, in_model_units=True):\n    \"\"\"Resturns or sets the document's absolute tolerance. Absolute tolerance\n    is measured in drawing units. See Rhino's document properties command\n    (Units and Page Units Window) for details\n    Parameters:\n      tolerance [opt] = the absolute tolerance to set\n      in_model_units[opt] = Return or modify the document's model units (True)\n                            or the document's page units (False)\n    Returns:\n      if tolerance is not specified, the current absolute tolerance\n      if tolerance is specified, the previous absolute tolerance\n    \"\"\"\n    rc = 0\n    if in_model_units:\n        rc = scriptcontext.doc.ModelAbsoluteTolerance\n        if tolerance is not None:\n            scriptcontext.doc.ModelAbsoluteTolerance = tolerance\n    else:\n        rc = scriptcontext.doc.PageAbsoluteTolerance\n        if tolerance is not None:\n            scriptcontext.doc.PageAbsoluteTolerance = tolerance\n    return rc\n\n\ndef UnitAngleTolerance(angle_tolerance_degrees=None, in_model_units=True):\n    \"\"\"Returns or sets the document's angle tolerance. Angle tolerance is\n    measured in degrees. See Rhino's DocumentProperties command\n    (Units and Page Units Window) for details\n    Parameters:\n      angle_tolerance_degrees [opt] = the angle tolerance to set\n      in_model_units [opt] = Return or modify the document's model units (True)\n                             or the document's page units (False)\n    Returns:\n      if angle_tolerance_degrees is not specified, the current angle tolerance\n      if angle_tolerance_degrees is specified, the previous angle tolerance\n    \"\"\"\n    rc = 0\n    if in_model_units:\n        rc = scriptcontext.doc.ModelAngleToleranceDegrees\n        if angle_tolerance_degrees is not None:\n            scriptcontext.doc.ModelAngleToleranceDegrees = angle_tolerance_degrees\n    else:\n        rc = scriptcontext.doc.PageAngleToleranceDegrees\n        if angle_tolerance_degrees is not None:\n            scriptcontext.doc.PageAngleToleranceDegrees = angle_tolerance_degrees\n    return rc\n\n\ndef UnitRelativeTolerance(relative_tolerance=None, in_model_units=True):\n    \"\"\"Returns or sets the document's relative tolerance. Relative tolerance\n    is measured in percent. See Rhino's DocumentProperties command\n    (Units and Page Units Window) for details\n    Parameters:\n      relative_tolerance [opt] = the relative tolerance in percent\n      in_model_units [opt] = Return or modify the document's model units (True)\n                             or the document's page units (False)\n    Returns:\n      if relative_tolerance is not specified, the current tolerance in percent\n      if relative_tolerance is specified, the previous tolerance in percent\n    \"\"\"\n    rc = 0\n    if in_model_units:\n        rc = scriptcontext.doc.ModelRelativeTolerance\n        if relative_tolerance is not None:\n            scriptcontext.doc.ModelRelativeTolerance = relative_tolerance\n    else:\n        rc = scriptcontext.doc.PageRelativeTolerance\n        if relative_tolerance is not None:\n            scriptcontext.doc.PageRelativeTolerance = relative_tolerance\n    return rc\n\n\ndef UnitScale(to_system, from_system=None):\n  \"\"\"Returns the scale factor for changing between unit systems.\n  Parameters:\n    to_system = The unit system to convert to. The unit systems are are:\n       0 - No unit system\n       1 - Microns (1.0e-6 meters)\n       2 - Millimeters (1.0e-3 meters)\n       3 - Centimeters (1.0e-2 meters)\n       4 - Meters\n       5 - Kilometers (1.0e+3 meters)\n       6 - Microinches (2.54e-8 meters, 1.0e-6 inches)\n       7 - Mils (2.54e-5 meters, 0.001 inches)\n       8 - Inches (0.0254 meters)\n       9 - Feet (0.3408 meters, 12 inches)\n      10 - Miles (1609.344 meters, 5280 feet)\n      11 - *Reserved for custom Unit System*\n      12 - Angstroms (1.0e-10 meters)\n      13 - Nanometers (1.0e-9 meters)\n      14 - Decimeters (1.0e-1 meters)\n      15 - Dekameters (1.0e+1 meters)\n      16 - Hectometers (1.0e+2 meters)\n      17 - Megameters (1.0e+6 meters)\n      18 - Gigameters (1.0e+9 meters)\n      19 - Yards (0.9144  meters, 36 inches)\n      20 - Printer point (1/72 inches, computer points)\n      21 - Printer pica (1/6 inches, (computer picas)\n      22 - Nautical mile (1852 meters)\n      23 - Astronomical (1.4959787e+11)\n      24 - Lightyears (9.46073e+15 meters)\n      25 - Parsecs (3.08567758e+16)\n    from_system [opt] = the unit system to convert from (see above). If omitted,\n        the document's current unit system is used\n  Returns:\n    the scale factor for changing between unit systems\n  \"\"\"\n  if from_system is None:\n      from_system = scriptcontext.doc.ModelUnitSystem\n  if type(from_system) is int:\n      from_system = System.Enum.ToObject(Rhino.UnitSystem, from_system)\n  if type(to_system) is int:\n      to_system = System.Enum.ToObject(Rhino.UnitSystem, to_system)\n  return Rhino.RhinoMath.UnitScale(from_system, to_system)\n\n\ndef UnitSystem(unit_system=None, scale=False, in_model_units=True):\n    \"\"\"Returns or sets the document's units system. See Rhino's DocumentProperties\n    command (Units and Page Units Window) for details\n    Parameters:\n      unit_system = The unit system to set the document to. The unit systems are:\n         0 - No unit system\n         1 - Microns (1.0e-6 meters)\n         2 - Millimeters (1.0e-3 meters)\n         3 - Centimeters (1.0e-2 meters)\n         4 - Meters\n         5 - Kilometers (1.0e+3 meters)\n         6 - Microinches (2.54e-8 meters, 1.0e-6 inches)\n         7 - Mils (2.54e-5 meters, 0.001 inches)\n         8 - Inches (0.0254 meters)\n         9 - Feet (0.3408 meters, 12 inches)\n        10 - Miles (1609.344 meters, 5280 feet)\n        11 - *Reserved for custom Unit System*\n        12 - Angstroms (1.0e-10 meters)\n        13 - Nanometers (1.0e-9 meters)\n        14 - Decimeters (1.0e-1 meters)\n        15 - Dekameters (1.0e+1 meters)\n        16 - Hectometers (1.0e+2 meters)\n        17 - Megameters (1.0e+6 meters)\n        18 - Gigameters (1.0e+9 meters)\n        19 - Yards (0.9144  meters, 36 inches)\n        20 - Printer point (1/72 inches, computer points)\n        21 - Printer pica (1/6 inches, (computer picas)\n        22 - Nautical mile (1852 meters)\n        23 - Astronomical (1.4959787e+11)\n        24 - Lightyears (9.46073e+15 meters)\n        25 - Parsecs (3.08567758e+16)\n      scale [opt] = Scale existing geometry based on the new unit system.\n          If not specified, any existing geometry is not scaled (False)\n      in_model_units [opt] = Return or modify the document's model units (True)\n          or the document's page units (False). The default is True.\n    Returns:\n      if unit_system is no specified, then the current unit system\n      if unit_system is specified, then the previous unit system\n      None on error\n    \"\"\"\n    if (unit_system is not None and (unit_system<1 or unit_system>25)):\n        raise ValueError(\"unit_system value of %s is not valid\"%unit_system)\n    rc = None\n    if in_model_units:\n        rc = int(scriptcontext.doc.ModelUnitSystem)\n        if unit_system is not None:\n            unit_system = System.Enum.ToObject(Rhino.UnitSystem, unit_system)\n            scriptcontext.doc.AdjustModelUnitSystem(unit_system, scale)\n    else:\n        rc = int(scriptcontext.doc.PageUnitSystem)\n        if unit_system is not None:\n            unit_system = System.Enum.ToObject(Rhino.UnitSystem, unit_system)\n            scriptcontext.doc.AdjustPageUnitSystem(unit_system, scale)\n    return rc\n",
  "language": "python",
  "imports": [
    "Rhino",
    "scriptcontext"
  ],
  "has_docstring": false
}