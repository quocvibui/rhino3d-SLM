{
  "source_url": "https://discourse.mcneel.com/t/plugin-installer-rhinocommon-version-mismatch/111085",
  "topic_id": 111085,
  "title": "Plugin installer RhinoCommon version mismatch",
  "question": "I struggled a bit to upgrade our v6 project to v7 on Mac but succeeded.\n\n\nI’ve copied the Mac VS Project to a new Project that are targeting Windows like in the cross platform guide.\n\n\nIt mostly works, except for the installer. I have \n7.0.20295.18003\n installed, and I’ve tried to uninstall RhinoCommon and reinstall that exact version with NuGet. I’ve tried deleting the \nbin\n and \nobj\n folders. The logs are below indicate I have some kind of wrong version: \n7.0.20295.18000\n (notice the 0 at the end instead of the 3). Is there any other directories I can try to delete, caches I can try to clear etc?\n\n\n(I got a much simpler plugin working with the above method so it should sort of be working \n)\n\n\n10/27/2020 21:52:54\t6016\tInfo\tStart: rhiexec\n\t\t\t\t\tversion 7.0.20295.18003\n\t\t\t\t\t64-bit\n\t\t\t\t\tunknown   10.0.17763.0\n10/27/2020 21:52:54\t6016\tInfo\targuments: \n\t\t\t\t\t\"C:\\Users\\Administrator\\source\\repos\\...\\stykka-windows-plugin.rhi\"\n10/27/2020 21:52:54\t6016\tInfo\tLogging started: 2020/10/27 21:52:54\n10/27/2020 21:52:54\t6016\tDebug\tUnknown\tInstallerDialog_Load starting\t(0%)\n10/27/2020 21:52:54\t6016\tDebug\tUnknown\tInstallerDialog_Load ending\t(0%)\n10/27/2020 21:52:54\t6016\tDebug\tUnknown\tShowInitializationDialog starting\t(0%)\n10/27/2020 21:52:54\t6016\tDebug\tUnknown\tSwapPanel starting\t(0%)\n10/27/2020 21:52:54\t6016\tDebug\tUnknown\tSwapPanel ending\t(0%)\n10/27/2020 21:52:54\t6016\tDebug\tUnknown\tShowPanel ending\t(0%)\n10/27/2020 21:52:54\t6016\tDebug\tUnknown\tShowInitializationDialog ending\t(0%)\n10/27/2020 21:52:54\t6016\tDebug\tExecuteChildProcess starting: x86, /INSPECTPLUGIN \"C:\\Users\\Administrator\\AppData\\Local\\Temp\\2\\rhiexec\\0f34755c-9fe1-43ab-945e-6138ab5ed39a\\StykkaRhinoPluginWin.rhp\"\n10/27/2020 21:52:54\t6016\tDebug\tStarting: C:\\Program Files\\McNeel\\Rhino Installer Engine\\x64\\..\\x86\\rhiexec.exe /loglevel=Debug /logfile=\"C:\\Users\\Administrator\\AppData\\Roaming\\McNeel\\Rhinoceros\\7.0\\logs\\stykka-windows-plugin (20201027-215254).log\" /noerrorreports /INSPECTPLUGIN \"C:\\Users\\Administrator\\AppData\\Local\\T...",
  "code_blocks": [
    {
      "code": "10/27/2020 21:52:54\t6016\tInfo\tStart: rhiexec\n\t\t\t\t\tversion 7.0.20295.18003\n\t\t\t\t\t64-bit\n\t\t\t\t\tunknown   10.0.17763.0\n10/27/2020 21:52:54\t6016\tInfo\targuments: \n\t\t\t\t\t\"C:\\Users\\Administrator\\source\\repos\\...\\stykka-windows-plugin.rhi\"\n10/27/2020 21:52:54\t6016\tInfo\tLogging started: 2020/10/27 21:52:54\n10/27/2020 21:52:54\t6016\tDebug\tUnknown\tInstallerDialog_Load starting\t(0%)\n10/27/2020 21:52:54\t6016\tDebug\tUnknown\tInstallerDialog_Load ending\t(0%)\n10/27/2020 21:52:54\t6016\tDebug\tUnknown\tShowInitializationDialog starting\t(0%)\n10/27/2020 21:52:54\t6016\tDebug\tUnknown\tSwapPanel starting\t(0%)\n10/27/2020 21:52:54\t6016\tDebug\tUnknown\tSwapPanel ending\t(0%)\n10/27/2020 21:52:54\t6016\tDebug\tUnknown\tShowPanel ending\t(0%)\n10/27/2020 21:52:54\t6016\tDebug\tUnknown\tShowInitializationDialog ending\t(0%)\n10/27/2020 21:52:54\t6016\tDebug\tExecuteChildProcess starting: x86, /INSPECTPLUGIN \"C:\\Users\\Administrator\\AppData\\Local\\Temp\\2\\rhiexec\\0f34755c-9fe1-43ab-945e-6138ab5ed39a\\StykkaRhinoPluginWin.rhp\"\n10/27/2020 21:52:54\t6016\tDebug\tStarting: C:\\Program Files\\McNeel\\Rhino Installer Engine\\x64\\..\\x86\\rhiexec.exe /loglevel=Debug /logfile=\"C:\\Users\\Administrator\\AppData\\Roaming\\McNeel\\Rhinoceros\\7.0\\logs\\stykka-windows-plugin (20201027-215254).log\" /noerrorreports /INSPECTPLUGIN \"C:\\Users\\Administrator\\AppData\\Local\\Temp\\2\\rhiexec\\0f34755c-9fe1-43ab-945e-6138ab5ed39a\\StykkaRhinoPluginWin.rhp\"\n10/27/2020 21:52:54\t6016\tDebug\tUnknown\tShowPanel starting\t(0%)\n10/27/2020 21:52:54\t6016\tInfo\tInitializing\tINIT START: \t(0%)\n10/27/2020 21:52:54\t6016\tInfo\tUnknown\tFound 1 plug-ins\t(0%)\n10/27/2020 21:52:54\t6016\tInfo\tInitializing\tInitializing Installer\t(0%)\n10/27/2020 21:52:54\t6016\tInfo\tUnknown\tFound 1 plug-ins\t(0%)\n10/27/2020 21:52:54\t6016\tDebug\tUnknown\tExecuting 32-bit Plug-in Inspector for 'C:\\Users\\Administrator\\AppData\\Local\\Temp\\2\\rhiexec\\0f34755c-9fe1-43ab-945e-6138ab5ed39a\\StykkaRhinoPluginWin.rhp'\t(0%)\n10/27/2020 21:52:54\t4260\tInfo\tStart: rhiexec\n\t\t\t\t\tversion 7.0.20295.18003\n\t\t\t\t\t32-bit\n\t\t\t\t\tunknown   10.0.17763.0\n10/27/2020 21:52:54\t4260\tInfo\targuments: \n\t\t\t\t\t\"/loglevel=Debug\"\n\t\t\t\t\t\"/logfile=C:\\Users\\Administrator\\AppData\\Roaming\\McNeel\\Rhinoceros\\7.0\\logs\\stykka-windows-plugin (20201027-215254).log\"\n\t\t\t\t\t\"/noerrorreports\"\n\t\t\t\t\t\"/INSPECTPLUGIN\"\n\t\t\t\t\t\"C:\\Users\\Administrator\\AppData\\Local\\Temp\\2\\rhiexec\\0f34755c-9fe1-43ab-945e-6138ab5ed39a\\StykkaRhinoPluginWin.rhp\"\n10/27/2020 21:52:54\t4260\tInfo\tLogging started: 2020/10/27 21:52:54\n10/27/2020 21:52:54\t6016\tInfo\tUnknown\tPackage not recognized as Localization Package\t(0%)\n10/27/2020 21:52:55\t4260\tError\tException: System.IO.FileLoadException\n\t\t\t\t\tMessage: Cannot resolve dependency to assembly 'RhinoCommon, Version=7.0.20295.18000, Culture=neutral, PublicKeyToken=552281e97c755530' because it has not been preloaded. When using the ReflectionOnly APIs, dependent assemblies must be pre-loaded or loaded on demand through the ReflectionOnlyAssemblyResolve event.\n\t\t\t\t\tSource: mscorlib\n\t\t\t\t\tStackTrace:    at System.ModuleHandle.ResolveMethod(RuntimeModule module, Int32 methodToken, IntPtr* typeInstArgs, Int32 typeInstCount, IntPtr* methodInstArgs, Int32 methodInstCount)\n\t\t\t\t\t   at System.ModuleHandle.ResolveMethodHandleInternalCore(RuntimeModule module, Int32 methodToken, IntPtr[] typeInstantiationContext, Int32 typeInstCount, IntPtr[] methodInstantiationContext, Int32 methodInstCount)\n\t\t\t\t\t   at System.ModuleHandle.ResolveMethodHandleInternal(RuntimeModule module, Int32 methodToken, RuntimeTypeHandle[] typeInstantiationContext, RuntimeTypeHandle[] methodInstantiationContext)\n\t\t\t\t\t   at System.Reflection.CustomAttributeData..ctor(RuntimeModule scope, CustomAttributeRecord caRecord)\n\t\t\t\t\t   at System.Reflection.CustomAttributeData.GetCustomAttributes(RuntimeModule module, Int32 tkTarget)\n\t\t\t\t\t   at System.Reflection.CustomAttributeData.GetCustomAttributesInternal(RuntimeAssembly target)\n\t\t\t\t\t   at System.Reflection.RuntimeAssembly.GetCustomAttributesData()\n\t\t\t\t\t   at System.Reflection.CustomAttributeData.GetCustomAttributes(Assembly target)\n\t\t\t\t\t   at RhiExec.PluginInfo.GetPluginAttributes(AsyncReporter reporter)\n\t\t\t\t\t   at RhiExec.PluginInfo.InspectPlugin(String rhp_file, AsyncReporter reporter)\n\t\t\t\t\t   at RhiExec.InstallerPlugin.InspectPlugin(String PathToPlugin, AsyncReporter reporter)\n\t\t\t\t\t   at RhiExec.Program.Main(String[] args)\n\t\t\t\t\t\n10/27/2020 21:52:55\t4260\tDebug\tFinalExit\tExiting installation with return code Exception\n10/27/2020 21:52:55\t4260\tInfo\tLogging ended: 2020/10/27 21:52:55\n\t\t\t\t\t\n10/27/2020 21:52:55\t6016\tDebug\tExecuteChildProcess complete. Child process returned: Exception\n10/27/2020 21:52:55\t6016\tDebug\tExecuteChildProcess starting: x64, /INSPECTPLUGIN \"C:\\Users\\Administrator\\AppData\\Local\\Temp\\2\\rhiexec\\0f34755c-9fe1-43ab-945e-6138ab5ed39a\\StykkaRhinoPluginWin.rhp\"\n10/27/2020 21:52:55\t6016\tDebug\tStarting: C:\\Program Files\\McNeel\\Rhino Installer Engine\\x64\\..\\x64\\rhiexec.exe /loglevel=Debug /logfile=\"C:\\Users\\Administrator\\AppData\\Roaming\\McNeel\\Rhinoceros\\7.0\\logs\\stykka-windows-plugin (20201027-215254).log\" /noerrorreports /INSPECTPLUGIN \"C:\\Users\\Administrator\\AppData\\Local\\Temp\\2\\rhiexec\\0f34755c-9fe1-43ab-945e-6138ab5ed39a\\StykkaRhinoPluginWin.rhp\"\n10/27/2020 21:52:55\t2648\tInfo\tStart: rhiexec\n\t\t\t\t\tversion 7.0.20295.18003\n\t\t\t\t\t64-bit\n\t\t\t\t\tunknown   10.0.17763.0\n10/27/2020 21:52:55\t2648\tInfo\targuments: \n\t\t\t\t\t\"/loglevel=Debug\"\n\t\t\t\t\t\"/logfile=C:\\Users\\Administrator\\AppData\\Roaming\\McNeel\\Rhinoceros\\7.0\\logs\\stykka-windows-plugin (20201027-215254).log\"\n\t\t\t\t\t\"/noerrorreports\"\n\t\t\t\t\t\"/INSPECTPLUGIN\"\n\t\t\t\t\t\"C:\\Users\\Administrator\\AppData\\Local\\Temp\\2\\rhiexec\\0f34755c-9fe1-43ab-945e-6138ab5ed39a\\StykkaRhinoPluginWin.rhp\"\n10/27/2020 21:52:55\t2648\tInfo\tLogging started: 2020/10/27 21:52:55\n10/27/2020 21:52:55\t2648\tError\tException: RhiExec.PackageNotCompatibleException\n\t\t\t\t\tMessage: This plug-in is not compatible with the Rhino Installer Engine.\n\t\t\t\t\tPlug-in: C:\\Users\\Administrator\\AppData\\Local\\Temp\\2\\rhiexec\\0f34755c-9fe1-43ab-945e-6138ab5ed39a\\StykkaRhinoPluginWin.rhp\n\t\t\t\t\t\n\t\t\t\t\tFor details on the Rhino Installer Engine, please visit http://developer.rhino3d.com/guides/general/rhino-installer-engine\n\t\t\t\t\tSource: RhiExec\n\t\t\t\t\tStackTrace:    at RhiExec.PluginInfo.InspectPlugin(String rhp_file, AsyncReporter reporter)\n\t\t\t\t\t   at RhiExec.InstallerPlugin.InspectPlugin(String PathToPlugin, AsyncReporter reporter)\n\t\t\t\t\t   at RhiExec.Program.Main(String[] args)\n\t\t\t\t\t\n10/27/2020 21:52:55\t2648\tDebug\tFinalExit\tExiting installation with return code InspctPkgNotCompatible\n10/27/2020 21:52:55\t2648\tInfo\tLogging ended: 2020/10/27 21:52:55\n\t\t\t\t\t\n10/27/2020 21:52:55\t6016\tDebug\tExecuteChildProcess complete. Child process returned: InspctPkgNotCompatible\n10/27/2020 21:52:55\t6016\tError\tUnknown\tPlug-in inspection failed\t(0%)\n10/27/2020 21:52:55\t6016\tDebug\tUnknown\tExecuting 64-bit Plug-in Inspector for 'C:\\Users\\Administrator\\AppData\\Local\\Temp\\2\\rhiexec\\0f34755c-9fe1-43ab-945e-6138ab5ed39a\\StykkaRhinoPluginWin.rhp'\t(0%)\n10/27/2020 21:52:55\t6016\tError\tThis package is not compatible with the Rhino Installer Engine.\n\t\t\t\t\t\n\t\t\t\t\tYou may need to update to the latest Rhino Service Release to use this plug-in.\n\t\t\t\t\t\n\t\t\t\t\tDEVELOPERS:\n\t\t\t\t\tFor information on making your plug-in compatible, visit http://developer.rhino3d.com/guides/general/rhino-installer-engine\n10/27/2020 21:52:56\t6016\tDebug\tUnknown\tShowPanel starting\t(0%)\n10/27/2020 21:52:56\t6016\tDebug\tUnknown\tSwapPanel ending\t(0%)\n10/27/2020 21:52:56\t6016\tDebug\tUnknown\tShowPanel ending\t(0%)\n10/27/2020 21:52:56\t6016\tDebug\tUnknown\tSwapPanel starting\t(0%)",
      "language": "csharp",
      "author": "aske",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "csharp",
    "python",
    "rhinocommon"
  ],
  "has_accepted_answer": true,
  "category_id": 3,
  "posts_count": 16,
  "views": 968
}