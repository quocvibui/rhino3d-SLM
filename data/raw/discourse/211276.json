{
  "source_url": "https://discourse.mcneel.com/t/detailview-changes-with-grasshopper/211276",
  "topic_id": 211276,
  "title": "DetailView changes with grasshopper",
  "question": "I‚Äôm trying to programmatically modify an existing \nDetailView\n in a Rhino 8 layout using RhinoCommon (.NET 7). The code successfully finds the target detail, updates its camera location, target, projection, and display mode, and then calls \nCommitViewportChanges()\n followed by \nCommitChanges()\n. However, none of these visual changes appear in the layout ‚Äî the detail‚Äôs view remains unchanged even though no errors are reported. It seems like the viewport updates aren‚Äôt being reflected or synchronized correctly between the \nDetailViewObject\n, its runtime \nDetailView\n, and the layout page.\n\n\n// -*- coding: utf-8 -*-\n// ORIOL ‚Äî Components/Layout/DetailEdit\n// Author: Sebasti√°n Valenzuela Ferry\n// Description: Modifies an existing Detail by applying camera, projection, display mode, \n// and frustum from a reference view, with proper commit order for Rhino 8 / .NET 7.\n\nusing Grasshopper.Kernel;\nusing Oriol.Core;\nusing Rhino;\nusing Rhino.DocObjects;\nusing Rhino.Geometry;\nusing System;\nusing System.Drawing;\nusing System.Linq;\nusing DisplayModeDescription = Rhino.Display.DisplayModeDescription;\nusing ViewportInfo = Rhino.DocObjects.ViewportInfo;\n\nnamespace Oriol.Components.Layout\n{\n    public class DetailEdit : GH_Component\n    {\n        private bool _prevRun = false;\n\n        public DetailEdit()\n            : base(\"Edit Detail\", \"DetailEdit\",\n                   \"Edits an existing Detail applying camera, projection, display mode, and frustum from a reference view.\",\n                   \"ORIOL\", \"LAYOUT\")\n        { }\n\n        public override GH_Exposure Exposure => GH_Exposure.primary;\n\n        protected override void RegisterInputParams(GH_InputParamManager p)\n        {\n            p.AddBooleanParameter(\"Run\", \"R\", \"Executes the action (toggle or button).\", GH_ParamAccess.item, false);\n            p.AddTextParameter(\"GUID\", \"G\", \"GUID of the DetailView object to edit.\", GH_ParamAccess.item);\n            p.AddTextParameter(\"Display\", \"D\", \"Display mode (Wireframe, Rendered, etc...",
  "code_blocks": [
    {
      "code": "// -*- coding: utf-8 -*-\n// ORIOL ‚Äî Components/Layout/NewDetail (Rhino 8 / .NET 7)\n// Autor: Sebasti√°n Valenzuela Ferry\n// Descripci√≥n:\n//   Crea uno o varios DetailView en Layouts existentes basados en la vista activa.\n//   Copia c√°mara, proyecci√≥n y modo de visualizaci√≥n desde la vista fuente,\n//   pero si se proporciona entrada en ‚ÄúDisplay Mode‚Äù, esa tiene prioridad.\n//   Incluye persistencia visual, bloqueo de redibujado tipo ‚ÄúIterStar‚Äù y log de rendimiento.\n\n#nullable enable\n\nusing Grasshopper.Kernel;\nusing Rhino;\nusing Rhino.Display;\nusing Rhino.DocObjects;\nusing Rhino.Geometry;\nusing System;\nusing System.Collections.Generic;\nusing System.Diagnostics;\nusing System.Drawing;\nusing System.Linq;\n\nnamespace Oriol.Components.Layout\n{\n    public class NewDetail : GH_Component\n    {\n        private bool _lastRun = false;\n\n        private static readonly Dictionary<Guid, (string, List<Guid>, List<string>)> _lastOutputs = new();\n        private static readonly Dictionary<Guid, string> _displayHistory = new();\n\n        public NewDetail() : base(\n            \"New Detail\", \"NewDetail\",\n            \"Crea uno o varios DetailView en Layouts existentes de Rhino 8. Copia c√°mara, proyecci√≥n y modo de visualizaci√≥n desde la vista de referencia, o usa el modo conectado en ‚ÄúDisplay Mode‚Äù.\",\n            \"Oriol\", \"Layout\")\n        { }\n\n        public override Guid ComponentGuid => new(\"XXXXXXXXXXXXXX\");\n\n#pragma warning disable CA1416\n        protected override Bitmap Icon\n        {\n            get\n            {\n                var asm = typeof(NewDetail).Assembly;\n                using var s = asm.GetManifestResourceStream(\"Oriol.Resources.NewDetail.png\");\n                return s != null ? new Bitmap(s) : new Bitmap(24, 24);\n            }\n        }\n#pragma warning restore CA1416\n\n        public override GH_Exposure Exposure => GH_Exposure.primary;\n\n        protected override void RegisterInputParams(GH_InputParamManager p)\n        {\n            p.AddBooleanParameter(\"Run\", \"R\", \"Ejecutar creaci√≥n (flanco ascendente)\", GH_ParamAccess.item, false);\n            p.AddTextParameter(\"Layout\", \"L\", \"Nombre del Layout de destino\", GH_ParamAccess.list);\n            p.AddCurveParameter(\"Bounds\", \"B\", \"Curvas cerradas (rect√°ngulos) en coordenadas de p√°gina\", GH_ParamAccess.list);\n            p.AddTextParameter(\"Nombre\", \"N\", \"Nombre visible del Detail\", GH_ParamAccess.list, \"DetailView\");\n            p.AddNumberParameter(\"Escala\", \"S\", \"Escala (1:X) ‚Äî 1.0 = 1:1\", GH_ParamAccess.list, 50.0);\n            p.AddGenericParameter(\"View Source\", \"V\", \"Vista de referencia (nombre, NamedView, RhinoView o Gh_View)\", GH_ParamAccess.list);\n            p.AddTextParameter(\"Display Mode\", \"M\", \"Modo de visualizaci√≥n opcional (Wireframe, Shaded, Rendered, Ghosted, Arctic, etc.)\", GH_ParamAccess.list);\n            p[6].Optional = true;\n        }\n\n        protected override void RegisterOutputParams(GH_OutputParamManager p)\n        {\n            p.AddTextParameter(\"Status\", \"S\", \"Mensajes de estado del proceso.\", GH_ParamAccess.list);\n            p.AddGenericParameter(\"Detail Id\", \"ID\", \"Identificadores GUID de los Details creados.\", GH_ParamAccess.list);\n            p.AddTextParameter(\"Detail Name\", \"DN\", \"Nombres de los Details creados.\", GH_ParamAccess.list);\n        }\n\n        protected override void SolveInstance(IGH_DataAccess DA)\n        {\n            bool run = false;\n            if (!DA.GetData(0, ref run)) return;\n\n            bool risingEdge = run && !_lastRun;\n            _lastRun = run;\n\n            if (!risingEdge)\n            {\n                if (_lastOutputs.TryGetValue(InstanceGuid, out var cached))\n                {\n                    DA.SetDataList(0, new List<string> { cached.Item1 });\n                    DA.SetDataList(1, cached.Item2);\n                    DA.SetDataList(2, cached.Item3);\n                }\n                else\n                    DA.SetData(0, \"üü° Inactivo ‚Äî sin datos previos.\");\n                return;\n            }\n\n            var layoutName = new List<string>();\n            var bounds = new List<Curve>();\n            var nombre = new List<string>();\n            var scale = new List<double>();\n            var views = new List<object>();\n            var displayModeName = new List<string>();\n\n            DA.GetDataList(1, layoutName);\n            DA.GetDataList(2, bounds);\n            DA.GetDataList(3, nombre);\n            DA.GetDataList(4, scale);\n            DA.GetDataList(5, views);\n            DA.GetDataList(6, displayModeName);\n\n            if (layoutName.Count == 0 || bounds.Count == 0)\n            {\n                AddRuntimeMessage(GH_RuntimeMessageLevel.Error, \"Entradas insuficientes (Layout o Bounds).\");\n                return;\n            }\n\n            int count = new[] { layoutName.Count, bounds.Count, nombre.Count, scale.Count, views.Count }.Max();\n\n            var statusList = new List<string>();\n            var idList = new List<Guid>();\n            var nameList = new List<string>();\n            int createdCount = 0, failedCount = 0;\n\n            var doc = RhinoDoc.ActiveDoc;\n            if (doc == null)\n            {\n                AddRuntimeMessage(GH_RuntimeMessageLevel.Error, \"No hay documento activo.\");\n                return;\n            }\n\n            uint undo = doc.BeginUndoRecord(\"ORIOL.NewDetail.Batch\");\n            bool prevRedraw = doc.Views.RedrawEnabled;\n            doc.Views.RedrawEnabled = false;\n            var timer = Stopwatch.StartNew();\n\n            try\n            {\n                for (int i = 0; i < count; i++)\n                {\n                    string? layoutName_i = SafeIndex(layoutName, i) ?? layoutName.LastOrDefault();\n                    Curve? bounds_i = SafeIndex(bounds, i);\n                    string nombre_i = SafeIndex(nombre, i, $\"Detail_{i}\") ?? $\"Detail_{i}\";\n                    double scale_i = SafeIndex(scale, i, 50.0);\n                    object? viewInput_i = SafeIndex(views, i);\n                    string? displayMode_i = SafeIndex(displayModeName, i);\n\n                    var page = doc.Views.GetPageViews()\n                        .FirstOrDefault(v => v.PageName.Equals(layoutName_i, StringComparison.OrdinalIgnoreCase));\n                    if (page == null)\n                    {\n                        statusList.Add($\"‚ö†Ô∏è Layout '{layoutName_i}' no encontrado.\");\n                        idList.Add(Guid.Empty);\n                        nameList.Add(nombre_i);\n                        failedCount++;\n                        continue;\n                    }\n\n                    doc.Views.ActiveView = page;\n\n                    if (bounds_i == null || !bounds_i.IsValid || !bounds_i.TryGetPlane(out Plane plano))\n                    {\n                        statusList.Add($\"‚ö†Ô∏è Curva inv√°lida para '{nombre_i}'.\");\n                        idList.Add(Guid.Empty);\n                        nameList.Add(nombre_i);\n                        failedCount++;\n                        continue;\n                    }\n\n                    var bb = bounds_i.GetBoundingBox(true);\n                    var rect = new Rectangle3d(plano, bb.Min, bb.Max);\n                    Point2d corner0 = new(rect.Corner(3).X, rect.Corner(3).Y);\n                    Point2d corner1 = new(rect.Corner(1).X, rect.Corner(1).Y);\n\n                    var existing = page.GetDetailViews()\n                        .FirstOrDefault(d => d.Attributes.Name == nombre_i || d.Name == nombre_i);\n                    if (existing != null)\n                        doc.Objects.Delete(existing.Id, true);\n\n                    var srcInfo = Oriol.Core.ViewInterpreter.ResolveViewportInfo(viewInput_i!);\n                    if (srcInfo is null)\n                    {\n                        var fallbackView = doc.Views.ActiveView\n                            ?? doc.Views.GetViewList(ViewTypeFilter.ModelStyleViews).FirstOrDefault();\n                        if (fallbackView != null)\n                            srcInfo = new ViewportInfo(fallbackView.ActiveViewport);\n                        else\n                        {\n                            statusList.Add($\"‚ö†Ô∏è Vista no v√°lida para '{nombre_i}'.\");\n                            idList.Add(Guid.Empty);\n                            nameList.Add(nombre_i);\n                            failedCount++;\n                            continue;\n                        }\n                    }\n\n                    var projection = srcInfo.IsParallelProjection\n                        ? DefinedViewportProjection.Top\n                        : DefinedViewportProjection.Perspective;\n\n                    var detailObj = page.AddDetailView(nombre_i, corner0, corner1, projection);\n                    if (detailObj == null)\n                    {\n                        statusList.Add($\"‚ùå No se pudo crear '{nombre_i}' en '{layoutName_i}'.\");\n                        idList.Add(Guid.Empty);\n                        nameList.Add(nombre_i);\n                        failedCount++;\n                        continue;\n                    }\n\n                    detailObj.Attributes.Name = nombre_i;\n                    detailObj.Attributes.SetUserString(\"ORIOL.DetailName\", nombre_i);\n                    detailObj.CommitChanges();\n\n                    // üîπ Aplicar c√°mara y DisplayMode de la vista fuente\n                    Oriol.Core.ViewInterpreter.ApplyViewportInfoToDetail(srcInfo, detailObj.Viewport);\n\n                    // üîπ Si se da entrada \"Display Mode\", sobrescribir el modo heredado\n                    string? finalMode = displayMode_i;\n                    if (string.IsNullOrWhiteSpace(finalMode))\n                    {\n                        // Si no hay entrada, intentar usar modo previo persistente\n                        _displayHistory.TryGetValue(detailObj.Id, out finalMode);\n                    }\n\n                    if (!string.IsNullOrWhiteSpace(finalMode))\n                    {\n                        var mode = DisplayModeDescription.GetDisplayModes()\n                            .FirstOrDefault(m => m.EnglishName.Equals(finalMode, StringComparison.OrdinalIgnoreCase));\n                        if (mode != null)\n                        {\n                            detailObj.Viewport.DisplayMode = mode;\n\n                            // üß≠ Rhino 8: CommitViewportChanges() refresca el pipeline visual\n                            detailObj.CommitViewportChanges();\n                            page.Redraw();\n\n                            _displayHistory[detailObj.Id] = mode.EnglishName;\n                        }\n                        else\n                        {\n                            AddRuntimeMessage(GH_RuntimeMessageLevel.Warning,\n                                $\"Modo '{finalMode}' no encontrado, se mantiene el de la vista fuente.\");\n                        }\n                    }\n\n\n\n\n\n\n                    // Escala (heredada o de entrada)\n                    if (viewInput_i is DetailViewObject srcDetail)\n                    {\n                        double inheritedScale = srcDetail.DetailGeometry.PageToModelRatio;\n                        if (inheritedScale > 0)\n                            scale_i = inheritedScale;\n                    }\n\n                    if (scale_i > 0)\n                    {\n                        var dgeom = detailObj.DetailGeometry;\n                        dgeom.SetScale(1.0 / scale_i, doc.ModelUnitSystem, 1.0, doc.PageUnitSystem);\n                        dgeom.IsProjectionLocked = true;\n                        detailObj.CommitChanges();\n                    }\n\n                    detailObj.CommitViewportChanges();\n                    detailObj.CommitChanges();\n\n                    Guid detailId = detailObj.Id;\n                    if (detailId == Guid.Empty)\n                    {\n                        var found = doc.Objects.FindByObjectType(ObjectType.Detail)\n                            .OfType<DetailViewObject>()\n                            .FirstOrDefault(d => d.Attributes.Name == nombre_i);\n                        if (found != null)\n                            detailId = found.Id;\n                    }\n\n                    statusList.Add($\"‚úÖ Detail '{nombre_i}' creado correctamente en layout '{layoutName_i}'.\");\n                    idList.Add(detailId);\n                    nameList.Add(nombre_i);\n                    createdCount++;\n                }\n            }\n            finally\n            {\n                timer.Stop();\n                double seconds = timer.Elapsed.TotalSeconds;\n\n                doc.EndUndoRecord(undo);\n                doc.Views.RedrawEnabled = prevRedraw;\n                doc.Views.Redraw();\n\n                string emoji = failedCount > 0 ? \"‚ö†Ô∏è\" : \"‚úÖ\";\n                string report = $\"{emoji} {createdCount} Details creados en {seconds:0.00} s ({failedCount} fallidos)\";\n                RhinoApp.WriteLine($\"[ORIOL] {report}\");\n                statusList.Add(report);\n            }\n\n            _lastOutputs[InstanceGuid] = ($\"{statusList.LastOrDefault()}\", idList, nameList);\n\n            DA.SetDataList(0, statusList);\n            DA.SetDataList(1, idList);\n            DA.SetDataList(2, nameList);\n        }\n\n        private static T? SafeIndex<T>(IReadOnlyList<T>? list, int index, T? fallback = default)\n        {\n            if (list is null || list.Count == 0)\n                return fallback;\n            return (index >= 0 && index < list.Count) ? list[index] : fallback;\n        }\n    }\n}",
      "language": "csharp",
      "author": "sebastian.valenzu.11",
      "post_number": 4,
      "is_solution": false
    },
    {
      "code": "// -*- coding: utf-8 -*-\n// ORIOL ‚Äî Components/Layout/DetailEdit\n// Author: Sebasti√°n Valenzuela Ferry\n// Description: Modifies an existing Detail by applying camera, projection, display mode, \n// and frustum from a reference view, with proper commit order for Rhino 8 / .NET 7.\n\nusing Grasshopper.Kernel;\nusing Oriol.Core;\nusing Rhino;\nusing Rhino.DocObjects;\nusing Rhino.Geometry;\nusing System;\nusing System.Drawing;\nusing System.Linq;\nusing DisplayModeDescription = Rhino.Display.DisplayModeDescription;\nusing ViewportInfo = Rhino.DocObjects.ViewportInfo;\n\nnamespace Oriol.Components.Layout\n{\n    public class DetailEdit : GH_Component\n    {\n        private bool _prevRun = false;\n\n        public DetailEdit()\n            : base(\"Edit Detail\", \"DetailEdit\",\n                   \"Edits an existing Detail applying camera, projection, display mode, and frustum from a reference view.\",\n                   \"ORIOL\", \"LAYOUT\")\n        { }\n\n        public override GH_Exposure Exposure => GH_Exposure.primary;\n\n        protected override void RegisterInputParams(GH_InputParamManager p)\n        {\n            p.AddBooleanParameter(\"Run\", \"R\", \"Executes the action (toggle or button).\", GH_ParamAccess.item, false);\n            p.AddTextParameter(\"GUID\", \"G\", \"GUID of the DetailView object to edit.\", GH_ParamAccess.item);\n            p.AddTextParameter(\"Display\", \"D\", \"Display mode (Wireframe, Rendered, etc.).\", GH_ParamAccess.item);\n            p.AddBoxParameter(\"Target\", \"T\", \"Target box or camera focus point.\", GH_ParamAccess.item);\n            p.AddNumberParameter(\"Scale\", \"S\", \"Page-to-model scale.\", GH_ParamAccess.item, 1.0);\n            p.AddIntegerParameter(\"Projection\", \"P\", \"Projection type (Top, Front, Perspective...).\", GH_ParamAccess.item, 0);\n            p.AddGenericParameter(\"View\", \"V\", \"View or ViewportInfo to replicate camera and frustum from.\", GH_ParamAccess.item);\n            for (int i = 2; i <= 6; i++) p[i].Optional = true;\n        }\n\n        protected override void RegisterOutputParams(GH_OutputParamManager p)\n        {\n            p.AddTextParameter(\"Result\", \"R\", \"Operation result.\", GH_ParamAccess.item);\n            p.AddTextParameter(\"Display\", \"D\", \"Final display mode.\", GH_ParamAccess.item);\n            p.AddPointParameter(\"Target\", \"T\", \"Resulting camera target.\", GH_ParamAccess.item);\n            p.AddNumberParameter(\"Scale\", \"S\", \"Final detail scale.\", GH_ParamAccess.item);\n            p.AddTextParameter(\"Projection\", \"P\", \"Current projection name.\", GH_ParamAccess.item);\n            p.AddPointParameter(\"Camera\", \"C\", \"Resulting camera location (for debugging).\", GH_ParamAccess.item);\n        }\n\n        protected override void SolveInstance(IGH_DataAccess DA)\n        {\n            bool run = false;\n            string guidText = \"\";\n            string displayName = \"\";\n            BoundingBox targetBox = BoundingBox.Empty;\n            double scale = 1.0;\n            int projInt = 0;\n            object viewInput = null!;\n\n            DA.GetData(0, ref run);\n            DA.GetData(1, ref guidText);\n            DA.GetData(2, ref displayName);\n            DA.GetData(3, ref targetBox);\n            DA.GetData(4, ref scale);\n            DA.GetData(5, ref projInt);\n            DA.GetData(6, ref viewInput);\n\n            // Rising edge detection\n            bool risingEdge = run && !_prevRun;\n            _prevRun = run;\n            if (!risingEdge) return;\n\n            // === Basic validation ===\n            if (!Guid.TryParse(guidText, out Guid detailId))\n            {\n                AddRuntimeMessage(GH_RuntimeMessageLevel.Error, \"Invalid GUID.\");\n                return;\n            }\n\n            var doc = RhinoDoc.ActiveDoc;\n            if (doc == null)\n            {\n                AddRuntimeMessage(GH_RuntimeMessageLevel.Error, \"No active document.\");\n                return;\n            }\n\n            var detailObj = doc.Objects.FindId(detailId) as DetailViewObject;\n            if (detailObj == null)\n            {\n                AddRuntimeMessage(GH_RuntimeMessageLevel.Error, \"Detail with this GUID not found.\");\n                return;\n            }\n\n            // Find the PageView and runtime DetailView\n            var page = doc.Views.GetPageViews()\n                .FirstOrDefault(pv => pv.GetDetailViews().Any(dv => dv.Id == detailObj.Attributes.Id));\n            if (page == null)\n            {\n                AddRuntimeMessage(GH_RuntimeMessageLevel.Warning, \"The Detail does not belong to any active Layout.\");\n                return;\n            }\n\n            var runtimeDetail = page.GetDetailViews().FirstOrDefault(dv => dv.Id == detailObj.Attributes.Id);\n            if (runtimeDetail == null)\n            {\n                AddRuntimeMessage(GH_RuntimeMessageLevel.Warning, \"No active DetailView found on this page.\");\n                return;\n            }\n\n            var vp = runtimeDetail.Viewport;\n            if (vp == null)\n            {\n                AddRuntimeMessage(GH_RuntimeMessageLevel.Error, \"Could not get Viewport from Detail.\");\n                return;\n            }\n\n            // Activate layout and its detail\n            page.SetPageAsActive();\n            doc.Views.ActiveView = page;\n            page.SetActiveDetail(runtimeDetail.Id);\n            RhinoApp.Wait();\n\n            var displayMode = DisplayModeDescription.GetDisplayModes()\n                .FirstOrDefault(m => m.DisplayAttributes.EnglishName.Equals(displayName, StringComparison.OrdinalIgnoreCase))\n                ?? vp.DisplayMode;\n\n            var projection = Enum.IsDefined(typeof(Rhino.Display.DefinedViewportProjection), projInt)\n                ? (Rhino.Display.DefinedViewportProjection)projInt\n                : Rhino.Display.DefinedViewportProjection.None;\n\n            bool prevRedraw = doc.Views.RedrawEnabled;\n            doc.Views.RedrawEnabled = false;\n\n            try\n            {\n                // === 1 Base camera or reference view ===\n                if (viewInput == null)\n                {\n                    if (targetBox.IsValid)\n                        vp.SetCameraTarget(targetBox.Center, true);\n\n                    if (projection != Rhino.Display.DefinedViewportProjection.None)\n                        vp.SetProjection(projection, projection.ToString(), true);\n                }\n                else\n                {\n                    var srcVp = ViewInterpreter.ResolveViewport(viewInput);\n                    if (srcVp != null)\n                    {\n                        bool applied = ViewInterpreter.ApplyToDetail(srcVp, detailObj, true);\n                        RhinoApp.WriteLine(applied\n                            ? \"[ORIOL] Frustum and camera replicated from reference view.\"\n                            : \"[ORIOL] Frustum replication failed.\");\n                    }\n                    else\n                    {\n                        AddRuntimeMessage(GH_RuntimeMessageLevel.Warning, \"Reference view could not be resolved.\");\n                    }\n                }\n\n                // === 2 Display mode and target ===\n                if (!string.IsNullOrWhiteSpace(displayName))\n                    vp.DisplayMode = displayMode;\n\n                if (targetBox.IsValid)\n                {\n                    vp.SetCameraTarget(targetBox.Center, true);\n                    if (targetBox.Diagonal.Length > 0)\n                        vp.ZoomBoundingBox(targetBox);\n                }\n\n                //  FIRST commit viewport\n                runtimeDetail.CommitViewportChanges();\n\n                // === 3 Persistent scale (DetailGeometry) ===\n                if (vp.IsParallelProjection && scale > 0 &&\n                    Math.Abs(scale - detailObj.DetailGeometry.PageToModelRatio) > RhinoMath.ZeroTolerance)\n                {\n                    bool prevLock = detailObj.DetailGeometry.IsProjectionLocked;\n                    detailObj.DetailGeometry.IsProjectionLocked = false;\n                    detailObj.DetailGeometry.SetScale(1, doc.ModelUnitSystem, scale, doc.PageUnitSystem);\n                    detailObj.DetailGeometry.IsProjectionLocked = prevLock;\n                }\n\n                // Synchronize persistence and save\n                detailObj.DetailGeometry.Viewport = new ViewportInfo(vp);\n                detailObj.CommitChanges();\n            }\n            catch (Exception ex)\n            {\n                AddRuntimeMessage(GH_RuntimeMessageLevel.Error, $\"Error: {ex.Message}\");\n                DA.SetData(0, \"Failed\");\n                doc.Views.RedrawEnabled = prevRedraw;\n                return;\n            }\n            finally\n            {\n                doc.Views.RedrawEnabled = prevRedraw;\n            }\n\n            // === 4 Final Redraw ===\n            page.Redraw();\n            doc.Views.ActiveView = page;\n            doc.Views.Redraw();\n            RhinoApp.Wait();\n\n            RhinoApp.WriteLine($\"[ORIOL] DetailEdit OK ‚Üí Mode:{vp.DisplayMode.EnglishName} | Target:{vp.CameraTarget}\");\n\n            // --- Outputs ---\n            DA.SetData(0, \"Success\");\n            DA.SetData(1, vp.DisplayMode.EnglishName);\n            DA.SetData(2, vp.CameraTarget);\n            DA.SetData(3, detailObj.DetailGeometry.PageToModelRatio);\n            DA.SetData(4, vp.Name);\n            DA.SetData(5, vp.CameraLocation);\n        }\n\n        protected override Bitmap Icon =>\n            Rhino.UI.DrawingUtilities.BitmapFromIconResource(\"Oriol.Resources.Layout.DetailEdit.png\", typeof(DetailEdit).Assembly);\n\n        public override Guid ComponentGuid =>\n            new Guid(\"FA2D07D3-B77A-4BAF-BEAD-AB61E2C1207E\");\n    }\n}",
      "language": "csharp",
      "author": "sebastian.valenzu.11",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "boolean",
    "csharp",
    "file-io",
    "geometry",
    "grasshopper",
    "materials",
    "rhinocommon",
    "transformation"
  ],
  "has_accepted_answer": false,
  "category_id": 8,
  "posts_count": 3,
  "views": 97
}