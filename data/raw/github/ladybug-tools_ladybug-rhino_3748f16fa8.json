{
  "source_url": "https://github.com/ladybug-tools/ladybug-rhino/blob/f3efee1cc7d68fad592b2538ad7aedead49455fd/ladybug_rhino/light.py",
  "repo": "ladybug-tools/ladybug-rhino",
  "repo_stars": 12,
  "repo_description": "üêû ü¶è A library for translating between Ladybug Tools core libraries and Rhino CAD",
  "license": "AGPL-3.0",
  "filepath": "ladybug_rhino/light.py",
  "instruction": "Functions for setting lights within the Rhino scene.",
  "code": "\"\"\"Functions for setting lights within the Rhino scene.\"\"\"\nfrom __future__ import division\n\nfrom ladybug.dt import DateTime\nfrom ladybug.sunpath import Sunpath\n\ntry:\n    import System\nexcept ImportError as e:  # No .NET; We are really screwed\n    raise ImportError(\"Failed to import System.\\n{}\".format(e))\n\ntry:\n    import Rhino.Geometry as rg\n    import Rhino.Render.Sun as sun\n    from Rhino import RhinoDoc as rhdoc\nexcept ImportError as e:\n    raise ImportError(\"Failed to import Rhino document attributes.\\n{}\".format(e))\n\n\ndef set_sun(location, hoy, north=0):\n    \"\"\"Set the sun in the Rhino scene to correspond to a given location and DateTime.\n\n    The resulting sun objects will have color rendering that mimics the sun at\n    the particular hoy specified.\n\n    Args:\n        location: A Ladybug Location object to set the latitude, longitude and\n            time zone of the Rhino sun path.\n        hoy: A number between 0 and 8760 that represent the hour of the year at\n            which to evaluate the sun position. Note that this does not need to\n            be an integer and decimal values can be used to specify date times\n            that are not on the hour mark.\n        north: A number between -360 and 360 for the counterclockwise\n            difference between the North and the positive Y-axis in degrees.\n            90 is West and 270 is East. (Default: 0).\n\n    Returns:\n        The Rhino sun object.\n    \"\"\"\n    doc = rhdoc.ActiveDoc\n    # process the hoy into a .NET date/time\n    lb_dt = DateTime.from_hoy(hoy)\n    rh_dt = System.DateTime(\n        lb_dt.year, lb_dt.month, lb_dt.day, lb_dt.hour, lb_dt.minute, 0)\n\n    # enable the sun and set its position based on the location and date/time\n    sun_position = doc.Lights.Sun\n    sun.Enabled.SetValue(sun_position, True)\n    sun.TimeZone.SetValue(sun_position, location.time_zone)\n    sun.SetPosition(sun_position, rh_dt, location.latitude, location.longitude)\n\n    # set the north of the sun, ensuring the the y-axis is North\n    sun.North.SetValue(sun_position, 90 + north)\n    return sun\n\n\ndef set_suns(location, hoys, north=0):\n    \"\"\"Setup multiple light objects for several sun positions.\n\n    Note that the resulting lights will not have any color rendering associated\n    with them and all lights will be white.\n\n    Args:\n        location: A Ladybug Location object to set the latitude, longitude and\n            time zone of the Rhino sun path.\n        hoys: A list of numbers between 0 and 8760 that represent the hours of\n            the year at which to evaluate the sun position. Note that this does\n            not need to be an integer and decimal values can be used to specify\n            date times that are not on the hour mark.\n        north: A number between -360 and 360 for the counterclockwise\n            difference between the North and the positive Y-axis in degrees.\n            90 is West and 270 is East. (Default: 0).\n\n    Returns:\n        An array of lights representing sun positions.\n    \"\"\"\n    doc_lights = rhdoc.ActiveDoc.Lights\n\n    # initialize the Sunpath and get the relevant LB Suns\n    sp = Sunpath.from_location(location, north)\n    sun_vecs = []\n    for hoy in hoys:\n        lb_sun = sp.calculate_sun_from_hoy(hoy)\n        if lb_sun.is_during_day:\n            sun_vecs.append(lb_sun.sun_vector)\n    \n    # create Rhino Light objects for each sun\n    sli = (1 / len(sun_vecs)) * 1.75\n    sun_lights = []\n    for sun_vec in sun_vecs:\n        sun_light = rg.Light()\n        sun_light.LightStyle = rg.LightStyle(7)\n        sun_light.Direction = rg.Vector3d(sun_vec.x, sun_vec.y, sun_vec.z)\n        sun_light.Intensity = sli\n        sun_light.Name = 'LB_Sun'\n        doc_lights.Add(sun_light)\n        sun_lights.append(sun_light)\n\n    return sun_lights\n\n\ndef disable_sun():\n    \"\"\"Disable all suns in the Rhino scene so it does not interfere with other lights.\"\"\"\n    doc_lights = rhdoc.ActiveDoc.Lights\n    doc_lights.Sun.Enabled = False\n    for i, light in enumerate(doc_lights):\n        if light.Name =='LB_Sun':\n            doc_lights.Delete(i, True)\n",
  "language": "python",
  "imports": [
    "Rhino",
    "Rhino.Geometry"
  ],
  "has_docstring": true
}