{
  "source_url": "https://github.com/JanMeow/BFH_Reuse24/blob/8ee5b5647d3500e8ac32686766bd46658e59ac11/Kevin/otherThing/windowDefinition.py",
  "repo": "JanMeow/BFH_Reuse24",
  "repo_stars": 0,
  "repo_description": "BFH 24 Spring Studio Scripts Development",
  "license": "MIT",
  "filepath": "Kevin/otherThing/windowDefinition.py",
  "instruction": "Window definition",
  "code": "import Rhino.Geometry as rg\nfrom Grasshopper.Kernel.Data import GH_Path\nfrom Grasshopper import DataTree\nimport System.Array as array\nimport Rhino\nimport ghpythonlib.treehelpers as th\nimport System\nimport scriptcontext as sc\nimport inspect\n\n# Ensure we're using the Rhino document, not Grasshopper's\nsc.doc = Rhino.RhinoDoc.ActiveDoc\n\nclass DetectObjectIsMoved:\n    def __init__(self, geometryInput, nickname):\n\n        self.geometryInput = rg.Point3d(geometryInput)\n        self.nickname = nickname\n        self.detectObjType(self.geometryInput)\n        self.isMoved = False\n    \n    def initializeMovement(self, storeDict):\n        self.store_initial_point_data(self.points, storeDict)\n        # self.store_initial_curve_data(self.curves, storeDict)\n\n    def detectObjType(self, objInput):\n        self.points = []\n        self.curves = []\n        self.surfaces = []\n\n        # Check if the object is a point\n        if isinstance(objInput, rg.Point3d):\n            self.points.append(objInput)\n            self.geometryType = \"point\"\n        # Check if the object is a curve\n        elif isinstance(objInput, rg.Curve):\n            self.curves.append(objInput)\n            self.geometryType = \"curve\"\n        # Check if the object is a surface\n        elif isinstance(objInput, rg.Surface):\n            self.surfaces.append(objInput)\n            self.geometryType = \"surface\"\n\n\n        # Function to store initial locations\n    def store_initial_point_data(self, points, storeDict):\n        for point in points:\n            # Get the object's Rhino document object\n            if point:\n                # Store the initial location (for point objects, use the Location property)\n                storeDict[self.nickname] = (point, False)\n                \n\n    # Function to check if objects have moved\n    def have_points_moved(self, detectPoints, storeDict):\n            if detectPoints and isinstance(detectPoints, rg.Point3d):\n                current_data = detectPoints\n                initial_data = storeDict.get(self.nickname)[0]\n\n                if current_data != initial_data:\n                    storeDict[self.nickname] = (current_data, True)\n                else:\n                    storeDict[self.nickname] = (initial_data, False)\n\n\n\nclass Window:\n    def __init__(self, guid, id):\n        \"\"\"\n        Can input guid of \"Point\"\n        It should add guid allowed for inputing \"surface\"\n        \"\"\"\n        self.guid = guid\n        self.guidStr = str(guid)\n        self.nickname = \"window_\" + str(id)\n        self.wall = None\n        # create self.pt for self.checkObj\n        self.addPoint()\n        self.checkMoveObj = DetectObjectIsMoved(self.pt, self.nickname)\n        self.isMoved = False\n        \n    def addElement(self, element):\n        self.element = element\n        \n    def addHeight(self, height):\n        self.height = height\n        \n    def addWidth(self, width):\n        self.width = width\n        \n    def addLocHeight(self, locHeight):\n        self.locHeight = locHeight\n        \n    def addPoint(self):\n        self.pt = rg.Point3d(sc.doc.Objects.Find(self.guid).Geometry.Location)\n           \n    def setWall(self, wall):\n        self.wall = wall\n    \n\n    # Method to check if the wall has moved\n    def update_movement(self, inputDict):\n        try:\n            self.checkMoveObj.have_points_moved(self.pt, inputDict)\n\n        except:\n            self.checkMoveObj.initializeMovement(inputDict)\n            self.checkMoveObj.have_points_moved(self.pt, inputDict)\n\n    def check_isMoved(self, searchDict):\n        self.isMoved = searchDict[self.nickname][1]\n        return self.isMoved\n\n\n        \n        \n    def showAttribute(self):\n        self.attributes = []\n        for item in dir(self):\n            if item.startswith('__') and item.endswith('__'):\n                continue\n            attr = getattr(self, item)\n            if inspect.ismethod(attr):\n                continue\n            else:\n                if item not in ['attributes', 'methods']:  # Avoid including the lists themselves\n                    self.attributes.append(item)  # Append the attribute name\n        \n        print(\"attr: \"+ str(self.attributes))\n    \n    def showMethod(self):\n        self.methods = []\n        for item in dir(self):\n            if item.startswith('__') and item.endswith('__'):\n                continue\n            attr = getattr(self, item)\n            if inspect.ismethod(attr):\n                self.methods.append(item)  # Append the method name\n        \n        print(\"method: \"+ str(self.methods))\n\n\nshow = \"\"\nwindow_dict = {}\nid = 0\nfor window in iWindows:\n    windowObj = Window(window, id)\n    windowObj.addElement(\"window\")\n    windowObj.addHeight(iHeight)\n    windowObj.addWidth(iWidth)\n    windowObj.addLocHeight(iLocHeight)\n    windowObj.addPoint()\n    #windowObj.check_isMoved(initial_point_data)\n    \n    window_dict[windowObj.nickname] = windowObj\n    id += 1\n    \n    if id == 1:\n        show = windowObj.nickname\n\n\n\n\n\n\nclass classForOutput:\n    def __init__(self):\n        pass\n\nwindowData = classForOutput()\nwindowData.data = window_dict\noWindowData = windowData\n\nwindow_dict[show].showAttribute()\nwindow_dict[show].showMethod()\n\n# print(initial_point_data)",
  "language": "python",
  "imports": [
    "Rhino",
    "Rhino.Geometry",
    "ghpythonlib",
    "scriptcontext"
  ],
  "has_docstring": false
}