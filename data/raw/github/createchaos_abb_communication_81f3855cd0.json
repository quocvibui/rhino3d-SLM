{
  "source_url": "https://github.com/createchaos/abb_communication/blob/740ea3c6bf93b9b0d03e63a6d56ee8ad748e4e38/src/abb_communication/clients_withRN/rfl_robot/gantry.py",
  "repo": "createchaos/abb_communication",
  "repo_stars": 3,
  "repo_description": "communication library for abb robot control",
  "license": "NOASSERTION",
  "filepath": "src/abb_communication/clients_withRN/rfl_robot/gantry.py",
  "instruction": ". . . . . . . . . . . . . . . . . . \r\n.                                 .\r\n.   <<><><>    <<><><>  <<        .\r\n.   <<    ><   <<       <<        .\r\n.   <<><><>    <<><><   <<        .  \r\n.   <<  >< ...",
  "code": "'''\r\n. . . . . . . . . . . . . . . . . . \r\n.                                 .\r\n.   <<><><>    <<><><>  <<        .\r\n.   <<    ><   <<       <<        .\r\n.   <<><><>    <<><><   <<        .  \r\n.   <<  ><     <<       <<        .\r\n.   <<   <>    <<       <<        .\r\n.   <<    ><   <<       <<><><>   .\r\n.                                 .\r\n.             GKR 2016/17         .\r\n. . . . . . . . . . . . . . . . . .\r\n\r\nCreated on 05.01.2017\r\n\r\n@author: stefanap \r\n'''\r\n\r\n\r\nfrom abb_communication.geometry import Frame\r\nimport ghpythonlib.components as ghcomp\r\nimport Rhino.Geometry as rg\r\nimport math as m\r\n\r\n\r\nclass Gantry(object):\r\n    \r\n    #===========================================================================\r\n    def __init__(self, geo, gantry_plane):\r\n        ''' gantry class for the rfl \r\n        geo = gantry geometry as list\r\n        plane = defined gantry plane - if default - [0,0,0,x,y]\r\n        '''\r\n        \r\n        self.geo = geo\r\n        self.plane = gantry_plane\r\n        self.frame = Frame(self.plane, draw_geo=True)\r\n        \r\n        self.T = rg.Transform.PlaneToPlane(self.plane, rg.Plane.WorldXY)\r\n        self.geo_WCS = ghcomp.Transform(self.geo, self.T) # gantry aligned_with_WCS\r\n        \r\n        self.plane_WCS = ghcomp.Transform(self.plane, self.T) # should be WorldXY plane\r\n    \r\n    \r\n    def get_transformed_geo(self, plane_new, rob_nr):\r\n        \r\n        self.plane = plane_new\r\n        geo_z1, geo_z2, geo_y, geo_x, geo_fix = self.geo\r\n        \r\n        plane_0 = rg.Plane(rg.Point3d(0,0,0), rg.Vector3d(1,0,0), rg.Vector3d(0,1,0))\r\n\r\n        #self.plane.YAxis.Reverse()\r\n        #self.plane.XAxis.Reverse()\r\n        vec_trans_1 = rg.Vector3d.Subtract(rg.Vector3d(self.plane.Origin), rg.Vector3d(rg.Plane.WorldXY.Origin))\r\n        T1 = rg.Transform.Translation(vec_trans_1)\r\n        \r\n        T_rot = rg.Transform.Rotation(m.pi, rg.Vector3d.ZAxis, self.plane.Origin)\r\n        T_mirr = rg.Transform.Mirror(self.plane.Origin, rg.Vector3d.XAxis)\r\n            \r\n        z_max = 4500\r\n        vec_trans_2_z = ((z_max - vec_trans_1.Z)/2) + vec_trans_1.Z \r\n        vec_trans_2 = vec_trans_1\r\n        vec_trans_2.Z = vec_trans_2_z\r\n        T2 = rg.Transform.Translation(vec_trans_2)\r\n        \r\n        vec_trans_3 = rg.Vector3d(vec_trans_1.X, vec_trans_1.Y, 0)\r\n        T3 = rg.Transform.Translation(vec_trans_3)\r\n        \r\n        vec_trans_4 = rg.Vector3d(vec_trans_1.X, 0, 0)\r\n        T4 = rg.Transform.Translation(vec_trans_4)\r\n        \r\n        geo_z1_WCS = ghcomp.Transform(geo_z1, T1)\r\n        geo_z2_WCS = ghcomp.Transform(geo_z2, T2)\r\n        geo_y_WCS = ghcomp.Transform(geo_y, T3)\r\n        \r\n        if rob_nr == 1 or rob_nr == 3:\r\n            geo_x_WCS = ghcomp.Transform(geo_x, T4)\r\n        else:\r\n            geo_x_WCS = None\r\n        \r\n        if rob_nr == 2 or rob_nr == 4:\r\n            geo_z1_WCS = ghcomp.Transform(geo_z1_WCS, T_rot)\r\n            geo_z2_WCS = ghcomp.Transform(geo_z2_WCS, T_rot)\r\n        if rob_nr == 3 or rob_nr == 4:\r\n            geo_y_WCS = ghcomp.Transform(geo_y_WCS, T_rot)\r\n        if rob_nr == 3:\r\n            geo_x_WCS = ghcomp.Transform(geo_x_WCS, T_mirr)\r\n\r\n         \r\n        geo_gantry = [geo_z1_WCS, geo_z2_WCS, geo_y_WCS, geo_x_WCS, geo_fix]\r\n        \r\n        return geo_gantry\r\n        \r\n        \r\n    ",
  "language": "python",
  "imports": [
    "Rhino",
    "Rhino.Geometry",
    "ghpythonlib"
  ],
  "has_docstring": true
}