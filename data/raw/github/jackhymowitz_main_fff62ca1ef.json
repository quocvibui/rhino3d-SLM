{
  "source_url": "https://github.com/jackhymowitz/main/blob/7325131db23094f1a28bd184b6a68f864f41a729/01_GH_Components/py/BT_SaveXLWorkbook.py",
  "repo": "jackhymowitz/main",
  "repo_stars": 0,
  "repo_description": "IDF2PH is a free open source toolkit for working with E+ and PHPP Energy Models",
  "license": "GPL-3.0",
  "filepath": "01_GH_Components/py/BT_SaveXLWorkbook.py",
  "instruction": "Saves the open workbook in an excel instance\r\r\n-\r\r\nComponent by Jack Hymowitz, July 31, 2020\r\r\n\r\r\n    Args:\r\r\n        save: Set to true to save the workbook\r\r\n        excel: The excel instance\r\r\n   ...",
  "code": "#\r\r\n# IDF2PHPP: A Plugin for exporting an EnergyPlus IDF file to the Passive House Planning Package (PHPP). Created by blgdtyp, llc\r\r\n# \r\r\n# This component is part of IDF2PHPP.\r\r\n# \r\r\n# Copyright (c) 2020, bldgtyp, llc <info@bldgtyp.com> \r\r\n# IDF2PHPP is free software; you can redistribute it and/or modify \r\r\n# it under the terms of the GNU General Public License as published \r\r\n# by the Free Software Foundation; either version 3 of the License, \r\r\n# or (at your option) any later version. \r\r\n# \r\r\n# IDF2PHPP is distributed in the hope that it will be useful,\r\r\n# but WITHOUT ANY WARRANTY; without even the implied warranty of \r\r\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the \r\r\n# GNU General Public License for more details.\r\r\n# \r\r\n# For a copy of the GNU General Public License\r\r\n# see <http://www.gnu.org/licenses/>.\r\r\n# \r\r\n# @license GPL-3.0+ <http://spdx.org/licenses/GPL-3.0+>\r\r\n#\r\r\n\"\"\"\r\r\nSaves the open workbook in an excel instance\r\r\n-\r\r\nComponent by Jack Hymowitz, July 31, 2020\r\r\n\r\r\n    Args:\r\r\n        save: Set to true to save the workbook\r\r\n        excel: The excel instance\r\r\n    Returns:\r\r\n        excel: The excel instance after the component runs\r\r\n\"\"\"\r\r\n\r\r\nghenv.Component.Name = \"BT_SaveXLWorkbook\"\r\r\nghenv.Component.NickName = \"Save XL Workbook\"\r\r\nghenv.Component.Message = 'JUL_31_2020'\r\r\nghenv.Component.IconDisplayMode = ghenv.Component.IconDisplayMode.application\r\r\nghenv.Component.Category = \"BT\"\r\r\nghenv.Component.SubCategory = \"02 | IDF2PHPP\"\r\r\n\r\r\nfrom ghpythonlib.componentbase import executingcomponent as component\r\r\nimport Grasshopper, GhPython\r\r\nimport System\r\r\n\r\r\nimport Rhino\r\r\nimport rhinoscriptsyntax as rs\r\r\nimport Grasshopper.Kernel as ghK\r\r\n\r\r\nclass MyComponent(component):\r\r\n    \r\r\n    def RunScript(self, save, excel):\r\r\n        if (save is None  or save) and excel:\r\r\n            if not excel.save():\r\r\n                msg1 = \"Unable to save\"\r\r\n                ghenv.Component.AddRuntimeMessage(ghK.GH_RuntimeMessageLevel.Warning, msg1)\r\r\n        else:\r\r\n            msg1 = \"No Excel Instance or save set to false\"\r\r\n            ghenv.Component.AddRuntimeMessage(ghK.GH_RuntimeMessageLevel.Warning, msg1)\r\r\n        return excel\r\r\n\r\n",
  "language": "python",
  "imports": [
    "Rhino",
    "ghpythonlib",
    "rhinoscriptsyntax"
  ],
  "has_docstring": true
}