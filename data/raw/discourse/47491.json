{
  "source_url": "https://discourse.mcneel.com/t/rhinocommon-nested-instances/47491",
  "topic_id": 47491,
  "title": "RhinoCommon nested instances",
  "question": "Iâ€™m am attempting to query nested instance in rhino common and find it confusing.\n\n\nIf I have an InstanceReferenceGeometry, I see its Xform property and then it has a ParentIdefId.\n\n\nI guess I look this up in the RhinoDoc.ActiveDoc.InstanceDefinition but using what method?\n\nWill this look up give me InstanceDefinition objects or InstanceDefinitionGeometry objects?\n\nHow to you get the actual geometry objects from an InstanceDefinitionGeometry?\n\n\nI start with a list of ObjRef\n\n\nList geometries = GetListFromSomewhere();\n\n\n        foreach (var objref in geometries)\n        {\n            if (null != objref.Object())\n            {\n                    var iref = objref.Object() as Rhino.DocObjects.InstanceObject;\n                    if (iref != null)\n                    {\n                           Transform itransf = iref.InstanceXform;\n                           var idef = iref.InstanceDefinition;\n                           if (idef != null)\n                           {\n                                 var inst_obj = idef.GetObjects();\n                                 foreach (Rhino.DocObjects.RhinoObject rhObj in inst_obj)\n                                  {\n                                        Rhino.Geometry.InstanceReferenceGeometry childRef = rhObj.Geometry as Rhino.Geometry.InstanceReferenceGeometry;\n                                        if(childRef != null)\n                                        {\n                                              // Stuck here\n                                        }\n                                 }\n            }",
  "code_blocks": [
    {
      "code": "foreach (var objref in geometries)\n        {\n            if (null != objref.Object())\n            {\n                    var iref = objref.Object() as Rhino.DocObjects.InstanceObject;\n                    if (iref != null)\n                    {\n                           Transform itransf = iref.InstanceXform;\n                           var idef = iref.InstanceDefinition;\n                           if (idef != null)\n                           {\n                                 var inst_obj = idef.GetObjects();\n                                 foreach (Rhino.DocObjects.RhinoObject rhObj in inst_obj)\n                                  {\n                                        Rhino.Geometry.InstanceReferenceGeometry childRef = rhObj.Geometry as Rhino.Geometry.InstanceReferenceGeometry;\n                                        if(childRef != null)\n                                        {\n                                              // Stuck here\n                                        }\n                                 }\n            }",
      "language": "csharp",
      "author": "Tommy_Tucker",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "csharp",
    "rhinocommon",
    "selection",
    "transformation"
  ],
  "has_accepted_answer": false,
  "category_id": 3,
  "posts_count": 3,
  "views": 935
}