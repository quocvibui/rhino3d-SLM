{
  "source_url": "https://discourse.mcneel.com/t/c-creating-automatic-sliders/84502",
  "topic_id": 84502,
  "title": "C# creating automatic sliders",
  "question": "Hey !\n\nI am trying to create multiple sliders based based upon an integer input. I have modified \nJames -ramden  code:\n.\n\nThe problem is it works fine on the first attempt, but the number of sliders increases exponentially , I want them to erase the old sliders and generate new ones  according to the integer input.\n\nHere is my modified code.\n\nprivate void RunScript(bool x, object y, int z, ref object A)\n\n{\n\n\nRandom rnd = new Random();\nint i = 0;\n\nif(x)\n{\n  for(i = 0;i < z;i++)\n  {\n    //instantiate  new slider\n    Grasshopper.Kernel.Special.GH_NumberSlider slid = new Grasshopper.Kernel.Special.GH_NumberSlider();\n    slid.CreateAttributes(); //sets up default values, and makes sure your slider doesn't crash rhino\n\n    //customise slider (position, ranges etc)\n    int inputcount = this.Component.Params.Input[1].SourceCount;\n    slid.Attributes.Pivot = new System.Drawing.PointF((float) this.Component.Attributes.DocObject.Attributes.Bounds.Left - slid.Attributes.Bounds.Width - 30, (float) this.Component.Params.Input[1].Attributes.Bounds.Y + inputcount * 30);\n    slid.Slider.Maximum = 10;\n    slid.Slider.Minimum = 0;\n    slid.Slider.DecimalPlaces = 2;\n    slid.SetSliderValue((decimal) (rnd.Next(1000) * 0.01));\n\n    //Until now, the slider is a hypothetical object.\n    // This command makes it 'real' and adds it to the canvas.\n    GrasshopperDocument.AddObject(slid, false);\n\n    //Connect the new slider to this component\n    this.Component.Params.Input[1].AddSource(slid);\n  }\n}\n\n\n\n}\n\n\nAny help will be much appreciated",
  "code_blocks": [
    {
      "code": "private void RunScript(bool x, List<object> y, int z)\n  {\n    Random rnd = new Random();\n    if(x)\n    {\n      if(this.Component.Params.Input[1].SourceCount > 0)\n      {\n        List<IGH_Param> sources = new List<IGH_Param>(this.Component.Params.Input[1].Sources);\n        GrasshopperDocument.RemoveObjects(sources, false);\n      }\n      for(int i = 0;i < z;i++)\n      {\n        //instantiate  new slider\n        Grasshopper.Kernel.Special.GH_NumberSlider slid = new Grasshopper.Kernel.Special.GH_NumberSlider();\n        slid.CreateAttributes(); //sets up default values, and makes sure your slider doesn't crash rhino\n\n        //customise slider (position, ranges etc)\n        int inputcount = this.Component.Params.Input[1].SourceCount;\n        slid.Attributes.Pivot = new System.Drawing.PointF((float) this.Component.Attributes.DocObject.Attributes.Bounds.Left - slid.Attributes.Bounds.Width - 30, (float) this.Component.Params.Input[1].Attributes.Bounds.Y + inputcount * 30);\n        slid.Slider.Maximum = 10;\n        slid.Slider.Minimum = 0;\n        slid.Slider.DecimalPlaces = 2;\n        slid.SetSliderValue((decimal) (rnd.Next(1000) * 0.01));\n\n        //Until now, the slider is a hypothetical object.\n        // This command makes it 'real' and adds it to the canvas.\n        GrasshopperDocument.AddObject(slid, false);\n\n        //Connect the new slider to this component\n        this.Component.Params.Input[1].AddSource(slid);\n      }\n    }\n  }",
      "language": "csharp",
      "author": "Mahdiyar",
      "post_number": 5,
      "is_solution": false
    },
    {
      "code": "private void RunScript(bool x, List<object> y, int z)\n  {\n    if(x && z != _z)\n      GrasshopperDocument.ScheduleSolution(5, SolutionCallback);\n    _z = z;\n  }\n\n  // <Custom additional code> \n  private int _z;\n  private void SolutionCallback(GH_Document doc)\n  {\n    Random rnd = new Random();\n    if(this.Component.Params.Input[1].SourceCount > 0)\n    {\n      List<IGH_Param> sources = new List<IGH_Param>(this.Component.Params.Input[1].Sources);\n      GrasshopperDocument.RemoveObjects(sources, false);\n    }\n    for(int i = 0;i < _z;i++)\n    {\n      //instantiate  new slider\n      Grasshopper.Kernel.Special.GH_NumberSlider slid = new Grasshopper.Kernel.Special.GH_NumberSlider();\n      slid.CreateAttributes(); //sets up default values, and makes sure your slider doesn't crash rhino\n\n      //customise slider (position, ranges etc)\n      int inputcount = this.Component.Params.Input[1].SourceCount;\n      slid.Attributes.Pivot = new System.Drawing.PointF((float) this.Component.Attributes.DocObject.Attributes.Bounds.Left - slid.Attributes.Bounds.Width - 30, (float) this.Component.Params.Input[1].Attributes.Bounds.Y + inputcount * 30);\n      slid.Slider.Maximum = 10;\n      slid.Slider.Minimum = 0;\n      slid.Slider.DecimalPlaces = 2;\n      slid.SetSliderValue((decimal) (rnd.Next(1000) * 0.01));\n\n      //Until now, the slider is a hypothetical object.\n      // This command makes it 'real' and adds it to the canvas.\n      GrasshopperDocument.AddObject(slid, false);\n\n      //Connect the new slider to this component\n      this.Component.Params.Input[1].AddSource(slid);\n    }\n  }",
      "language": "csharp",
      "author": "Mahdiyar",
      "post_number": 7,
      "is_solution": false
    },
    {
      "code": "private void RunScript(bool reset, string compoentnName, int n)\n  {\n    if(reset)\n    {\n      _n = n;\n      _compoentnName = compoentnName;\n      GrasshopperDocument.ScheduleSolution(5, SolutionCallback);\n    }\n  }\n\n  // <Custom additional code> \n  private int _n;\n  private string _compoentnName;\n  private void SolutionCallback(GH_Document doc)\n  {\n    foreach(IGH_DocumentObject obj in GrasshopperDocument.Objects)\n    {\n      if (obj.NickName == _compoentnName)\n      {\n        IGH_Component targetComponent = obj as IGH_Component;\n        Random rnd = new Random();\n        if(targetComponent.Params.Input[1].SourceCount > 0)\n        {\n          List<IGH_Param> sources = new List<IGH_Param>(targetComponent.Params.Input[1].Sources);\n          GrasshopperDocument.RemoveObjects(sources, false);\n        }\n        for(int i = 0;i < _n;i++)\n        {\n          //instantiate  new slider\n          Grasshopper.Kernel.Special.GH_NumberSlider slid = new Grasshopper.Kernel.Special.GH_NumberSlider();\n          slid.CreateAttributes(); //sets up default values, and makes sure your slider doesn't crash rhino\n\n          //customise slider (position, ranges etc)\n          int inputcount = targetComponent.Params.Input[1].SourceCount;\n          slid.Attributes.Pivot = new System.Drawing.PointF((float) targetComponent.Attributes.DocObject.Attributes.Bounds.Left - slid.Attributes.Bounds.Width - 30, (float) targetComponent.Params.Input[1].Attributes.Bounds.Y + inputcount * 30);\n          slid.Slider.Maximum = 10;\n          slid.Slider.Minimum = 0;\n          slid.Slider.DecimalPlaces = 2;\n          slid.SetSliderValue((decimal) (rnd.Next(1000) * 0.01));\n\n          //Until now, the slider is a hypothetical object.\n          // This command makes it 'real' and adds it to the canvas.\n          GrasshopperDocument.AddObject(slid, false);\n\n          //Connect the new slider to this component\n          targetComponent.Params.Input[1].AddSource(slid);\n        }\n        break;\n      }\n    }\n  }",
      "language": "csharp",
      "author": "Mahdiyar",
      "post_number": 9,
      "is_solution": true
    },
    {
      "code": "private void RunScript(bool reset, string compoentnName, int n, int a, int b, int @Decimal, int indexInput)\n  {\n  if(reset)\n  {\n  _n = n;\n  _a = a;\n  _b = b;\n  _Decimal = Decimal;\n  _indexInput=indexInput;\n  _compoentnName = compoentnName;\n  GrasshopperDocument.ScheduleSolution(5, SolutionCallback);\n}\n  }\n\n  // <Custom additional code> \nprivate int _n;\nprivate int _a = 0;\nprivate int _b = 10;\nprivate int _Decimal ;\nprivate int _indexInput;\nprivate string _compoentnName;\nprivate void SolutionCallback(GH_Document doc)\n{\n  foreach(IGH_DocumentObject obj in GrasshopperDocument.Objects)\n  {\n    if (obj.NickName == _compoentnName)\n    {\n      IGH_Component targetComponent = obj as IGH_Component;\n      Random rnd = new Random();\n      if(targetComponent.Params.Input[_indexInput].SourceCount > 0)\n      {\n        List<IGH_Param> sources = new List<IGH_Param>(targetComponent.Params.Input[_indexInput].Sources);\n        GrasshopperDocument.RemoveObjects(sources, false);\n      }\n      for(int i = 0;i < _n;i++)\n      {\n        //instantiate  new slider\n        Grasshopper.Kernel.Special.GH_NumberSlider slid = new Grasshopper.Kernel.Special.GH_NumberSlider();\n        slid.CreateAttributes(); //sets up default values, and makes sure your slider doesn't crash rhino\n\n        //customise slider (position, ranges etc)\n        int inputcount = targetComponent.Params.Input[_indexInput].SourceCount;\n        slid.Attributes.Pivot = new System.Drawing.PointF((float) targetComponent.Attributes.DocObject.Attributes.Bounds.Left - slid.Attributes.Bounds.Width - 30, (float) targetComponent.Params.Input[_indexInput].Attributes.Bounds.Y + inputcount * 30);\n        slid.Slider.Maximum = _b;\n        slid.Slider.Minimum = _a;\n        slid.Slider.DecimalPlaces = _Decimal;\n        slid.SetSliderValue((decimal) (rnd.Next(1000 * _b / 10) * 0.01));\n\n        //Until now, the slider is a hypothetical object.\n        // This command makes it 'real' and adds it to the canvas.\n        GrasshopperDocument.AddObject(slid, false);\n\n        //Connect the new slider to this component\n        targetComponent.Params.Input[_indexInput].AddSource(slid);\n      }\n      break;\n    }\n  }\n}",
      "language": "csharp",
      "author": "architect.civil5",
      "post_number": 15,
      "is_solution": false
    },
    {
      "code": "protected override void AppendAdditionalComponentMenuItems(ToolStripDropDown menu)\n  {\n    // First, see if there's a single value already stored in the parameter.\n    // If there isn't, cv will have a value of Int32.MinValue.\n    int cv = int.MinValue;\n    Parameters.Param_Integer param = (Parameters.Param_Integer) Params.Input[1];\n\n    if (param.PersistentDataCount == 1)\n    {\n      cv = param.PersistentData[0].Value;\n    }\n\n    Menu_AppendGenericMenuItem(menu, \"First\", Menu_SetFirstDefault, null, null, null, cv == 1);\n    Menu_AppendGenericMenuItem(menu, \"Second\", Menu_SetSecondDefault, null, null, null, cv == 2);\n    Menu_AppendGenericMenuItem(menu, \"Third\", Menu_SetThirdDefault, null, null, null, cv == 3);\n    Menu_AppendGenericMenuItem(menu, \"Fourth\", Menu_SetFourthDefault, null, null, null, cv == 4);\n  }\n\n  private void Menu_SetFirstDefault(object sender, EventArgs e)\n  {\n    RecordUndoEvent(\"Constant changed\");\n    Parameters.Param_Integer param = (Parameters.Param_Integer) Params.Input[1];\n    param.ClearPersistentData();\n    param.AddPersistentData(1);\n    param.ExpireSolution(true);\n  }",
      "language": "csharp",
      "author": "Rh-3d-p",
      "post_number": 17,
      "is_solution": false
    },
    {
      "code": "Random rnd = new Random();\nint i = 0;\n\nif(x)\n{\n  for(i = 0;i < z;i++)\n  {\n    //instantiate  new slider\n    Grasshopper.Kernel.Special.GH_NumberSlider slid = new Grasshopper.Kernel.Special.GH_NumberSlider();\n    slid.CreateAttributes(); //sets up default values, and makes sure your slider doesn't crash rhino\n\n    //customise slider (position, ranges etc)\n    int inputcount = this.Component.Params.Input[1].SourceCount;\n    slid.Attributes.Pivot = new System.Drawing.PointF((float) this.Component.Attributes.DocObject.Attributes.Bounds.Left - slid.Attributes.Bounds.Width - 30, (float) this.Component.Params.Input[1].Attributes.Bounds.Y + inputcount * 30);\n    slid.Slider.Maximum = 10;\n    slid.Slider.Minimum = 0;\n    slid.Slider.DecimalPlaces = 2;\n    slid.SetSliderValue((decimal) (rnd.Next(1000) * 0.01));\n\n    //Until now, the slider is a hypothetical object.\n    // This command makes it 'real' and adds it to the canvas.\n    GrasshopperDocument.AddObject(slid, false);\n\n    //Connect the new slider to this component\n    this.Component.Params.Input[1].AddSource(slid);\n  }\n}",
      "language": "csharp",
      "author": "tognatta.aditya",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "csharp",
    "geometry",
    "grasshopper",
    "python",
    "transformation"
  ],
  "has_accepted_answer": true,
  "category_id": 11,
  "posts_count": 21,
  "views": 4860
}