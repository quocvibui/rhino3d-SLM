{
  "source_url": "https://github.com/AlasdairMott/Rhino-Blender-Render/blob/0b922490b7b2f8beba8518a2b6c7ede4ed2320d8/Scripts/BlenderRender-Interface.py",
  "repo": "AlasdairMott/Rhino-Blender-Render",
  "repo_stars": 5,
  "repo_description": "Rhino to Blender Script",
  "license": "MIT",
  "filepath": "Scripts/BlenderRender-Interface.py",
  "instruction": "Blender render interface",
  "code": "# -*- encoding: utf-8 -*-\n\nimport Rhino\nimport scriptcontext\nimport System\nimport Rhino.UI\nimport Eto.Drawing as drawing\nimport Eto.Forms as forms\nfrom System import Drawing as dw\n\nimport os\nimport json\n\nclass BlenderRenderSettingsDialog(forms.Dialog[bool]):\n\t\t# Dialog box Class initializer\n\tdef __init__(self):\n\t\t\n\t\t# Initialize dialog box\n\t\tself.Title = 'Render Settings'\n\t\tself.Padding = drawing.Padding(5)\n\t\tself.Resizable = False\n\n\t\tsettings = self.readSettings()\n\n\t\tdirname=os.path.dirname\n\t\tscript_path = dirname(os.path.realpath(__file__)) + \"\\\\\"\n\n\t\tself.HDRIs = [\"Colour\"]\n\t\tfor r, d, f in os.walk(script_path + \"HDRI\\\\\"):\n\t\t\tfor file in f: \n\t\t\t\tif '.hdr' in file: self.HDRIs.append(file)\n\t\t\n\t\tself.render_engine = forms.ComboBox()\n\t\tself.render_engine.DataStore = [\"CYCLES\", \"EEVEE\"]\n\t\tself.render_engine.SelectedIndex = 0\n\t\tself.render_scale = forms.NumericUpDown()\n\t\tself.render_samples = forms.NumericStepper()\n\t\t\n\t\tself.camera_exposure = forms.NumericUpDown()\n\t\tself.camera_exposure.DecimalPlaces = 3\n\t\tself.camera_exposure.Increment = 0.1\n\t\tself.camera_exposure.MinValue = -10.000\n\t\tself.camera_exposure.MaxValue = 10.000\n\t\tself.camera_transparent = forms.CheckBox()\n\t\t\n\t\tself.world_HDRI = forms.ComboBox()\n\t\tself.world_HDRI.DataStore = self.HDRIs\n\t\tself.world_HDRIRotation = forms.NumericStepper()\n\t\tself.world_HDRIRotation.DecimalPlaces = 2\n\t\tself.world_HDRIBlur = forms.NumericStepper()\n\t\tself.world_HDRIBlur.DecimalPlaces = 2\n\t\tself.world_HDRIBlur.MinValue = 0.000\n\t\tself.world_HDRIBlur.MaxValue = 1.000\n\t\tself.world_HDRIBlur.Width = 50\n\t\tself.world_HDRIPower = forms.NumericStepper()\n\t\tself.world_HDRIPower.DecimalPlaces = 2\n\t\tself.world_HDRIPower.MinValue = 0.000\n\t\tself.world_HDRIPower.Width = 50\n\t\t\n\t\tself.render_bouncesTotal = forms.NumericStepper()\n\t\tself.render_bouncesDiffuse = forms.NumericStepper()\n\t\tself.render_bouncesGlossy = forms.NumericStepper()\n\t\tself.render_bouncesTransparency = forms.NumericStepper()\n\t\tself.render_bouncesTransmission = forms.NumericStepper()\n\t\tself.render_bouncesVolume = forms.NumericStepper()\n\t\tself.render_clampingDirect = forms.NumericUpDown()\n\t\tself.render_clampingDirect.DecimalPlaces = 2\n\t\tself.render_clampingDirect.Increment = 0.01\n\t\tself.render_clampingDirect.MinValue = 0.00\n\t\tself.render_clampingIndirect = forms.NumericUpDown()\n\t\tself.render_clampingIndirect.DecimalPlaces = 2\n\t\tself.render_clampingIndirect.MinValue = 0.00\n\t\tself.render_Denoising = forms.CheckBox()\n\t\t\n\t\tself.open = forms.CheckBox()\n\t\tself.save = forms.CheckBox()\n\t\tself.render = forms.CheckBox()\n\t\tself.showRender = forms.CheckBox()\n\n\t\tif settings:\n\t\t\tself.render_engine.SelectedIndex \t\t= self.render_engine.DataStore.index(settings[\"settings\"][\"render_engine\"])\n\t\t\tself.render_scale.Value\t\t\t\t\t= float(settings[\"settings\"][\"render_scale\"])\n\t\t\tself.render_samples.Value\t\t\t\t= int(settings[\"settings\"][\"render_samples\"])\n\t\t\t\n\t\t\tself.camera_exposure.Value\t\t\t\t= float(settings[\"camera\"][\"camera_exposure\"])\n\t\t\tself.camera_transparent.Checked\t\t\t= bool(settings[\"camera\"][\"camera_transparent\"])\n\t\t\t\n\t\t\tself.world_HDRI.SelectedIndex\t\t\t= self.world_HDRI.DataStore.index(settings[\"world\"][\"world_HDRI\"])\n\t\t\tself.world_HDRIRotation.Value\t\t\t= float(settings[\"world\"][\"world_HDRIRotation\"])\n\t\t\tself.world_HDRIBlur.Value\t\t\t\t= float(settings[\"world\"][\"world_HDRIBlur\"])\n\t\t\tself.world_HDRIPower.Value\t\t\t\t= float(settings[\"world\"][\"world_HDRIPower\"])\n\t\t\t\n\t\t\tself.render_bouncesTotal.Value\t\t\t= int(settings[\"settings\"][\"render_bouncesTotal\"])\n\t\t\tself.render_bouncesDiffuse.Value\t\t= int(settings[\"settings\"][\"render_bouncesDiffuse\"])\n\t\t\tself.render_bouncesGlossy.Value\t\t\t= int(settings[\"settings\"][\"render_bouncesGlossy\"])\n\t\t\tself.render_bouncesTransparency.Value\t= int(settings[\"settings\"][\"render_bouncesTransparency\"])\n\t\t\tself.render_bouncesTransmission.Value\t= int(settings[\"settings\"][\"render_bouncesTransmission\"])\n\t\t\tself.render_bouncesVolume.Value\t\t\t= int(settings[\"settings\"][\"render_bouncesVolume\"])\n\t\t\tself.render_clampingDirect.Value\t\t= float(settings[\"settings\"][\"render_clampingDirect\"])\n\t\t\tself.render_clampingIndirect.Value\t\t= float(settings[\"settings\"][\"render_clampingIndirect\"])\n\t\t\tself.render_Denoising.Checked\t\t\t= bool(settings[\"settings\"][\"render_Denoising\"])\n\t\t\t\n\t\t\tself.open.Checked\t\t\t\t\t\t= bool(settings[\"settings\"][\"open\"])\n\t\t\tself.save.Checked\t\t\t\t\t\t= bool(settings[\"settings\"][\"save\"])\n\t\t\tself.render.Checked\t\t\t\t\t\t= bool(settings[\"settings\"][\"render\"])\n\t\t\tself.showRender.Checked\t\t\t\t\t= bool(settings[\"settings\"][\"showRender\"])\n\t\t\t\n\t\t\tloc = settings[\"settings\"][\"render_settingWindowPosition\"]\n\t\t\tloc = loc.split(\",\")\n\t\t\tself.Location = drawing.Point(int(loc[0]), int(loc[1]))\n\t\t\n\t\tself.DefaultButton = forms.Button(Text = 'OK')\n\t\tself.DefaultButton.Click += self.OnOKButtonClick\n\n\t\tself.AbortButton = forms.Button(Text = 'Cancel')\n\t\tself.AbortButton.Click += self.OnCloseButtonClick\n\n\t\tlayout = forms.DynamicLayout()\n\t\tlayout.Spacing = drawing.Size(0, 1)\n\t\t\n\t\t\"\"\"Box 1: Render\"\"\"\n\t\tbox_1 = forms.GroupBox()\n\t\tbox_1.Padding = drawing.Padding(1)\n\t\tbox_1_layout = forms.DynamicLayout()\n\t\tbox_1_layout.Spacing = drawing.Size(3, 3)\n\t\tbox_1.Content = box_1_layout\n\t\t\n\t\tbox_1_layout.AddRow(\"render_engine\", self.render_engine)\n\t\tbox_1_layout.AddRow(\"render_scale\", self.render_scale)\n\t\tbox_1_layout.AddRow(\"samples\", self.render_samples)\n\t\t\n\t\t\n\t\t\"\"\"Box 2: Camera\"\"\"\n\t\tbox_2 = forms.GroupBox(Text = 'Camera')\n\t\tbox_2.Padding = drawing.Padding(1)\n\t\tbox_2_layout = forms.DynamicLayout()\n\t\tbox_2_layout.Spacing = drawing.Size(3, 3)\n\t\tbox_2.Content = box_2_layout\n\t\t\n\t\tbox_2_layout.AddRow(\"Exposure\", self.camera_exposure)\n\t\tbox_2_layout.AddRow(\"Transparent\", self.camera_transparent)\n\t\t\n\t\t\"\"\"Box 3: World\"\"\"\n\t\tbox_3 = forms.GroupBox(Text = 'World')\n\t\tbox_3.Padding = drawing.Padding(1)\n\t\tbox_3_layout = forms.DynamicLayout()\n\t\tbox_3_layout.Spacing = drawing.Size(3, 3)\n\t\tbox_3.Content = box_3_layout\n\t\t\n\t\tbox_3_layout.BeginVertical()\n\t\tbox_3_layout.AddRow(\"HDRI\", self.world_HDRI)\n\t\tbox_3_layout.AddRow(\"HDRI Rotation\", self.world_HDRIRotation)\n\t\tbox_3_layout.EndVertical()\n\t\tbox_3_layout.AddSeparateRow(\"Blur\", self.world_HDRIBlur, None, \"Power\", self.world_HDRIPower)\n\t\t\n\t\t\"\"\"Box 4: Samples\"\"\"\n\t\tbox_4 = forms.GroupBox(Text = 'Sampling')\n\t\tbox_4.Padding = drawing.Padding(1)\n\t\tbox_4_layout = forms.DynamicLayout()\n\t\tbox_4_layout.Spacing = drawing.Size(3, 3)\n\t\tbox_4.Content = box_4_layout\n\t\t\n\t\tself.box_4_hidden = forms.DynamicLayout(Visible = False)\n\t\tself.box_4_hidden.Spacing = drawing.Size(3, 3)\n\t\t\n\t\tself.box_4_hidden.AddRow(\"bouncesTotal\", self.render_bouncesTotal)\n\t\tself.box_4_hidden.AddRow(\"bouncesDiffuse\", self.render_bouncesDiffuse)\n\t\tself.box_4_hidden.AddRow(\"bouncesGlossy\", self.render_bouncesGlossy)\n\t\tself.box_4_hidden.AddRow(\"bouncesTransparency\", self.render_bouncesTransparency)\n\t\tself.box_4_hidden.AddRow(\"bouncesTransmission\", self.render_bouncesTransmission)\n\t\tself.box_4_hidden.AddRow(\"bouncesVolume\", self.render_bouncesVolume)\n\t\tself.box_4_hidden.AddRow(\"clampingDirect\", self.render_clampingDirect)\n\t\tself.box_4_hidden.AddRow(\"clampingIndirect\", self.render_clampingIndirect)\n\t\t\n\t\tself.dropdown_text = forms.Label(Text = \"Show Sampling Properties\")\n\t\tself.dropdown_samples = forms.Button(Size = drawing.Size(16,16))\n\t\tself.dropdown_samples.Text = \"▼\"\n\t\tself.dropdown_samples.Font = drawing.Font(\"Arial\", 5)\n\t\tself.dropdown_samples.Click += self.dropdown_samples_Click\n\t\t\n\t\tbox_4_layout.AddSeparateRow(None, self.dropdown_text, None, self.dropdown_samples, None)\n\t\tbox_4_layout.AddRow(self.box_4_hidden)\n\t\t\n\t\t\"\"\"Box 5: Output\"\"\"\n\t\tbox_5 = forms.GroupBox(Text = 'Output')\n\t\tbox_5.Padding = drawing.Padding(1)\n\t\tbox_5_layout = forms.DynamicLayout()\n\t\tbox_5_layout.Spacing = drawing.Size(3, 3)\n\t\tbox_5.Content = box_5_layout\n\t\t\n\t\tbox_5_layout.AddRow(self.save, \"Save File\", self.open, \"Open File\")\n\t\tbox_5_layout.AddRow(self.render_Denoising, \"Denoising\")\n\t\tbox_5_layout.AddRow(self.render, \"Render\")\n\t\tbox_5_layout.AddRow(self.showRender, \"Show Render\")\n\t\t\n\t\t#Add the group boxes to the main interface\n\t\tlayout.AddRow(box_1)\n\t\tlayout.AddRow(box_2)\n\t\tlayout.AddRow(box_3)\n\t\tlayout.AddRow(box_4)\n\t\tlayout.AddRow(box_5)\n\t\tlayout.AddSeparateRow(self.DefaultButton, None, self.AbortButton)\n\t\t\n\t\tself.Content = layout\n\n\tdef readSettings(self):\n\t\tdirname=os.path.dirname\n\t\tscript_path = dirname(os.path.realpath(__file__)) + \"\\\\\"\n\t\tjson_filename = script_path + \"BlenderRender-Settings.json\"\n\t\t\n\t\tif os.path.exists(json_filename):\n\t\t\twith open(json_filename) as f: return json.load(f)\n\t\telse: return None\n\n\tdef dropdown_samples_Click(self, sender, e):\n\t\tif self.box_4_hidden.Visible:\n\t\t\tself.ClientSize = drawing.Size(self.ClientSize.Width, 440)\n\t\t\tself.box_4_hidden.Visible = False\n\t\t\t#self.dropdown_text.Visible = True\n\t\t\tself.dropdown_samples.Text = \"▼\"\n\t\telse:\n\t\t\tself.box_4_hidden.Visible = True\n\t\t\t#self.dropdown_text.Visible = False\n\t\t\tself.dropdown_samples.Text = \"▲\"\n\t\t\t#self.ClientSize = drawing.Size(max(self.ClientSize.Width, self.box_4_hidden.Width), self.ClientSize.Height + self.box_4_hidden.Height*2)\n\t\t\tself.ClientSize = drawing.Size(self.ClientSize.Width, 440 + 181)\n\n\tdef OnCloseButtonClick(self, sender, e):\n\t\tself.Close(False)\n\n\tdef OnOKButtonClick(self, sender, e):\n\t\tself.Close(True)\n\n\ndef RequestBlenderRenderSettingsDialog():\n\tdialog = BlenderRenderSettingsDialog();\n\n\trc = dialog.ShowModal(Rhino.UI.RhinoEtoApp.MainWindow)\n\tif (rc):\n\t\t#render_settings = dialog.GetText()\n\t\t\n\t\tdirname=os.path.dirname\n\t\tscript_path = dirname(os.path.realpath(__file__)) + \"\\\\\"\n\t\tjson_filename = script_path + \"BlenderRender-Settings.json\"\n\n\t\t#Clear File\n\t\twith open(json_filename, 'w') as f: json.dump({}, f)\n\t\t\n\t\tsettings = {\n\t\t\t\"render_engine\": \t\t\t\t[\"CYCLES\", \"EEVEE\"][dialog.render_engine.SelectedIndex],\n\t\t\t\"render_scale\": \t\t\t\tdialog.render_scale.Value,\n\t\t\t\"render_samples\": \t\t\t\tdialog.render_samples.Value,\t\t\t\n\t\t\t\"render_bouncesTotal\": \t\t\tdialog.render_bouncesTotal.Value,\n\t\t\t\"render_bouncesDiffuse\": \t\tdialog.render_bouncesDiffuse.Value,\n\t\t\t\"render_bouncesGlossy\": \t\tdialog.render_bouncesGlossy.Value,\n\t\t\t\"render_bouncesTransparency\": \tdialog.render_bouncesTransparency.Value,\n\t\t\t\"render_bouncesTransmission\": \tdialog.render_bouncesTransmission.Value,\n\t\t\t\"render_bouncesVolume\":\t\t\tdialog.render_bouncesVolume.Value,\n\t\t\t\"render_clampingDirect\": \t\tdialog.render_clampingDirect.Value,\n\t\t\t\"render_clampingIndirect\": \t\tdialog.render_clampingIndirect.Value,\n\t\t\t\"render_Denoising\": \t\t\tdialog.render_Denoising.Checked,\n\t\t\t\"open\":\t\t\t\t\t\t\tdialog.open.Checked,\n\t\t\t\"save\": \t\t\t\t\t\tdialog.save.Checked,\n\t\t\t\"render\":\t\t\t\t\t\tdialog.render.Checked,\n\t\t\t\"showRender\":\t\t\t\t\tdialog.showRender.Checked,\n\t\t\t\"render_settingWindowPosition\": dialog.Location.ToString()\n\t\t\t}\n\t\t\t\n\t\tcamera = {\n\t\t\t\"camera_exposure\": \t\t\t\tdialog.camera_exposure.Value,\n\t\t\t\"camera_transparent\":\t\t\tdialog.camera_transparent.Checked\n\t\t}\n\t\t\n\t\tworld = {\n\t\t\t\"world_HDRI\" :\t\t\t\t\tdialog.HDRIs[dialog.world_HDRI.SelectedIndex],\n\t\t\t\"world_HDRIRotation\" :\t\t\tdialog.world_HDRIRotation.Value,\n\t\t\t\"world_HDRIBlur\" :\t\t\t\tdialog.world_HDRIBlur.Value,\n\t\t\t\"world_HDRIPower\" :\t\t\t\tdialog.world_HDRIPower.Value\n\t\t}\n\t\t\n\t\tnew_entry = {\"settings\" : settings, \"camera\" : camera, \"world\" : world}\n\t\twith open(json_filename, 'w') as f: json.dump(new_entry, f, indent = 4, sort_keys=True)\n\t\t\n\t\treturn settings\n\nif __name__ == \"__main__\":\n\tRequestBlenderRenderSettingsDialog()\n",
  "language": "python",
  "imports": [
    "Rhino",
    "scriptcontext"
  ],
  "has_docstring": false
}