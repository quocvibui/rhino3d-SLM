{
  "source_url": "https://github.com/gramaziokohler/integral_timber_joints/blob/d543a28ccfaeb8a56ff692a29d5510c3e649477f/src/integral_timber_joints/joint_customization/customize_check_polyline_files.py",
  "repo": "gramaziokohler/integral_timber_joints",
  "repo_stars": 11,
  "repo_description": "Robotic Assembled Timber Structures with Integral Timber Joints",
  "license": "MIT",
  "filepath": "src/integral_timber_joints/joint_customization/customize_check_polyline_files.py",
  "instruction": "Customize check polyline files",
  "code": "import rhinoscriptsyntax as rs\nfrom compas.geometry import Frame, Point, Vector, Transformation, distance_point_point\nfrom compas_rhino.geometry import RhinoPoint\nfrom integral_timber_joints.joint_customization.customize_polyline_lap import read_joint_customization_string, read_structural_model_transformation\nfrom integral_timber_joints.joint_customization.customize_polyline_lap import find_joint_by_centroid\nimport logging\nimport os\nfrom compas_rhino.utilities import unload_modules\nunload_modules (\"find_joint_by_centroid\")\n# joints_string_folder = \"C:\\\\Users\\\\leungp\\\\Documents\\\\GitHub\\\\integral_timber_joints\\\\external\\\\itj_design_study\\\\211010_CantiBox\\\\joints\\\\left\\\\\"\njoints_string_folder = \"C:\\\\Users\\\\leungp\\\\Documents\\\\GitHub\\\\integral_timber_joints\\\\external\\\\itj_design_study\\\\211010_CantiBox\\\\joints\\\\mid\\\\\"\n# joints_string_folder = \"C:\\\\Users\\\\leungp\\\\Documents\\\\GitHub\\\\integral_timber_joints\\\\external\\\\itj_design_study\\\\211010_CantiBox\\\\joints\\\\right\\\\\"\n\n# This file help identify problems with individual polyline definitions.\n\nprint(\"Checking Polyline: %s\" % joints_string_folder)\n\n\nfrom integral_timber_joints.rhino.load import get_process, get_process_artist, process_is_none\nfrom integral_timber_joints.geometry import JointPolylineLap\n\nprocess = get_process()\nartist = get_process_artist()\nassembly = process.assembly\n\ntransformation = read_structural_model_transformation()\n\nfiles = []\nfor i in range (36):\n    files.append(joints_string_folder + str(i) + \".txt\")\n\n\n\ndef find_joint_by_centroid(assembly, centroid_pt, distance_threshold = 50, verbose = True):\n\n    for joint_id in assembly.joint_ids():\n        joint = assembly.joint(joint_id)\n        if joint.__class__.__name__ != \"JointPolylineLap\":\n            continue\n        distance = distance_point_point(joint.centroid, centroid_pt)\n        if distance < distance_threshold:\n            if verbose: print(\"Joint Found: %s, %s\" % (joint_id, distance))\n            return joint_id\n    if verbose: print(\"Joint Not Found\")\n    return None\n\n# files = files[0:6]\n# files = files[6:12]\n# files = files[12:18]\n# files = files[18:24]\n# files = files[24:30]\n# files = files[30:36]\n\n# files = [files[3]]\n\nfor file_name in files:\n    file_path = joints_string_folder + file_name\n    print(\"file_name: %s\" %file_name)\n    pt, v1, v2, v3, v4, polyline_string = read_joint_customization_string(file_name, transformation)\n    # print(\"polyline_string = %s\" % polyline_string)\n    joint_id = find_joint_by_centroid(assembly, pt, distance_threshold=100, verbose = True)\n\n    if joint_id is None:\n        print (\"Cannot find joint\")\n    else:\n        height, polyline = eval(polyline_string)\n        for i in range(4):\n            if polyline[i][0] != [0.0, 0.0]:\n                print (\"Polyline %i start not at 0,0: %s\" % (i, polyline[i][0]))\n            if polyline[i][-1] != [1.0, 0.0]:\n                print (\"Polyline %i end not at 1,0: %s\" % (i, polyline[i][0]))",
  "language": "python",
  "imports": [
    "rhinoscriptsyntax"
  ],
  "has_docstring": false
}