{
  "source_url": "https://github.com/ar0551/Wasp/blob/66f63c018f2420d37aa451ade0178de260946b0c/src/ghComp/Wasp_Get%20Valid%20Smart%20Attributes.py",
  "repo": "ar0551/Wasp",
  "repo_stars": 67,
  "repo_description": "Combinatorial Design with Grasshopper plug-in (LGPL) initiated by Andrea Rossi",
  "license": "LGPL-3.0",
  "filepath": "src/ghComp/Wasp_Get Valid Smart Attributes.py",
  "instruction": "Wasp get valid smart attributes",
  "code": "\nghenv.Component.Name = \"Wasp_Get Valid Smart Attributes\"\nghenv.Component.NickName = 'GetSmartAttr'\nghenv.Component.Message = 'v0.6.001'\nghenv.Component.IconDisplayMode = ghenv.Component.IconDisplayMode.application\nghenv.Component.Category = \"Wasp\"\nghenv.Component.SubCategory = \"1 | Elements\"\ntry: ghenv.Component.AdditionalHelpFromDocStrings = \"2\"\nexcept: pass\n\n\nimport sys\nimport Grasshopper as gh\nimport ghpythonlib.treehelpers as th\n\n\n## add Wasp install directory to system path\nwasp_loaded = False\nghcompfolder = gh.Folders.DefaultAssemblyFolder\nif ghcompfolder not in sys.path:\n    sys.path.append(ghcompfolder)\ntry:\n    from wasp import __version__\n    wasp_loaded = True\nexcept:\n    msg = \"Cannot import Wasp. Is the wasp folder available in \" + ghcompfolder + \"?\"\n    ghenv.Component.AddRuntimeMessage(gh.Kernel.GH_RuntimeMessageLevel.Error, msg)\n\n## if Wasp is installed correctly, load the classes required by the component\nif wasp_loaded:\n    from wasp.core import SmartAttribute\n\n\ndef main(aggregation, ids):\n        \n    check_data = True\n    \n    ## check inputs\n    if aggregation is None:\n        check_data = False\n        msg = \"No aggregation provided\"\n        ghenv.Component.AddRuntimeMessage(gh.Kernel.GH_RuntimeMessageLevel.Warning, msg)\n    \n    if len(ids) == 0:\n        check_data = False\n        msg = \"No attribute ids provided\"\n        ghenv.Component.AddRuntimeMessage(gh.Kernel.GH_RuntimeMessageLevel.Warning, msg)\n    \n    ## execute main code if all needed inputs are available\n    if check_data:\n        \n        values = []\n        \n        for i in range(len(aggregation.aggregated_parts)):\n            part = aggregation.aggregated_parts[i]\n            p_matrix = aggregation.check_blocked_connections(part)\n            values.append([])\n            for attr_id in ids:\n                for attr in part.attributes:\n                    if type(attr) == SmartAttribute:\n                        if attr.name == attr_id:\n                            is_valid = True\n                            for i2 in range(len(attr.conn_mask)):\n                                if attr.conn_mask[i2] == 1:\n                                    if attr.connections[i2].id not in p_matrix:\n                                        is_valid = False\n                                        break\n                                elif attr.conn_mask[i2] == -1:\n                                    if attr.connections[i2].id in p_matrix:\n                                        is_valid = False\n                                        break\n                            if is_valid:\n                                values[i].append(attr.values)\n                            break\n        \n        return th.list_to_tree(values)\n    else:\n        return -1\n\nresult = main(AGGR, ID)\n\nif result != -1:\n        VAL = result",
  "language": "python",
  "imports": [
    "ghpythonlib"
  ],
  "has_docstring": false
}