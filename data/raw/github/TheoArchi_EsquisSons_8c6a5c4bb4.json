{
  "source_url": "https://github.com/TheoArchi/EsquisSons/blob/00d1b02f7ce3e190b5c4c3429d3e84756c29bfdb/WIP_ESQUISSONS%20PYTHON%20FILES/EsquisSons_Launcher.py",
  "repo": "TheoArchi/EsquisSons",
  "repo_stars": 3,
  "repo_description": "Esquissons is a grasshopper plugin which help you to design with sound ;)",
  "license": "NOASSERTION",
  "filepath": "WIP_ESQUISSONS PYTHON FILES/EsquisSons_Launcher.py",
  "instruction": "EsquisSons Launcher\r\nUse 2 boolean toggles to launch the app and then start the sound module :)\r\n-\r\nAAU / Theo Marchal / BETA VERSION / AVRIL2020\r\nWith the Contribution of Manon COUTIER & Domitille...",
  "code": "\"\"\"EsquisSons Launcher\r\nUse 2 boolean toggles to launch the app and then start the sound module :)\r\n-\r\nAAU / Theo Marchal / BETA VERSION / AVRIL2020\r\nWith the Contribution of Manon COUTIER & Domitille GRANDJEAN\"\"\"\r\n\r\nfrom ghpythonlib.componentbase import executingcomponent as component\r\nimport Grasshopper, GhPython\r\nimport System\r\nimport Rhino\r\nimport rhinoscriptsyntax as rs\r\nimport os\r\nimport OSC\r\nimport platform\r\nimport time\r\nimport subprocess\r\nimport Grasshopper.Kernel as gh\r\n\r\n\r\nclass EsquisSonsLauncher(component):\r\n\r\n    def RunScript(self, open_esquissons, on_off, _alt_path):\r\n\r\n        # block init\r\n        __author__ = \"theomarchal\"\r\n        self.Params.Input[0].Description = \"Boolean input, set True to run the sound algorythm\"\r\n        self.Params.Input[1].Description = \"General Status of EsquisSons module\"\r\n        self.Params.Input[2].Description = \"Alternative Path to -EsquisSons.exe/app-\"\r\n        self.Name = \"EsquisSons Launcher\"\r\n        self.NickName = \"Launcher\"\r\n        self.Message = \"EsquisSons V3\"\r\n        self.Category = \"EsquisSons\"\r\n        self.SubCategory = \"0/ EsquisSons\"\r\n\r\n        # path to Esquissons Sound App. If _alt_path is None, it's the default one.\r\n        esq_path = _alt_path\r\n        if esq_path is None:\r\n            if platform.system() == 'Windows':\r\n                esq_path = os.getenv('APPDATA') + '\\Grasshopper\\Libraries\\EsquisSons\\EsquisSons.exe'\r\n            if platform.system() == 'Darwin':\r\n                esq_path = '/applications/EsquisSons.app'\r\n\r\n        # connection to Esquissons Sound App initialization (OSC protocol)\r\n        client = OSC.OSCClient()\r\n        client.connect(('127.0.0.1', 58234))\r\n        osc_message = OSC.OSCMessage()\r\n        osc_message.append(\"no message\")\r\n        osc_message.append(\"no int\")\r\n\r\n        if open_esquissons == True:\r\n\r\n            # launching of Esquissons Sound App\r\n            # display error if the Sound App can't be found in esq_path\r\n            try:\r\n                if platform.system() == 'Windows':\r\n                    os.startfile(esq_path)\r\n                    error = False\r\n                if platform.system() == 'Darwin':\r\n                    subprocess.call(['open', esq_path])\r\n                    error = False\r\n            except:\r\n                error = True\r\n            if error == True:\r\n                self.AddRuntimeMessage(gh.GH_RuntimeMessageLevel.Warning,\r\n                                       \"EsquisSons can't be open ! \" + esq_path + \" can not be found. Please check the installation !\")\r\n                self.Message = \"EsquisSons is OFF\"\r\n\r\n            else:\r\n\r\n                # display of different messages depending on the status of Esquissons Sound App\r\n                if on_off == True:\r\n                    osc_message[0] = \"EsquisSons\\\\ is\\\\ Online!\\\\ Let's\\\\ make\\\\ some\\\\ noise\"\r\n                    osc_message[1] = 1\r\n                    self.AddRuntimeMessage(gh.GH_RuntimeMessageLevel.Remark,\r\n                                           'EsquisSons is online ! Let''s make some noise !')\r\n                    self.Message = \"EsquisSons is ON\"\r\n                else:\r\n                    osc_message[\r\n                        0] = 'EsquisSons\\\\ is\\\\ not\\\\ online\\\\ turn\\\\ it\\\\ on\\\\ (in\\\\ Gh)\\\\ to\\\\ start\\\\ the\\\\ sketch'\r\n                    osc_message[1] = 0\r\n                    self.AddRuntimeMessage(gh.GH_RuntimeMessageLevel.Warning,\r\n                                           'EsquisSons app should be open ! Now turn it on with a boolean toogle (on_off input)!')\r\n                    self.Message = \"Almost there : Turn it on !\"\r\n\r\n        else:\r\n\r\n            # display of different messages depending on the status of Esquissons Sound App\r\n            if on_off is True:\r\n                osc_message[0] = \"EsquisSons\\\\ is\\\\ Online!\\\\ Let's\\\\ make\\\\ some\\\\ noise\"\r\n                osc_message[1] = 1\r\n                self.AddRuntimeMessage(gh.GH_RuntimeMessageLevel.Warning,\r\n                                       'Message sent, EsquisSons should be online but...Check if EsquisSons app is open ! (if not, use the open_esquissons input with boolean toggle ;)')\r\n                self.Message = \"EsquisSons is ON\"\r\n            else:\r\n                self.AddRuntimeMessage(gh.GH_RuntimeMessageLevel.Error,\r\n                                       'EsquisSons is not online and probably not open. You should open_esquissons, then turn it on with on_off !')\r\n                osc_message[\r\n                    0] = \"EsquisSons\\\\ is\\\\ not\\\\ online\\\\ turn\\\\ it\\\\ on\\\\ (in\\\\ Gh)\\\\ to\\\\ start\\\\ the\\\\ sketch\"\r\n                osc_message[1] = 0\r\n                self.Message = \"EsquisSons is OFF\"\r\n\r\n        # send osc_message to Esquissons Sound App\r\n        client.send(osc_message)\r\n\r\n        return \r\n",
  "language": "python",
  "imports": [
    "Rhino",
    "ghpythonlib",
    "rhinoscriptsyntax"
  ],
  "has_docstring": true
}