{
  "source_url": "https://github.com/localsoftware/localsoftware_rhino-grasshopper/blob/4aafec57e33b9f09cce6fd73dcda12b17cf794a5/plugin_files/Create_View.py",
  "repo": "localsoftware/localsoftware_rhino-grasshopper",
  "repo_stars": 0,
  "repo_description": null,
  "license": "BSD-2-Clause",
  "filepath": "plugin_files/Create_View.py",
  "instruction": "Create view",
  "code": "﻿from ghpythonlib.componentbase import dotnetcompiledcomponent as component\nimport Grasshopper, GhPython, System, Rhino, os, math\nimport rhinoscriptsyntax as rs\nimport scriptcontext as sc\nfrom Grasshopper.Kernel import GH_RuntimeMessageLevel as RML\n\nrcdoc = Rhino.RhinoDoc.ActiveDoc\nghdoc = sc.doc\n\nclass MyComponent(component):\n    def __new__(cls):\n        instance = Grasshopper.Kernel.GH_Component.__new__(cls,\n            \"CreateView\", \"CreateView\", \"\"\"Creates view target and vector from seleted objects.\nTransforms view data into a Rhino view.\nCreating a view is the first step to set a view in Rhino’s viewport.\nTo select a view, you need a geometry to point to. You can define view angles.\nBased on the work of Jackie Berry.\n    Typical usage:\nInput the curve to point to, so you should never input a surface, brep or mesh as geometry to create a view.\nSelect an Azimuth and Altitude angle. The angles go between 0 and 360, and represent the position of a “camera” around the base object.\"\"\", \"Extra\", \"LocalCode\")\n        return instance\n    \n    def get_ComponentGuid(self):\n        return System.Guid(\"b1996ce9-0a0d-4bcd-b147-145bcd380adb\")\n    \n    def SetUpParam(self, p, name, nickname, description):\n        p.Name = name\n        p.NickName = nickname\n        p.Description = description\n        p.Optional = True\n    \n    def RegisterInputParams(self, pManager):\n        p = GhPython.Assemblies.MarshalParam()\n        self.SetUpParam(p, \"geometry\", \"geometry\", \"curve geometry to focus on in view\")\n        p.Access = Grasshopper.Kernel.GH_ParamAccess.list\n        self.Params.Input.Add(p)\n        \n        p = Grasshopper.Kernel.Parameters.Param_Number()\n        self.SetUpParam(p, \"azimuth\", \"azimuth\", \"Camera rotation in XY. 0 to 360.\")\n        p.Access = Grasshopper.Kernel.GH_ParamAccess.item\n        self.Params.Input.Add(p)\n        \n        p = Grasshopper.Kernel.Parameters.Param_Number()\n        self.SetUpParam(p, \"altitude\", \"altitude\", \"Camera z-position. -90 to 90.\")\n        p.Access = Grasshopper.Kernel.GH_ParamAccess.item\n        self.Params.Input.Add(p)\n        \n    \n    def RegisterOutputParams(self, pManager):\n        p = Grasshopper.Kernel.Parameters.Param_GenericObject()\n        self.SetUpParam(p, \"view_geom\", \"view_geom\", \"geometry in view\")\n        self.Params.Output.Add(p)\n        \n        p = Grasshopper.Kernel.Parameters.Param_GenericObject()\n        self.SetUpParam(p, \"view_target\", \"view_target\", \"3D point for camera target.\")\n        self.Params.Output.Add(p)\n        \n        p = Grasshopper.Kernel.Parameters.Param_GenericObject()\n        self.SetUpParam(p, \"view_vector\", \"view_vector\", \"3D vector defining camera direction.\")\n        self.Params.Output.Add(p)\n        \n    \n    def SolveInstance(self, DA):\n        p0 = self.marshal.GetInput(DA, 0)\n        p1 = self.marshal.GetInput(DA, 1)\n        p2 = self.marshal.GetInput(DA, 2)\n        result = self.RunScript(p0, p1, p2)\n\n        if result is not None:\n            if not hasattr(result, '__getitem__'):\n                self.marshal.SetOutput(result, DA, 0, True)\n            else:\n                self.marshal.SetOutput(result[0], DA, 0, True)\n                self.marshal.SetOutput(result[1], DA, 1, True)\n                self.marshal.SetOutput(result[2], DA, 2, True)\n        \n    def get_Internal_Icon_24x24(self):\n        o = \"iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAHYcAAB2HAY/l8WUAAANMSURBVEhLxZVbSJRREMe/Nde77q5kmrfAS1iuia578barqxLYQwgGESFiYBRIF6gkKSqKonoT6kUMukhpBCUuVNiDkRIJJollJkahEEFlfnnJzek/53NdzQubFf3hhzPzzZk5Z85hlf63VoN0xRSKBbdAlvAUJQOOr0inAAFf4UlSDGB/s/AU9QGHYnqmcBCimKLgOHCdghu9BEnCk6RgIIN84UnSKsDrl5Q/GACNwlNUC/YrptANEKGYUiFoVkwhzhsBkcJbRF5gK3CCYg5AcaBGMYX2giDFlCqBXTHFPfA6zvXhwHLiS7wP1ghPkkzAtSgR8ChUwAx4U2pwHewGHot3zrvjQiwuNFeuOMsIeFweKWwGvsAADvwt8Y7KwBfAF8XUAX4VfKnLwaP8NbbgHi4lb9B8N2aEkjFd5yZDM2rO0MhLYtDIudk6Oc+qlW05GjnPppVzMnWyWq1qRU33WFUqr7bBniwiKiCazF/IFOBvVAQKiZwzccQe3jPQ+dMmqr2YSRfOmqm5KY2Sknw/oKz7FCqV6kF/txkLbETfct3IYBqx6Xzq7jDS3Zsp1PHIQDSGGOWJ/OPVCVS2o5iOVZdSRdkWOnIwHqcPeIuy8xv0daHBDywcRVHmK3DaaGgwm4oKwvgnYpYUfQh1tpvQwE49T9Op8WoyNV1LpsYGPXW2pVFior8HDcatNDZio016jSi6c3sk1dfp6UDVOuHrtL707jWPlUfFp2Fg49TR0d4eNEDylcsbRbGjh+Lg8/zt4m9DvV7E9+2JVWKuNRNWGv+Y7WkDO2a7VhQa7sdO+S5mitC4jbQaH5wuGGuUXa+oQWVFlGjQ322BjxHwvUxZyTlipcBAbzIZtH/SIJ9abqeKBqUlEeSc5PHwUy2gmsNxIn7uRILYyOya32rAzxTvf1uJMqb18UFUXh5DZqNW+GmpGhr9hHHxyDxp8P5Vpti18u4BNxMvw05nsNPoKD9ROFSnpipc7gRemMjnPNcazsfGYhY28Gp33Emn3p5M6u20uHlmpr7nFhoeyKHOxxbinPZWEw3159CbF8jF93n5yO16YqLwcJ/PKOtuAO1CmxaA/6+Lo1Z7O4IC1Q4/X+9Fv89HOgnm/qT/C0nSTw0bl6OgcEo6AAAAAElFTkSuQmCC\"\n        return System.Drawing.Bitmap(System.IO.MemoryStream(System.Convert.FromBase64String(o)))\n\n    view_geom, view_target, view_vector = None, None, None\n\n    def RunScript(self, geometry, azimuth, altitude):\n        view_geom, view_target, view_vector = None, None, None\n        if geometry == None:\n            self.AddRuntimeMessage(RML.Warning,\"add geometry\")\n        if azimuth == None:\n            self.AddRuntimeMessage(RML.Warning,\"add azimuth\")\n        if altitude == None:\n            self.AddRuntimeMessage(RML.Warning,\"add altitude\")\n        if geometry!=None and azimuth!=None and altitude!=None:\n            #given geometry get centroid (bounding box)\n            bbox = rs.BoundingBox(geometry)\n            #cam target is centroid\n            centroid = [0,0,0]\n            for pt in bbox:\n                centroid = [centroid[0]+pt[0]/8, centroid[1]+pt[1]/8, centroid[2]+pt[2]/8]\n\n            target = rs.AddPoint(centroid)\n            view_dist = rs.Distance(bbox[0], bbox[6])\n\n            # convert angles to radians\n            azimuth = azimuth*2*math.pi/360\n            altitude = altitude*2*math.pi/360\n            X = centroid[0] + view_dist*math.cos(azimuth)\n            Y = centroid[1] + view_dist*math.sin(azimuth)\n            Z = centroid[2] + view_dist*math.sin(altitude)\n            cam_pos = [X, Y, Z]\n\n            view_geom = geometry\n            view_target = target\n            view_vector = rs.VectorCreate(centroid, cam_pos)\n\n        # return outputs if you have them; here I try it for you:\n        return (view_geom, view_target, view_vector)\n\n\nimport GhPython\nimport System\n\nclass AssemblyInfo(GhPython.Assemblies.PythonAssemblyInfo):\n    def get_AssemblyName(self):\n        return \"CreateView\"\n    \n    def get_AssemblyDescription(self):\n        return \"\"\"\"\"\"\n\n    def get_AssemblyVersion(self):\n        return \"0.1\"\n\n    def get_AuthorName(self):\n        return \"\"\n    \n    def get_Id(self):\n        return System.Guid(\"ce9ecb28-2824-4226-90c2-11a6b672d5f1\")",
  "language": "python",
  "imports": [
    "ghpythonlib",
    "rhinoscriptsyntax",
    "scriptcontext"
  ],
  "has_docstring": false
}