{
  "source_url": "https://discourse.mcneel.com/t/section-modulus/23316",
  "topic_id": 23316,
  "title": "Section Modulus",
  "question": "If I establish a cross section shape for a structural beam, how can I use Rhino to give me a section modulus?\n\n\nThis is what I get from the ‘area moments’ command;\n\n\nArea = 2.14778953 (+/- 1e-09) square feet\n\nArea Centroid = 48.7607237,-0.116125533,4.10834046 (+/- 1e-08,1e-10,5.5e-09)\n\nArea Moments:\n\nFirst Moments\n\nx: \t104.727772 (+/- 1e-07)\n\ny: \t-0.249413205 (+/- 1e-10)\n\nz: \t8.82385063 (+/- 1.2e-08)\n\nSecond Moments\n\nxx: \t5107.30953 (+/- 1e-06)\n\nyy: \t0.0289632414 (+/- 1e-11)\n\nzz: \t37.0935158 (+/- 1.4e-07)\n\nProduct Moments\n\nxy: \t-12.1615684 (+/- 1e-08)\n\nyz: \t-1.02467436 (+/- 1.4e-09)\n\nzx: \t430.238757 (+/- 6.2e-07)\n\nArea Moments of Inertia about World Coordinate Axes\n\nIx: \t37.1224791 (+/- 1.4e-07)\n\nIy: \t5144.40304 (+/- 1e-06)\n\nIz: \t5107.33849 (+/- 1e-06)\n\nArea Radii of Gyration about World Coordinate Axes\n\nRx: \t4.15740778 (+/- 8.1e-09)\n\nRy: \t48.940864 (+/- 1e-08)\n\nRz: \t48.76424 (+/- 1e-08)\n\nArea Moments of Inertia about Centroid Coordinate Axes\n\nIx: \t0.842133304 (+/- 4.8e-08)\n\nIy: \t1.54970531 (+/- 8.4e-08)\n\nIz: \t0.707572002 (+/- 3.5e-08)\n\nArea Principal Moments of Inertia about Centroid and Principal Axes\n\nI1: \t0.705052224 , \t Direction ( 0.990933965, 0 ,-0.13434983)\n\nI2: \t1.26764532e-34 , \t Direction ( 0, 1 ,0)\n\nI3: \t0.844653082 , \t Direction ( 0.13434983, 0 ,0.990933965)\n\nArea Radii of Gyration about Centroid Coordinate Axes\n\nRx: \t0.626173322 (+/- 1.8e-08)\n\nRy: \t0.849432159 (+/- 2.3e-08)\n\nRz: \t0.573970351 (+/- 1.4e-08)",
  "code_blocks": [
    {
      "code": "import rhinoscriptsyntax as rs\n\n\nwarning = \"1) All parts must be surface, not polysurface or closed curve! \\n \"\nwarning += \"2) All parts must be planar. \\n\"\nwarning += \"3) You have to work in TOP view, XY-axis \\n\\n\"\nwarning += \"View screen will be turn to TOP-view now!  \" \nrs.MessageBox(warning,0,\"Warning\")\nrs.CurrentView(\"Top\")\n\n\nsurfaces = rs.GetObjects(\"Select Surfaces\" , preselect=True , filter=8)\n\nif surfaces : \n    TotalAreaMomentAxis = 0 \n    TotalAreaMX = 0\n    TotalAreaMY = 0\n    TotalAreaMZ = 0\n    TotalArea = 0 \n    \n    for x in surfaces :\n        area = rs.Area(x)\n        areaCenter = rs.SurfaceAreaCentroid(x)[0]\n        areaCenterX = areaCenter[0]\n        areaCenterY = areaCenter[1]\n        areaCenterZ = areaCenter[2]\n        \n        TotalAreaMX = TotalAreaMX + (area * areaCenterX)\n        TotalAreaMY = TotalAreaMY + (area * areaCenterY)\n        TotalAreaMZ = TotalAreaMZ + (area * areaCenterZ)\n        TotalArea = TotalArea + area \n    totalCenterX = TotalAreaMX / TotalArea\n    totalCenterY = TotalAreaMY / TotalArea\n    totalCenterZ = TotalAreaMZ / TotalArea\n    TotalCenter = (totalCenterX,totalCenterY,totalCenterZ)\n    \n    \n    \n    BB = rs.BoundingBox(surfaces)\n    x_kucuk=BB[0][0] ; x_buyuk=BB[0][0] ; y_kucuk=BB[0][1] ; y_buyuk=BB[0][1] ; z_kucuk=BB[0][2] ; z_buyuk=BB[0][2]\n    \n    for y in BB :\n        if y[0] < x_kucuk : x_kucuk = y[0]\n        if y[0] > x_buyuk : x_buyuk = y[0]\n        if y[1] < y_kucuk : y_kucuk = y[1]\n        if y[1] > y_buyuk : y_buyuk = y[1]\n        if y[2] < z_kucuk : z_kucuk = y[2]\n        if y[2] > z_buyuk : z_buyuk = y[2]\n    \n    axis = rs.ListBox((\"X axis select\",\"Y axis select\",\"X-Neutral Axis\",\"Y-Neutral Axis\"), \"Select the axis for section modules\" , \"Axis\" , default=0)\n    if axis == \"X axis select\" :\n        axispoint = rs.GetPoint (\"Select a point on X-Axis you want to see moments\")\n    if axis == axis == \"Y axis select\" :\n        axispoint = rs.GetPoint (\"Select a point on Y-Axis you want to see moments\")\n    \n    if axis == \"X axis select\" :\n        axis_line = rs.AddLine((x_kucuk,axispoint[1],z_kucuk) , (x_buyuk,axispoint[1],z_kucuk ) )\n    elif axis == \"Y axis select\" :\n        axis_line = rs.AddLine((axispoint[0],y_kucuk,z_kucuk ) , (axispoint[0],y_buyuk,z_kucuk ) )\n    elif axis == \"X-Neutral Axis\" : axis_line = rs.AddLine((x_kucuk,totalCenterY,z_kucuk) , (x_buyuk,totalCenterY,z_kucuk ) )\n    elif axis == \"Y-Neutral Axis\" : axis_line = rs.AddLine((totalCenterX,y_kucuk,z_kucuk ) , (totalCenterX,y_buyuk,z_kucuk ) )\n    else: print \"No axis selected\" ; exit()\n    \n    \n    \n    for x in surfaces :\n        areaMomentCentroid = rs.SurfaceAreaMoments(x)[10]\n        if axis == \"X axis select\" or axis == \"X-Neutral Axis\" : areaMomentCentroid = areaMomentCentroid[0]\n        elif axis == \"Y axis select\" or axis == \"Y-Neutral Axis\"  : areaMomentCentroid = areaMomentCentroid[1]\n        else : print \"Axis is not correct\" ; exit() \n        area = rs.Area(x)\n        areaCenter = rs.SurfaceAreaCentroid(x)[0]\n        ClosestPoint = rs.PointClosestObject(areaCenter,axis_line)[1]\n        distance = rs.Distance(ClosestPoint,areaCenter)\n        round(distance,2)\n        round(area)\n        round(areaMomentCentroid,2)\n        areaMomentAxis = areaMomentCentroid + (area * distance * distance)\n        TotalAreaMomentAxis = TotalAreaMomentAxis + areaMomentAxis \n        \n    #section modulus\n    \n    \n    \n    ClosestPoint = rs.PointClosestObject(TotalCenter,axis_line)[1]\n    Distance = round (rs.Distance(ClosestPoint,TotalCenter),2)\n    #rs.AddPoint(TotalCenter)\n    print \"distance \" + str(Distance)\n    if Distance != 0 : \n        SectionModulus = round((TotalAreaMomentAxis / Distance) ,1)\n    else : \n        SectionModulus = \"--infinity--\"\n    axeCenter = rs.CurveMidPoint(axis_line)\n    \n    text = \"Total Moment of inertia on axis = \" + str(round(TotalAreaMomentAxis,1)) + \" mm4 \\n Total Elastic Section modulus for axis = \" + str(SectionModulus)+ \" mm3\"\n    result = rs.AddText(text, axeCenter, height=3, font=None, font_style=0 )\n    rs.ObjectLinetype(axis_line , \"Center\")\n    rs.ObjectColor(axis_line,(255,0,0))\n    rs.ObjectColor(result,(255,0,0))\n    print text \nelse :  print \"No surface selected\"",
      "language": "python",
      "author": "Ersin_KAR",
      "post_number": 7,
      "is_solution": false
    }
  ],
  "tags": [
    "file-io",
    "geometry",
    "python",
    "rhinoscriptsyntax",
    "selection",
    "ui"
  ],
  "has_accepted_answer": false,
  "category_id": 1,
  "posts_count": 8,
  "views": 6803
}