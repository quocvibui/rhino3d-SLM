{
  "source_url": "https://github.com/fromenlab/LatticeTools/blob/4ed52adaf55fdab72c4b6c9566f011a3bdc9f8d3/log/log_utils.py",
  "repo": "fromenlab/LatticeTools",
  "repo_stars": 1,
  "repo_description": "Components for generating lattice structures in Rhino®/Grasshopper®",
  "license": "NOASSERTION",
  "filepath": "log/log_utils.py",
  "instruction": "Log utils",
  "code": "from ghpythonlib.componentbase import executingcomponent as component\nimport Grasshopper, GhPython\nimport System\nimport Rhino\nimport rhinoscriptsyntax as rs\nimport scriptcontext\nimport os\nimport hashlib\nfrom datetime import datetime\nimport json\nfrom collections import OrderedDict\n\n##########\n# External\n##########\n\ndef get_libraries(self):\n    # Includes logic from Giulio Piacentino\n    # Source: https://www.grasshopper3d.com/forum/topics/gh-filename-is-python\n    core_libraries = {}\n    addon_libraries = {}\n    objids = {}\n    \n    server = Grasshopper.Instances.ComponentServer\n    for obj in self.OnPingDocument().Objects:\n        if obj == self: continue #Ignore this component.\n        \n        objId = obj.ComponentGuid\n        if objids.has_key(objId): continue\n        objids[objId] = \"\"\n        \n        lib = server.FindAssemblyByObject(obj)\n        if lib == None: continue\n        if core_libraries.has_key(lib.Id) or addon_libraries.has_key(lib.Id): continue\n        \n        if lib.IsCoreLibrary:\n            core_libraries[lib.Id] = lib\n        else:\n            addon_libraries[lib.Id] = lib\n    \n    return core_libraries, addon_libraries\n\n##########\n# Original\n##########\n\ndef make_id(properties):\n    properties_string = ','.join(map(str, properties))\n    properties_fragment = (hashlib.md5(properties_string.encode(\"UTF-8\")).hexdigest())[:3]\n\n    date_info = datetime.now().strftime(\"%y%m%d\")\n    date_utc = datetime.utcnow().strftime(\"%Y-%m-%dT%H:%M:%S\")\n    instance_fragment = (hashlib.sha256(date_utc.encode(\"UTF-8\")).hexdigest())[:2]\n\n    unique_id = '-'.join([date_info, properties_fragment, instance_fragment])\n    \n    return unique_id, date_utc\n\ndef get_units(ghdoc):\n    scriptcontext.doc = Rhino.RhinoDoc.ActiveDoc\n    base_units = rs.UnitSystemName()\n    scriptcontext.doc = ghdoc\n    \n    return base_units\n\ndef get_device():\n    device = Rhino.Runtime.HostUtils.DeviceId.ToString()\n\n    return device\n\ndef get_software_build():\n    rhino_build = str(Rhino.RhinoApp.Version)\n    rhino_date = Rhino.RhinoApp.BuildDate\n    gh_build = str(Grasshopper.Versioning.Version)\n    gh_date = Grasshopper.Versioning.BuildDate\n\n    return rhino_build, rhino_date, gh_build, gh_date\n\ndef combine_inputs(input_json):\n    inputs = OrderedDict()\n    for item in input_json:\n        if item:\n            item = str(item).replace(\"\\n\", \"\")\n            inputs.update(json.loads(item, object_pairs_hook=OrderedDict))\n    return inputs",
  "language": "python",
  "imports": [
    "Rhino",
    "ghpythonlib",
    "rhinoscriptsyntax",
    "scriptcontext"
  ],
  "has_docstring": false
}