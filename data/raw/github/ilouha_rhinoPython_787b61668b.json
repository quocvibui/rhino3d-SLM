{
  "source_url": "https://github.com/ilouha/rhinoPython/blob/4194fbd3f384073a9a648e1a52490737a4509e1d/ExportObjectsInLayersToSeparateFiles.py",
  "repo": "ilouha/rhinoPython",
  "repo_stars": 1,
  "repo_description": "general scripting repository for quick hacks in Rhino using Python",
  "license": "unknown",
  "filepath": "ExportObjectsInLayersToSeparateFiles.py",
  "instruction": "Export objects in layers to separate files",
  "code": "import rhinoscriptsyntax as rs\nimport os\n\ndef export_layers_to_dwg():\n    # Prompt the user for a folder to export files\n    folder = rs.BrowseForFolder(None, \"Select Folder to Export DWG Files\")\n    if not folder:\n        print(\"No folder selected. Export canceled.\")\n        return\n    \n    # Get all layers in the document\n    layers = rs.LayerNames()\n    if not layers:\n        print(\"No layers found in the document.\")\n        return\n    \n    # Iterate through each layer\n    for layer in layers:\n        # Select all objects on the current layer\n        objs_on_layer = rs.ObjectsByLayer(layer)\n        if not objs_on_layer:\n            print(\"No objects found on layer: {}\".format(layer))\n            continue\n        \n        # Export only objects on this layer\n        rs.SelectObjects(objs_on_layer)\n        \n        # Define the file path\n        layer_name = rs.LayerName(layer, fullpath=False)\n        file_path = os.path.join(folder, \"{}.dwg\".format(layer_name))\n        \n        # Export the selected objects to a DWG file\n        rs.Command('-_Export \"{}\" _Enter'.format(file_path), echo=False)\n        \n        # Deselect objects after exporting\n        rs.UnselectObjects(objs_on_layer)\n    \n    print(\"Export completed.\")\n\n# Run the function\nexport_layers_to_dwg()\n",
  "language": "python",
  "imports": [
    "rhinoscriptsyntax"
  ],
  "has_docstring": false
}