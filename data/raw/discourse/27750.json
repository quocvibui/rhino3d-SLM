{
  "source_url": "https://discourse.mcneel.com/t/excel-handling-help-in-rhino-python/27750",
  "topic_id": 27750,
  "title": "Excel handling help in Rhino python",
  "question": "Hi!\n\nI was working on NURBS modeling using rhino python in which I had to draw several models whith several different sets of control point weights.Now,I have a matrix with 18 different sets of weight values.I use the below mentioned code for the same.Although I am getting 18 different files ,but the problem each of the file saved has all the curves from the previous saved files too,apart from the curve which is actually to be saved in that \nfile.In\n short ,the save feature I am using keeps accumulating the curves to the later saved files.For example,the 10th saved file has all the 9 curves corresponding to the previous 9 weight points ,Can somebody help me with this.Thanks.\n\n\nimport Rhino\n\nimport scriptcontext\n\nimport os\n\nimport rhinoscriptsyntax as rs\n\nimport sys\n\nimport xlrd\n\n\nk=0\n\nMatrix = [[0 for x in range(18)] for x in range(18)]\n\nMatrix=([[3.97,2.59,3.34],[1.34,4.16,3.09],[4.03,4.47,0.59],[0.84,3.28,2.47],[0.34,2.03,2.66],[2.22,1.84,4.66],[1.78,3.91,4.16],[4.78,1.03,4.47],[4.91,0.41,3.03],[1.72,1.47,2.03],[0.41,2.72,4.72],[3.16,4.53,2.34],[4.41,3.66,1.22],[4.47,1.28,2.09],[0.22,1.34,3.66],[2.34,4.66,2.91],[3.09,4.91,3.53],[3.28,2.97,4.78]])\n\n\ndef SaveAsRhinoFile(name=“Default.3dm”):\n\n\nfilename = name\nfolder = \"D:/Sachin/\"\npath = os.path.abspath(folder + filename)\ncmd = \"_-SaveAs \" + chr(34) + path + chr(34)\nrs.Command(cmd, True)\n\n\n\nl=1\n\ndef TestNurbsCurve(l=1):\n\ndegree = 7\n\ncv_count = 8\n\nknot_count = cv_count + degree - 1\n\norder = degree + 1\n\ncvs = []\n\ncvs.append(Rhino.Geometry.Point3d(0.0, 0.0, 0.0))\n\ncvs.append(Rhino.Geometry.Point3d(458.0, 0.0, 0.0))\n\ncvs.append(Rhino.Geometry.Point3d(458.0, 229.0, 0.0))\n\ncvs.append(Rhino.Geometry.Point3d(458.0, 458.0, 0.0))\n\ncvs.append(Rhino.Geometry.Point3d(0.0, 458.0, 0.0))\n\ncvs.append(Rhino.Geometry.Point3d(0.0, 686.0, 0.0))\n\ncvs.append(Rhino.Geometry.Point3d(0.0, 915.0, 0.0))\n\ncvs.append(Rhino.Geometry.Point3d(458.0, 915.0, 0.0))\n\nknots = []\n\nknots.append(0)\n\nknots.append(0)\n\nknots.append(0)\n\nknots.append(0)\n\nknots.a...",
  "code_blocks": [
    {
      "code": "crv_id=scriptcontext.doc.Objects.AddCurve(curve)\nscriptcontext.doc.Objects.Select(crv_id,True,True)\nfilename = name\nfolder = \"D:/Sachin/\"\npath = os.path.abspath(folder + filename)\ncmd = \"_-Export \" + chr(34) + path + chr(34)\nrs.Command(cmd, True)\nscriptcontext.doc.Objects.Delete(crv_id,True)",
      "language": "python",
      "author": "Helvetosaur",
      "post_number": 4,
      "is_solution": false
    },
    {
      "code": "filename = name\nfolder = \"D:/Sachin/\"\npath = os.path.abspath(folder + filename)\ncmd = \"_-SaveAs \" + chr(34) + path + chr(34)\nrs.Command(cmd, True)",
      "language": "python",
      "author": "Sachin_Saxena1",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "csharp",
    "file-io",
    "geometry",
    "nurbs",
    "python",
    "rhinocommon",
    "rhinoscriptsyntax"
  ],
  "has_accepted_answer": false,
  "category_id": 11,
  "posts_count": 4,
  "views": 1765
}