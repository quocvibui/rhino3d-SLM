{
  "source_url": "https://discourse.mcneel.com/t/circle-packing-on-surface-in-python/195213",
  "topic_id": 195213,
  "title": "Circle Packing on surface in Python",
  "question": "Greetings,\n\nI was looking for a Python solution for circle packing on surface, or at least on a boundary.\n\nMost useful seems to be the VBscript written by Steven Janssen, which I translated to Python using ChatGPT. (maybe somone should include the translation on the developer page?)\n\n\nBut anyway, is there any Python that can solve circle packing on a surface or boundary? I donâ€™t like to use Kangaroo.\n\n\nThank you!\n\n\n# Original VBScript by Steven Janssen\n# https://developer.rhino3d.com/samples/rhinoscript/circle-packing/\n# Translated to Python by BC using ChatGPT, 241120\n\nimport rhinoscriptsyntax as rs\nimport random\nimport math\n\n\ndef main():\n    # Get Input Circles\n    arr_input_r = rs.GetObjects(\"Select Circles\", rs.filter.curve)\n    if not arr_input_r:\n        return\n    \n    # Get Radii from Input Circles\n    for i, curve in enumerate(arr_input_r):\n        if rs.IsCircle(curve):\n            arr_input_r[i] = rs.CircleRadius(curve)\n    \n    # Get Number of Circles\n    int_circle_number = rs.GetInteger(\"Number of Circles\", 1000)\n    if int_circle_number is None:\n        return\n    int_circle_number -= 1\n\n    arr_point = [None] * (int_circle_number + 1)\n    arr_radius = [None] * (int_circle_number + 1)\n    \n    # Draw 1st Circle\n    arr_radius[0] = random.choice(arr_input_r)\n    arr_point[0] = rs.GetPoint(\"Centre of Circle\")\n    if not arr_point[0]:\n        return\n    str_current_circle_id = rs.AddCircle(arr_point[0], arr_radius[0])\n\n    rs.EnableRedraw(False)\n    \n    # Draw 2nd Circle\n    arr_radius[1] = random.choice(arr_input_r)\n    arr_point[1] = list(arr_point[0])  # Convert to list for mutability\n    arr_point[1][0] += arr_radius[0] + arr_radius[1]\n    str_current_circle_id = rs.AddCircle(arr_point[1], arr_radius[1])\n\n    int_current_centre = 0\n    int_hole = 1\n\n    # Draw other Circles\n    for k in range(2, int_circle_number + 1):\n        rs.StatusBarMessage(f\"{k+1}/{int_circle_number+1}\")\n        arr_radius[k] = random.choice(arr_input_r)\n\n        while True:\n...",
  "code_blocks": [
    {
      "code": "# Original VBScript by Steven Janssen\n# https://developer.rhino3d.com/samples/rhinoscript/circle-packing/\n# Translated to Python by BC using ChatGPT, 241120\n\nimport rhinoscriptsyntax as rs\nimport random\nimport math\n\n\ndef main():\n    # Get Input Circles\n    arr_input_r = rs.GetObjects(\"Select Circles\", rs.filter.curve)\n    if not arr_input_r:\n        return\n    \n    # Get Radii from Input Circles\n    for i, curve in enumerate(arr_input_r):\n        if rs.IsCircle(curve):\n            arr_input_r[i] = rs.CircleRadius(curve)\n    \n    # Get Number of Circles\n    int_circle_number = rs.GetInteger(\"Number of Circles\", 1000)\n    if int_circle_number is None:\n        return\n    int_circle_number -= 1\n\n    arr_point = [None] * (int_circle_number + 1)\n    arr_radius = [None] * (int_circle_number + 1)\n    \n    # Draw 1st Circle\n    arr_radius[0] = random.choice(arr_input_r)\n    arr_point[0] = rs.GetPoint(\"Centre of Circle\")\n    if not arr_point[0]:\n        return\n    str_current_circle_id = rs.AddCircle(arr_point[0], arr_radius[0])\n\n    rs.EnableRedraw(False)\n    \n    # Draw 2nd Circle\n    arr_radius[1] = random.choice(arr_input_r)\n    arr_point[1] = list(arr_point[0])  # Convert to list for mutability\n    arr_point[1][0] += arr_radius[0] + arr_radius[1]\n    str_current_circle_id = rs.AddCircle(arr_point[1], arr_radius[1])\n\n    int_current_centre = 0\n    int_hole = 1\n\n    # Draw other Circles\n    for k in range(2, int_circle_number + 1):\n        rs.StatusBarMessage(f\"{k+1}/{int_circle_number+1}\")\n        arr_radius[k] = random.choice(arr_input_r)\n\n        while True:\n            marker = 0\n            \n            # Calculate the lengths of the sides\n            arr_side = [0, 0, 0]\n            arr_side[0] = rs.Distance(arr_point[int_current_centre], arr_point[k - int_hole])\n            arr_side[1] = arr_radius[k] + arr_radius[int_current_centre]\n            arr_side[2] = arr_radius[k] + arr_radius[k - int_hole]\n            \n            # Calculate Angle\n            dbl_cos_a = (arr_side[0] ** 2 + arr_side[1] ** 2 - arr_side[2] ** 2) / (2 * arr_side[0] * arr_side[1])\n            \n            if dbl_cos_a > 1:\n                marker = 1\n            else:\n                dbl_rot_a = math.degrees(math.acos(dbl_cos_a))\n                \n                # Create, rotate, and scale Vector\n                vector = rs.VectorCreate(arr_point[k - int_hole], arr_point[int_current_centre])\n                vector = rs.VectorRotate(vector, dbl_rot_a, [0, 0, 1])\n                vector = rs.VectorScale(vector, arr_side[1] / arr_side[0])\n                arr_point[k] = rs.VectorAdd(vector, arr_point[int_current_centre])\n                \n                # Check if Circle will Intersect with Existing Circles\n                for checkloop in range(k - 1, -1, -1):\n                    checkdistance_a = rs.Distance(arr_point[k], arr_point[checkloop]) + 0.001\n                    checkdistance_b = arr_radius[k] + arr_radius[checkloop]\n                    if checkdistance_a < checkdistance_b:\n                        marker = 1\n                        break\n                \n                if marker == 0:\n                    str_current_circle_id = rs.AddCircle(arr_point[k], arr_radius[k])\n            \n            # Exit the loop if the Circle is Good\n            if marker == 0:\n                int_hole = 1\n                break\n\n            int_current_centre += 1\n\n            if int_current_centre == k - int_hole:\n                int_hole += 1\n                int_current_centre = 0\n\n    rs.EnableRedraw(True)\n\nif __name__ == \"__main__\":\n    main()",
      "language": "python",
      "author": "Bogdan_Chipara",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "file-io",
    "geometry",
    "python",
    "rhinoscriptsyntax",
    "selection",
    "transformation",
    "ui"
  ],
  "has_accepted_answer": false,
  "category_id": 11,
  "posts_count": 1,
  "views": 164
}