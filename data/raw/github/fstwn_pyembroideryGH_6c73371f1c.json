{
  "source_url": "https://github.com/fstwn/pyembroideryGH/blob/ee7fd47316b364962a69976b4168ce9fef2702cf/usrobj_src/pyembroideryGH_AddBlock.py",
  "repo": "fstwn/pyembroideryGH",
  "repo_stars": 11,
  "repo_description": "Set of UserObjects enabling Grasshopper to directly read, write and manipulate various kinds of embroidery formats. It is based on an IronPython-compatible fork of the original pyembroidery library.",
  "license": "MIT",
  "filepath": "usrobj_src/pyembroideryGH_AddBlock.py",
  "instruction": "Adds a block of stitches to an embroidery pattern supplied as\npyembroidery.EmbPattern instance\n    Inputs:\n        Pattern: The pattern to be modified as\n                 pyembroidery.EmbPattern...",
  "code": "\"\"\"\nAdds a block of stitches to an embroidery pattern supplied as\npyembroidery.EmbPattern instance\n    Inputs:\n        Pattern: The pattern to be modified as\n                 pyembroidery.EmbPattern instance.\n                 {item, EmbPattern}\n        Stitches: The block(s) of stitches to add to the pattern. If a\n                  tree is supplied, each branch will be treated as one block.\n                  {list, str}\n        Thread: The threads for the pattern, corresponding to\n                the blocks of stitches. This is optional, If no thread is\n                supplied, the blocks will still be added to the pattern!\n                {item, EmbThread}\n    Output:\n        Pattern: The modified pattern with the blocks of stitches and the their\n                 thread added.\n                 {item/list/tree, EmbPattern}\n    Remarks:\n        Author: Max Eschenbach\n        License: MIT License\n        Version: 201104\n\"\"\"\n\n# PYTHON STANDARD LIBRARY IMPORTS\nfrom __future__ import division\nimport re\n\n# GHPYTHON SDK IMPORTS\nfrom ghpythonlib.componentbase import executingcomponent as component\nimport Grasshopper, GhPython\nimport System\nimport Rhino\nimport rhinoscriptsyntax as rs\n\n# GHENV COMPONENT SETTINGS\nghenv.Component.Name = \"AddBlock\"\nghenv.Component.NickName = \"AB\"\nghenv.Component.Category = \"pyembroideryGH\"\nghenv.Component.SubCategory = \"3 Pattern Creation\"\n\n# LOCAL MODULE IMPORTS\ntry:\n    import pyembroidery\nexcept ImportError:\n    errMsg = (\"The pyembroidery python module seems to be not correctly \" +\n              \"installed! Please make sure the module is in you search \" +\n              \"path, see README for instructions!.\")\n    raise ImportError(errMsg)\n\nclass AddBlock(component):\n\n    def RunScript(self, input_pattern, Stitches, Thread):\n        # initialize output\n        Pattern = Grasshopper.DataTree[object]()\n        \n        # check if valid data is coming in\n        if input_pattern != None and Stitches:\n            # check if pattern is valid\n            if not isinstance(input_pattern, pyembroidery.EmbPattern):\n                raise TypeError(\"The supplied pattern is not a valid \" +\n                                \"pyembroidery.EmbPattern instance!\")\n            else:\n                # copy input pattern to avoid changing the original\n                Pattern = input_pattern.copy()\n                # regex pattern for matching stitch strings\n                regex = re.compile(r'^([+-]?(\\d+([.]\\d*)?([eE][+-]?\\d+)?|[.]\\d+([eE][+-]?\\d+)?)[,]){2}[-+]?[0-9]+$')\n                # check and extract stitches, compile valid_stitches\n                valid_stitches = []\n                for i, stitch in enumerate(Stitches):\n                    if bool(regex.match(stitch)):\n                        # convert the stitch\n                        stitch = stitch.split(\",\")\n                        stitch = (float(stitch[0]),\n                                  float(stitch[1]),\n                                  int(stitch[2]))\n                        valid_stitches.append(stitch)\n                    else:\n                        rml = self.RuntimeMessageLevel.Warning\n                        errMsg = (\"{}. stitch at index {} is not a \" +\n                                  \"valid stitch string! Skipping this stitch!\")\n                        errMsg = errMsg.format(i, self.RunCount)\n                        self.AddRuntimeMessage(rml, errMsg)\n                if Thread != None:\n                    if not isinstance(Thread, pyembroidery.EmbThread):\n                        raise TypeError(\"The supplied thread is not a valid \" +\n                                        \"pyembroidery.EmbThread instance!\")\n                else:\n                    rml = self.RuntimeMessageLevel.Remark\n                    errMsg = (\"No Thread supplied. Resulting block will not \" +\n                              \"have a thread attached.\")\n                    errMsg = errMsg.format(self.RunCount)\n                    self.AddRuntimeMessage(rml, errMsg)\n                # add the block and thread to the pattern\n                Pattern.add_block(valid_stitches, Thread)\n        else:\n            rml = self.RuntimeMessageLevel.Warning\n            if not Stitches:\n                errMsg = (\"Input Stitches failed to collect data!\")\n                self.AddRuntimeMessage(rml, errMsg)\n        \n        # return outputs if you have them; here I try it for you:\n        return Pattern\n",
  "language": "python",
  "imports": [
    "Rhino",
    "ghpythonlib",
    "rhinoscriptsyntax"
  ],
  "has_docstring": true
}