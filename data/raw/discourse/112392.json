{
  "source_url": "https://discourse.mcneel.com/t/how-to-delete-a-layer-from-gh/112392",
  "topic_id": 112392,
  "title": "How to delete a layer from GH?",
  "question": "I would like to delete some layers and the objects on those layers in Rhino from GH. They were previously generated by Human. I know there is a “Delete on Layer” component, but that only deletes objects and doesn’t delete in sublayers.\n\n\nSo what I have are the layer paths to delete in the typical format of “Layer::Sublayer::etc.”\n\n\nOf course I am aware of the usual warnings.\n\n\nIs there a way to do it with Python or C#? I found this \nhttps://developer.rhino3d.com/api/RhinoCommon/html/M_Rhino_DocObjects_Tables_LayerTable_Purge.htm\n, which I think is the method to delete a layer and its contents, but not sure how to get the GUID of a layer based on its path and how to plug it all together.\n\n\nThanks.",
  "code_blocks": [
    {
      "code": "import rhinoscriptsyntax as rs\nimport scriptcontext\nimport Rhino\n\nscriptcontext.doc = Rhino.RhinoDoc.ActiveDoc\n\ncrv=rs.ObjectsByLayer('panel', False)\n\nif crv: rs.DeleteObjects(crv)\n\nscriptcontext.doc = ghdoc",
      "language": "python",
      "author": "martinsiegrist",
      "post_number": 2,
      "is_solution": false
    },
    {
      "code": "import rhinoscriptsyntax as rs\nimport scriptcontext\nimport Rhino\n\nscriptcontext.doc = Rhino.RhinoDoc.ActiveDoc\n\nif x == 1:\n   if layer: rs.PurgeLayer(layer)\n\nscriptcontext.doc = ghdoc",
      "language": "python",
      "author": "seltzdesign",
      "post_number": 6,
      "is_solution": false
    },
    {
      "code": "using Rhino.DocObjects;\nusing Rhino.DocObjects.Tables;\n\npublic class Script_Instance: GH_ScriptInstance {\n\n  private void RunScript(bool ok, string layerName) {\n    if (!ok) return;\n\n    var layerTable = RhinoDocument.Layers;\n    var layerId = layerTable.FindByFullPath(layerName, -1);\n    if (layerId == -1) return;\n\n    PurgeRecursive(layerTable, layerTable[layerId]);\n  }\n \n  private void PurgeRecursive(LayerTable lt, Layer parent) {\n    foreach(var it in parent.GetChildren() ?? Array.Empty<Layer>())\n      PurgeRecursive(lt, it);\n\n    lt.Purge(parent.Id, true);\n  }\n}",
      "language": "csharp",
      "author": "gankeyu",
      "post_number": 11,
      "is_solution": false
    },
    {
      "code": "def PurgeLayer(layer):\n    \"\"\"Removes an existing layer from the document. The layer will be removed\n    even if it contains geometry objects. The layer to be removed cannot be the\n    current layer\n    empty.\n    Parameters:\n      layer (str|guid): the name or id of an existing empty layer\n    Returns:\n      bool: True or False indicating success or failure\n    Example:\n      import rhinoscriptsyntax as rs\n      layer = rs.GetString(\"Layer to purge\")\n      if layer: rs.PurgeLayer(layer)\n    See Also:\n      AddLayer\n      CurrentLayer\n      DeleteLayer\n      RenameLayer\n    \"\"\"\n    layer = __getlayer(layer, True)\n    rc = scriptcontext.doc.Layers.Purge( layer.LayerIndex, True)\n    scriptcontext.doc.Views.Redraw()\n    return rc",
      "language": "python",
      "author": "AndersDeleuran",
      "post_number": 15,
      "is_solution": false
    },
    {
      "code": "def DeleteLayer(layer):\n    \"\"\"Removes an existing layer from the document. The layer to be removed\n    cannot be the current layer. Unlike the PurgeLayer method, the layer must\n    be empty, or contain no objects, before it can be removed. Any layers that\n    are children of the specified layer will also be removed if they are also\n    empty.\n    Parameters:\n      layer (str|guid): the name or id of an existing empty layer\n    Returns:\n      bool: True or False indicating success or failure\n    Example:\n      import rhinoscriptsyntax as rs\n      layer = rs.GetString(\"Layer to remove\")\n      if layer: rs.DeleteLayer(layer)\n    See Also:\n      AddLayer\n      CurrentLayer\n      PurgeLayer\n      RenameLayer\n    \"\"\"\n    layer = __getlayer(layer, True)\n    return scriptcontext.doc.Layers.Delete( layer.LayerIndex, True)",
      "language": "python",
      "author": "AndersDeleuran",
      "post_number": 15,
      "is_solution": false
    },
    {
      "code": "# Get all layer names sorted by depth (children first)\nlayerNames = rs.LayerNames()\nlayerNames.sort(key=lambda ln: ln.count(\"::\"), reverse=True)\n\n# Create a list to store the sub-layers under the specified parent layer\nLayers = []  # Initialize an empty list\n\n# Get the parent layer name from the input parameter\nparent_layer_name = ParentLayerName\n\n# Iterate through the layerNames to find sub-layers\nfor sln in layerNames:\n    if parent_layer_name in sln:\n        Layers.append(sln)\n\n# Purge Layers and their children\nfor sln in Layers:\n    if rs.IsLayerEmpty(sln):\n        rs.PurgeLayer(sln)\n    else:\n        print \"The layer is not empty.\"\n\n# Enable drawing and set context back to Grasshopper\nrs.EnableRedraw(True)\nsc.doc = ghdoc",
      "language": "python",
      "author": "Yo_Ro",
      "post_number": 21,
      "is_solution": false
    }
  ],
  "tags": [
    "csharp",
    "file-io",
    "grasshopper",
    "layers",
    "python",
    "rhinocommon",
    "rhinoscriptsyntax",
    "transformation",
    "ui"
  ],
  "has_accepted_answer": false,
  "category_id": 2,
  "posts_count": 21,
  "views": 3878
}