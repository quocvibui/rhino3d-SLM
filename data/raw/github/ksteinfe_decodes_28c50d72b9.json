{
  "source_url": "https://github.com/ksteinfe/decodes/blob/b876d6d01ea23ccbf4558182582a822b008cf2b8/src/decodes/io/rhinoscript/material.py",
  "repo": "ksteinfe/decodes",
  "repo_stars": 43,
  "repo_description": "a platform agnostic generative design library for 3d designers",
  "license": "GPL-3.0",
  "filepath": "src/decodes/io/rhinoscript/material.py",
  "instruction": "Material",
  "code": "import Rhino.DocObjects\nimport scriptcontext\nfrom . import utility as rhutil\nfrom .layer import __getlayer\n\n\ndef AddMaterialToLayer(layer):\n    \"\"\"Add material to a layer and returns the new material's index. If the\n    layer already has a material, then the layer's current material index is\n    returned\n    Parameters:\n      layer = name of an existing layer.\n    Returns:\n      Material index of the layer if successful\n      None if not successful or on error\n    \"\"\"\n    layer = __getlayer(layer, True)\n    if layer.RenderMaterialIndex>-1: return layer.RenderMaterialIndex\n    material_index = scriptcontext.doc.Materials.AddMaterial()\n    layer.RenderMaterialIndex = material_index\n    if scriptcontext.doc.Layers.Modify( layer, layer.LayerIndex, True):\n        scriptcontext.doc.Views.Redraw()\n        return material_index\n    return scriptcontext.errorhandler()\n\n\ndef AddMaterialToObject(object_id):\n    \"\"\"Adds material to an object and returns the new material's index. If the\n    object already has a material, the the object's current material index is\n    returned.\n    Parameters:\n      object_id = identifier of an object\n    Returns:\n      material index of the object\n    \"\"\"\n    rhino_object = rhutil.coercerhinoobject(object_id, True, True)\n    attr = rhino_object.Attributes\n    if attr.MaterialSource!=Rhino.DocObjects.ObjectMaterialSource.MaterialFromObject:\n        attr.MaterialSource = Rhino.DocObjects.ObjectMaterialSource.MaterialFromObject\n        scriptcontext.doc.Objects.ModifyAttributes(rhino_object, attr, True)\n        attr = rhino_object.Attributes\n    material_index = attr.MaterialIndex\n    if material_index>-1: return material_index\n    material_index = scriptcontext.doc.Materials.AddMaterial()\n    attr.MaterialIndex = material_index\n    scriptcontext.doc.Objects.ModifyAttributes(rhino_object, attr, True)\n    return material_index\n\n    \ndef CopyMaterial(source_index, destination_index):\n    \"\"\"Copies definition of a source material to a destination material\n    Parameters:\n      source_index, destination_index = indices of materials to copy\n    Returns:\n      True or False indicating success or failure\n    \"\"\"\n    if source_index==destination_index: return False\n    source = scriptcontext.doc.Materials[source_index]\n    if source is None: return False\n    rc = scriptcontext.doc.Materials.Modify(source, destination_index, True)\n    if rc: scriptcontext.doc.Views.Redraw()\n    return rc\n\n\ndef IsMaterialDefault(material_index):\n    \"\"\"Verifies a material is a copy of Rhino's built-in \"default\" material.\n    The default material is used by objects and layers that have not been\n    assigned a material.\n    Parameters:\n      material_index = the zero-based material index\n    Returns:\n      True or False indicating success or failure\n    \"\"\"\n    mat = scriptcontext.doc.Materials[material_index]\n    return mat and mat.IsDefaultMaterial\n\n\ndef IsMaterialReference(material_index):\n    \"\"\"Verifies a material is referenced from another file\n    Parameters:\n      material_index = the zero-based material index\n    Returns:\n      True or False indicating success or failure\n    \"\"\"\n    mat = scriptcontext.doc.Materials[material_index]\n    return mat and mat.IsReference\n\n\ndef MatchMaterial(source, destination):\n    \"\"\"Copies the material definition from one material to one or more objects\n    Parameters:\n      source = source material index -or- identifier of the source object.\n        The object must have a material assigned\n      destination = indentifier(s) of the destination object(s)\n    Returns:\n      number of objects that were modified if successful\n      None if not successful or on error\n    \"\"\"\n    source_id = rhutil.coerceguid(source)\n    source_mat = None\n    if source_id:\n        rhobj = rhutil.coercerhinoobject(source_id, True, True)\n        source = rhobj.Attributes.MaterialIndex\n    mat = scriptcontext.doc.Materials[source]\n    if not mat: return scriptcontext.errorhandler()\n    destination_id = rhutil.coerceguid(destination)\n    if destination_id: destination = [destination]\n    ids = [rhutil.coerceguid(d) for d in destination]\n    rc = 0\n    for id in ids:\n        rhobj = scriptcontext.doc.Objects.Find(id)\n        if rhobj:\n            rhobj.Attributes.MaterialIndex = source\n            rhobj.Attributes.MaterialSource = Rhino.DocObjects.ObjectMaterialSource.MaterialFromObject\n            rhobj.CommitChanges()\n            rc += 1\n    if rc>0: scriptcontext.doc.Views.Redraw()\n    return rc\n\n\ndef MaterialBump(material_index, filename=None):\n    \"\"\"Returns or modifies a material's bump bitmap filename\n    Parameters:\n      material_index = zero based material index\n      filename[opt] = the bump bitmap filename\n    Returns:\n      if filename is not specified, the current bump bitmap filename\n      if filename is specified, the previous bump bitmap filename\n      None if not successful or on error\n    \"\"\"\n    mat = scriptcontext.doc.Materials[material_index]\n    if mat is None: return scriptcontext.errorhandler()\n    texture = mat.GetBumpTexture()\n    rc = texture.FileName if texture else \"\"\n    if filename:\n        mat.SetBumpTexture(filename)\n        mat.CommitChanges()\n        scriptcontext.doc.Views.Redraw()\n    return rc\n\n\ndef MaterialColor(material_index, color=None):\n    \"\"\"Returns or modifies a material's diffuse color.\n    Parameters:\n      material_index = zero based material index\n      color[opt] = the new color value\n    Returns:\n      if color is not specified, the current material color\n      if color is specified, the previous material color\n      None on error\n    \"\"\"\n    mat = scriptcontext.doc.Materials[material_index]\n    if mat is None: return scriptcontext.errorhandler()\n    rc = mat.DiffuseColor\n    color = rhutil.coercecolor(color)\n    if color:\n        mat.DiffuseColor = color\n        mat.CommitChanges()\n        scriptcontext.doc.Views.Redraw()\n    return rc\n\n\ndef MaterialEnvironmentMap(material_index, filename=None):\n    \"\"\"Returns or modifies a material's environment bitmap filename.\n    Parameters:\n      material_index = zero based material index\n      filename[opt] = the environment bitmap filename\n    Returns:\n      if filename is not specified, the current environment bitmap filename\n      if filename is specified, the previous environment bitmap filename\n      None if not successful or on error\n    \"\"\"\n    mat = scriptcontext.doc.Materials[material_index]\n    if mat is None: return scriptcontext.errorhandler()\n    texture = mat.GetEnvironmentTexture()\n    rc = texture.FileName if texture else \"\"\n    if filename:\n        mat.SetEnvironmentTexture(filename)\n        mat.CommitChanges()\n        scriptcontext.doc.Views.Redraw()\n    return rc\n\n\ndef MaterialName(material_index, name=None):\n    \"\"\"Returns or modifies a material's user defined name\n    Parameters:\n      material_index = zero based material index\n      name[opt] = the new name\n    Returns:\n      if name is not specified, the current material name\n      if name is specified, the previous material name\n      None on error\n    \"\"\"\n    mat = scriptcontext.doc.Materials[material_index]\n    if mat is None: return scriptcontext.errorhandler()\n    rc = mat.Name\n    if name:\n        mat.Name = name\n        mat.CommitChanges()\n    return rc\n\n\ndef MaterialReflectiveColor(material_index, color=None):\n    \"\"\"Returns or modifies a material's reflective color.\n    Parameters:\n      material_index = zero based material index\n      color[opt] = the new color value\n    Returns:\n      if color is not specified, the current material reflective color\n      if color is specified, the previous material reflective color\n      None on error\n    \"\"\"\n    mat = scriptcontext.doc.Materials[material_index]\n    if mat is None: return scriptcontext.errorhandler()\n    rc = mat.ReflectionColor\n    color = rhutil.coercecolor(color)\n    if color:\n        mat.ReflectionColor = color\n        mat.CommitChanges()\n        scriptcontext.doc.Views.Redraw()\n    return rc\n\n\ndef MaterialShine(material_index, shine=None):\n    \"\"\"Returns or modifies a material's shine value\n    Parameters:\n      material_index = zero based material index\n      shine[opt] = the new shine value. A material's shine value ranges from 0.0 to 255.0, with\n        0.0 being matte and 255.0 being glossy\n    Returns:\n      if shine is not specified, the current material shine value\n      if shine is specified, the previous material shine value\n      None on error\n    \"\"\"\n    mat = scriptcontext.doc.Materials[material_index]\n    if mat is None: return scriptcontext.errorhandler()\n    rc = mat.Shine\n    if shine:\n        mat.Shine = shine\n        mat.CommitChanges()\n        scriptcontext.doc.Views.Redraw()\n    return rc\n\n\ndef MaterialTexture(material_index, filename=None):\n    \"\"\"Returns or modifies a material's texture bitmap filename\n    Parameters:\n      material_index = zero based material index\n      filename[opt] = the texture bitmap filename\n    Returns:\n      if filename is not specified, the current texture bitmap filename\n      if filename is specified, the previous texture bitmap filename\n      None if not successful or on error\n    \"\"\"\n    mat = scriptcontext.doc.Materials[material_index]\n    if mat is None: return scriptcontext.errorhandler()\n    texture = mat.GetBitmapTexture()\n    rc = texture.FileName if texture else \"\"\n    if filename:\n        mat.SetBitmapTexture(filename)\n        mat.CommitChanges()\n        scriptcontext.doc.Views.Redraw()\n    return rc\n\n\ndef MaterialTransparency(material_index, transparency=None):\n    \"\"\"Returns or modifies a material's transparency value\n    Parameters:\n      material_index = zero based material index\n      transparency[opt] = the new transparency value. A material's transparency value ranges from 0.0 to 1.0, with\n        0.0 being opaque and 1.0 being transparent\n    Returns:\n      if transparency is not specified, the current material transparency value\n      if transparency is specified, the previous material transparency value\n      None on error\n    \"\"\"\n    mat = scriptcontext.doc.Materials[material_index]\n    if mat is None: return scriptcontext.errorhandler()\n    rc = mat.Transparency\n    if transparency:\n        mat.Transparency = transparency\n        mat.CommitChanges()\n        scriptcontext.doc.Views.Redraw()\n    return rc\n\n\ndef MaterialTransparencyMap(material_index, filename=None):\n    \"\"\"Returns or modifies a material's transparency bitmap filename\n    Parameters:\n      material_index = zero based material index\n      filename[opt] = the transparency bitmap filename\n    Returns:\n      if filename is not specified, the current transparency bitmap filename\n      if filename is specified, the previous transparency bitmap filename\n      None if not successful or on error\n    \"\"\"\n    mat = scriptcontext.doc.Materials[material_index]\n    if mat is None: return scriptcontext.errorhandler()\n    texture = mat.GetTransparencyTexture()\n    rc = texture.FileName if texture else \"\"\n    if filename:\n        mat.SetTransparencyTexture(filename)\n        mat.CommitChanges()\n        scriptcontext.doc.Views.Redraw()\n    return rc\n\n\ndef ResetMaterial(material_index):\n    \"\"\"Resets a material to Rhino's default material\n    Parameters:\n      material_index = zero based material index\n    Returns:\n      True or False indicating success or failure\n    \"\"\"\n    mat = scriptcontext.doc.Materials[material_index]\n    if mat is None: return False\n    rc = scriptcontext.doc.Materials.ResetMaterial(material_index)\n    scriptcontext.doc.Views.Redraw()\n    return rc\n",
  "language": "python",
  "imports": [
    "Rhino",
    "scriptcontext"
  ],
  "has_docstring": false
}