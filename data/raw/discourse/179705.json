{
  "source_url": "https://discourse.mcneel.com/t/change-layer-of-object/179705",
  "topic_id": 179705,
  "title": "Change layer of object?",
  "question": "Hi All,\n\n\nI’ve hit a wall on what should be a simple problem. I’m creating a polyline from a list of points, and I want to assign it to a layer (specified by a string). the function executes without error, but it doesn’t make the change in the document (by inspection).\n\n\nWhat am I doing wrong?\n\n\ndef InsertPolyLine(doc, Points: list, Layer: str):\n\n    ob = doc.Objects\n    rg = Rhino.Geometry\n\n    for i in range(len(Points)):\n        Points[i] = rg.Point3d(Points[i][0], Points[i][1], 0.0)\n\n    poly = rg.Polyline()\n    for p in Points:\n        poly.Add(p)\n\n    if poly.IsValid:\n        poly = doc.Objects.Find(ob.AddPolyline(poly))\n        poly.Attributes.LayerIndex = doc.Layers.FindName(Layer).Index\n    \n    doc.Views.Redraw()\n    return poly\n\n\n\nThanks in Advance.",
  "code_blocks": [
    {
      "code": "import Rhino\nfrom Rhino import Geometry as rg\nimport scriptcontext as sc\nimport rhinoscriptsyntax as rs\n\ndef TestInsertPL(pts,layer_name):\n    poly=rg.Polyline(pts)\n    if poly.IsValid:\n        layer_index=sc.doc.Layers.FindByFullPath(layer_name,False)\n        if layer_index and layer_index != -1:\n            attrs=Rhino.DocObjects.ObjectAttributes()\n            attrs.LayerIndex=layer_index\n            obj_id=sc.doc.Objects.AddPolyline(poly,attrs)\n            sc.doc.Views.Redraw()\n            return obj_id\n        else:\n            print(\"Layer does not exist\")\n    \npts=rs.GetPoints(\"Pick points\")\nif pts: \n    result=TestInsertPL(pts,\"PointsLayer\")\n    if not result: print(\"Unable to comply\")",
      "language": "python",
      "author": "Helvetosaur",
      "post_number": 5,
      "is_solution": true
    },
    {
      "code": "#add the layer if it doesn't already exist\nif not rs.IsLayer(new_layer): rs.AddLayer(new_layer)\n#change the object layer\nrs.ObjectLayer(obj,new_layer)",
      "language": "python",
      "author": "Helvetosaur",
      "post_number": 7,
      "is_solution": false
    },
    {
      "code": "import Rhino\nfrom Rhino import Geometry as rg\nimport scriptcontext as sc\nimport rhinoscriptsyntax as rs\n\ndef TestInsertPL(pts,layer_name):\n    poly=rg.Polyline(pts)\n    if poly.IsValid:\n        layer_index=sc.doc.Layers.FindByFullPath(layer_name,False)\n        if layer_index and layer_index != -1:\n            #add the polyline to the document and return the ID\n            obj_id=sc.doc.Objects.AddPolyline(poly)\n            #get the object reference from the ID\n            rhobj=sc.doc.Objects.Find(obj_id)\n            #change the layer index\n            rhobj.Attributes.LayerIndex=layer_index\n            rhobj.CommitChanges()\n            sc.doc.Views.Redraw()\n            return obj_id\n        else:\n            print(\"Layer does not exist\")\n    \npts=rs.GetPoints(\"Pick points\")\nif pts: \n    result=TestInsertPL(pts,\"PointsLayer\")\n    if not result: print(\"Unable to comply\")",
      "language": "python",
      "author": "Helvetosaur",
      "post_number": 7,
      "is_solution": false
    },
    {
      "code": "def InsertPolyLine(doc, Points: list, Layer: str):\n\n    ob = doc.Objects\n    rg = Rhino.Geometry\n\n    for i in range(len(Points)):\n        Points[i] = rg.Point3d(Points[i][0], Points[i][1], 0.0)\n\n    poly = rg.Polyline()\n    for p in Points:\n        poly.Add(p)\n\n    if poly.IsValid:\n        poly = doc.Objects.Find(ob.AddPolyline(poly))\n        poly.Attributes.LayerIndex = doc.Layers.FindName(Layer).Index\n    \n    doc.Views.Redraw()\n    return poly",
      "language": "python",
      "author": "Gerrard_Hickson",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "file-io",
    "geometry",
    "layers",
    "python",
    "rhinocommon",
    "rhinoscriptsyntax"
  ],
  "has_accepted_answer": true,
  "category_id": 11,
  "posts_count": 8,
  "views": 295
}