{
  "source_url": "https://github.com/jingcheng-chen/rhinomcp/blob/615f0eae092d3d129f07fde519b28ca10d31dd6e/rhino_mcp_server/static/line.py",
  "repo": "jingcheng-chen/rhinomcp",
  "repo_stars": 299,
  "repo_description": "RhinoMCP connects Rhino 3D to AI Agent through the Model Context Protocol (MCP)",
  "license": "Apache-2.0",
  "filepath": "rhino_mcp_server/static/line.py",
  "instruction": null,
  "code": "import Rhino\n\nimport scriptcontext\n\nimport rhinocompat as compat\nfrom rhinoscript import utility as rhutil\n\n\ndef LineClosestPoint(line, testpoint):\n    \"\"\"Finds the point on an infinite line that is closest to a test point\n    Parameters:\n      line ([point, point]): List of 6 numbers or 2 Point3d.  Two 3-D points identifying the starting and ending points of the line.\n      testpoint (point): List of 3 numbers or Point3d.  The test point.\n    Returns:\n      point: the point on the line that is closest to the test point if successful, otherwise None\n    Example:\n      import rhinoscriptsyntax as rs\n      line = (0,0,0), (5,5,0)\n      point = (15, 10, 0)\n      result = rs.LineClosestPoint( line, point)\n      if result: rs.AddPoint(result)\n    See Also:\n      LineIsFartherThan\n      LineMaxDistanceTo\n      LineMinDistanceTo\n      LinePlane\n      LineTransform\n    \"\"\"\n    line = rhutil.coerceline(line, True)\n    testpoint = rhutil.coerce3dpoint(testpoint, True)\n    return line.ClosestPoint(testpoint, False)\n\n\ndef LineCylinderIntersection(line, cylinder_plane, cylinder_height, cylinder_radius):\n    \"\"\"Calculates the intersection of a line and a cylinder\n    Parameters:\n      line (guid|line): the line to intersect\n      cylinder_plane (plane): base plane of the cylinder\n      cylinder_height (number): height of the cylinder\n      cylinder_radius (number): radius of the cylinder\n    Returns:\n      list(point, ...): list of intersection points (0, 1, or 2 points)\n    Example:\n      import rhinoscriptsyntax as rs\n      plane = rs.WorldXYPlane()\n      line = (-10,0,0), (10,0,10)\n      points = rs.LineCylinderIntersection(line, plane, cylinder_height=10, cylinder_radius=5)\n      if points:\n          for point in points: rs.AddPoint(point)\n    See Also:\n      LineLineIntersection\n      LinePlaneIntersection\n      LineSphereIntersection\n    \"\"\"\n    line = rhutil.coerceline(line, True)\n    cylinder_plane = rhutil.coerceplane(cylinder_plane, True)\n    circle = Rhino.Geometry.Circle( cylinder_plane, cylinder_radius )\n    if not circle.IsValid: raise ValueError(\"unable to create valid circle with given plane and radius\")\n    cyl = Rhino.Geometry.Cylinder( circle, cylinder_height )\n    if not cyl.IsValid: raise ValueError(\"unable to create valid cylinder with given circle and height\")\n    rc, pt1, pt2 = Rhino.Geometry.Intersect.Intersection.LineCylinder(line, cyl)\n    if rc==compat.ENUM_NONE(Rhino.Geometry.Intersect.LineCylinderIntersection):\n        return []\n    if rc==Rhino.Geometry.Intersect.LineCylinderIntersection.Single:\n        return [pt1]\n    return [pt1, pt2]\n\n\ndef LineIsFartherThan(line, distance, point_or_line):\n    \"\"\"Determines if the shortest distance from a line to a point or another\n    line is greater than a specified distance\n    Parameters:\n      line (line | [point, point]): List of 6 numbers, 2 Point3d, or Line.\n      distance (number): the distance\n      point_or_line (point|line) the test point or the test line\n    Returns:\n      bool: True if the shortest distance from the line to the other project is\n            greater than distance, False otherwise\n      None: on error\n    Example:\n      import rhinoscriptsyntax as rs\n      line = (0,0,0), (10,10,0)\n      testPoint = (10,5,0)\n      print(rs.LineIsFartherThan(line, 3, testPoint))\n    See Also:\n      LineClosestPoint\n      LineMaxDistanceTo\n      LineMinDistanceTo\n      LinePlane\n      LineTransform\n    \"\"\"\n    line = rhutil.coerceline(line, True)\n    test = rhutil.coerceline(point_or_line)\n    if not test: test = rhutil.coerce3dpoint(point_or_line, True)\n    minDist = line.MinimumDistanceTo(test)\n    return minDist>distance\n\n\ndef LineLineIntersection(lineA, lineB):\n    \"\"\"Calculates the intersection of two non-parallel lines. Note, the two\n    lines do not have to intersect for an intersection to be found. (see help)\n    Parameters:\n      lineA, lineB (line): lines to intersect\n    Returns:\n      tuple(point, point): containing a point on the first line and a point on the second line if successful\n      None: on error\n    Example:\n      import rhinoscriptsyntax as rs\n      lineA = (1,1,0), (5,0,0)\n      lineB = (1,3,0), (5,5,0)\n      point = rs.LineLineIntersection(lineA, lineB)\n      if point:\n          rs.AddPoint(point[0])\n          rs.AddPoint(point[1])\n    See Also:\n      IntersectPlanes\n      LinePlaneIntersection\n      PlanePlaneIntersection\n    \"\"\"\n    lineA = rhutil.coerceline(lineA, True)\n    lineB = rhutil.coerceline(lineB, True)\n    rc, a, b = Rhino.Geometry.Intersect.Intersection.LineLine(lineA, lineB)\n    if not rc: return None\n    return lineA.PointAt(a), lineB.PointAt(b)\n\n\ndef LineMaxDistanceTo(line, point_or_line):\n    \"\"\"Finds the longest distance between a line as a finite chord, and a point\n    or another line\n    Parameters:\n      line (line | [point, point]): List of 6 numbers, two Point3d, or Line.\n      point_or_line (point|line): the test point or test line.\n    Returns:\n      number: A distance (D) such that if Q is any point on the line and P is any point on the other object, then D >= Rhino.Distance(Q, P).\n      None: on error\n    Example:\n      import rhinoscriptsyntax as rs\n      line = (0,0,0), (10,10,0)\n      print(rs.LineMaxDistanceTo( line, (10,5,0) ))\n    See Also:\n      LineClosestPoint\n      LineIsFartherThan\n      LineMinDistanceTo\n      LinePlane\n      LineTransform\n    \"\"\"\n    line = rhutil.coerceline(line, True)\n    test = rhutil.coerceline(point_or_line)\n    if test is None: test = rhutil.coerce3dpoint(point_or_line, True)\n    return line.MaximumDistanceTo(test)\n\n\ndef LineMinDistanceTo(line, point_or_line):\n    \"\"\"Finds the shortest distance between a line as a finite chord, and a point\n    or another line\n    Parameters:\n      line (line | [point, point]): List of 6 numbers, two Point3d, or Line.\n      point_or_line (point|line): the test point or test line.\n    Returns:\n      number: A distance (D) such that if Q is any point on the line and P is any point on the other object, then D <= Rhino.Distance(Q, P).\n      None: on error\n    Example:\n      import rhinoscriptsyntax as rs\n      line = (0,0,0), (10,10,0)\n      print(rs.LineMinDistanceTo(line, (10,5,0)))\n    See Also:\n      LineClosestPoint\n      LineIsFartherThan\n      LineMaxDistanceTo\n      LinePlane\n      LineTransform\n    \"\"\"\n    line = rhutil.coerceline(line, True)\n    test = rhutil.coerceline(point_or_line)\n    if test is None: test = rhutil.coerce3dpoint(point_or_line, True)\n    return line.MinimumDistanceTo(test)\n\n\ndef LinePlane(line):\n    \"\"\"Returns a plane that contains the line. The origin of the plane is at the start of\n    the line. If possible, a plane parallel to the world XY, YZ, or ZX plane is returned\n    Parameters:\n      line (line | [point, point]):  List of 6 numbers, two Point3d, or Line.\n    Returns:\n      plane: the plane if successful\n      None: if not successful\n    Example:\n      import rhinoscriptsyntax as rs\n      lineFrom = (0,0,0)\n      lineTo = (10,10,0)\n      distance = rs.Distance(lineFrom, lineTo)\n      plane = rs.LinePlane([lineFrom, lineTo])\n      rs.AddPlaneSurface( plane, distance, distance )\n    See Also:\n      LineClosestPoint\n      LineIsFartherThan\n      LineMaxDistanceTo\n      LineMinDistanceTo\n      LineTransform\n    \"\"\"\n    line = rhutil.coerceline(line, True)\n    rc, plane = line.TryGetPlane()\n    if not rc: return scriptcontext.errorhandler()\n    return plane\n\n\ndef LinePlaneIntersection(line, plane):\n    \"\"\"Calculates the intersection of a line and a plane.\n    Parameters:\n      line ([point, point]): Two 3D points identifying the starting and ending points of the line to intersect.\n      plane (plane): The plane to intersect.\n    Returns:\n      point: The 3D point of intersection is successful.\n      None: if not successful, or on error.\n    Example:\n      import rhinoscriptsyntax as rs\n      plane = rs.WorldXYPlane()\n      line = (2, 11, 13), (20, 4, -10)\n      point = rs.LinePlaneIntersection(line, plane)\n      if( point!=None ): rs.AddPoint(point)\n    See Also:\n      LineLineIntersection\n      PlanePlaneIntersection\n    \"\"\"\n    plane = rhutil.coerceplane(plane, True)\n    line_points = rhutil.coerce3dpointlist(line, True)\n    line = Rhino.Geometry.Line(line_points[0], line_points[1])\n    rc, t = Rhino.Geometry.Intersect.Intersection.LinePlane(line, plane) \n    if  not rc: return scriptcontext.errorhandler()\n    return line.PointAt(t)\n\n\ndef LineSphereIntersection(line, sphere_center, sphere_radius):\n    \"\"\"Calculates the intersection of a line and a sphere\n    Parameters:\n      line (line | [point, point]): the line\n      sphere_center (point): the center point of the sphere\n      sphere_radius (number): the radius of the sphere\n    Returns:\n      list(point, ...): list of intersection points if successful, otherwise None\n    Example:\n      import rhinoscriptsyntax as rs\n      radius = 10\n      line = (-10,0,0), (10,0,10)\n      points = rs.LineSphereIntersection(line, (0,0,0), radius)\n      if points:\n          for point in points: rs.AddPoint(point)\n    See Also:\n      LineCylinderIntersection\n      LineLineIntersection\n      LinePlaneIntersection\n    \"\"\"\n    line = rhutil.coerceline(line, True)\n    sphere_center = rhutil.coerce3dpoint(sphere_center, True)\n    sphere = Rhino.Geometry.Sphere(sphere_center, sphere_radius)\n    rc, pt1, pt2 = Rhino.Geometry.Intersect.Intersection.LineSphere(line, sphere)\n    if rc==compat.ENUM_NONE(Rhino.Geometry.Intersect.LineSphereIntersection): return []\n    if rc==Rhino.Geometry.Intersect.LineSphereIntersection.Single: return [pt1]\n    return [pt1, pt2]\n\n\ndef LineTransform(line, xform):\n    \"\"\"Transforms a line\n    Parameters:\n      line (guid): the line to transform\n      xform (transform): the transformation to apply\n    Returns:\n      guid: transformed line\n    Example:\n      import rhinoscriptsyntax as rs\n      line = (0,0,0), (10,10,0)\n      rs.AddLine( line[0], line[1] )\n      plane = rs.WorldXYPlane()\n      xform = rs.XformRotation(30, plane.Zaxis, plane.Origin)\n      line = rs.LineTransform(line, xform)\n      rs.AddLine( line.From, line.To )\n    See Also:\n      LineClosestPoint\n      LineIsFartherThan\n      LineMaxDistanceTo\n      LineMinDistanceTo\n      LinePlane\n    \"\"\"\n    line = rhutil.coerceline(line, True)\n    xform = rhutil.coercexform(xform, True)\n    success = line.Transform(xform)\n    if not success: raise Exception(\"unable to transform line\")\n    return line\n",
  "language": "python",
  "imports": [
    "Rhino",
    "Rhino.Geometry",
    "rhinoscriptsyntax",
    "scriptcontext"
  ],
  "has_docstring": false
}