{
  "source_url": "https://github.com/fstwn/cockatoo/blob/d952ac5d2148ec29fba52e8eb75f0f43770c74ca/usrobj_src/Cockatoo_BuildMappingNetwork.py",
  "repo": "fstwn/cockatoo",
  "repo_stars": 38,
  "repo_description": "Cockatoo is a prototypical open-source software toolkit for generating (3d-)knitting patterns from NURBS surface and mesh geometry directly inside Grasshopper.",
  "license": "MIT",
  "filepath": "usrobj_src/Cockatoo_BuildMappingNetwork.py",
  "instruction": "Assign 'segment' attributes to nodes and 'weft' edges based on their position\nbetween two 'end' nodes and build a mapping network used for final loop\ngeneration.\n    Inputs:\n        Toggle: Set to...",
  "code": "\"\"\"\nAssign 'segment' attributes to nodes and 'weft' edges based on their position\nbetween two 'end' nodes and build a mapping network used for final loop\ngeneration.\n    Inputs:\n        Toggle: Set to true to activate\n                {item, bool}\n        KnitNetwork: An initialized KnitNetwork with preliminary 'weft' and\n                     first 'warp' connections (edges).\n                     {item, KnitNetwork}\n    Output:\n        KnitNetwork: The KnitNetwork, consisting only of 'warp' edges and their\n                     'end' nodes but with an embedded MappingNetwork for final\n                     loop generation.\n                     {item, KnitNetwork}\n        KnitMappingNetwork: Only the mapping network of the KnitNetwork.\n                            NOTE The mapping network is also embedded in the\n                            KnitNetwork during this step and can be accessed by\n                            the KnitNetwork.MappingNetwork property. It is\n                            returned here as a seperate output for reasons of\n                            visualisation, analysis and troubleshooting.\n                            {item, KnitMappingNetwork}\n    Remarks:\n        Author: Max Eschenbach\n        License: MIT License\n        Version: 200717\n\"\"\"\n\n# GPYTHON SDK IMPORTS\nfrom ghpythonlib.componentbase import executingcomponent as component\nimport Grasshopper, GhPython\nimport System\nimport Rhino\nimport rhinoscriptsyntax as rs\n\n# GHENV COMPONENT SETTINGS\nghenv.Component.Name = \"BuildMappingNetwork\"\nghenv.Component.NickName =\"BMN\"\nghenv.Component.Category = \"Cockatoo\"\nghenv.Component.SubCategory = \"06 KnitNetwork\"\n\n# LOCAL MODULE IMPORTS\ntry:\n    import cockatoo\nexcept ImportError:\n    errMsg = \"The Cockatoo python module seems to be not correctly \" + \\\n             \"installed! Please make sure the module is in you search \" + \\\n             \"path, see README for instructions!.\"\n    raise ImportError(errMsg)\n\nclass BuildMappingNetwork(component):\n    \n    def RunScript(self, Toggle, KN):\n        \n        if Toggle and KN:\n            # copy the input network to not mess with previous components\n            KN = cockatoo.KnitNetwork(KN)\n            \n            # CREATE SEGMENTATION AND ASSIGN ATTRIBUTES ------------------------\n            \n            KN.assign_segment_attributes()\n            \n            # CHECK THE RESULTS ------------------------------------------------\n            \n            for edge in KN.edges(data=True):\n                s = edge[2][\"segment\"]\n                w = edge[2][\"weft\"]\n                if w and not s:\n                    vStr = \"'weft' edge {} has no segment value!\"\n                    vStr = vStr.format((edge[0], edge[1]))\n                    rml = self.RuntimeMessageLevel.Warning\n                    self.AddRuntimeMessage(rml, vStr)\n            \n            for node in KN.nodes(data=True):\n                e = node[1][\"end\"]\n                s = node[1][\"segment\"]\n                if not s:\n                    if not e:\n                        vStr = \"node {} has no segment value!\"\n                        vStr = vStr.format(node[0])\n                        rml = self.RuntimeMessageLevel.Warning\n                        self.AddRuntimeMessage(rml, vStr)\n            # CREATE MAPPING NETWORK -------------------------------------------\n            \n            KN.create_mapping_network()\n            MappingNetwork = KN.mapping_network\n            \n        elif not Toggle and KN:\n            return KN, Grasshopper.DataTree[object]()\n        elif Toggle and not KN:\n            rml = self.RuntimeMessageLevel.Warning\n            self.AddRuntimeMessage(rml, \"No KnitNetwork input!\")\n            return Grasshopper.DataTree[object](), Grasshopper.DataTree[object]()\n        elif not Toggle and not KN:\n            return Grasshopper.DataTree[object](), Grasshopper.DataTree[object]()\n        \n        # return outputs if you have them; here I try it for you:\n        return KN, MappingNetwork",
  "language": "python",
  "imports": [
    "Rhino",
    "ghpythonlib",
    "rhinoscriptsyntax"
  ],
  "has_docstring": true
}