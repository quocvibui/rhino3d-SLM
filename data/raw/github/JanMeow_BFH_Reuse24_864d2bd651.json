{
  "source_url": "https://github.com/JanMeow/BFH_Reuse24/blob/8ee5b5647d3500e8ac32686766bd46658e59ac11/Kevin/otherThing/wallDefinition.py",
  "repo": "JanMeow/BFH_Reuse24",
  "repo_stars": 0,
  "repo_description": "BFH 24 Spring Studio Scripts Development",
  "license": "MIT",
  "filepath": "Kevin/otherThing/wallDefinition.py",
  "instruction": "Wall definition",
  "code": "import Rhino.Geometry as rg\nfrom Grasshopper.Kernel.Data import GH_Path\nfrom Grasshopper import DataTree\nimport System.Array as array\nimport Rhino\nimport ghpythonlib.treehelpers as th\nimport inspect\nimport scriptcontext as sc\n\n# Ensure we're using the Rhino document, not Grasshopper's\nsc.doc = Rhino.RhinoDoc.ActiveDoc\n\nclass DetectObjectIsMoved:\n    def __init__(self, geometryInput, nickname):\n\n        self.geometryInput = geometryInput\n        self.nickname = nickname\n        self.detectObjType(self.geometryInput)\n        self.isMoved = False\n    \n    def initializeMovement(self, storeDict):\n        # self.store_initial_point_data(self.points, storeDict)\n        self.store_initial_curve_data(self.curves, storeDict)\n    \n    def detectObjType(self, objInput):\n        self.points = []\n        self.curves = []\n        self.surfaces = []\n\n        # Check if the object is a point\n        #print(obj)\n        if isinstance(objInput, rg.Point3d):\n            self.points.append(objInput)\n            self.geometryType = \"point\"\n        # Check if the object is a curve\n        elif isinstance(objInput, rg.Curve):\n            self.curves.append(objInput)\n            self.geometryType = \"curve\"\n        # Check if the object is a surface\n        elif isinstance(objInput, rg.Surface):\n            self.surfaces.append(objInput)\n            self.geometryType = \"surface\"\n                \n    # Function to store initial curve data\n    def store_initial_curve_data(self, curves, storeDict):\n        for curve in curves:\n            if curve:\n                # Extract and store the curve's control points or vertices\n                control_points = [pt.Location for pt in curve.ToNurbsCurve().Points]\n                storeDict[self.nickname] = (control_points, False, curve)\n\n    # Function to determine if curves have moved\n    def have_curves_moved(self, detectCurves, storeDict):\n        if detectCurves and isinstance(detectCurves, rg.Curve):\n            current_curve = detectCurves\n            current_control_points = [pt.Location for pt in current_curve.ToNurbsCurve().Points]\n            initial_control_points = storeDict.get(self.nickname)[0]\n\n            # Check if the set of control points has changed\n            if any(pt1 != pt2 for pt1, pt2 in zip(current_control_points, initial_control_points)):\n                storeDict[self.nickname] = (current_control_points, True, current_curve)\n            else:\n                storeDict[self.nickname] = (initial_control_points, False, current_curve)\n\n\n\nclass DetectObjectValue:\n    \"\"\"\n    Now this DetectObjectValue only execute for list. However, I need to detect if the number, such as height, material and also the parameters of window, are changed, so I need to modify here.\n    \"\"\"\n    def __init__(self, nickname):\n        self.nickname = nickname\n    \n    def initializeValue(self, attrName, attrData, storeDict):\n        self.store_initial_Value(attrName, attrData, storeDict)\n    \n    def store_initial_Value(self, attrName, attrData, storeDict):\n        storeDict[self.nickname][attrName] = (len(attrData), False)\n\n    def have_Value_changed(self, attrName, attrData, storeDict):\n        if storeDict[self.nickname][attrName][0] != len(attrData):\n            storeDict[self.nickname][attrName] = (len(attrData), True)\n        else:\n            storeDict[self.nickname][attrName] = (len(attrData), False)\n    \n\n\nclass Wall:\n    def __init__(self, guid, id, geometryInput, checkValueList):\n        \"\"\"\n        Can input guid of \"Curve\"\n        It should add guid allowed for inputing \"surface\"\n        Consider when I should add geometryInput. Since init? Because in wall, I cannot find curve by using guid to find the geometry like the way I use in window's point.\n        \"\"\"\n        self.guid = guid\n        self.guidStr = str(guid)\n        self.nickname = \"wall_\" + str(id)\n        self.geometryInput = geometryInput\n        self.checkValueList = checkValueList\n        self.windowList = []\n        self.doorList = []\n        self.isMoved = False\n        self.rebuild = False\n        self.isValueChanged = False\n\n        self.checkMoveObj = DetectObjectIsMoved(self.geometryInput, self.nickname) \n        self.checkValueObj = DetectObjectValue(self.nickname)\n        \n    def addElement(self, element):\n        self.element = element\n        \n    def addWallType(self, type):\n        self.type = type\n        \n    def addGeometry(self, curve, height):\n        self.curve = curve\n        self.height = height\n        self.surface = rg.Extrusion.Create(curve,height,False)\n        \n    def addWindow(self, window):\n        self.windowList.append(window)\n        \n    def addDoor(self, door):\n        self.doorList.append(door)\n\n\n    # Method to check if the wall has moved\n    def update_movement(self, inputDict):\n        try:\n            self.checkMoveObj.have_curves_moved(self.curve, inputDict)\n\n        except:\n            self.checkMoveObj.initializeMovement(inputDict)\n            self.checkMoveObj.have_curves_moved(self.curve, inputDict)\n\n    def check_isMoved(self, searchDict):\n        self.isMoved = searchDict[self.nickname][1]\n        return self.isMoved\n    \n\n    def update_value(self, inputDict):\n        for attrName in self.checkValueList:\n            attrData = getattr(self, attrName, None)\n            if inputDict.get(self.nickname) == None:\n                inputDict[self.nickname]={}\n\n            try:\n                self.checkValueObj.have_Value_changed(attrName, attrData, inputDict)\n\n            except:\n                self.checkValueObj.initializeValue(attrName, attrData, inputDict)\n                self.checkValueObj.have_Value_changed(attrName, attrData, inputDict)\n\n    \n    def check_value(self, inputDict):\n        boolList = [inputDict[self.nickname][attrName][1] for attrName in self.checkValueList]\n        \n        self.isValueChanged = any(boolList)\n        return any(boolList)\n\n\n    def showAttribute(self):\n        self.attributes = []\n        for item in dir(self):\n            if item.startswith('__') and item.endswith('__'):\n                continue\n            attr = getattr(self, item)\n            if inspect.ismethod(attr):\n                continue\n            else:\n                if item not in ['attributes', 'methods']:  # Avoid including the lists themselves\n                    self.attributes.append(item)  # Append the attribute name\n        \n        print(\"attr: \"+ str(self.attributes))    \n    \n    def showMethod(self):\n        self.methods = []\n        for item in dir(self):\n            if item.startswith('__') and item.endswith('__'):\n                continue\n            attr = getattr(self, item)\n            if inspect.ismethod(attr):\n                self.methods.append(item)  # Append the method name\n        \n        print(\"method: \"+ str(self.methods))\n\n\nshow = \"\"\nwall_dict = {}\ncheckValueList = [\"windowList\", \"doorList\"]\nid = 0\nfor wallSeries in iWalls:\n    obj = sc.doc.Objects.Find(wallSeries).Geometry\n    wallSeg = obj.DuplicateSegments()\n    for wall in wallSeg:\n        wallObj = Wall(wallSeries, id, wall, checkValueList)\n        wallObj.addElement(\"wall\")\n        wallObj.addWallType(iType)\n        wallObj.addGeometry(wall, iHeight)\n        #wallObj.check_isMoved(initial_curve_data)\n        \n        wall_dict[wallObj.nickname] = wallObj\n        id += 1\n        \n        if id == 1:\n            show = wallObj.nickname\n        \n\n\n\n\nclass classForOutput:\n    def __init__(self):\n        pass\n\nwallData = classForOutput()\nwallData.data = wall_dict\noWallData = wallData\n\n\nwall_dict[show].showAttribute()\nwall_dict[show].showMethod()\n",
  "language": "python",
  "imports": [
    "Rhino",
    "Rhino.Geometry",
    "ghpythonlib",
    "scriptcontext"
  ],
  "has_docstring": false
}