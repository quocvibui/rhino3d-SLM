{
  "source_url": "https://github.com/compas-dev/compas/blob/HEAD/src/compas_rhino/conversions/curves.py",
  "repo": "compas-dev/compas",
  "repo_stars": 352,
  "repo_description": "Main library of the COMPAS framework and CAD integrations for Rhino/GH and Blender.",
  "license": "MIT",
  "filepath": "src/compas_rhino/conversions/curves.py",
  "instruction": "Curves",
  "code": "from __future__ import absolute_import\nfrom __future__ import division\nfrom __future__ import print_function\n\nimport Rhino  # type: ignore\nimport scriptcontext as sc  # type: ignore\n\nfrom compas.geometry import Arc\nfrom compas.geometry import Circle\nfrom compas.geometry import Curve\nfrom compas.geometry import Ellipse\nfrom compas.geometry import Line\nfrom compas.geometry import NurbsCurve\nfrom compas.geometry import Polyline\n\nfrom .exceptions import ConversionError\nfrom .geometry import frame_to_rhino_plane\nfrom .geometry import plane_to_compas\nfrom .geometry import plane_to_compas_frame\nfrom .geometry import plane_to_rhino\nfrom .geometry import point_to_compas\nfrom .geometry import point_to_rhino\n\n# =============================================================================\n# To Rhino\n# =============================================================================\n\n\ndef line_to_rhino(line):\n    \"\"\"Convert a COMPAS line to a Rhino line.\n\n    Parameters\n    ----------\n    line : :class:`compas.geometry.Line`\n\n    Returns\n    -------\n    :rhino:`Rhino.Geometry.Line`\n\n    \"\"\"\n    return Rhino.Geometry.Line(point_to_rhino(line[0]), point_to_rhino(line[1]))\n\n\ndef line_to_rhino_curve(line):\n    \"\"\"Convert a COMPAS line to a Rhino curve.\n\n    Parameters\n    ----------\n    line : :class:`compas.geometry.Line`\n\n    Returns\n    -------\n    :rhino:`Rhino.Geometry.Curve`\n\n    \"\"\"\n    return Rhino.Geometry.NurbsCurve.CreateFromLine(line_to_rhino(line))\n\n\ndef polyline_to_rhino(polyline, tol=None):\n    \"\"\"Convert a COMPAS polyline to a Rhino polyline.\n\n    Parameters\n    ----------\n    polyline : :class:`compas.geometry.Polyline`\n\n    Returns\n    -------\n    :rhino:`Rhino.Geometry.Ellipse`\n\n    \"\"\"\n    tol = tol or sc.doc.ModelAbsoluteTolerance\n    polyline = Rhino.Geometry.Polyline([point_to_rhino(point) for point in polyline])\n    polyline.DeleteShortSegments(tol)\n    return polyline\n\n\ndef polyline_to_rhino_curve(polyline):\n    \"\"\"Convert a COMPAS polyline to a Rhino curve.\n\n    Parameters\n    ----------\n    polyline : :class:`compas.geometry.Polyline`\n\n    Returns\n    -------\n    :rhino:`Rhino.Geometry.PolylineCurve`\n\n    \"\"\"\n    return Rhino.Geometry.PolylineCurve([point_to_rhino(point) for point in polyline])\n\n\ndef circle_to_rhino(circle):\n    \"\"\"Convert a COMPAS circle to a Rhino circle.\n\n    Parameters\n    ----------\n    circle : :class:`compas.geometry.Circle`\n\n    Returns\n    -------\n    :rhino:`Rhino.Geometry.Circle`\n\n    \"\"\"\n    return Rhino.Geometry.Circle(plane_to_rhino(circle.plane), circle.radius)\n\n\ndef circle_to_rhino_curve(circle):\n    \"\"\"Convert a COMPAS circle to a Rhino curve.\n\n    Parameters\n    ----------\n    circle : :class:`compas.geometry.Circle`\n\n    Returns\n    -------\n    :rhino:`Rhino.Geometry.Curve`\n\n    \"\"\"\n    return Rhino.Geometry.NurbsCurve.CreateFromCircle(circle_to_rhino(circle))\n\n\ndef ellipse_to_rhino(ellipse):\n    \"\"\"Convert a COMPAS ellipse to a Rhino ellipse.\n\n    Parameters\n    ----------\n    ellipse : :class:`compas.geometry.Ellipse`\n\n    Returns\n    -------\n    :rhino:`Rhino.Geometry.Ellipse`\n\n    \"\"\"\n    return Rhino.Geometry.Ellipse(plane_to_rhino(ellipse.plane), ellipse.major, ellipse.minor)\n\n\ndef ellipse_to_rhino_curve(ellipse):\n    \"\"\"Convert a COMPAS ellipse to a Rhino curve.\n\n    Parameters\n    ----------\n    ellipse : :class:`compas.geometry.Ellipse`\n\n    Returns\n    -------\n    :rhino:`Rhino.Geometry.Curve`\n\n    \"\"\"\n    return Rhino.Geometry.NurbsCurve.CreateFromEllipse(ellipse_to_rhino(ellipse))\n\n\ndef arc_to_rhino(arc):\n    \"\"\"Convert a COMPAS Arc to a Rhino one.\n\n    Parameters\n    ----------\n    arc : :class:`compas.geometry.Arc`\n        The COMPAS Arc to convert.\n\n    Returns\n    -------\n    :rhino:`Rhino.Geometry.Arc`\n\n    \"\"\"\n    plane = frame_to_rhino_plane(arc.frame)\n    circle = Rhino.Geometry.Circle(plane, arc.radius)\n    angle_interval = Rhino.Geometry.Interval(arc.start_angle, arc.end_angle)\n    return Rhino.Geometry.Arc(circle, angle_interval)\n\n\ndef curve_to_rhino(curve):\n    \"\"\"Convert a COMPAS curve to a Rhino curve.\n\n    Parameters\n    ----------\n    curve : :class:`compas.geometry.Curve`\n\n    Returns\n    -------\n    :rhino:`Rhino.Geometry.Curve`\n\n    \"\"\"\n    return curve.rhino_curve\n\n\n# =============================================================================\n# To COMPAS\n# =============================================================================\n\n\ndef line_to_compas(line):\n    \"\"\"Convert a Rhino line to a COMPAS line.\n\n    Parameters\n    ----------\n    line : :rhino:`Rhino.Geometry.Line`\n\n    Returns\n    -------\n    :class:`compas.geometry.Line`\n\n    \"\"\"\n    return Line(point_to_compas(line.From), point_to_compas(line.To))\n\n\ndef circle_to_compas(circle):\n    \"\"\"Convert a Rhino circle to a COMPAS circle.\n\n    Parameters\n    ----------\n    circle : :rhino:`Rhino.Geometry.Circle`\n\n    Returns\n    -------\n    :class:`compas.geometry.Circle`\n\n    \"\"\"\n    frame = plane_to_compas_frame(circle.Plane)\n    return Circle(circle.Radius, frame=frame)\n\n\ndef ellipse_to_compas(ellipse):\n    \"\"\"Convert a Rhino ellipse to a COMPAS ellipse.\n\n    Parameters\n    ----------\n    ellipse : :rhino:`Rhino.Geometry.Ellipse`\n\n    Returns\n    -------\n    :class:`compas.geometry.Ellipse`\n\n    \"\"\"\n    frame = plane_to_compas(ellipse.Plane)\n    return Ellipse(ellipse.Radius1, ellipse.Radius2, frame=frame)\n\n\ndef polyline_to_compas(polyline):\n    \"\"\"Convert a Rhino polyline to a COMPAS polyline.\n\n    Parameters\n    ----------\n    polyline : :rhino:`Rhino.Geometry.Polyline`\n\n    Returns\n    -------\n    :class:`compas.geometry.Polyline`\n\n    \"\"\"\n    return Polyline([point_to_compas(point) for point in polyline])\n\n\ndef arc_to_compas(arc):\n    \"\"\"Convert a Rhino Arc Structure to a COMPAS Arc.\n\n    Parameters\n    ----------\n    arc : :rhino:`Rhino.Geometry.Arc`\n        The Rhino Arc to convert.\n\n    Returns\n    -------\n    :class:`compas.geometry.Arc`\n\n    \"\"\"\n    frame = plane_to_compas_frame(arc.Plane)\n    # Arc center point can be set independently of its plane's origin\n    center = point_to_compas(arc.Center)\n    frame.point = center\n    return Arc(radius=arc.Radius, start_angle=arc.StartAngle, end_angle=arc.EndAngle, frame=frame)\n\n\ndef curve_to_compas_line(curve):\n    \"\"\"Convert a Rhino curve to a COMPAS line.\n\n    Parameters\n    ----------\n    curve : :rhino:`Rhino.Geometry.Curve`\n\n    Returns\n    -------\n    :class:`compas.geometry.Line`\n\n    \"\"\"\n    return Line(point_to_compas(curve.PointAtStart), point_to_compas(curve.PointAtEnd))\n\n\ndef curve_to_compas_circle(curve):\n    \"\"\"Convert a Rhino curve to a COMPAS circle.\n\n    Parameters\n    ----------\n    curve : :rhino:`Rhino.Geometry.Curve`\n\n    Returns\n    -------\n    :class:`compas.geometry.Circle`\n\n    Raises\n    ------\n    ConversionError\n        If the curve cannot be converted to a circle.\n\n    \"\"\"\n    result, circle = curve.TryGetCircle()\n    if not result:\n        raise ConversionError(\"The curve cannot be converted to a circle.\")\n    return circle_to_compas(circle)\n\n\ndef curve_to_compas_ellipse(curve):\n    \"\"\"Convert a Rhino curve to a COMPAS ellipse.\n\n    Parameters\n    ----------\n    curve : :rhino:`Rhino.Geometry.Curve`\n\n    Returns\n    -------\n    :class:`compas.geometry.Ellipse`\n\n    Raises\n    ------\n    ConversionError\n        If the curve cannot be converted to an ellipse.\n\n    \"\"\"\n    result, ellipse = curve.TryGetEllipse()\n    if not result:\n        raise ConversionError(\"The curve cannot be converted to an ellipse.\")\n    return ellipse_to_compas(ellipse)\n\n\ndef curve_to_compas_polyline(curve):\n    \"\"\"Convert a Rhino curve to a COMPAS polyline.\n\n    Parameters\n    ----------\n    curve : :rhino:`Rhino.Geometry.Curve`\n\n    Returns\n    -------\n    :class:`compas.geometry.Polyline`\n\n    Raises\n    ------\n    ConversionError\n        If the curve cannot be converted to a polyline.\n\n    \"\"\"\n    result, polyline = curve.TryGetPolyline()\n    if not result:\n        raise ConversionError(\"The curve cannot be converted to a polyline.\")\n    return polyline_to_compas(polyline)\n\n\ndef curve_to_compas(curve, try_nurbs=True):\n    \"\"\"Convert a Rhino curve to a COMPAS curve.\n\n    Parameters\n    ----------\n    curve : :rhino:`Rhino.Geometry.Curve`\n        A Rhino curve.\n    try_nurbs : bool, optional\n        Try to convert the curve to a NURBS curve.\n\n    Returns\n    -------\n    :class:`compas.geometry.Curve` | :class:`compas.geometry.NurbsCurve`\n        If `try_nurbs` is `True`, and the geometry has a NURBS representation, return a NURBS curve.\n        Otherwise return a general curve.\n\n    \"\"\"\n    if try_nurbs and curve.HasNurbsForm():\n        return NurbsCurve.from_native(curve.ToNurbsCurve())\n    return Curve.from_native(curve)\n",
  "language": "python",
  "imports": [
    "Rhino",
    "Rhino.Geometry",
    "scriptcontext"
  ],
  "has_docstring": false
}