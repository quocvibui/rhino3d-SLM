{
  "source_url": "https://github.com/localcode/rhinopythonscripts/blob/34c5314a276e9d4d79a62da6bed96a8112552c2f/LayerTools.py",
  "repo": "localcode/rhinopythonscripts",
  "repo_stars": 62,
  "repo_description": "A place to dump and share python scripts for use in McNeel's Rhino and Grasshopper",
  "license": "unknown",
  "filepath": "LayerTools.py",
  "instruction": "Layer tools",
  "code": "import System\n\nimport Rhino\nimport scriptcontext\n\nimport Smart\n\n\n\ndef addRhinoLayer(layerName, layerColor=System.Drawing.Color.Black):\n    \"\"\"Creates a Layer in Rhino using a name and optional color. Returns the\n    index of the layer requested. If the layer\n    already exists, the color is updated and no new layer is created.\"\"\"\n    scriptcontext.docLyrs = scriptcontext.doc.Layers\n    layerIndex = scriptcontext.docLyrs.Find(layerName, True)\n    if layerIndex == -1:\n        layerIndex = scriptcontext.docLyrs.Add(layerName,layerColor)\n    else: # it exists\n        layer = scriptcontext.docLyrs[layerIndex] # so get it\n        if layer.Color != layerColor: # if it has a different color\n            layer.Color = layerColor # reset the color\n    return layerIndex\n\ndef layerAttributes(layerName, layerColor=System.Drawing.Color.Black):\n    \"\"\"Returns a Rhino ObjectAttributes object for a rhino layer with an optional color.\"\"\"\n    att = Rhino.DocObjects.ObjectAttributes()\n    att.LayerIndex = addRhinoLayer(layerName, layerColor)\n    return att\n\ndef deleteLayer(layerName, quiet=True):\n    \"\"\"Deletes a layer by Name. returns nothing.\"\"\"\n    layer_index = scriptcontext.doc.Layers.Find(layerName, True)\n    settings = Rhino.DocObjects.ObjectEnumeratorSettings()\n    settings.LayerIndexFilter = layer_index\n    objs = scriptcontext.doc.Objects.FindByFilter(settings)\n    ids = [obj.Id for obj in objs]\n    scriptcontext.doc.Objects.Delete(ids, quiet)\n    scriptcontext.doc.Layers.Delete(layer_index, quiet)\n\ndef switchLayers(fromLayer, toLayer):\n    \"\"\"gets the objects on fromLayer and moves them to toLayer.\"\"\"\n    objs = scriptcontext.doc.Objects.FindByLayer(fromLayer)\n    lIndex = scriptcontext.doc.Layers.Find(toLayer, True)\n    for obj in objs:\n        obj.Attributes.LayerIndex = lIndex\n        obj.CommitChanges()\n\ndef restoreLayers():\n    \"\"\"Ensures that all layers are visible.\"\"\"\n    for i in range(scriptcontext.doc.Layers.ActiveCount):\n        scriptcontext.doc.Layers.SetCurrentLayerIndex(i, True)\n        name = scriptcontext.doc.Layers.CurrentLayer.Name\n        rs.LayerVisible(name, True)\n    scriptcontext.doc.Layers.SetCurrentLayerIndex(0, True)\n\ndef getLayerGeometry(layerName):\n    '''uses doc.Objects.FindByLayer and returns the Geometry of the\n    resulting RhinoObjects. If nothing found, returns an empty list.'''\n    out = []\n    objs = scriptcontext.doc.Objects.FindByLayer(layerName)\n    if objs:\n        for obj in objs:\n            out.append(obj.Geometry)\n    return out\n\ndef layerNames():\n    '''Returns a list of strings, the name of each layer in the current\n    document.'''\n    names = []\n    for l in scriptcontext.doc.Layers:\n        names.append(l.Name)\n    return names\n\ndef getLayerGuids(layerName):\n    '''uses doc.Objects.FindByLayer and returns the Geometry of the\n    resulting RhinoObjects. If nothing found, returns an empty list.'''\n    out = []\n    objs = scriptcontext.doc.Objects.FindByLayer(layerName)\n    if objs:\n        for obj in scriptcontext.doc.Objects.FindByLayer(layerName):\n            out.append(obj.Id)\n    return out\n\ndef getLayerSmartFeatures(layerName):\n    out = []\n    objs = scriptcontext.doc.Objects.FindByLayer(layerName)\n    if objs and len(objs) > 0:\n        out = Smart.RhinoObjectsToSmartFeatures(objs)\n    return out\n\n\n",
  "language": "python",
  "imports": [
    "Rhino",
    "scriptcontext"
  ],
  "has_docstring": false
}