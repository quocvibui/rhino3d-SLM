{
  "source_url": "https://github.com/ladybug-tools/ladybug-legacy/blob/d90db02f2776febbb38100dea26ec0c93e77aa53/src/Ladybug_Thermal%20Comfort%20Indices.py",
  "repo": "ladybug-tools/ladybug-legacy",
  "repo_stars": 202,
  "repo_description": ":beetle: Ladybug is an environmental plugin for Grasshopper.",
  "license": "NOASSERTION",
  "filepath": "src/Ladybug_Thermal Comfort Indices.py",
  "instruction": "Use this component to calculate various thermal comfort indices:\n------\n- HI (Heat Index)\n- humidex (humidity index)\n- DI (Discomfort Index)\n- WCI (Wind Chill Index)\n- WCT (Wind Chill Temperature)\n-...",
  "code": "# thermal comfort indices\n#\n# Ladybug: A Plugin for Environmental Analysis (GPL) started by Mostapha Sadeghipour Roudsari\n# \n# This file is part of Ladybug.\n# \n# Copyright (c) 2013-2020, Djordje Spasic <djordjedspasic@gmail.com>\n# with assistance of Dr. Krzysztof Blazejczyk <k.blaz@twarda.pan.pl>\n# Ladybug is free software; you can redistribute it and/or modify \n# it under the terms of the GNU General Public License as published \n# by the Free Software Foundation; either version 3 of the License, \n# or (at your option) any later version. \n# \n# Ladybug is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of \n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the \n# GNU General Public License for more details.\n# \n# You should have received a copy of the GNU General Public License\n# along with Ladybug; If not, see <http://www.gnu.org/licenses/>.\n# \n# @license GPL-3.0+ <http://spdx.org/licenses/GPL-3.0+>\n\n\n\"\"\"\nUse this component to calculate various thermal comfort indices:\n------\n- HI (Heat Index)\n- humidex (humidity index)\n- DI (Discomfort Index)\n- WCI (Wind Chill Index)\n- WCT (Wind Chill Temperature)\n- WBGT (Wet-Bulb Globe Temperature) indoors\n- WBGT (Wet-Bulb Globe Temperature) outdoors\n- TE (Effective Temperature)\n- AT (Apparent Temperature)\n- TS (Thermal Sensation)\n- ASV (Actual Sensation Vote)\n- MRT (Mean Radiant Temperature)\n- Iclp (Predicted Insulation Index Of Clothing)\n- HR (Heart Rate)\n- DhRa (Dehydration Risk)\n- PET (Physiological Equivalent Temperature)\n- THI (Temperature Humidity Index)\n- PHS (Predicted Heat Strain)\n-\nProvided by Ladybug 0.0.69\n    \n    input:\n        _comfortIndex: Choose one of the comfort indices:\n                       0 - HI (Heat Index)\n                       1 - humidex (humidity index)\n                       2 - DI (Discomfort Index)\n                       3 - WCI (Wind Chill Index)\n                       4 - WCT (Wind Chill Temperature)\n                       5 - WBGT (Wet-Bulb Globe Temperature) indoors\n                       6 - WBGT (Wet-Bulb Globe Temperature) outdoors\n                       7 - TE (Effective Temperature)\n                       8 - AT (Apparent Temperature)\n                       9 - TS (Thermal Sensation)\n                       10 - ASV (Actual Sensation Vote)\n                       11 - MRT (Mean Radiant Temperature)\n                       12 - Iclp (Predicted Insulation Index Of Clothing)\n                       13 - HR (Heart Rate)\n                       14 - DhRa (Dehydration Risk)\n                       15 - PET (Physiological Equivalent Temperature) for temperate climates\n                       16 - PET (Physiological Equivalent Temperature) for tropical and subtropical humid climates\n                       17 - THI (Temperature Humidity Index)\n                       18 - PHS (Predicted Heat Strain)\n        _location: Input data from Ladybug's \"Import epw\" \"location\" output, or create your own location data with Ladybug's \"Construct Location\" component.\n        _dryBulbTemperature: Air temperature.\n                             Input a single value or a whole list from \"Import epw\" component's \"dryBulbTemperature\" output.\n                             -\n                             In Celsius degrees (C).\n        meanRadiantTemperature_: An average temperature of the surfaces that surround the analysis location.\n                                 For indoor conditions or outdoor in-shade, it should be equal to air temperature. So just input the same data you inputted to \"_dryBulbTemperature\".\n                                 -\n                                 If nothing supplied, it will be calculated for outdoor conditions (both in-shade and out-shade).\n                                 -\n                                 In Celsius degrees (C).\n        dewPointTemperature_: Dew point temperature.\n                              Input a single value or a whole list from \"Import epw\" component's \"dewPointTemperature\" output.\n                              -\n                              If not supplied, it will be calculated from _dryBulbTemperature and relativeHumidity_ data.\n                              -\n                              In Celsius degrees (C).\n        relativeHumidity_: Relative humidity.\n                           Input a single value or a whole list from \"Import epw\" component's \"relativeHumidity\" output.\n                           -\n                           If not supplied 50% will be used as a default (indoor conditions).\n                           -\n                           In percent (from 0% to 110%).\n        windSpeed_: Wind speed at 1.1 meters height from analysis surface (height of standing persons gravity center). It can be a single value or a list of values.\n                    Take the \"windSpeed\" output from \"Import epw\" component and plug it to \"Wind Speed Calculator\" component's \"_windSpeed_tenMeters\" input. Set the \"heightAboveGround_\" input to \"1.1\". Then plug in the data from \"Wind Speed Calculator\" component's \"windSpeedAtHeight\" output to this component's \"windSpeed_\" input.\n                    In this way we converted the 10 meter wind speed from the .epw file to required 1.1m.\n                    -\n                    If not supplied, default value of 0.3 m/s is used (meaning: the analysis is conducted in outdoor no wind conditions, or indoor conditions).\n                    -\n                    In meters/second.\n        totalSkyCover_: Amount of sky dome covered by clouds.\n                        Input a single value or a whole list from \"Import epw\" component's \"totalSkyCover\" output.\n                        It ranges from from 1 to 10. For example: 1 is 1/10 covered. 10 is total coverage (10/10).\n                        -\n                        If not supplied 6/10 will be used (cloud coverage of temperate humid climate).\n                        -\n                        In tenths of sky cover.\n        solarRadiationPerHour_:  Amount of solar radiation that an analysis person received.\n                                 -\n                                 1) If you would like to do an analysis accounted for shading (more precise) use the \"Sunpath shading\" component and its \"shadedSolarRadiationPerHour\" output.\n                                 Or use \"Radiation Analysis\" component's \"radiationResult\" output. Be sure to scale the \"radiationResult\" output data 1000 times (to convert it from kW/m2 to W/m2).\n                                 The \"Sunpath shading\" component will account for partial shading from the trees, while \"Radiation Analysis\" will not.\n                                 -\n                                 2) If you would not like to do an analysis accounted for shading (because it's quicker that way), then you can simply supply the data from \"Import epw\" component's \"diffuseHorizontalRadiation\" output. In this way it will be assumed that an analysis is being conducted in outdoor in-shade conditions, or indoor conditions.\n                                 -\n                                 If nothing supplied, default value of 0 Wh/m2 will be used (no solar radiation at all).\n                                 -\n                                 In Wh/m2.\n        bodyCharacteristics_: A list of body characteristics in the following order: age, sex, height, weight, bodyPosition, clothingInsulation, acclimated, metabolicRate, activityDuration.\n                              Use Ladybug's \"Body Characteristics\" component to generate it.\n                              -\n                              If not supplied, the following default values will be used:\n                              --\n                              35 - age\n                              \"male\" - sex\n                              175 - height in centimeters\n                              75 - weight in kilograms\n                              \"standing\" - bodyPosition\n                              None (clothingInsulation - \"None\" means that it will be calculated based on air temperature)\n                              37 - clothingAlbedo in % (for medium colored clothes)\n                              \"unacclimated\" - acclimated\n                              2.32 - metabolicRate in mets (2.32 corresponds to walking 4km/h)\n                              480 - activityDuration in minutes\n        HOY_: An hour (or hours) of the year for which you would like to calculate thermal indices. These hours must be a value between 1 and 8760.\n              This input will override the analysisPeriod_ input below.\n              -\n              If not supplied, this input will be ignored.\n        analysisPeriod_: An optional analysis period from the \"Analysis Period\" component.\n                         -\n                         If not supplied, the whole year period will be used as an analysis period.\n        _runIt: ...\n        \n    output:\n        readMe!: If your _comfortIndex is set to either 15 or 16, and you are performing analysis for a single hour, then this output will show additional results related with PET (Physiological Equivalent Temperature).\n        comfortIndexValue: The value of the chosen comfort.\n        comfortIndexLevel: The level (category, sensation) of the chosen index.\n        comfortableOrNot: Indication of whether that person is comfortable (1) or not (0) at particular hour.\n        percentComfortable: Percentage of time, during which chosen index falls into the comfortable category.\n        percentHotExtreme: Percentage of time, during which chosen index falls into the hot extreme category.\n        percentColdExtreme: Percentage of time, during which chosen index falls into the cold extreme category.\n\"\"\"\n\nghenv.Component.Name = \"Ladybug_Thermal Comfort Indices\"\nghenv.Component.NickName = \"ThermalComfortIndices\"\nghenv.Component.Message = 'VER 0.0.69\\nJUL_07_2020'\nghenv.Component.IconDisplayMode = ghenv.Component.IconDisplayMode.application\nghenv.Component.Category = \"LB-Legacy\"\nghenv.Component.SubCategory = \"1 | AnalyzeWeatherData\"\n#compatibleLBVersion = VER 0.0.64\\nFEB_12_2017\ntry: ghenv.Component.AdditionalHelpFromDocStrings = \"3\"\nexcept: pass\n\nimport Grasshopper.Kernel as gh\nimport scriptcontext as sc\nimport System\nimport math\nimport time\n\n\ndef getLocationData(location):\n    \n    if location:\n        try:\n            locationName, latitude, longitude, timeZone, elevation = lb_preparation.decomposeLocation(location)\n            latitude, longitude, timeZone = float(latitude), float(longitude), float(timeZone)\n            \n            validLocationData = True\n            printMsg = \"ok\"\n        \n        except:\n            # something is wrong with \"_location\" input (the input is not from Ladybug \"Import epw\" component's \"location\" ouput)\n            locationName = latitude = longitude = timeZone = None\n            validLocationData = False\n            printMsg = \"Something is wrong with \\\"_location\\\" input.\"\n    else:\n        locationName = latitude = longitude = timeZone = None\n        validLocationData = False\n        printMsg = \"Please input \\\"location\\\" ouput from Ladybug \\\"Import epw\\\" component, or make your own location data by using Ladybug's \\\"Contruct Location\\\" and plug it into \\\"_location\\\" input of this component.\"\n    \n    return locationName, latitude, longitude, timeZone, validLocationData, printMsg\n\n\ndef averageWeatherData(hourlyData, activityDuration):\n    # average weather data for the last activityDuration hours\n    activityDurationHours = int(activityDuration/60)\n    activityDurationValues = activityDurationHours - 1\n    hourlyDataShifted = hourlyData[-activityDurationValues:] + hourlyData[:]\n    \n    #lastActivityDurationHoursAverageL = [sum(hourlyDataShifted[i:activityDurationHours+i])/activityDurationHours for i in range(8760)]\n    lastActivityDurationHoursAverageL = [sum(hourlyDataShifted[i:activityDurationHours+i])/activityDurationHours for i in range(len(hourlyData))]\n    \n    return lastActivityDurationHoursAverageL\n\n\ndef getWeatherData(latitude, longitude, timeZone, Ta, mrt, Tdp, rh, ws, SR, N, bodyCharacteristics, HOY, analysisPeriod):\n    \n    # define function and HotExtremeCategory, ColdExtremeCategory variables\n    if _comfortIndex == 0:\n        function = heatIndex\n        HotExtremeCategory = 4\n        ColdExtremeCategory = \"dummy\"\n        climate = \"dummy\"\n    elif _comfortIndex == 1:\n        function = Humidex\n        HotExtremeCategory = 5\n        ColdExtremeCategory = \"dummy\"\n        climate = \"dummy\"\n    elif _comfortIndex == 2:\n        function = discomfortIndex\n        HotExtremeCategory = 3\n        ColdExtremeCategory = -6\n        climate = \"dummy\"\n    elif _comfortIndex == 3:\n        function = windChillIndex\n        HotExtremeCategory = 3\n        ColdExtremeCategory = -4\n        climate = \"dummy\"\n    elif _comfortIndex == 4:\n        function = windChillTemperature\n        HotExtremeCategory = \"dummy\"\n        ColdExtremeCategory = -4\n        climate = \"dummy\"\n    elif _comfortIndex == 5:\n        function = wbgt_indoors\n        HotExtremeCategory = 5\n        ColdExtremeCategory = \"dummy\"\n        climate = \"dummy\"\n    elif _comfortIndex == 6:\n        function = wbgt_outdoors\n        HotExtremeCategory = 5\n        ColdExtremeCategory = \"dummy\"\n        climate = \"dummy\"\n    elif _comfortIndex == 7:\n        function = effectiveTemperature\n        HotExtremeCategory = 2\n        ColdExtremeCategory = -4\n        climate = \"dummy\"\n    elif _comfortIndex == 8:\n        function = apparentTemperature\n        HotExtremeCategory = 4\n        ColdExtremeCategory = -6\n        climate = \"dummy\"\n    elif _comfortIndex == 9:\n        function = thermalSensation\n        HotExtremeCategory = 3\n        ColdExtremeCategory = -3\n        climate = \"dummy\"\n    elif _comfortIndex == 10:\n        function = actualSensationModel\n        HotExtremeCategory = 2\n        ColdExtremeCategory = -2\n        climate = \"dummy\"\n    elif _comfortIndex == 11:\n        function = meanRadiantTemperature\n        HotExtremeCategory = \"dummy\"\n        ColdExtremeCategory = \"dummy\"\n        climate = \"dummy\"\n    elif _comfortIndex == 12:\n        function = predictedInsulationIndexOfClothing\n        HotExtremeCategory = 2\n        ColdExtremeCategory = -4\n        climate = \"dummy\"\n    elif _comfortIndex == 13:\n        function = heartRate\n        HotExtremeCategory = 3\n        ColdExtremeCategory = \"dummy\"\n        climate = \"dummy\"\n    elif _comfortIndex == 14:\n        function = dehydrationRisk\n        HotExtremeCategory = 2\n        ColdExtremeCategory = \"dummy\"\n        climate = \"dummy\"\n    elif _comfortIndex == 15:\n        function = physiologicalEquivalentTemperature\n        HotExtremeCategory = 4\n        ColdExtremeCategory = -4\n        climate = \"temperate\"\n    elif _comfortIndex == 16:\n        function = physiologicalEquivalentTemperature\n        HotExtremeCategory = 4\n        ColdExtremeCategory = -4\n        climate = \"humid\"\n    elif _comfortIndex == 17:\n        function = temperatureHumidityIndex\n        HotExtremeCategory = 2\n        ColdExtremeCategory = -3\n        climate = \"dummy\"\n    elif _comfortIndex == 18:\n        function = predictedHeatStrain\n        HotExtremeCategory = 4\n        ColdExtremeCategory = \"dummy\"\n        climate = \"dummy\"\n    \n    \n    # initial check of weather data inputs\n    TaL = []; mrtL = []; TdpL = []; rhL = []; wsL = []; SRL = []; NL = []; IclL = []; ML = []\n    \n    if (len(Ta) == 0) or (Ta[0] == None):\n        comfortIndexValue = comfortIndexCategory = comfortableOrNot = PETresults = HotExtremeCategory = ColdExtremeCategory = outputNickNames = outputDescriptions = createOutputHeaders = HOYs = date = None\n        validWeatherData = False\n        printMsg = \"Please input _dryBulbTemperature. As a single value, a list of values, or as a list from \\\"Import EPW\\\" component.\"\n        return comfortIndexValue, comfortIndexCategory, comfortableOrNot, PETresults, HotExtremeCategory, ColdExtremeCategory, outputNickNames, outputDescriptions, createOutputHeaders, HOYs, date, validWeatherData, printMsg\n    elif (len(Ta) == 8767) and (type(Ta[0]) == System.String):\n        # the _dryBulbTemperature input contains annual data from \"Import Epw\" component and not 8767 numerical values\n        TaL = Ta[7:]\n    elif (len(Ta) > 0) and (len(Ta) < 8767):\n        TaL = [float(Ta[i])  for i in range(len(Ta))]\n    \n    \n    if (len(mrt) == 0) or (mrt[0] == None):\n        mrtL = [\"calculate_MRT\"]  # calculate mrtL\n    elif (len(mrt) == 8767) and (type(mrt[0]) == System.String):\n        # the meanRadiantTemperature_ input contains annual data from \"Import Epw\" component and not 8767 numerical values\n        mrtL = mrt[7:]\n    elif (len(mrt) > 0) and (len(mrt) < 8767):\n        mrtL = [float(mrt[i])  for i in range(len(mrt))]\n    \n    \n    if (len(rh) == 0) or (rh[0] == None):\n        rhL = [50]  # default 50%, indoor condition\n    elif (len(rh) == 8767) and (type(rh[0]) == System.String):\n        # the relativeHumidity_ input contains annual data from \"Import Epw\" component and not 8767 numerical values\n        rhL = rh[7:]\n    elif (len(rh) > 0) and (len(rh) < 8767):\n        rhL = [float(rh[i])  for i in range(len(rh))]\n    \n    \n    if (len(Tdp) == 0) or (Tdp[0] == None):\n        TdpL = [\"calculate_Tdp\"]\n    elif (len(Tdp) == 8767) and (type(Tdp[0]) == System.String):\n        # the dewPointTemperature_ input contains annual data from \"Import Epw\" component and not 8767 numerical values\n        TdpL = Tdp[7:]\n    elif (len(Tdp) > 0) and (len(Tdp) < 8767):\n        TdpL = [float(Tdp[i])  for i in range(len(Tdp))]\n    \n    \n    if (len(ws) == 0) or (ws[0] == None):\n        wsL = [0.3]  # default 0.3 m/s: no wind\n    elif (len(ws) == 8767) and (type(ws[0]) == System.String):\n        # the windSpeed_ input contains annual data from \"Import Epw\" component and not 8767 numerical values\n        wsL = ws[7:]\n    elif (len(ws) > 0) and (len(ws) < 8767):\n        wsL = [float(ws[i])  for i in range(len(ws))]\n    \n    \n    if (len(N) == 0) or (N[0] == None):\n        NL = [6]  # default 6 tens, continental humid climate\n    elif (len(N) == 8767) and (type(N[0]) == System.String):\n        # the totalSkyCover_ input contains annual data from \"Import Epw\" component and not 8767 numerical values\n        NL = N[7:]\n    elif (len(N) > 0) and (len(N) < 8767):\n        NL = [float(N[i])  for i in range(len(N))]\n    \n    \n    if (len(SR) == 0) or (SR[0] is \"\") or (SR[0] == None):\n        SRL = [0]  # default 0 Wh/m2: no solar radiation\n    elif (len(SR) == 8767) and (type(SR[0]) == System.String):\n        # the solarRadiationPerHour_ input contains annual data from \"Import Epw\" component and not 8767 numerical values\n        SRL = SR[7:]\n    elif (len(SR) > 0) and (len(SR) < 8767):\n        SRL = [float(SR[i])  for i in range(len(SR))]\n    \n    \n    \n    # bodyCharacteristics\n    if (len(bodyCharacteristics) != 10) and (len(bodyCharacteristics) != 0):\n        comfortIndexValue = comfortIndexCategory = comfortableOrNot = PETresults = HotExtremeCategory = ColdExtremeCategory = outputNickNames = outputDescriptions = createOutputHeaders = HOYs = date = None\n        validWeatherData = False\n        printMsg = \"Your \\\"bodyCharacteristics_\\\" input is incorrect. Please use the \\\"bodyCharacteristics\\\" output from Ladybug's \\\"Body Characteristics\\\" component.\"\n        return comfortIndexValue, comfortIndexCategory, comfortableOrNot, PETresults, HotExtremeCategory, ColdExtremeCategory, outputNickNames, outputDescriptions, createOutputHeaders, HOYs, date, validWeatherData, printMsg\n        \n    elif (len(bodyCharacteristics) == 0) or (bodyCharacteristics[0] is \"\"):\n        # nothing inputted into \"bodyCharacteristics_\", use default bodyCharacteristics values\n        age = 35\n        sex = \"male\"\n        heightCM = 175  # in centimeters\n        heightM = 1.75  # in meters\n        weight = 75  # in kg\n        bodyPosition = \"standing\"\n        Icl = None  # it will be calculated based on air temperature\n        ac = 37  # default in %, medium colored clothes\n        acclimated = \"unacclimated\"\n        Mmets = 2.32  # default value: 2.32 met = 135 W/m2\n        activityDuration = 480  # in minutes\n    elif (len(bodyCharacteristics) == 10):\n        # 9 items inputted into \"bodyCharacteristics_\"\n        age = bodyCharacteristics[0]\n        sex = bodyCharacteristics[1]\n        heightCM = bodyCharacteristics[2]\n        heightM = heightCM/100\n        weight = bodyCharacteristics[3]\n        bodyPosition = bodyCharacteristics[4]\n        Icl = bodyCharacteristics[5]\n        ac = bodyCharacteristics[6]\n        acclimated = bodyCharacteristics[7]\n        Mmets = bodyCharacteristics[8]\n        activityDuration = bodyCharacteristics[9]\n    \n    # check Icl and M from bodyCharacteristics\n    if (Icl != None):\n        # use \"clothingInsulation\" defined in \"bodyCharacteristics_\"\n        IclL = [Icl]\n    else:\n        # nothing inputted to \"bodyCharacteristics_\" or something inputted to \"bodyCharacteristics_\" but \"clothingInsulation\" is not defined (equals to: None)\n        IclL = [\"calculate_Icl\"]  # this is so that: len(IclL) == 1\n    \n    if (Mmets == None) or (Mmets <= 0):\n        Mmets = 2.32\n    ML = [Mmets]\n    \n    \n    \n    # check compatibility between different input lengths\n    inputsLengths = [ len(TaL), len(mrtL), len(TdpL), len(rhL), len(wsL), len(SRL), len(NL) ]\n    \n    inputsMaximalLength = max( inputsLengths )\n    if (inputsMaximalLength == 1) and (len(HOY_) == 0) and (len(analysisPeriod_) == 0):\n        # all inputs have only one value, and HOY_ and analysisPeriod_ inputs are empty - in that case duplicate all inputs 8760 times, as we do not know to which HOY does these inputs belong to\n        inputsMaximalLength = 8760\n        inputsLengths[0] = 8760  # it could have been any other index indstead of \"[0]\"\n    elif (inputsMaximalLength == 1) and (len(HOY_) != 0) or (len(analysisPeriod_) != 0):\n        inputsMaximalLength = 8760\n    \n    inputsMinimalLength = min( inputsLengths )\n    numberOfDifferentInputLengths = list(set(inputsLengths))\n    \n    if len(numberOfDifferentInputLengths) > 2:\n        comfortIndexValue = comfortIndexCategory = comfortableOrNot = PETresults = HotExtremeCategory = ColdExtremeCategory = outputNickNames = outputDescriptions = createOutputHeaders = HOYs = date = None\n        validWeatherData = False\n        printMsg = \"\\\"Thermal Comfort Indices\\\" component accepts maximum the two types of inputs when it come to number of items per input. For example, the following input combinations:\\n\\n- All input data coming from Ladybug \\\"Import EPW\\\" component.\\n- All input data coming from Ladybug \\\"Import EPW\\\" component and some of inputs having a single value added to them.\\n- Some inputs having a single value added to them, while some of them have number of values larger than 1. However all of these have the same number of items.\\n- All inputs have a single value added to them.\\n- All inputs have a number of values added to them larger than 1. However all of them have the same number of values.\\n\\n Edit your inputs so that they follow one of upper combinations.\"\n        return comfortIndexValue, comfortIndexCategory, comfortableOrNot, PETresults, HotExtremeCategory, ColdExtremeCategory, outputNickNames, outputDescriptions, createOutputHeaders, HOYs, date, validWeatherData, printMsg\n    \n    \n    # HOY_ and analysisPeriod_ inputs\n    if (len(HOY_) == 0) and (len(analysisPeriod_) == 0) and (mrtL[0] != \"calculate_MRT\"):\n        # something added to the \"meanRadiantTemperature_\" input and nothing added to the \"HOY_\" input. In that case use dummy \"HOY_\" values, as what \"noaaSolarCalculator\" function returns will not be important: MRT will not be calculated but the values added to the \"meanRadiantTemperature_\" input will be used instead\n        HOY = range(inputsMaximalLength)  # dummy HOYs\n    \n    HOYs, daysDummy, monthsDummy, hoursDummy, date, newAnalysisPeriod = HOYsDaysMonthsHoursFromHOY_analysisPeriod(HOY, analysisPeriod)\n    HOYsDummy, days, months, hours, dateDummy, newAnalysisPeriodDummy = HOYsDaysMonthsHoursFromHOY_analysisPeriod([], [(1, 1, 1),(12, 31, 24)])\n    \n    if (len(HOYs) > inputsMaximalLength):\n        comfortIndexValue = comfortIndexCategory = comfortableOrNot = PETresults = HotExtremeCategory = ColdExtremeCategory = outputNickNames = outputDescriptions = createOutputHeaders = HOYs = date = None\n        validWeatherData = False\n        printMsg = \"\\\"Thermal Comfort Indices\\\" component does not know for which specific hour of the year you would like to calculate your chosen _comfortIndex.\\nDefine it through \\\"HOY_\\\" or \\\"analysisPeriod_\\\" inputs. Either of these inputs need to cover the period of minimum 1 and maximum %s hours!\" % inputsMaximalLength\n        return comfortIndexValue, comfortIndexCategory, comfortableOrNot, PETresults, HotExtremeCategory, ColdExtremeCategory, outputNickNames, outputDescriptions, createOutputHeaders, HOYs, date, validWeatherData, printMsg\n    \n    \n    # headers\n    if (len(HOYs) == 1):\n        createOutputHeaders = False\n    elif (inputsMaximalLength == 8760):\n        createOutputHeaders = True\n    elif (inputsMaximalLength != 8760):\n        createOutputHeaders = False\n    \n    \n    # number of values in each input need to be the same across all inputs\n    if (len(TaL) == 1):\n        TaL = [float(TaL[0])  for i in range(inputsMaximalLength)]\n    if (len(mrtL) == 1) and (mrtL[0] != \"calculate_MRT\"):\n        mrtL = [mrtL[0]  for i in range(inputsMaximalLength)]\n    if (len(rhL) == 1):\n        rhL = [float(rhL[0])  for i in range(inputsMaximalLength)]\n    if (len(TdpL) == 1) and (TdpL[0] != \"calculate_Tdp\"):\n        TdpL = [float(TdpL[0])  for i in range(inputsMaximalLength)]\n    if (len(TdpL) == 1) and (TdpL[0] == \"calculate_Tdp\"):\n        try:\n            TdpL = [dewPointTemperature(TaL[i],rhL[i])  for i in range(inputsMaximalLength)]  # calculate TdpL\n        except:\n            comfortIndexValue = comfortIndexCategory = comfortableOrNot = PETresults = HotExtremeCategory = ColdExtremeCategory = outputNickNames = outputDescriptions = createOutputHeaders = HOYs = date = None\n            validWeatherData = False\n            printMsg = \"The values you added to \\\"HOY_\\\" or \\\"analysisPeriod_\\\" inputs do not correspond to those you added to weather data inputs above.\\nCorrect your \\\"HOY_\\\" or \\\"analysisPeriod_\\\" inputs.\"\n            return comfortIndexValue, comfortIndexCategory, comfortableOrNot, PETresults, HotExtremeCategory, ColdExtremeCategory, outputNickNames, outputDescriptions, createOutputHeaders, HOYs, date, validWeatherData, printMsg\n    if (len(wsL) == 1):\n        wsL = [float(wsL[0])  for i in range(inputsMaximalLength)]\n    if (len(NL) == 1):\n        NL = [float(NL[0])  for i in range(inputsMaximalLength)]\n    if (len(SRL) == 1):\n        SRL = [float(SRL[0]) for i in range(inputsMaximalLength)]\n    if (len(IclL) == 1) and (IclL[0] != \"calculate_Icl\"):\n        IclL = [IclL[0] for i in range(inputsMaximalLength)]\n    if (len(IclL) == 1) and (IclL[0] == \"calculate_Icl\"):\n        IclL = [clothingInsulation(Ta) for Ta in TaL]\n    if (len(ML) == 1):\n        ML = [Mmets * 58.2  for i in range(inputsMaximalLength)]  # convert mets to W/m2 (2.32 met = 2.32 * 58.2 = 135 W/m2)\n    \n    \n    if _comfortIndex == 18:\n        # for PHS, replace weather data with average weather data for the last activityDuration hours\n        TaL = averageWeatherData(TaL, activityDuration)\n        if mrtL[0] != \"calculate_MRT\":  # if meanRadiantTemperature_ inputted: average it\n            mrtL = averageWeatherData(mrtL, activityDuration)\n        else:\n            pass\n            # it will be averaged by using averaged data (TaL, rhL, SRL, NL)\n        rhL = averageWeatherData(rhL, activityDuration)\n        TdpL = averageWeatherData(TdpL, activityDuration)\n        wsL = averageWeatherData(wsL, activityDuration)\n        SRL = averageWeatherData(SRL, activityDuration)\n        NL = averageWeatherData(NL, activityDuration)\n        IclL = averageWeatherData(IclL, activityDuration)\n    \n    \n    \n    HRrates = heartRates(age, sex)\n    dehydrationRiskRates = DehydrationRiskRates(acclimated)\n    comfortIndexValue, comfortIndexCategory, comfortableOrNot, outputNickNames, outputDescriptions = createHeaders(createOutputHeaders, _comfortIndex, locationName, newAnalysisPeriod, _dryBulbTemperature, dewPointTemperature_, relativeHumidity_, windSpeed_, solarRadiationPerHour_, totalSkyCover_, HRrates, dehydrationRiskRates, activityDuration)\n    \n    TgroundL = []; RprimL = []; vapourPressureL = []; EpotL = []; mrtL_calculated = []\n    for i,hoy in enumerate(HOYs):\n        listIndex = hoy - 1\n        if (inputsMaximalLength == 8760):\n            valueIndex = listIndex\n        else:\n            valueIndex = i\n        Tground = groundTemperature(TaL[valueIndex], NL[valueIndex])  # in C\n        solarZenithD, solarAzimuthD, solarAltitudeD = noaaSolarCalculator(latitude, longitude, timeZone, months[listIndex], days[listIndex], hours[listIndex])  # in degrees\n        Rprim = solarRadiationNudeMan(SRL[valueIndex], solarAltitudeD, ac)  # in W/m2\n        vapourPressure = VapourPressure(TaL[valueIndex], rhL[valueIndex])  # in hPa\n        if (mrtL[0] == \"calculate_MRT\"):\n            MRT = meanRadiantTemperature2(TaL[valueIndex], Tground, Rprim, vapourPressure, NL[valueIndex])  # in C\n        else:\n            MRT = mrtL[valueIndex]  # in C\n        Ts = meanSkinTemperature(TaL[valueIndex], wsL[valueIndex], rhL[valueIndex], MRT, IclL[valueIndex], ML[valueIndex])  # in C\n        e_ = VapourPressure(TaL[valueIndex], 5)  # in hPa\n        Epot = turbulentExchangeOfLatentHeat(TaL[valueIndex], wsL[valueIndex], Ts, IclL[valueIndex], e_, ML[valueIndex])  # in W/m2\n        \n        comfIndexValue, comfCategory, comfOrNot, PETresults = function(TaL[valueIndex], MRT, TdpL[valueIndex], rhL[valueIndex], wsL[valueIndex], SRL[valueIndex], NL[valueIndex], Tground, Rprim, vapourPressure, Epot, age, sex, heightCM, heightM, weight, bodyPosition, IclL[valueIndex], ac, acclimated, ML[valueIndex], activityDuration, HRrates, dehydrationRiskRates, climate)\n        comfortIndexValue.append(comfIndexValue)\n        comfortIndexCategory.append(comfCategory)\n        comfortableOrNot.append(comfOrNot)\n    \n    \n    printMsg = \"ok\"\n    validWeatherData = True\n    \n    return comfortIndexValue, comfortIndexCategory, comfortableOrNot, PETresults, HotExtremeCategory, ColdExtremeCategory, outputNickNames, outputDescriptions, createOutputHeaders, HOYs, date, validWeatherData, printMsg\n\n\n# angle units conversion\ndef degreesToRadians(deg):\n    return deg*0.0174532925 \n\ndef radiansToDegrees(R):\n    return R*57.2957795\n\n# temperature units conversion\ndef celsiusToFahrenheit(Tc):\n    Tf = (Tc * (9/5)) + 32\n    return Tf\n\ndef fahrenheitToCelsius(Tf):\n    Tc = (Tf-32)*(5/9)\n    return Tc\n    \ndef celsiusToKelvin(Tc):\n    Tk = Tc + 273.15\n    return Tk\n\n\n# thermal comfort indices\ndef heatIndex(Ta, mrt, Tdp, rh, ws, SR, N, Tground, Rprim, vapourPressure, Epot, age, sex, heightCM, heightM, weight, bodyPosition, Icl, ac, acclimated, M, activityDuration, HRrates, dehydrationRiskRates, climate):\n    # inputs: (Ta, rh):\n    # formula by (NWS) National Weather Service\n    Tf = celsiusToFahrenheit(Ta)\n    \n    if Tf < 80:\n        HI_f = 0.5 * (Tf + 61.0 + ((Tf-68.0)*1.2) + (rh*0.094))\n    else:\n        HI_f = -42.379 + 2.04901523*Tf + 10.14333127*rh - \\\n             0.22475541*Tf*rh -6.83783*(10**(-3))*(Tf**(2)) - \\\n             5.481717*(10**(-2))*(rh**(2)) + \\\n             1.22874*(10**(-3))*(Tf**(2))*(rh) + 8.5282*(10**(-4))*(Tf)*(rh**(2)) - \\\n             1.99*(10**(-6))*(Tf**(2))*(rh**(2))\n        if (Tf >= 80) and (Tf <= 112) and (rh < 13):\n            adjust = ((13-rh)/4) * math.sqrt((17-abs(Tf-95))/17)\n            HI_f = HI_f-adjust\n        elif (Tf >= 80) and (Tf <= 87) and (rh > 85):\n            adjust = ((rh-85)/10) * ((87-Tf)/5)\n            HI_f = HI_f+adjust\n    \n    if HI_f < 80:\n        effectHI = 0\n        comfortable = 1\n    elif HI_f >= 80 and HI_f < 90:\n        effectHI = 1\n        comfortable = 0\n    elif HI_f >= 90 and HI_f < 105:\n        effectHI = 2\n        comfortable = 0\n    elif HI_f >= 105 and HI_f < 130:\n        effectHI = 3\n        comfortable = 0\n    elif HI_f >= 130:\n        effectHI = 4\n        comfortable = 0\n    \n    HI_c = fahrenheitToCelsius(HI_f)\n    \n    return HI_c, effectHI, comfortable, []\n\n\ndef dewPointTemperature(Ta, rh):\n    # MET4 and MET4A calculation of dew point temperature.\n    # limits:\n    # uncertainty in the calculated dew point temperature: +/- 0.4C\n    # for Tc in range:  0C < Tc < 60C  \n    # for Tdp in range:  0C < Tdp < 50C   \n    a = 17.27\n    b = 237.7\n    rh = rh/100  # 0.01 < rh < 1.00\n    Tdp = (b * ( ((a*Ta)/(b+Ta))+math.log(rh) ))/(a-( ((a*Ta)/(b+Ta))+math.log(rh) ))  # in Celius degrees\n    \n    return Tdp\n\n\ndef Humidex(Ta, mrt, Tdp, rh, ws, SR, N, Tground, Rprim, vapourPressure, Epot, age, sex, heightCM, heightM, weight, bodyPosition, Icl, ac, acclimated, M, activityDuration, HRrates, dehydrationRiskRates, climate):\n    # inputs: (Ta, Tdp):\n    # formula by Environment Canada\n    dewpointK = celsiusToKelvin(Tdp)  # to Kelvin\n    e = 6.11 * math.exp(5417.7530 * ((1/273.16) - (1/dewpointK)))\n    h = (0.5555)*(e - 10.0)\n    humidex = Ta + h\n    \n    if humidex < 30:\n        effectHumidex = 0\n        comfortable = 1\n    elif humidex >= 30 and humidex < 35:\n        effectHumidex = 1\n        comfortable = 0\n    elif humidex >= 35 and humidex < 40:\n        effectHumidex = 2\n        comfortable = 0\n    elif humidex >= 40 and humidex < 45:\n        effectHumidex = 3\n        comfortable = 0\n    elif humidex >= 45 and humidex < 54:\n        effectHumidex = 4\n        comfortable = 0\n    elif humidex >= 54:\n        effectHumidex = 5\n        comfortable = 0\n    \n    return humidex, effectHumidex, comfortable, []\n\n\ndef discomfortIndex(Ta, mrt, Tdp, rh, ws, SR, N, Tground, Rprim, vapourPressure, Epot, age, sex, heightCM, heightM, weight, bodyPosition, Icl, ac, acclimated, M, activityDuration, HRrates, dehydrationRiskRates, climate):\n    # inputs: (Ta, rh):\n    # also called \"Thom's Index\"\n    # formula from: Thom, E.C. (1959): The discomfort index. Weather wise, 12: 5760.\n    DI = Ta - (0.55 - 0.0055*rh)*(Ta - 14.5)\n    \n    # categories by Kyle, 1994 in Unger, 1999\n    if DI < -40:\n        effectDI = -6\n        comfortable = 0\n    elif DI >= -40 and DI < -20:\n        effectDI = -5\n        comfortable = 0\n    elif DI >= -20 and DI < -10:\n        effectDI = -4\n        comfortable = 0\n    elif DI >= -10 and DI < -1.8:\n        effectDI = -3\n        comfortable = 0\n    elif DI >= -1.8 and DI < 13:\n        effectDI = -2\n        comfortable = 0\n    elif DI >= 13 and DI < 15:\n        effectDI = -1\n        comfortable = 0\n    elif DI >= 15 and DI < 20:\n        effectDI = 0\n        comfortable = 1\n    elif DI >= 20 and DI < 26.5:\n        effectDI = 1\n        comfortable = 0\n    elif DI >= 26.5 and DI < 30:\n        effectDI = 2\n        comfortable = 0\n    elif DI >= 30:\n        effectDI = 3\n        comfortable = 0\n    \n    return DI, effectDI, comfortable, []\n\n\ndef windChillIndex(Ta, mrt, Tdp, rh, ws, SR, N, Tground, Rprim, vapourPressure, Epot, age, sex, heightCM, heightM, weight, bodyPosition, Icl, ac, acclimated, M, activityDuration, HRrates, dehydrationRiskRates, climate):\n    # inputs: (Ta, ws):\n    # formula by Gregorczuk 1976\n    WCI = (10*math.sqrt(ws) + 10.45 - ws)*(33 - Ta)*1.163\n    \n    # Thermal sensations of man wearing clothing with insulation of 4 clo (heavy polar equipment):\n    if WCI >= 2326:\n        effectWCI = -4\n        comfortable = 0\n    elif WCI < 2326 and WCI >= 1628.2:\n        effectWCI = -3\n        comfortable = 0\n    elif WCI < 1628.2 and WCI >= 930.4:\n        effectWCI = -2\n        comfortable = 0\n    elif WCI < 930.4 and WCI >= 581.5:\n        effectWCI = -1\n        comfortable = 0\n    elif WCI < 581.5 and WCI >= 232.6:\n        effectWCI = 0\n        comfortable = 1\n    elif WCI < 232.6 and WCI >= 116.3:\n        effectWCI = 1\n        comfortable = 0\n    elif WCI < 116.3 and WCI >= 58.3:\n        effectWCI = 2\n        comfortable = 0\n    elif WCI < 58.3:\n        effectWCI = 3\n        comfortable = 0\n    \n    return WCI, effectWCI, comfortable, []\n\n\ndef windChillTemperature(Ta, mrt, Tdp, rh, ws, SR, N, Tground, Rprim, vapourPressure, Epot, age, sex, heightCM, heightM, weight, bodyPosition, Icl, ac, acclimated, M, activityDuration, HRrates, dehydrationRiskRates, climate):\n    # inputs: (Ta, ws):\n    # formula by Environment Canada (corresponds to National Weather Service (NSW) Wind chill formula used in U.S.)\n    ws_km_h = ws * 3.6   # convert m/s to km/h wind speed\n    \n    Twc = 13.12 + 0.6215*Ta - 11.37*(ws_km_h**0.16) + 0.3965*Ta*(ws_km_h**0.16)   # in Celius degrees\n    \n    if Twc >= 0:\n        effectTwc = 0\n        comfortable = 1\n    elif Twc < 0 and Twc >= -9:\n        effectTwc = -1\n        comfortable = 0\n    elif Twc < -9 and Twc >= -27:\n        effectTwc = -2\n        comfortable = 0\n    elif Twc < -27 and Twc >= -39:\n        effectTwc = -3\n        comfortable = 0\n    elif Twc < -39 and Twc >= -47:\n        effectTwc = -4\n        comfortable = 0\n    elif Twc < -47 and Twc >= -54:\n        effectTwc = -5\n        comfortable = 0\n    elif Twc < -54:\n        effectTwc = -6\n        comfortable = 0\n    \n    return Twc, effectTwc, comfortable, []\n\n\ndef effectiveTemperature(Ta, mrt, Tdp, rh, ws, SR, N, Tground, Rprim, vapourPressure, Epot, age, sex, heightCM, heightM, weight, bodyPosition, Icl, ac, acclimated, M, activityDuration, HRrates, dehydrationRiskRates, climate):\n    # inputs: (Ta, ws, rh, SR, ac):\n    if ws <= 0.2:\n        # formula by Missenard\n        TE = Ta - 0.4*(Ta - 10)*(1-rh/100)\n    elif ws > 0.2:\n        # modified formula by Gregorczuk (WMO, 1972; Hentschel, 1987)\n        TE = 37 - ( (37-Ta)/(0.68-(0.0014*rh)+(1/(1.76+1.4*(ws**0.75)))) ) - (0.29 * Ta * (1-0.01*rh))\n    \n    # Radiative-effective temperature\n    TRE = TE + ((1 - 0.01*ac)*SR) * ((0.0155 - 0.00025*TE) - (0.0043 - 0.00011*TE))\n    \n    if TRE < 1:\n        effectTE = -4\n        comfortable = 0\n    elif TRE >= 1 and TE < 9:\n        effectTE = -3\n        comfortable = 0\n    elif TRE >= 9 and TE < 17:\n        effectTE = -2\n        comfortable = 0\n    elif TRE >= 17 and TE < 21:\n        effectTE = -1\n        comfortable = 0\n    elif TRE >= 21 and TE < 23:\n        effectTE = 0\n        comfortable = 1\n    elif TRE >= 23 and TE < 27:\n        effectTE = 1\n        comfortable = 0\n    elif TRE >= 27:\n        effectTE = 2\n        comfortable = 0\n    \n    return TRE, effectTE, comfortable, []\n\n\ndef apparentTemperature(Ta, mrt, Tdp, rh, ws, SR, N, Tground, Rprim, vapourPressure, Epot, age, sex, heightCM, heightM, weight, bodyPosition, Icl, ac, acclimated, M, activityDuration, HRrates, dehydrationRiskRates, climate):\n    # inputs: (Ta, ws, rh):\n    \n    e = (rh/100) * 6.105 * math.exp((17.27*Ta)/(237.7+Ta))\n    AT = Ta + (0.33*e) - (0.70*ws) - 4.00\n    \n    # Apparel effects by: Norms of apparent temperature in Australia, Aust. Met. Mag., 1994, Vol 43, 1-16:\n    if AT > 40:\n        effectAT = 4\n        comfortable = 0\n    elif AT > 35 and AT <= 40:\n        effectAT = 3\n        comfortable = 0\n    elif AT > 30 and AT <= 35:\n        effectAT = 2\n        comfortable = 0\n    elif AT > 25 and AT <= 30:\n        effectAT = 1\n        comfortable = 0\n    elif AT > 20 and AT <= 25:\n        effectAT = 0\n        comfortable = 1\n    elif AT > 15 and AT <= 20:\n        effectAT = -1\n        comfortable = 0\n    elif AT > 10 and AT <= 15:\n        effectAT = -2\n        comfortable = 0\n    elif AT > 5 and AT <= 10:\n        effectAT = -3\n        comfortable = 0\n    elif AT > 0 and AT <= 5:\n        effectAT = -4\n        comfortable = 0\n    elif AT > -5 and AT <= 0:\n        effectAT = -5\n        comfortable = 0\n    elif AT <= -5:\n        effectAT = -6\n        comfortable = 0\n    \n    return AT, effectAT, comfortable, []\n\n\ndef thermalSensation(Ta, mrt, Tdp, rh, ws, SR, N, Tground, Rprim, vapourPressure, Epot, age, sex, heightCM, heightM, weight, bodyPosition, Icl, ac, acclimated, M, activityDuration, HRrates, dehydrationRiskRates, climate):\n    # inputs: (Ta, ws, rh, SR, Tground):\n    # formula from: Givoni, Noguchi, Issues and problems in outdoor comfort research, in: Proceedings of the PLEA2000 Conference, Cambridge, UK, July 2000\n    TS=1.7+0.1118*Ta+0.0019*SR-0.322*ws-0.0073*rh+0.0054*Tground\n    \n    if TS < 2:\n        effectTS = -3\n        comfortable = 0\n    elif TS >= 2 and TS < 3:\n        effectTS = -2\n        comfortable = 0\n    elif TS >= 3 and TS < 4:\n        effectTS = -1\n        comfortable = 0\n    elif TS >= 4 and TS < 5:\n        effectTS = 0\n        comfortable = 1\n    elif TS >= 5 and TS < 6:\n        effectTS = 1\n        comfortable = 0\n    elif TS >= 6 and TS < 7:\n        effectTS = 2\n        comfortable = 0\n    elif TS >= 7:\n        effectTS = 3\n        comfortable = 0\n    \n    return TS, effectTS, comfortable, []\n\n\ndef actualSensationModel(Ta, mrt, Tdp, rh, ws, SR, N, Tground, Rprim, vapourPressure, Epot, age, sex, heightCM, heightM, weight, bodyPosition, Icl, ac, acclimated, M, activityDuration, HRrates, dehydrationRiskRates, climate):\n    # inputs: (Ta, ws, rh, SR):\n    # Actual Sensation Model for whole Europe \n    # formula by RUROS project.\n    ASV = 0.049*Ta + 0.001*SR - 0.051*ws + 0.014*rh - 2.079\n    \n    # Classification of human thermal sensation according to TS levels and ASV scale\n    # Givoni and Noguchi, 2000; Nikolopoulou et al., 2004\n    if ASV < -2:\n        effectASV = -2\n        comfortable = 0\n    elif ASV >= -2 and ASV < -1:\n        effectASV = -1\n        comfortable = 0\n    elif ASV >= -1 and ASV <= 1:\n        effectASV = 0\n        comfortable = 1\n    elif ASV > 1 and ASV <= 2:\n        effectASV = 1\n        comfortable = 0\n    elif ASV > 2:\n        effectASV = 2\n        comfortable = 0\n    \n    return ASV, effectASV, comfortable, []\n\n\ndef noaaSolarCalculator(latitude, longitude, timeZone, month, day, hour):\n    # by NOAA Earth System Research Laboratory\n    # NOAA defines longitude and time zone as positive to the west:\n    timeZone = -timeZone\n    longitude = -longitude\n    DOY = int(lb_preparation.getJD(month, day))\n    minute = 0  # default\n    second = 0  # default\n    gamma = (2*math.pi)/365*(DOY-1+((hour-12)/24))\n    eqtime = 229.18*(0.000075 + 0.001868*math.cos(gamma) - 0.032077*math.sin(gamma) - 0.014615*math.cos(2*gamma) - 0.040849*math.sin(2*gamma))\n    declAngle = 0.006918 - 0.399912*math.cos(gamma) + 0.070257*math.sin(gamma) - 0.006758*math.cos(2*gamma) + 0.000907*math.sin(2*gamma) - 0.002697*math.cos(3*gamma) + 0.00148*math.sin(3*gamma)\n    time_offset = eqtime-4*longitude+60*timeZone\n    tst = hour *60 + minute + second / 60 + time_offset\n    solarHangle = (tst / 4) - 180\n    \n    # solar zenith angle\n    solarZenithR = math.acos(math.sin(math.radians(latitude)) * math.sin(declAngle) + math.cos(math.radians(latitude)) * math.cos(declAngle) * math.cos(math.radians(solarHangle)))\n    solarZenithD = math.degrees(solarZenithR)\n    if solarZenithD > 90:\n        solarZenithD = 90\n    elif solarZenithD < 0:\n        solarZenithD = 0\n    \n    # solar altitude angle\n    solarAltitudeD = 90 - solarZenithD\n    \n    # solar azimuth angle\n    solarAzimuthR = - (math.sin(math.radians(latitude)) * math.cos(solarZenithR) - math.sin(declAngle)) / (math.cos(math.radians(latitude)) * math.sin(solarZenithR))\n    solarAzimuthR = math.acos(solarAzimuthR)\n    solarAzimuthD = math.degrees(solarAzimuthR)\n    \n    return solarZenithD, solarAzimuthD, solarAltitudeD\n\n\ndef solarRadiationNudeMan(Kglob, hSl, ac):\n    # formula from: Bioclimatic principles of recreation and tourism in Poland, 2nd edition, Blazejczyk, Kunert, 2011 (MENEX_2005 model)\n    Kt = Kglob / (-0.0015*(hSl**3) + 0.1796*(hSl**2) + 9.6375*hSl - 11.9)\n    \n    ac_ = 1 - 0.01*ac\n    \n    # Rprim - solar radiation absorbed by nude man (W/m2)\n    if hSl <= 12:\n        Rprim = ac_*(0.0014*(Kglob**2) + 0.476*Kglob - 3.8)\n    elif hSl > 12 and Kt <= 0.8:\n        Rprim = 0.2467*ac_*(Kglob**0.9763)\n    elif hSl > 12 and Kt >0.8 and Kt <=1.05:\n        Rprim = 3.6922*ac_*(Kglob**0.5842)\n    elif hSl > 12 and Kt > 1.05 and Kt <=1.2:\n        Rprim = 43.426*ac_*(Kglob**0.2326)\n    elif hSl > 12 and Kt >1.2:\n        Rprim = 8.9281*ac_*(Kglob**0.4861)\n        \n    if Rprim < 0:\n        Rprim = 0\n    \n    return Rprim\n\n\ndef groundTemperature(Ta, N):\n    # formula from: Assessment of bioclimatic differentiation of Poland. Based on the human heat balance, Geographia Polonica, Matzarakis, Blazejczyk, 2007\n    N100 = N *10 #converting weather data totalSkyCover from 0 to 10% to 0 to 100%\n    \n    if (N100 == None) or (N100 >= 80):\n        Tground = Ta\n    elif (N100 < 80) and (Ta >= 0):\n        Tground = 1.25*Ta\n    elif (N100 < 80) and (Ta < 0):\n        Tground = 0.9*Ta\n    \n    return Tground\n\n\ndef VapourPressure(Ta, rh):\n    # formula by ITS-90 formulations for vapor pressure, frostpoint temperature, dewpoint temperature, and enhancement factors in the range 100 to +100 c, Thunder Scientific Corporation, Albuquerque, NM, Bob Hardy\n    TaK = Ta + 273.15   # convert to Kelvins\n    \n    TS90coefficients = [-2.8365744*(10**(3)), -6.028076559*(10**(3)), 1.954263612*(10**(1)), -2.737830188*(10**(-2)), 1.6261698*(10**(-5)), 7.0229056*(10**(-10)), -1.8680009*(10**(-13)), 2.7150305]\n    e_s = TS90coefficients[7]*math.log(TaK)\n    \n    for i in range(7):\n        e_s += TS90coefficients[i]*(TaK**(i-2))\n    \n    es = math.exp(e_s)  # in Pa\n    \n    es = (es*0.01*rh)/100  # convert to hPa\n    \n    return es\n\n\ndef meanRadiantTemperature(Ta, mrt, Tdp, rh, ws, SR, N, Tground, Rprim, vapourPressure, Epot, age, sex, heightCM, heightM, weight, bodyPosition, Icl, ac, acclimated, M, activityDuration, HRrates, dehydrationRiskRates, climate):\n    # inputs: (Ta, Tground, Rprim, e, N):\n    # formula by Man-ENvironment heat EXchange model (MENEX_2005)\n    \n    La = 5.5*(10**(-8)) *((273 + Ta)**(4)) *(0.82 - 0.25*(10**(-0.094*0.75*vapourPressure))) * (1 + 0.22*((N/10)**2.75))  # incoming long-wave radiation emitted from the sky hemisphere, in W/m2\n    Lg = 5.5 *(10**(-8)) * ((273 + Tground)**(4))  # outgoing long-wave radiation emitted by the ground, in W/m2\n    \n    MRT = (((Rprim + 0.5*Lg + 0.5*La) / (0.95*5.667*(10**(-8))))**(0.25)) - 273  # in C\n    \n    return MRT, \"dummyCategory\", \"dummyComfortableOrNot\", []\n\n\ndef meanRadiantTemperature2(Ta, Tground, Rprim, e, N):\n    # formula by Man-ENvironment heat EXchange model (MENEX_2005)\n    \n    La = 5.5*(10**(-8)) *((273 + Ta)**(4)) *(0.82 - 0.25*(10**(-0.094*0.75*e))) * (1 + 0.22*((N/10)**2.75))  # incoming long-wave radiation emitted from the sky hemisphere, in W/m2\n    Lg = 5.5 *(10**(-8)) * ((273 + Tground)**(4))  # outgoing long-wave radiation emitted by the ground, in W/m2\n    \n    MRT = (((Rprim + 0.5*Lg + 0.5*La) / (0.95*5.667*(10**(-8))))**(0.25)) - 273  # in C\n    \n    return MRT\n\n\ndef wbgt_indoors(Ta, mrt, Tdp, rh, ws, SR, N, Tground, Rprim, vapourPressure, Epot, age, sex, heightCM, heightM, weight, bodyPosition, Icl, ac, acclimated, M, activityDuration, HRrates, dehydrationRiskRates, climate):\n    # inputs: (Ta, ws, rh, e, MRT, Tdp):\n    # WBGT indoor formula by Bernard\n    # formula from: \"Calculating Workplace WBGT from Meteorological Data: A Tool for Climate Change Assessment\", Lemke, Kjellstrom, 2012\n    # natural wet bulb temperature based on code written by Nick Burns: https://github.com/nickb-/Calculating-WBGT/blob/master/relaxation_Tw/working_code/wbgt.R\n    \n    ed = 0.6106 * math.exp(17.27 * Tdp / (237.7 + Tdp))\n    step = 0.02  # lowering the step value increases precision\n    Tpwb = Tdp + step\n    McPherson_1 = 1\n    McPherson_2 = 1\n    while Tpwb <= Ta and ((McPherson_1 > 0 and McPherson_2 > 0) or (McPherson_1 < 0 and McPherson_2 <0)):\n        ew = 0.6106 * math.exp(17.27 * Tpwb / (237.7 + Tpwb))\n        McPherson_1 = McPherson_2\n        McPherson_2 = 1556*ed - 1.484*ed*Tpwb - 1556*ew + 1.484*ew*Tpwb + 101*(Ta - Tpwb)\n        Tpwb = Tpwb + step\n    \n    if (ws > 3):\n        WBGTid = 0.7*Tpwb + 0.3*Ta\n    elif (ws >= 0.3) and (ws <= 3):\n        WBGTid = 0.67 * Tpwb + 0.33 * Ta - 0.048*math.log10(ws) * (Ta - Tpwb)\n    elif (ws < 0.3):\n        ws = 0.3\n        WBGTid = 0.67 * Tpwb + 0.33 * Ta - 0.048*math.log10(ws) * (Ta - Tpwb)\n    WBGT_f = celsiusToFahrenheit(WBGTid)\n    \n    # Suggested actions and Impact Prevention by Environmental Health Section, Dwight D. Eisenhower Medical Center:\n    if WBGT_f < 80:\n        effectWBGT = 0\n        comfortable = 1\n    elif WBGT_f >= 80 and WBGT_f < 82:\n        effectWBGT = 1\n        comfortable = 0\n    elif WBGT_f >= 82 and WBGT_f < 85:\n        effectWBGT = 2\n        comfortable = 0\n    elif WBGT_f >=85 and WBGT_f < 88:\n        effectWBGT = 3\n        comfortable = 0\n    elif WBGT_f >=88 and WBGT_f < 90:\n        effectWBGT = 4\n        comfortable = 0\n    elif WBGT_f >= 90:\n        effectWBGT = 5\n        comfortable = 0\n    \n    return WBGTid, effectWBGT, comfortable, []\n\n\ndef wbgt_outdoors(Ta, MRT, Tdp, rh, ws, SR, N, Tground, Rprim, vapourPressure, Epot, age, sex, heightCM, heightM, weight, bodyPosition, Icl, ac, acclimated, M, activityDuration, HRrates, dehydrationRiskRates, climate):\n    # inputs: (Ta, ws, rh, e, MRT):\n    # WBGT outdoor formula from Heat stress and occupational health and safety  spatial and temporal differentiation, K. Blazejczyk, J.Baranowski, A. Blazejczyk, Miscellanea geographica  regional studies on development, Vol. 18, No. 1, 2014, \n    Tw = 1.885 + 0.3704*Ta + 0.4492*vapourPressure\n    Tg = 2.098 - 2.561*ws + 0.5957*Ta + 0.4017*MRT\n    WBGTout = 0.7*Tw + 0.2*Tg + 0.1*Ta\n    WBGT_f = celsiusToFahrenheit(WBGTout)\n    \n    # Suggested actions and Impact Prevention by Environmental Health Section, Dwight D. Eisenhower Medical Center:\n    if WBGT_f < 80:\n        effectWBGT = 0\n        comfortable = 1\n    elif WBGT_f >= 80 and WBGT_f < 82:\n        effectWBGT = 1\n        comfortable = 0\n    elif WBGT_f >= 82 and WBGT_f < 85:\n        effectWBGT = 2\n        comfortable = 0\n    elif WBGT_f >=85 and WBGT_f < 88:\n        effectWBGT = 3\n        comfortable = 0\n    elif WBGT_f >=88 and WBGT_f < 90:\n        effectWBGT = 4\n        comfortable = 0\n    elif WBGT_f >= 90:\n        effectWBGT = 5\n        comfortable = 0\n    \n    return WBGTout, effectWBGT, comfortable, []\n\n\ndef predictedInsulationIndexOfClothing(Ta, mrt, Tdp, rh, ws, SR, N, Tground, Rprim, vapourPressure, Epot, age, sex, heightCM, heightM, weight, bodyPosition, Icl, ac, acclimated, M, activityDuration, HRrates, dehydrationRiskRates, climate):\n    # inputs: (Ta, ws, M):\n    # total insulation of clothing and the surrounding air layer by Burton and Edholm (1955)\n    It = (0.082*(91.4 - (1.8*Ta + 32)) / (0.01724*M))\n    # insulation of the surrounded air layer by Fourt and Hollies (1970)\n    Ia = 1/(0.61+1.9*(ws**0.5))\n    \n    Iclp = It - Ia  # in clo\n    \n    if Iclp > 4.0:\n        effectIclp = -4\n        comfortable = 1\n    elif Iclp > 3.0 and Iclp <= 4.0:\n        effectIclp = -3\n        comfortable = 0\n    elif Iclp > 2.0 and Iclp <= 3.0:\n        effectIclp = -2\n        comfortable = 0\n    elif Iclp > 1.20 and Iclp <= 2.0:\n        effectIclp = -1\n        comfortable = 0\n    elif Iclp > 0.80 and Iclp <= 1.20:\n        effectIclp = 0\n        comfortable = 1\n    elif Iclp > 0.30 and Iclp <= 0.80:\n        effectIclp = 1\n        comfortable = 0\n    elif Iclp <= 0.30:\n        effectIclp = 2\n        comfortable = 0\n    \n    if Iclp < 0.5: Iclp = 0.5  # summer clothes (light trousers, short sleeves or blouse)\n    if Iclp > 4.1: Iclp = 4.1  # heavy polar outfit (fur pants, coat, hood, gloves...)\n    \n    return Iclp, effectIclp, comfortable, []\n\n\ndef heartRates(age, sex):\n    #Resting Heart Rates for Man taken from: http://www.topendsports.com/testing/heart-rate-resting-chart.htm\n    if sex == \"male\":\n        if age <= 25:\n            HRrates = [73,82,90]\n        elif age > 25 and age <= 35:\n            HRrates = [74,82,90]\n        elif age > 35 and age <= 45:\n            HRrates = [75,83,90]\n        elif age > 45 and age <= 55:\n            HRrates = [76,84,90]\n        elif age > 55 and age <= 65:\n            HRrates = [75,82,90]\n        elif age > 65:\n            HRrates = [73,80,90]\n    elif sex == \"female\":\n        if age <= 25:\n            HRrates = [78,85,90]\n        elif age > 25 and age <= 35:\n            HRrates = [76,83,90]\n        elif age > 35 and age <= 45:\n            HRrates = [78,85,90]\n        elif age > 45 and age <= 55:\n            HRrates = [77,84,90]\n        elif age > 55 and age <= 65:\n            HRrates = [77,84,90]\n        elif age > 65:\n            HRrates = [76,84,90]\n    elif sex == \"average sex\":\n        # average sex values ((\"male\" + \"female\")/2)\n        if age <= 25:\n            HRrates = [75.5, 83.5,90]\n        elif age > 25 and age <= 35:\n            HRrates = [75,82.5,90]\n        elif age > 35 and age <= 45:\n            HRrates = [76.5,84,90]\n        elif age > 45 and age <= 55:\n            HRrates = [76.5,84,90]\n        elif age > 55 and age <= 65:\n            HRrates = [76,83,90]\n        elif age > 65:\n            HRrates = [74.5,82,90]\n    \n    return HRrates\n\n\ndef heartRate(Ta, mrt, Tdp, rh, ws, SR, N, Tground, Rprim, vapourPressure, Epot, age, sex, heightCM, heightM, weight, bodyPosition, Icl, ac, acclimated, M, activityDuration, HRrates, dehydrationRiskRates, climate):\n    # inputs: (Ta, vapourPressure, M, HRrates):\n    #formula by Fuller, Brouha 1966\n    HR = 22.4 + 0.18*M + 0.25*(5*Ta + 2.66*vapourPressure)\n    HR = int(round(HR))\n    \n    if HR < HRrates[0]:\n        effectHR = 0\n        comfortable = 1\n    elif HR >= HRrates[0] and HR < HRrates[1]:\n        effectHR = 1\n        comfortable = 0\n    elif HR >= HRrates[1] and HR < HRrates[2]:\n        effectHR = 2\n        comfortable = 0\n    elif HR >= HRrates[2]:\n        effectHR = 3\n        comfortable = 0\n    \n    return HR, effectHR, comfortable, []\n\n\ndef clothingInsulation(Ta):\n    # by MENEX_2005 model\n    if Ta > 25:\n        Icl = 0.5  # summer clothes\n    else:\n        Icl = 1.691 - 0.0436*Ta\n    \n    if Icl > 4:\n        Icl = 4.1  # Heavy polar outfit\n    \n    return Icl\n\n\ndef meanSkinTemperature(Ta, ws, rh, MRT, Icl, M):\n    \n    Ts = (26.4 + 0.02138*MRT + 0.2095*Ta - 0.0185*rh - 0.009*ws) + 0.6*(Icl - 1) + 0.00128*M\n    return Ts  # in C\n\n\ndef turbulentExchangeOfLatentHeat(Ta, ws, Ts, Icl, e_, M):\n    # Turbulent exchange of latent heat (evaporation - mE) in W/m2\n    \n    p = 1000  # barometricpressure in hPa, default value\n    he = Ta*(6*(10**(-5))*Ta - 2*(10**(-5))*p + 0.011) + 0.02*p - 0.773\n    \n    hc = 0.013*p - 0.04*Ta - 0.503\n    \n    vprim = 1.1 #m/s default value (for man movement 4km/h)\n    d = math.sqrt(ws+vprim)\n    \n    if Ts < 22:\n        w = 0.002\n    elif Ts >= 22 and Ts <= 36.5:\n        w = 1.031/(37.5-Ts)- 0.065\n    elif Ts > 36.5:\n        w = 1.0\n    \n    if ws >= 0.2:\n        vcor = ws\n    elif ws < 0.2:\n        vcor = 0.2\n    d_ = 0.53/ (Icl *(1-0.27*math.exp(0.4*math.log(vcor+vprim))))\n    Ie = hc*d_ / (hc*(d + d_))\n    \n    esk = math.exp(0.058*Ts + 2.003)\n    \n    mE = he*d*w*Ie*(e_-esk) - 0.42*(M - 58.0) + 5.04\n    \n    return mE\n\n\ndef DehydrationRiskRates(acclimated):\n    if acclimated == \"acclimated\":\n        dehydrationRiskRates = [780,1040]\n    elif acclimated == \"unacclimated\":\n        dehydrationRiskRates = [520,650]\n    \n    return dehydrationRiskRates\n\n\ndef dehydrationRisk(Ta, mrt, Tdp, rh, ws, SR, N, Tground, Rprim, vapourPressure, Epot, age, sex, heightCM, heightM, weight, bodyPosition, Icl, ac, acclimated, M, activityDuration, HRrates, dehydrationRiskRates, climate):\n    # inputs: (Epot, dehydrationRiskRates):\n    # formula from MENEX_2005 model\n    # water loss\n    SW = -2.6*Epot  # in g/hour\n    \n    if SW < dehydrationRiskRates[0]:\n        effectSW = 0\n        comfortable = 1\n    elif SW >= dehydrationRiskRates[0] and SW <= dehydrationRiskRates[1]:\n        effectSW = 1\n        comfortable = 0\n    elif SW > dehydrationRiskRates[1]:\n        effectSW = 2\n        comfortable = 0\n    \n    return SW, effectSW, comfortable, []\n\n\ndef physiologicalEquivalentTemperature(Ta, mrt, Tdp, rh, ws, SR, N, Tground, Rprim, vapourPressure, Epot, age, sex, heightCM, heightM, weight, bodyPosition, Icl, ac, acclimated, M, activityDuration, HRrates, dehydrationRiskRates, climate):\n    # inputs: (climate, Ta, ws, rh, MRT, age, sex, heightM, weight, bodyPosition, M, Icl):\n    # based on: Peter Hoeppe PET fortran code, from:\n    # \"Urban climatic map and standards for wind environment - Feasibility study, Technical Input Report No.1\",\n    # The Chinese University of Hong Kong, Planning Department, Nov 2008\n    \n    petObj = lb_comfortModels.physiologicalEquivalentTemperature(Ta, mrt, rh, ws, age, sex, heightM, weight, bodyPosition, M, Icl)\n    respiration = petObj.inkoerp()\n    coreTemperature, radiationBalance, convection, waterVaporDiffusion = petObj.berech()\n    petObj.pet()\n    skinTemperature, totalHeatLoss, skinSweating, internalHeat, sweatEvaporation, PET = petObj.tsk, petObj.wsum, petObj.wetsk, petObj.h, petObj.esw, petObj.tx\n    effectPET, comfortablePET = petObj.thermalCategories(climate)\n    \n    PETresults = [coreTemperature, skinTemperature, totalHeatLoss, skinSweating, internalHeat, radiationBalance, convection, waterVaporDiffusion, sweatEvaporation, respiration]\n    \n    return PET, effectPET, comfortablePET, PETresults\n\n\ndef temperatureHumidityIndex(Ta, mrt, Tdp, rh, ws, SR, N, Tground, Rprim, vapourPressure, Epot, age, sex, heightCM, heightM, weight, bodyPosition, Icl, ac, acclimated, M, activityDuration, HRrates, dehydrationRiskRates, climate):\n    # inputs: (Ta, Tdp):\n    # formula and categories based on: Taiwan's Central Weather Bureau\n    THI = Ta - 0.55 * (1-math.exp((17.269*Tdp)/(Tdp+237.3)-(17.269*Ta)/(Ta+237.3))) * (Ta-14)  # Taiwan's Central Weather Bureau Comfort Index\n    \n    if THI < 11:\n        effectTHI = -3\n        comfortable = 0\n    elif THI >= 11 and THI < 16:\n        effectTHI = -2\n        comfortable = 0\n    elif THI >= 16 and THI < 20:\n        effectTHI = -1\n        comfortable = 0\n    elif THI >= 20 and THI < 27:\n        effectTHI = 0\n        comfortable = 1\n    elif THI >= 27 and THI < 31:\n        effectTHI = 1\n        comfortable = 0\n    elif THI >= 31:\n        effectTHI = 2\n        comfortable = 0\n    \n    return THI, effectTHI, comfortable, []\n\n\ndef predictedHeatStrain(Ta, mrt, Tdp, rh, ws, SR, N, Tground, Rprim, vapourPressure, Epot, age, sex, heightCM, heightM, weight, bodyPosition, Icl, ac, acclimated, Met, activityDuration, HRrates, dehydrationRiskRates, climate):\n    # inputs: (Ta, mrt, ws, vapourPressure, heightM, weight, bodyPosition, Icl, acclimated, Met, activityDuration):\n    # based on: Dr. Jacques Malchaire Quick Basic code from:\n    # \"Ergonomics of the thermal environment - Analytical determination and interpretation of heat stress using calculation of predicted heat strain\", ISO 7933, 2004\n    \n    drink = 1  # if drink = 1: water replacement is sufficient, and workers can drink freely; otherwise: drink = 0\n    if acclimated == \"acclimated\":  # 100 if acclimatised person, 0 if unacclimatised person\n        accl = 100\n    elif acclimated == \"unacclimated\":\n        accl = 0\n    \n    # Effective radiating area of the body (1 = sitting, 2 = standing, 3 = crouching)\n    if bodyPosition == \"sitting\":\n        Ardu = 0.7  # dimensionless\n    elif bodyPosition == \"standing\":\n        Ardu = 0.77  # dimensionless\n    elif bodyPosition == \"crouching\":\n        Ardu = 0.67  # dimensionless\n    \n    Pa = vapourPressure * 0.1  # partial water vapour pressure, converted from hectopascals to kilopascals\n    Work = 0  # effective mechanical power, in W/m2\n    imst = 0.38  # static moisture permeability index, dimensionless\n    Ap = 0.54  # fraction of the body surface covered by the reflective clothing, dimensionless\n    Fr = 0.97  # emissivity of the reflective clothing, dimensionless\n    # walking\n    defspeed = 1  # 1 if walking speed entered, 0 otherwise\n    Walksp = 0  # walking speed, in m/s\n    defdir = 1  # 1 if walking direction entered, 0 otherwise\n    THETA = 0  # angle between walking direction and wind direction degrees\n    \n    Adu = 0.202 * weight ** 0.425 * heightM ** 0.725  # body surface area in m2\n    spHeat = 57.83 * weight / Adu\n    \n    SWp = 0\n    SWtot = 0; Tre = 36.8; Tcr = 36.8; Tsk = 34.1; Tcreq = 36.8; TskTcrwg = 0.3\n    Dlimtre = 0; Dlimloss50 = 0; Dlimloss95 = 0\n    Dmax50 = 0.075 * weight * 1000\n    Dmax95 = 0.05 * weight * 1000\n    \n    # EXPONENTIAL AVERAGING CONSTANTS\n    # Core temperature as a function of the metabolic rate: time constant: 10 minutes\n    ConstTeq = math.exp(-1 / 10)\n    # Skin Temperature: time constant: 3 minutes\n    ConstTsk = math.exp(-1 / 3)\n    # Sweat rate: time constant: 10 minutes\n    ConstSW = math.exp(-1 / 10)\n    \n    for time in range(1, activityDuration+1):  # activityDuration - the duration of the work sequence in minutes\n        # INITIALISATION MIN PER MIN\n        Tsk0 = Tsk; Tre0 = Tre; Tcr0 = Tcr; Tcreq0 = Tcreq; TskTcrwg0 = TskTcrwg\n        \n        # EVALUATION OF THE MAXIMUM SWEAT RATE AS A FUNCTION OF THE METABOLIC RATE\n        SWmax = (Met - 32) * Adu\n        if SWmax > 400: SWmax = 400\n        if SWmax < 250: SWmax = 250\n        # For acclimatised subjects (accl=100), the maximum Sweat Rate is greater by 25%\n        if accl >= 50: SWmax = SWmax * 1.25\n        if accl < 50: Wmax = 0.85\n        else: Wmax = 1\n        \n        # EQUILIBRIUM CORE TEMPERATURE ASSOCIATED TO THE METABOLIC RATE\n        Tcreqm = 0.0036 * Met + 36.6\n        # Core temperature at this minute, by exponential averaging\n        Tcreq = Tcreq0 * ConstTeq + Tcreqm * (1 - ConstTeq)\n        # Heat storage associated with this core temperature increase during the last minute\n        dStoreq = spHeat * (Tcreq - Tcreq0) * (1 - TskTcrwg0)\n        \n        # SKIN TEMPERATURE PREDICTION\n        # Skin Temperature in equilibrium\n        # Clothed model\n        Tskeqcl = 12.165 + 0.02017 * Ta + 0.04361 * mrt + 0.19354 * Pa - 0.25315 * ws\n        Tskeqcl = Tskeqcl + 0.005346 * Met + 0.51274 * Tre\n        # Nude model\n        Tskeqnu = 7.191 + 0.064 * Ta + 0.061 * mrt + 0.198 * Pa - 0.348 * ws\n        Tskeqnu = Tskeqnu + 0.616 * Tre\n        # Value at this minute, as a function of the clothing insulation\n        if Icl >= 0.6: Tskeq = Tskeqcl\n        else: Tskeq = Tskeqnu + 2.5 * (Tskeqcl - Tskeqnu) * (Icl - 0.2)  # Interpolation between the values for clothed and nude subjects, if  0.2 < clo < 0.6\n        \n        if Icl <= 0.2: Tskeq = Tskeqnu\n        else: Tskeq = Tskeqnu + 2.5 * (Tskeqcl - Tskeqnu) * (Icl - 0.2)  # Interpolation between the values for clothed and nude subjects, if  0.2 < clo < 0.6\n        \n        # Skin Temperature at this minute, by exponential averaging\n        Tsk = Tsk0 * ConstTsk + Tskeq * (1 - ConstTsk)\n        # Saturated water vapour pressure at the surface of the skin\n        Psk = 0.6105 * math.exp(17.27 * Tsk / (Tsk + 237.3))\n        \n        # CLOTHING INFLUENCE ON EXCHANGE COEFFICIENTS\n        # Static clothing insulation\n        Iclst = Icl * 0.155\n        # Clothing area factor\n        fcl = 1 + 0.3 * Icl\n        # Static boundary layer thermal insulation in quiet air\n        Iast = 0.111\n        # Total static insulation\n        Itotst = Iclst + Iast / fcl\n        \n        # Relative velocities due to air velocity and movements\n        if defspeed > 0:\n            if defdir == 1:\n                # Unidirectional walking\n                Var = abs(ws - Walksp * math.cos(3.14159 * THETA / 180))\n            else:\n                # Omni-directional walking\n                if ws < Walksp:\n                    Var = Walksp\n                else: Var = ws\n        else:\n            # Stationary or undefined speed\n            Walksp = 0.0052 * (Met - 58)\n            if Walksp > 0.7:\n                Walksp = 0.7\n            Var = ws\n        \n        # Dynamic clothing insulation\n        # Clothing insulation correction for wind (Var) and walking (Walksp) \n        Vaux = Var\n        if Var > 3:\n            Vaux = 3\n        Waux = Walksp\n        if Walksp > 1.5:\n            Waux = 1.5\n        CORcl = 1.044 * math.exp((.066 * Vaux - 0.398) * Vaux + (.094 * Waux - 0.378) * Waux)\n        if CORcl > 1:\n            CORcl = 1\n        CORia = math.exp((.047 * Var - 0.472) * Var + (.117 * Waux - 0.342) * Waux)\n        if CORia > 1:\n            CORia = 1\n         \n        CORtot = CORcl\n        if Icl <= 0.6:\n            CORtot = ((.6 - Icl) * CORia + Icl * CORcl) / .6\n        \n        Itotdyn = Itotst * CORtot\n        IAdyn = CORia * Iast\n        Icldyn = Itotdyn - IAdyn / fcl\n        \n        # Permeability index\n        # Correction for wind and walking\n        CORe = (2.6 * CORtot - 6.5) * CORtot + 4.9\n        imdyn = imst * CORe\n        if imdyn > 0.9:\n            imdyn = 0.9\n        # Dynamic evaporative resistance\n        Rtdyn = Itotdyn / imdyn / 16.7\n        \n        # HEAT EXCHANGES\n        # Heat exchanges through respiratory convection and evaporation\n        # temperature of the expired air\n        Texp = 28.56 + 0.115 * Ta + 0.641 * Pa\n        Cres = 0.001516 * Met * (Texp - Ta)\n        Eres = 0.00127 * Met * (59.34 + 0.53 * Ta - 11.63 * Pa)\n        \n        # Mean temperature of the clothing: Tcl\n        # Dynamic convection coefficient\n        Z = 3.5 + 5.2 * Var\n        if Var > 1:\n            Z = 8.7 * Var ** 0.6\n        Hcdyn = 2.38 * abs(Tsk - Ta) ** 0.25\n        if Z > Hcdyn:\n            Hcdyn = Z\n        \n        auxR = 5.67E-08 * Ardu\n        FclR = (1 - Ap) * 0.97 + Ap * Fr\n        Tcl = mrt + 0.1\n        \n        for k in range(100):\n            # Radiation coefficient\n            Hr = FclR * auxR * ((Tcl + 273) ** 4 - (mrt + 273) ** 4) / (Tcl - mrt)\n            Tcl1 = ((fcl * (Hcdyn * Ta + Hr * mrt) + Tsk / Icldyn)) / (fcl * (Hcdyn + Hr) + 1 / Icldyn)\n            \n            if abs(Tcl - Tcl1) > 0.001:\n                Tcl = (Tcl + Tcl1) / 2\n                continue\n            else:\n                break\n        \n        # Convection and Radiation heat exchanges\n        Conv = fcl * Hcdyn * (Tcl - Ta)\n        Rad = fcl * Hr * (Tcl - mrt)\n        # Maximum Evaporation Rate\n        Emax = (Psk - Pa) / Rtdyn\n        # Required Evaporation Rate\n        Ereq = Met - dStoreq - Work - Cres - Eres - Conv - Rad\n         \n        # INTERPRETATION\n        # Required wettedness\n        wreq = Ereq / Emax\n        \n        # Required Sweat Rate\n        #    If no evaporation required: no sweat rate\n        if Ereq <= 0:\n            Ereq = 0; SWreq = 0;\n        else:\n            #    If evaporation is not possible, sweat rate is maximum\n            if Emax <= 0:\n                Emax = 0; SWreq = SWmax;\n            else:\n                #    If required wettedness greater than 1.7: sweat rate is maximum\n                if wreq >= 1.7:\n                    wreq = 1.7; SWreq = SWmax;\n                else:\n                    #    Required evaporation efficiency\n                    Eveff = (1 - wreq ** 2 / 2)\n                    if wreq > 1:\n                        Eveff = (2 - wreq) ** 2 / 2\n                    SWreq = Ereq / Eveff\n                    if SWreq > SWmax:\n                        SWreq = SWmax\n        \n        # Predicted Sweat Rate, by exponential averaging\n        SWp = SWp * ConstSW + SWreq * (1 - ConstSW)\n        if SWp <= 0:\n            Ep = 0; SWp = 0;\n        else:\n            # Predicted Evaporation Rate\n            k = Emax / SWp\n            wp = 1\n            if k >= 0.5:\n                wp = -k + math.sqrt(k * k + 2)\n            if wp > Wmax:\n                wp = Wmax\n            Ep = wp * Emax\n        \n        # Heat Storage\n        dStorage = Ereq - Ep + dStoreq\n        \n        # PREDICTION OF THE CORE TEMPERATURE\n        Tcr1 = Tcr0\n        for g in range(50):\n            # Skin - Core weighting\n            TskTcrwg = 0.3 - 0.09 * (Tcr1 - 36.8)\n            if TskTcrwg > 0.3:\n                TskTcrwg = 0.3\n            if TskTcrwg < 0.1:\n                TskTcrwg = 0.1\n            \n            Tcr = dStorage / spHeat + Tsk0 * TskTcrwg0 / 2 - Tsk * TskTcrwg / 2\n            Tcr = (Tcr + Tcr0 * (1 - TskTcrwg0 / 2)) / (1 - TskTcrwg / 2)\n            if abs(Tcr - Tcr1) > 0.001:\n                Tcr1 = (Tcr1 + Tcr) / 2;\n                continue\n            else:\n                break\n        \n        # PREDICTION OF THE CENTRAL (RECTAL) TEMPERATURE\n        Tre = Tre0 + (2 * Tcr - 1.962 * Tre0 - 1.31) / 9  # in Celsius degrees\n        \n        if Dlimtre == 0 and Tre >= 38: Dlimtre = time\n        # Total water loss rate during the minute (in W/m2)\n        SWtot = SWtot + SWp + Eres\n        SWtotg = SWtot * 2.67 * Adu / 1.8 / 60\n        \n        if Dlimloss50 == 0 and SWtotg >= Dmax50: Dlimloss50 = time\n        if Dlimloss95 == 0 and SWtotg >= Dmax95: Dlimloss95 = time\n        if drink == 0:\n            Dlimloss95 = Dlimloss95 * 0.6;\n            Dlimloss50 = Dlimloss95\n        continue\n    \n    if Dlimloss50 == 0:\n        Dlimloss50 = activityDuration\n    if Dlimloss95 == 0:\n        Dlimloss95 = activityDuration\n    if Dlimtre == 0:\n        Dlimtre = activityDuration\n    \n    PHSresults = [SWtotg, Dlimloss95, Dlimtre]\n    \n    \n    if (Dlimloss95 >= activityDuration) and (Dlimtre >= activityDuration):\n        effectPHS = 0\n        comfortable = 1\n    elif (Dlimtre <= 30) or (Dlimloss95 <= 30):\n        effectPHS = 4\n        comfortable = 0\n    elif ((Dlimtre > 30) and (Dlimtre <= 120)) or ((Dlimloss95 > 30) and (Dlimloss95 <= 120)):\n        effectPHS = 3\n        comfortable = 0\n    elif ((Dlimtre > 120) and (Dlimtre < (activityDuration - activityDuration*0.015))) or ((Dlimloss95 > 120) and (Dlimloss95 < (activityDuration - activityDuration*0.015))):\n        effectPHS = 2\n        comfortable = 0\n    elif ((Dlimtre >= (activityDuration - activityDuration*0.015)) and (Dlimtre < activityDuration)) or ((Dlimloss95 >= (activityDuration - activityDuration*0.015)) and (Dlimloss95 < activityDuration)):\n        effectPHS = 1\n        comfortable = 0\n    \n    return Tre, effectPHS, comfortable, []\n\n\ndef HOYsDaysMonthsHoursFromHOY_analysisPeriod(HOY, analysisPeriod):\n    if (len(HOY) != 0):\n        HOYs = HOY\n        HOYs.sort()\n        startingDay, startingMonth, startingHour = lb_preparation.hour2Date(min(HOYs),True)\n        endingDay, endingMonth, endingHour = lb_preparation.hour2Date(max(HOYs),True)\n        \n        newAnalysisPeriod = [(startingMonth+1, startingDay, startingHour),(endingMonth+1, endingDay, endingHour)]\n    \n    elif (len(HOY) == 0) and (len(analysisPeriod) != 0) and (analysisPeriod[0] != None):\n        startingDate = analysisPeriod[0]\n        endingDate = analysisPeriod[1]\n        timeStep = 1\n        HOYs, months, days = lb_preparation.getHOYsBasedOnPeriod(analysisPeriod, timeStep)\n        \n        newAnalysisPeriod = analysisPeriod\n    \n    else:  # no \"HOY_\" nor \"analysisPeriod_\" inputted. Use annual data.\n        HOYs = range(1,8761)\n        newAnalysisPeriod = [(1, 1, 1),(12, 31, 24)]\n    \n    days = []\n    months = []\n    hours = []\n    for hoy in HOYs:\n        d, m, h = lb_preparation.hour2Date(hoy, True)\n        days.append(d)\n        months.append(m + 1)\n        hours.append(h)\n    \n    startingDate = lb_preparation.hour2Date(lb_preparation.date2Hour(months[0], days[0], hours[0]))\n    endingDate = lb_preparation.hour2Date(lb_preparation.date2Hour(months[-1], days[-1], hours[-1]))\n    date = startingDate + \" to \" + endingDate\n    \n    return HOYs, days, months, hours, date, newAnalysisPeriod\n\n\ndef createHeaders(createOutputHeaders, comfortIndex, locationName, newAnalysisPeriod, Ta, Tdp, rh, ws, SR, N, HRrates, dehydrationRiskRates, activityDuration):\n    \n    for data in Ta, Tdp, rh, ws, SR, N:\n        if \"key:location/dataType/units/frequency/startsAt/endsAt\" in data:\n            header = data[:7]\n            break\n        else:\n            # default header\n            header = [\"key:location/dataType/units/frequency/startsAt/endsAt\", \"none\", \"none\", \"none\", \"Hourly\", (1, 1, 1), (1, 1, 2)]\n    \n    # change (or just replace it with the same current) locationName\n    header[1] = locationName\n    \n    comfortIndexValue = []\n    comfortIndexCategory = []\n    comfortableOrNot = []\n    IndicesEmptyLists = [comfortIndexValue, comfortIndexCategory, comfortableOrNot]\n    \n    \n    IndiceTitles = [\n    [\"Heat Index - values\", \"Heat Index - categories\", \"Heat Index - comfortable(1) or not(0)\"],\n    [\"Humidex - values\", \"Humidex - categories\", \"Humidex - comfortable(1) or not(0)\"],\n    [\"Discomfort Index - values\", \"Discomfort Index - categories\", \"Discomfort Index - comfortable(1) or not(0)\"],\n    [\"Wind Chill Index - values\", \"Wind Chill Index - categories\", \"Wind Chill Index - comfortable(1) or not(0)\"],\n    [\"Wind Chill Temperature - values\", \"Wind Chill Temperature - categories\", \"Wind Chill Temperature - comfortable(1) or not(0)\"],\n    [\"Wet-Bulb Globe Temperature (indoors) - values\", \"Wet-Bulb Globe Temperature (indoors) - categories\", \"Wet-Bulb Globe Temperature (indoors) - comfortable(1) or not(0)\"],\n    [\"Wet-Bulb Globe Temperature (outdoors) - values\", \"Wet-Bulb Globe Temperature (outdoors) - categories\", \"Wet-Bulb Globe Temperature (outdoors) - comfortable(1) or not(0)\"],\n    [\"Effective Temperature - values\", \"Effective Temperature - categories\", \"Effective Temperature - comfortable(1) or not(0)\"],\n    [\"Apparent Temperature - values\", \"Apparent Temperature - categories\", \"Apparent Temperature - comfortable(1) or not(0)\"],\n    [\"Thermal Sensation - values\", \"Thermal Sensation - categories \", \"Thermal Sensation - comfortable(1) or not(0)\"],\n    [\"Actual Sensation Vote - values\", \"Actual Sensation Vote - categories\", \"Actual Sensation Vote - comfortable(1) or not(0)\"],\n    [\"Mean Radiant Temperature - values\"],\n    [\"Predicted Insulation Index Of Clothing - values\", \"Predicted Insulation Index Of Clothing - categories\", \"Predicted Insulation Index Of Clothing - comfortable(1) or not(0)\"],\n    [\"Heart Rate - values\", \"Heart Rate - categories\", \"Heart Rate - comfortable(1) or not(0)\"],\n    [\"Dehydration Risk - values\", \"Dehydration Risk - categories\", \"Dehydration Risk - comfortable(1) or not(0)\"],\n    [\"Physiologically Equivalent Temperature (for temperate climates) - values\", \"Physiologically Equivalent Temperature (for temperate climates) - categories\", \"Physiologically Equivalent Temperature (for temperate climates) - comfortable(1) or not(0)\"],\n    [\"Physiologically Equivalent Temperature (for (sub)tropical humid climates) - values\", \"Physiologically Equivalent Temperature (for (sub)tropical humid climates) - categories\", \"Physiologically Equivalent Temperature (for (sub)tropical humid climates) - comfortable(1) or not(0)\"],\n    [\"Temperature Humidity Index - values\", \"Temperature Humidity Index - categories\", \"Temperature Humidity Index - comfortable(1) or not(0)\"],\n    [\"Predicted Heat Strain - values\", \"Predicted Heat Strain - categories\", \"Predicted Heat Strain - comfortable(1) or not(0)\"]\n    ]\n    \n    IndiceUnitsCat = [\n    [\"C\", \"0 = Comfortable,  1 = Moderate Hot,  2 = Hot,  3 = Quite hot,  4 = Very hot\", \"Boolean value\"],\n    [\"C\", \"0 = Comfortable,  1 = Moderate Hot,  2 = Hot,  3 = Quite hot,  4 = Very hot,  5 = Extremely hot\", \"Boolean value\"],\n    [\"C\", \"-6 = Hyper-glacial,  -5 = Glacial,  -4 = Extremely cold,  -3 = Very cold,  -2 = Cold,  -1 = Cool,  0 = Comfortable,  1 = Hot, 2 = Very hot, 3 = Torrid\", \"Boolean value\"],\n    [\"W/m2\", \"-4 = Extreme frost,  -3 = Frosty,  -2 = Cold,  -1 = Cool,  0 = Comfortable,  1 = Warm, 2 = Hot, 3 = Extremely hot\", \"Boolean value\"],\n    [\"C\", \"-6 = Extreme risk of frostbite,  -5 = Very high risk of frostbite,  -4 = High risk of frostbite,  -3 = Moderate risk of frostbite,  -2 = Low risk of frostbite,  -1 = Very low risk of frostbite, 0 = No risk of frostbite\", \"Boolean value\"],\n    [\"C\", \"0 = Comfortable,  1 = Moderate Hot,  2 = Hot,  3 = Quite hot,  4 = Very hot,  5 = Extremely hot\", \"Boolean value\"],\n    [\"C\", \"0 = Comfortable,  1 = Moderate Hot,  2 = Hot,  3 = Quite hot,  4 = Very hot,  5 = Extremely hot\", \"Boolean value\"],\n    [\"C\", \"-4 = Very cold,  -3 = Cold,  -2 = Cool,  -1 = Fresh,  0 = Comfortable,  1 = Warm, 2 = Hot\", \"Boolean value\"],\n    [\"C\", \"Appareal increments:\\n-5 = Overcoat, cap,  -4 = Overcoat,  -3 = Coat and sweater,  -2 = Sweater,  -1 = Thin sweater,  0 = Normal office wear,  1 = Cotton pants,  2 = Light undershirt,  3 = Shirt, shorts,  4 = Minimal clothes. Sun protection as needed\", \"Boolean value\"],\n    [\"unitless\", \"-3 = Very cold, -2 = Quite cold,  -1 = Cold,  0 = Comfortable,  1 = Hot,  2 = Quite hot,  3 = Very hot\", \"Boolean value\"],\n    [\"unitless\", \"-2 = Very cold,  -1 = Cold,  0 = Comfortable,  1 = Hot,  2 = Very hot\", \"Boolean value\"],\n    [\"C\"],\n    [\"clo\", \"-4 = Arctic, -3 = Very cold,, -2 = Cold,  -1 = Cool,  0 = Comfortable,  1 = Warm,  2 = Very warm\", \"Boolean value\"],\n    [\"beats per minute\", \"0 = Average,  1 = Below Average,  2 = Poor,  3 = Warning\", \"Boolean value\"],\n    [\"g/hour\", \"0 = No risk,  1 = Dehydration warning,  2 = Dehydration hazard\", \"Boolean value\"],\n    [\"C\", \"-4 = Very cold, -3 = Cold, -2 = Cool, -1 = Slightly cool, 0 = Comfortable,  1 = Slightly warm,  2 = Warm,  3 = Hot,  4 = Very hot\", \"Boolean value\"],\n    [\"C\", \"-4 = Very cold, -3 = Cold, -2 = Cool, -1 = Slightly cool, 0 = Comfortable,  1 = Slightly warm,  2 = Warm,  3 = Hot,  4 = Very hot\", \"Boolean value\"],\n    [\"C\", \"-3 = Extremely cold, -2 = Cold, -1 = Cool, 0 = Comfortable,  1 = Hot,  2 = Extremely hot\", \"Boolean value\"],\n    [\"C\", \"0 = Comfortable,  1 = Discomfort without health risk,  2 = Long-term constraint,  3 = Short-term constraint,  4 = Immediate constraint\", \"Boolean value\"]\n    ]\n    \n    for i in range(len(IndiceTitles[comfortIndex])):\n        for item in header:\n            IndicesEmptyLists[i].append(item)\n        IndicesEmptyLists[i][2] = IndiceTitles[comfortIndex][i]  # change header's title\n        IndicesEmptyLists[i][3] = IndiceUnitsCat[comfortIndex][i]  # change header's units or categories\n        IndicesEmptyLists[i][5] = newAnalysisPeriod[0]  # change header's from to date\n        IndicesEmptyLists[i][6] = newAnalysisPeriod[1]  # change header's from to date\n\n    outputNickNames = [\n    [\"HI\", \"HIlevel\", \"HIcomfortableOrNot\", \"HIpercentComfortable\", \"HIpercentHotExtreme\", \"_\"],\n    [\"humidex\", \"humidexLevel\", \"humidexComfortableOrNot\", \"humidexPercentComfortable\", \"humidexPercentHotExtreme\", \"_\"],\n    [\"DI\", \"DIlevel\", \"DIcomfortableOrNot\", \"DIpercentComfortable\", \"DIpercentHotExtreme\", \"DIpercentColdExtreme\"],\n    [\"WCI\", \"WCIlevel\", \"WCIcomfortableOrNot\", \"WCIpercentComfortable\", \"WCIpercentHotExtreme\", \"WCTpercentColdExtreme\"],\n    [\"WCT\", \"WCTlevel\", \"WCTcomfortableOrNot\", \"WCTpercentComfortable\", \"_\", \"WCTpercentColdExtreme\"],\n    [\"WBGTindoor\", \"WBGTlevel\", \"WBGTcomfortableOrNot\", \"WBGTpercentComfortable\", \"WBGTpercentHotExtreme\", \"_\"],\n    [\"WBGToutdoor\", \"WBGTlevel\", \"WBGTcomfortableOrNot\", \"WBGTpercentComfortable\", \"WBGTpercentHotExtreme\", \"_\"],\n    [\"TE\", \"TElevel\", \"TEcomfortableOrNot\", \"TEpercentComfortable\", \"TEpercentHotExtreme\", \"TEpercentColdExtreme\"],\n    [\"AT\", \"ATlevel\", \"ATcomfortableOrNot\", \"ATpercentComfortable\", \"ATpercentHotExtreme\", \"ATpercentColdExtreme\"],\n    [\"TS\", \"TSlevel\", \"TScomfortableOrNot\", \"TSpercentComfortable\", \"TSpercentHotExtreme\", \"TSpercentColdExtreme\"],\n    [\"ASV\", \"ASVlevel\", \"ASVcomfortableOrNot\", \"ASVpercentComfortable\", \"ASVpercentHotExtreme\", \"ASVpercentColdExtreme\"],\n    [\"MRT\", \"_\", \"_\", \"_\", \"_\", \"_\"],\n    [\"Iclp\", \"IclpLevel\", \"IclpComfortableOrNot\", \"IclpPercentComfortable\", \"IclpPercentHotExtreme\", \"IclpPercentColdExtreme\"],\n    [\"HR\", \"HRlevel\", \"HRcomfortableOrNot\", \"HRpercentComfortable\", \"HRpercentHotExtreme\", \"_\"],\n    [\"DhRa\", \"DhRaLevel\", \"DhRaComfortableOrNot\", \"DhRaPercentComfortable\", \"DhRaPercentHotExtreme\", \"_\"],\n    [\"PET\", \"PETlevel\", \"PETcomfortableOrNot\", \"PETpercentComfortable\", \"PETpercentHotExtreme\", \"PETpercentColdExtreme\"],\n    [\"PET\", \"PETlevel\", \"PETcomfortableOrNot\", \"PETpercentComfortable\", \"PETpercentHotExtreme\", \"PETpercentColdExtreme\"],\n    [\"THI\", \"THIlevel\", \"THIcomfortableOrNot\", \"THIpercentComfortable\", \"THIpercentHotExtreme\", \"THIpercentColdExtreme\"],\n    [\"PHS\", \"PHSlevel\", \"PHScomfortableOrNot\", \"PHSpercentComfortable\", \"PHSpercentHotExtreme\", \"_\"]\n    ] # outputNames = outputNickNames\n    \n    outputDescriptions = [\n    [\"Heat Index (C) - the human-perceived increase in air temperature due to humidity increase. It is used by National Weather Service (NSW).\\nHeat Index is calculated for shade values. Exposure to full sunshine can increase heat index values by up to 8 C (14 F)\",  #comfortIndexValues\n    \n    \"Each number (from 0 to 4) represents a certain HI thermal sensation category. With categories being the following:\\n\" + \\\n    \"--\\n\" + \\\n    \"- category 0 (<26.6 C): Satisfactory temperature. Can continue with activity.\\n\" + \\\n    \"- category 1 (26.6-32.2 C): Caution: fatigue is possible with prolonged exposure and activity. Continuing activity could result in heat cramps.\\n\" + \\\n    \"- category 2 (32.2-40.5 C): Extreme caution: heat cramps and heat exhaustion are possible. Continuing activity could result in heat stroke.\\n\" + \\\n    \"- category 3 (40.5-54.4 C): Danger: heat cramps and heat exhaustion are likely; heat stroke is probable with continued activity.\\n\" + \\\n    \"- category 4 (>54.4 C): Extreme danger: heat stroke is imminent.\",  # comfortIndexCategory\n    \n    \"Outputs 0 or 1. 0 indicates that a person is not comfortable, 1 that he/she is comfortable at that hour (meaning HI temperature is < 26.6 C)\",  #comfortableOrNot\n    \n    \"Percentage of time, during which HI is < 26.6 C\",  #percentComfortable\n    \n    \"Percentage of time, during which HI is > 54.4 C\",  #percentHotExtreme\n    \" \"]  #percentColdExtreme\n    \n    ,\n    \n    [\"Humidex (C) - the human-perceived increase in air temperature due to Dew point temperature increase. Used by Canadian Meteorologist service.\",  #comfortIndexValues\n    \n    \"Each number (from 0 to 5) represents a certain humidex thermal sensation category. With categories being the following:\\n\" + \\\n    \"--\\n\" + \\\n    \"- category 0 (<30 C): Little or no discomfort\\n\" + \\\n    \"- category 1 (30-35 C): Noticeable discomfort\\n\" + \\\n    \"- category 2 (35-40 C): Evident discomfort\\n\" + \\\n    \"- category 3 (40-45 C): Intense discomfort; avoid exertion\\n\" + \\\n    \"- category 4 (45-54 C): Dangerous discomfort\\n\" + \\\n    \"- category 5 (>54 C): Heat stroke probable\",  #comfortIndexCategory\n    \n    \"Outputs 0 or 1. 0 indicates that a person is not comfortable, 1 that he/she is comfortable at that hour (meaning humidex is < 30 C)\",  # comfortableOrNot\n    \n    \"Percentage of time chosen for analysis period, during which humidex is < 26.6 C\",  # percentComfortable\n    \n    \"Percentage of time chosen for analysis period, during which humidex is > 54.4 C\", # percentHotExtreme\n    \" \"]  #percentColdExtreme\n    \n    ,\n    \n    [\"Discomfort Index (or Thom's Index)(C) - the human-perceived increase in air temperature due to himidity increase.\",  #comfortIndexValues\n    \n    \"Each number (from -6 to 3) represents a certain DI thermal sensation category. With categories being the following:\\n\" + \\\n    \"--\\n\" + \\\n    \"- category -6 (<-40 C) Hyper-glacial\\n\" + \\\n    \"- category -5 (-40-(-20) C) Glacial\\n\" + \\\n    \"- category -4 (-20-(-10) C) Extremely cold\\n\" + \\\n    \"- category -3 (-10-(-1.8) C) Very cold\\n\" + \\\n    \"- category -2 (-1.8-(13) C): Cold\\n\" + \\\n    \"- category -1 (13-15 C): Cool\\n\" + \\\n    \"- category 0 (15-20 C): Comfortable\\n\" + \\\n    \"- category 1 (20-26.5 C): Hot\\n\" + \\\n    \"- category 2 (26.5-30 C): Very hot\\n\" + \\\n    \"- category 3 (>30 C): Torrid\",  #comfortIndexCategory\n    \n    \"Outputs 0 or 1. 0 indicates that a person is not comfortable, 1 that he/she is comfortable at that hour (meaning DI temperature is 15-20 C)\",  #comfortableOrNot\n    \n    \"Percentage of time chosen for analysis period, during which DI is 15-20 C\",  #percentComfortable\n    \n    \"Percentage of time chosen for analysis period, during which DI is > 30 C\",  #percentHotExtreme\n    \n    \"Percentage of time chosen for analysis period, during which DI is < -40 C\"]  #percentColdExtreme\n    \n    ,\n    \n    [\"Wind Chill Index (W/m2) - qualifies thermal sensations of man in wintertime. It is especially useful at low and very low air temperature and at high wind speed. WCI values are not equal to the actual heat loss from the human organism.\",  #comfortIndexValues\n    \n    \"Each number (from -4 to 3) represents a certain WCI thermal sensation category. With categories being the following:\\n\" + \\\n    \"--\\n\" + \\\n    \"- category -4 (>=2326 W/m2) Extreme frost\\n\" + \\\n    \"- category -3 (1628.2-2326 W/m2) Frosty\\n\" + \\\n    \"- category -2 (930.4-1628.2 W/m2) Cold\\n\" + \\\n    \"- category -1 (581.5-930.4 W/m2) Cool\\n\" + \\\n    \"- category 0 (232.6-581.5 W/m2) Comfortable\\n\" + \\\n    \"- category 1 (116.3-232.6 W/m2) Warm\\n\" + \\\n    \"- category 2 (58.3-116.3 W/m2) Hot\\n\" + \\\n    \"- category 3 (<58.3 W/m2) Extremely hot\",  #comfortIndexCategory\n    \n    \"Outputs 0 or 1. 0 indicates that a person is not comfortable, 1 that he/she is comfortable at that hour (meaning WCI is in range: 232.6 to 581.5 W/m2)\",  #comfortableOrNot\n    \n    \"Percentage of time, during which WCI is < 232.6-581.5 W/m2\",  #percentComfortable\n    \n    \"Percentage of time, during which WCI is < 58.3 W/m2\",  #percentHotExtreme\n    \n    \"Percentage of time, during which WCI >= 2326 W/m2\"]  #percentColdExtreme\n    \n    ,\n    \n    [\"Wind Chill Temperature (C) - the perceived decrease in air temperature felt by the body on exposed skin due to the flow of air.\\nIt's used by both National Weather Service (NSW) in US and Canadian Meteorologist service. This is new (2001 by JAG/TI) WCT.\\nWind chill index does not take into account the effect of sunshine.\\nBright sunshine may reduce the effect of wind chill (make it feel warmer) by 6 to 10 units(C or F)!\\nWindchill temperature is defined only for temperatures at or below 10C (50F) and for wind speeds at and above 1.3 m/s (or 4.8 km/h or 3.0 mph)\",  #comfortIndexValues\n    \n    \"Each number (from -6 to 0) represents a certain WCT thermal sensation category. With categories being the following:\\n\" + \\\n    \"--\\n\" + \\\n    \"- category 0 (>0 C) No discomfort. No risk of frostbite for most people\\n\" + \\\n    \"- category -1 (0-(-9) C) Slight increase in discomfort. Low risk of frostbite for most people\\n\" + \\\n    \"- category -2 (-9-(-27) C) Risk of hypothermia if outside for long periods without adequate protection. Low risk of frostbite for most people\\n\" + \\\n    \"- category -3 (-27-(-39) C) Risk of hypothermia if outside for long periods without adequate clothing or shelter from wind and cold. Increasing risk of frostbite for most people in 10 to 30 minutes of exposure\\n\" + \\\n    \"- category -4 (-39-(-47) C) Risk of hypothermia if outside for long periods without adequate clothing or shelter from wind and cold. High risk of frostbite for most people in 5 to 10 minutes of exposure\\n\" + \\\n    \"- category -5 (-47-(-54) C) Serious risk of hypothermia if outside for long periods without adequate clothing or shelter from wind and cold. High risk of frostbite for most people in 2 to 5 minutes of exposure\\n\" + \\\n    \"- category -6 (<-54 C) Danger! Outdoor conditions are hazardous. High risk of frostbite for most people in 2 minutes of exposure or less\",  #comfortIndexCategory\n    \n    \"Outputs 0 or 1. 0 indicates that there is danger of frostbite, 1 there is not danger of frostbite at that hour (meaning WCT temperature is in range: >-27 C)\",  #comfortableOrNot\n    \n    \"Percentage of time, during which there is low risk of frostbite (DI is > -27 C)\",  #percentComfortable\n    \" \",  #percentHotExtreme\n    \n    \"Percentage of time, during which there is high risk of frostbite (DI is < -54 C)\"]  #percentColdExtreme\n    \n    ,\n    \n    [\"Wet-Bulb Globe Temperature(C) - perceived indoor temperature.\\nIt is used by the U.S. military and American Academy of Pediatrics and OSHA (Occupational Safety and Health Administration) to obtain measure of heat stress involved in manual labor jobs of soldiers, construction workers, steel mill workers, firefighters, law enforcement officers, athletes...\",  #comfortIndexValues\n    \n    \"Each number (from 0 to 5) represents a certain WBGT thermal sensation category. With categories being the following:\\n\" + \\\n    \"--\\n\" + \\\n    \"- category 0 (<26 C): No change in activity is required.\\n\" + \\\n    \"- category 1 (26-27.7 C): No change in activity is required. Use discretion when planning heavy activities for unacclimated person.\\n\" + \\\n    \"- category 2 (27.7-29.4 C): Outdoor physical activities and strenuous exercise should be limited to 50 minutes per hour. This recommendation applies to the average acclimated person and conducting moderate work outdoors. Use discretion when planning heavy exercises for unacclimated person.\\n\" + \\\n    \"- category 3 (29.4-31.1 C): Outdoor physical activities and strenuous exercise should be limited to 40 minutes per hour. You should unblouse trouser legs. This recommendation applies to the average acclimated person and conducting moderate work outdoors. Use discretion when planning heavy exercises for unacclimated person.\\n\" + \\\n    \"- category 4 (31.1-32.2 C): Outdoor physical activities and strenuous exercise should be limited to 30 minutes per hour. You should unblouse trouser legs and top down to t-shirt. This recommendation applies to the average acclimated person and conducting moderate work outdoors. Use discretion when planning heavy exercises for unacclimated person.\\n\" + \\\n    \"- category 5 (>32.2 C): Outdoor physical activities and strenuous exercise should be limited to 20 minutes per hour. You should unblouse trouser legs and top down to t-shirt. This recommendation applies to the average acclimated person and conducting moderate work outdoors. Use discretion when planning heavy exercises for unacclimated person.\",  #comfortIndexCategory\n    \n    \"Outputs 0 or 1. 0 indicates that a person is not comfortable, 1 that he/she is comfortable at that hour (meaning WBGT temperature is in range: 29.4 to 31.1 C)\",  #comfortableOrNot\n    \n    \"Percentage of time, during which WBGT is < 26 C\",  #percentComfortable\n    \n    \"Percentage of time, during which WBGT is > 32.2 C\",  #percentHotExtreme\n    \" \"]  #percentColdExtreme\n    \n    ,\n    \n    [\"Wet-Bulb Globe Temperature(C) - perceived outdoor temperature.\\nIt is used by the U.S. military, American Academy of Pediatrics and OSHA (Occupational Safety and Health Administration) to obtain measure of heat stress involved in manual labor jobs of soldiers, construction workers, steel mill workers, firefighters, law enforcement officers, athletes...\",  #comfortIndexValues\n    \n    \"Each number (from 0 to 5) represents a certain WBGT thermal sensation category. With categories being the following:\\n\" + \\\n    \"--\\n\" + \\\n    \"- category 0 (<26 C): No change in activity is required.\\n\" + \\\n    \"- category 1 (26-27.7 C): No change in activity is required. Use discretion when planning heavy activities for unacclimated person.\\n\" + \\\n    \"- category 2 (27.7-29.4 C): Outdoor physical activities and strenuous exercise should be limited to 50 minutes per hour. This recommendation applies to the average acclimated person and conducting moderate work outdoors. Use discretion when planning heavy exercises for unacclimated person.\\n\" + \\\n    \"- category 3 (29.4-31.1 C): Outdoor physical activities and strenuous exercise should be limited to 40 minutes per hour. You should unblouse trouser legs. This recommendation applies to the average acclimated person and conducting moderate work outdoors. Use discretion when planning heavy exercises for unacclimated person.\\n\" + \\\n    \"- category 4 (31.1-32.2 C): Outdoor physical activities and strenuous exercise should be limited to 30 minutes per hour. You should unblouse trouser legs and top down to t-shirt. This recommendation applies to the average acclimated person and conducting moderate work outdoors. Use discretion when planning heavy exercises for unacclimated person.\\n\" + \\\n    \"- category 5 (>32.2 C): Outdoor physical activities and strenuous exercise should be limited to 20 minutes per hour. You should unblouse trouser legs and top down to t-shirt. This recommendation applies to the average acclimated person and conducting moderate work outdoors. Use discretion when planning heavy exercises for unacclimated person.\",  #comfortIndexCategory\n    \n    \"Outputs 0 or 1. 0 indicates that a person is not comfortable, 1 that he/she is comfortable at that hour (meaning WBGT temperature is in range: 29.4 to 31.1 C)\",  #comfortableOrNot\n    \n    \"Percentage of time, during which WBGT is < 26 C\",  #percentComfortable\n    \n    \"Percentage of time, during which WBGT is > 32.2 C\",  #percentHotExtreme\n    \" \"]  #percentColdExtreme\n    \n    ,\n    \n    [\"Effective Temperature (C) - influence of air temperature, wind speed, relative humidity of air, and solar radiation on man indoors and outdoors (both in shade and under the sun)\",  #comfortIndexValues\n    \n    \"Each number (from -4 to 2) represents a certain TE thermal sensation category. With categories being the following:\\n\" + \\\n    \"--\\n\" + \\\n    \"- category -4 (<1 C): Very cold\\n\" + \\\n    \"- category -3 (1-9 C): Cold\\n\" + \\\n    \"- category -2 (9-17 C): Cool\\n\" + \\\n    \"- category -1 (17-21 C): Fresh\\n\" + \\\n    \"- category 0 (21-23 C): Comfortable\\n\" + \\\n    \"- category 1 (23-27 C): Warm\\n\" + \\\n    \"- category 2 (>27 C): Hot\",  #comfortIndexCategory\n    \n    \"Outputs 0 or 1. 0 indicates that a person is not comfortable, 1 that he/she is comfortable at that hour (meaning TE temperature is in range: 21 to 23 C)\",  #comfortableOrNot\n    \n    \"Percentage of time, during which TE is < 21-23 C\",  #percentComfortable\n    \n    \"Percentage of time, during which TE is > 27 C\",  #percentHotExtreme\n    \n    \"Percentage of time, during which TE is < 1 C\"]  #percentColdExtreme\n    \n    ,\n    \n    [\"Apparent Temperature (C) - combines wind chill and heat index to give one single perceived outdoor temperature for Australian climate.\\nNon-radiation formula from ABM(Australian Bureau of Meteorology).\",  #comfortIndexValues\n    \n    \"Each number (from -6 to 4) represents a certain AT thermal sensation category. With categories being the following:\\n\" + \\\n    \"--\\n\" + \\\n    \"Appareal increments:\\n\" + \\\n    \"- category 4 (>40 C): Minimal; sun protection required\\n\" + \\\n    \"- category 3 (35-40 C): Minimal; sun protection as needed\\n\" + \\\n    \"- category 2 (30-35 C): Short sleeve, shirt and shorts\\n\" + \\\n    \"- category 1 (25-30 C): Light undershirt\\n\" + \\\n    \"- category 0 (20-25 C): Cotton-type slacks (pants)\\n\" + \\\n    \"- category -1 (15-20 C): Normal office wear\\n\" + \\\n    \"- category -2 (10-15 C): Thin or sleeveless sweater\\n\" + \\\n    \"- category -3 (5-10 C): Sweater. Thicker underwear\\n\" + \\\n    \"- category -4 (0-5 C): Coat and sweater\\n\" + \\\n    \"- category -5 (-5-0 C): Overcoat. Wind protection as needed\\n\" + \\\n    \"- category -6 (<-5 C): Overcoat. Head insulation. Heavier footwear\",  #comfortIndexCategory\n    \n    \"Outputs 0 or 1. 0 indicates that a person is not comfortable, 1 that he/she is comfortable at that hour (meaning AT temperature is in range: 20 to 25 C)\",  #comfortableOrNot\n    \n    \"Percentage of time, during which AT is < 20-25 C\",  #percentComfortable\n    \n    \"Percentage of time, during which AT is > 40 C\",  #percentHotExtreme\n    \n    \"Percentage of time, during which AT is < -5 C\"]  #percentColdExtreme\n    \n    ,\n    \n    [\"Thermal Sensation (index) (unit-less) - and index which predicts sensation of satisfaction/dissatisfaction under the prevailing outdoor climatic conditions.\\nIt is applicable to Japan only (with exception of Hokaido and central parts of Honshu island).\",  #comfortIndexValues\n    \n    \"Each number (from -3 to 3) represents a certain TS thermal sensation category. With categories being the following:\\n\" + \\\n    \"--\\n\" + \\\n    \"- category -3 (<2): Very cold\\n\" + \\\n    \"- category -2 (2-3): Quite cold\\n\" + \\\n    \"- category -1 (3-4): Cold\\n\" + \\\n    \"- category 0 (4-5): Comfort\\n\" + \\\n    \"- category 1 (5-6): Hot\\n\" + \\\n    \"- category 2 (6-7): Quite Hot\\n\" + \\\n    \"- category 3 (>7): Very hot\",  #comfortIndexCategory\n    \n    \"Outputs 0 or 1. 0 indicates that a person is not comfortable, 1 that he/she is comfortable at that hour (meaning TS index is in range: 4 to 5)\",  #comfortableOrNot\n    \n    \"Percentage of time, during which TS is 4 to 5\",  #percentComfortable\n    \n    \"Percentage of time, during which TS is > 7\",  #percentHotExtreme\n    \n    \"Percentage of time, during which TS is < 2\"]  #percentColdExtreme\n    \n    ,\n    \n    [\"Actual Sensation Vote (unit-less) - is an index which estimates human thermal sensation based on the empirical data gathered from field and human surveys, interviews and questionnaires in 7 European cities (RUROS project: Cambridge, Sheffield, Milan, Fribourg, Kassel, Athens, Thessaloniki). ASV index is valid for Europe only.\",  #comfortIndexValues\n    \n    \"Each number (from -2 to 2) represents a certain ASV thermal sensation category. With categories being the following:\\n\" + \\\n    \"--\\n\" + \\\n    \"- category -2 (<-2): Very cold\\n\" + \\\n    \"- category -1 (-2-(-1)): Cold\\n\" + \\\n    \"- category 0 (-1-1): Comfort\\n\" + \\\n    \"- category 1 (1-2): Hot\\n\" + \\\n    \"- category 2 (>2): Very Hot\",  #comfortIndexCategory\n    \n    \"Outputs 0 or 1. 0 indicates that a person is not comfortable, 1 that he/she is comfortable at that hour (meaning ASV index is in range: -1 to 1)\",  #comfortableOrNot\n    \n    \"Percentage of time, during which ASV is -1 to 1\",  #percentComfortable\n    \n    \"Percentage of time, during which ASV is > 2\",  #percentHotExtreme\n    \n    \"Percentage of time, during which ASV is < -2\"]  #percentColdExtreme\n    \n    ,\n    \n    [\"Mean Radiant Temperature (C) - uniform temperature of an imaginary enclosure in which the radiant heat transfer from the human body is equal to the radiant heat transfer in the actual non-uniform enclosure.\\nFor indoor conditions MRT equals the dry bulb (air) temperature.\", #comfortIndexValues\n    \" \",\n    \" \",\n    \" \",\n    \" \",\n    \" \"]\n    \n    ,\n    \n    [\"Predicted Insulation Index Of Clothing (clo) - is approximated, predicted value of thermal insulation of clothing which is necessary to keep thermal comfort in man.\\nIt is calculated based on air temperature, wind speed and metabolic rate.\\nMinimal Iclp is restricted to 0.5 (summer clothes). Maximal Iclp to 4.1 (heavy polar outfit).\",  #comfortIndexValues\n    \n    \"Each number (from -4 to 2) represents a certain Iclp thermal sensation category. With categories being the following:\\n\" + \\\n    \"--\\n\" + \\\n    \"- category -4 (>4): Arctic\\n\" + \\\n    \"- category -3 (3.0-4.0): Very cold\\n\" + \\\n    \"- category -2 (2.0-3.0): Cold\\n\" + \\\n    \"- category -1 (1.20-2.0): Cool\\n\" + \\\n    \"- category 0 (0.80-1.20): Comfortable\\n\" + \\\n    \"- category 1 (0.30-0.80): Warm\\n\" + \\\n    \"- category 2 (0.30<): Very warm\",  #comfortIndexCategory\n    \n    \"Outputs 0 or 1. 0 indicates that a person is not comfortable, 1 that he/she is comfortable at that hour (meaning Iclp index is in range: 0.80 to 1.20)\",  #comfortableOrNot\n    \n    \"Percentage of time, during which Iclp is 0.80 to 1.20\",  #percentComfortable\n    \n    \"Percentage of time, during which Iclp is < 0.30\",  #percentHotExtreme\n    \n    \"Percentage of time, during which Iclp is > 4\"]  #percentColdExtreme\n    \n    ,\n    \n    [\"Heart Rate (beats per minute) - is the number of heart beats per 1 minute.\",  #comfortIndexValues\n    \n    \"Each number (from 0 to 3) represents a certain HR beats per minute category. With categories being the following:\\n\" + \\\n    \"--\\n\" + \\\n    \"- category 0 (<%s  beats per minute): Average.\\n\" % HRrates[0] + \\\n    \"- category 1 (%s-%s beats per minute): Below Average.\\n\" % (HRrates[0],HRrates[1]) + \\\n    \"- category 2 (%s-%s  beats per minute): Poor.\\n\" % (HRrates[1], HRrates[2]) + \\\n    \"- category 3 (>%s beats per minute): Warning.\" % HRrates[2], # comfortIndexCategory\n    \n    \"Outputs 0 or 1. 0 indicates that a person is not comfortable, 1 that he/she is comfortable at that hour (meaning HR is < %s beaps per minute) \" % HRrates[0], #comfortableOrNot\n    \n    \"Percentage of time, during which HR is <%s beats per minute\" % HRrates[0],  #percentComfortable\n    \n    \"Percentage of time, during which HR is > %s beats per minute\" % HRrates[2],  #percentHotExtreme\n    \" \"]  #percentColdExtreme\n    \n    ,\n    \n    [\"Dehydration Risk (g/hour) - is the excessive loss of body water, with an accompanying disruption of metabolic processes.\",  #comfortIndexValues\n    \n    \"Each number (from 0 to 2) represents a certain Dehydration risk category. With categories being the following:\\n\" + \\\n    \"--\\n\" + \\\n    \"- category 0 (<%s g/hour): No risk.\\n\" % dehydrationRiskRates[0] + \\\n    \"- category 1 (%s-%s g/hour): Dehydration warning.\\n\" % (dehydrationRiskRates[0],dehydrationRiskRates[1]) + \\\n    \"- category 2 (>%s g/hour): Dehydration hazard.\" % dehydrationRiskRates[1],  # comfortIndexCategory\n    \n    \"Outputs 0 or 1. 0 indicates that a person is not comfortable, 1 that he/she is comfortable at that hour (meaning HI temperature is < %s g/hour)\" % dehydrationRiskRates[0],  #comfortableOrNot\n    \n    \"Percentage of time, during which HI is < %s g/hour\" % dehydrationRiskRates[0],  #percentComfortable\n    \n    \"Percentage of time, during which HI is > %s g/hour\" % dehydrationRiskRates[1],  #percentHotExtreme\n    \" \"]  #percentColdExtreme\n    \n    ,\n    \n    [\"Physiologically Equivalent Temperature (C) for temperate climates - an air temperature at which, in a typical indoor conditions, the heat budget of the human body is balanced with the same core and skin temperature as under the complex outdoor conditions to be assessed. This way PET enables a layperson to compare the integral effects of complex thermal conditions outside with his or her own experience indoors.\\n\\n\" + \\\n    \"If an analysis has been performed for a single hour, then \\\"readMe!\\\" output will show additional results related with PET!\",  #comfortIndexValues\n    \n    \"Each number (from -4 to 4) represents a certain PET level/category. With categories being the following:\\n\" + \\\n    \"--\\n\" + \\\n    \"- category -4 (<4 C) Very cold\\n\" + \\\n    \"- category -3 (4-8 C) Cold\\n\" + \\\n    \"- category -2 (8-13 C) Cool\\n\" + \\\n    \"- category -1 (13-18 C) Slightly cool\\n\" + \\\n    \"- category 0 (18-23 C) Comfortable\\n\" + \\\n    \"- category 1 (23-29 C) Slightly warm\\n\" + \\\n    \"- category 2 (29-35 C) Warm\\n\" + \\\n    \"- category 2 (35-41 C) Hot\\n\" + \\\n    \"- category 4 (>4 C) Very hot\",  #comfortIndexCategory\n    \n    \"Outputs 0 or 1. 0 indicates that a person is not comfortable, 1 that he/she is comfortable at that hour (meaning PET is in range: 18 to 23 C)\",  #comfortableOrNot\n    \n    \"Percentage of time, during which PET is 18-23 C\",  #percentComfortable\n    \n    \"Percentage of time, during which PET is > 41 C\",  #percentHotExtreme\n    \n    \"Percentage of time, during which PET is < 4 C\"]  #percentColdExtreme\n    \n    ,\n    \n    [\"Physiologically Equivalent Temperature (C) for (sub)tropical climates - an air temperature at which, in a typical indoor conditions, the heat budget of the human body is balanced with the same core and skin temperature as under the complex outdoor conditions to be assessed. This way PET enables a layperson to compare the integral effects of complex thermal conditions outside with his or her own experience indoors.\\n\\n\" + \\\n    \"If an analysis has been performed for a single hour, then \\\"readMe!\\\" output will show additional results related with PET!\",  #comfortIndexValues\n    \n    \"Each number (from -4 to 4) represents a certain PET level/category. With categories being the following:\\n\" + \\\n    \"--\\n\" + \\\n    \"- category -4 (<14 C) Very cold\\n\" + \\\n    \"- category -3 (14-18 C) Cold\\n\" + \\\n    \"- category -2 (18-22 C) Cool\\n\" + \\\n    \"- category -1 (22-26 C) Slightly cool\\n\" + \\\n    \"- category 0 (26-30 C) Comfortable\\n\" + \\\n    \"- category 1 (30-34 C) Slightly warm\\n\" + \\\n    \"- category 2 (34-38 C) Warm\\n\" + \\\n    \"- category 2 (38-42 C) Hot\\n\" + \\\n    \"- category 4 (>42 C) Very hot\",  #comfortIndexCategory\n    \n    \"Outputs 0 or 1. 0 indicates that a person is not comfortable, 1 that he/she is comfortable at that hour (meaning PET is in range: 18 to 23 C)\",  #comfortableOrNot\n    \n    \"Percentage of time, during which PET is 26-30 C\",  #percentComfortable\n    \n    \"Percentage of time, during which PET is > 42 C\",  #percentHotExtreme\n    \n    \"Percentage of time, during which PET is < 14 C\"]  #percentColdExtreme\n    \n    ,\n    \n    [\"Temperature Humidity Index (C) - the human-perceived increase in air temperature due to humidity increase.\\nIt is used by Central Weather Bureau of Taiwan. Essentially it represents the modified version of Discomfort Index (DI).\\nIt is meant to be used in inshade, non windy conditions.\",  #comfortIndexValues\n    \n    \"Each number (from -3 to 2) represents a certain THI level/category. With categories being the following:\\n\" + \\\n    \"--\\n\" + \\\n    \"- category -3 (<11 C) Extremely cold\\n\" + \\\n    \"- category -2 (11-16 C) Cold\\n\" + \\\n    \"- category -1 (16-20 C) Cool\\n\" + \\\n    \"- category 0 (20-27 C) Comfortable\\n\" + \\\n    \"- category 1 (27-31 C) Hot\\n\" + \\\n    \"- category 2 (>31 C) Extremely hot\",  #comfortIndexCategory\n    \n    \"Outputs 0 or 1. 0 indicates that a person is not comfortable, 1 that he/she is comfortable at that hour (meaning THI is in range: 20 to 27 C)\",  #comfortableOrNot\n    \n    \"Percentage of time, during which THI is 20-27 C\",  #percentComfortable\n    \n    \"Percentage of time, during which THI is > 31 C\",  #percentHotExtreme\n    \n    \"Percentage of time, during which THI is < 11 C\"]  #percentColdExtreme\n    \n    ,\n    \n    [\"Predicted Heat Strain (C) - ISO 7933 model for evaluation of thermal stress experienced by a person/athlete/worker in a hot environment.\",  #comfortIndexValues\n    \n    \"Each number (from 0 to 4) represents a certain PHS level/category. With categories being the following:\\n\" + \\\n    \"--\\n\" + \\\n    \"- category 0:  Comfortable - no health risk\\n\" + \\\n    \"  Excessive water loss happened at least %s minutes from the start of activity.\\n\" % activityDuration + \\\n    \"  or Central (rectal) temperature of 38 C was exceeded at least %s minutes from the start of activity.\\n\" % activityDuration + \\\n    \" \\n\" + \\\n    \"- category 1:  Discomfort without health risk\\n\" + \\\n    \"  Excessive water loss happened during %s to %s minutes from the start of activity.\\n\" % ((activityDuration - activityDuration*0.015), activityDuration) + \\\n    \"  or Central (rectal) temperature of 38 C was exceeded during %s to %s minutes from the start of activity.\\n\" % ((activityDuration - activityDuration*0.015), activityDuration) + \\\n    \" \\n\" + \\\n    \"- category 2:  Long-term constraint - discomfort and risk of dehydration after several hours of exposure\\n\" + \\\n    \"  Excessive water loss happened during 120 to %s minutes from the start of activity.\\n\" % (activityDuration - activityDuration*0.015) + \\\n    \"  or Central (rectal) temperature of 38 C was exceeded during 120 to %s minutes from the start of activity.\\n\" % (activityDuration - activityDuration*0.015) + \\\n    \" \\n\" + \\\n    \"- category 3:  Short-term constraint - health risk after 30 to 120 minutes of exposure\\n\" + \\\n    \"  Excessive water loss happened during 30 to 120 minutes from the start of activity.\\n\" + \\\n    \"  or Central (rectal) temperature of 38 C was exceeded during 30 to 120 minutes from the start of activity.\\n\" + \\\n    \" \\n\" + \\\n    \"- category 4:  Immediate constraint - health risks even for exposures of very short durations (less than 30 minutes)\\n\"\n    \"  Excessive water loss happened 30 minutes or less from the start of activity.\\n\" + \\\n    \"  or Central (rectal) temperature of 38 C was exceeded 30 minutes or less from the start of activity.\\n\",  #comfortIndexCategory\n    \n    \"Outputs 0 or 1. 0 indicates that a person is not comfortable, 1 that he/she is comfortable at that hour, meaning:\\n\" + \\\n    \"  Excessive water loss happened at least %s minutes from the start of activity.\\n\" % activityDuration + \\\n    \"  or Central (rectal) temperature of 38 C was exceeded at least %s minutes from the start of activity.\\n\" % activityDuration,  #comfortableOrNot\n    \n    \"Percentage of time, during which:\\n\" + \\\n    \"  Excessive water loss happened at least %s minutes from the start of activity.\\n\" % activityDuration + \\\n    \"  or Central (rectal) temperature of 38 C was exceeded at least %s minutes from the start of activity.\\n\" % activityDuration,  #percentComfortable\n    \n    \"Percentage of time, during which:\\n\" + \\\n    \"  Excessive water loss happened 30 minutes or less from the start of activity.\\n\" + \\\n    \"  or Central (rectal) temperature of 38 C was exceeded 30 minutes or less from the start of activity.\",  #percentHotExtreme\n    \n    \" \"]  #percentColdExtreme\n    ]\n    \n    if (createOutputHeaders == True):\n        # create headers for first three outputs\n        return comfortIndexValue, comfortIndexCategory, comfortableOrNot, outputNickNames[comfortIndex], outputDescriptions[comfortIndex]\n    elif (createOutputHeaders == False):\n        # do not create headers for first three outputs\n        return [], [], [], outputNickNames[comfortIndex], outputDescriptions[comfortIndex]\n\n\ndef printThermalComfortIndexName(comfortIndex, date, HOYs, PETresults):\n    thermalComfortIndexName = [\"HI (Heat Index)\", \"humidex (humidity index)\", \"DI (Discomfort Index)\", \"WCI (Wind Chill Index)\", \"WCT (Wind Chill Temperature)\", \"WBGT (Wet-Bulb Globe Temperature) indoors\", \"WBGT (Wet-Bulb Globe Temperature) outdoors\", \"TE (Effective Temperature)\", \"AT (Apparent Temperature)\", \"TS (Thermal Sensation)\", \"ASV (Actual Sensation Vote)\", \"MRT (Mean Radiant Temperature)\", \"Iclp (Predicted Insulation Index Of Clothing)\", \"HR (Heart Rate)\", \"DhRa (Dehydration Risk)\", \"PET for temperate climates\", \"PET for (sub)tropical humid climates\", \"THI (Temperature Humidity Index)\", \"PHS (Predicted Heat Strain)\"]\n    print \"%s\" % (thermalComfortIndexName[comfortIndex])\n    print date\n    \n    # print PETresults or PHSresults only for HOY_ inputted:\n    if PETresults and (len(HOYs) == 1):\n        coreTemperature, skinTemperature, totalHeatLoss, skinSweating, internalHeat, radiationBalance, convection, waterVaporDiffusion, sweatEvaporation, respiration = PETresults\n        print \"\\nBODY PARAMETERS\\nCore temperature (C): %0.2f\\nMean skin temperature (C): %0.2f\\nTotal heat loss (g/h): %0.2f\\nSkin wettedness (unitless): %0.2f\\n\\nHEAT FLUXES\\nInternal heat (W): %0.2f\\nRadiation balance (W): %0.2f\\nConvection (W): %0.2f\\nWater vapor diffusion (W): %0.2f\\nSweat evaporation (W): %0.2f\\nRespiration (W): %0.2f\" % (coreTemperature, skinTemperature, totalHeatLoss, skinSweating, internalHeat, radiationBalance, convection, waterVaporDiffusion, sweatEvaporation, respiration)\n\n\nlevel = gh.GH_RuntimeMessageLevel.Warning\nif sc.sticky.has_key(\"ladybug_release\"):\n    if sc.sticky[\"ladybug_release\"].isCompatible(ghenv.Component):\n        lb_preparation = sc.sticky[\"ladybug_Preparation\"]()\n        lb_comfortModels = sc.sticky[\"ladybug_ComfortModels\"]\n        \n        if (_comfortIndex != None) and _comfortIndex in range(19):\n            locationName, latitude, longitude, timeZone, validLocationData, printMsgLocation = getLocationData(_location)\n            if validLocationData:\n                if (len(_dryBulbTemperature) != 0) and (_dryBulbTemperature[0] != None):\n                    if _runIt:\n                        comfortIndexValue, comfortIndexCategory, comfortableOrNot, PETresults, HotExtremeCategory, ColdExtremeCategory, outputNickNames, outputDescriptions, createOutputHeaders, HOYs, date, validWeatherData, printMsgWeather = getWeatherData(latitude, longitude, timeZone, _dryBulbTemperature, meanRadiantTemperature_, dewPointTemperature_, relativeHumidity_, windSpeed_, solarRadiationPerHour_, totalSkyCover_, bodyCharacteristics_, HOY_, analysisPeriod_)\n                        if validWeatherData:\n                            if _comfortIndex != 11:  # not for MRT\n                                if (createOutputHeaders == True): startingIndex = 7\n                                elif (createOutputHeaders == False): startingIndex = 0\n                                percentComfortable = (comfortableOrNot[startingIndex:].count(1))/(len(comfortIndexValue[startingIndex:]))*100\n                                if _comfortIndex != 4:\n                                    percentHotExtreme = (comfortIndexCategory[startingIndex:].count(HotExtremeCategory))/(len(comfortIndexCategory[startingIndex:]))*100\n                                else: # remove percentHotExtreme for WCT\n                                    percentHotExtreme = []\n                                if _comfortIndex not in [0,1,5,6,13,14,18]: # no Cold categories\n                                    percentColdExtreme = (comfortIndexCategory[startingIndex:].count(ColdExtremeCategory))/(len(comfortIndexCategory[startingIndex:]))*100\n                                else:  # remove percentColdExtreme\n                                    percentColdExtreme = []\n                            else:\n                                percentComfortable = percentHotExtreme = percentColdExtreme = []\n                            \n                            generalOutputLists = [\"dummy\", \"comfortIndexValue\", \"comfortIndexCategory\", \"comfortableOrNot\", \"percentComfortable\", \"percentHotExtreme\", \"percentColdExtreme\"]\n                            for i in range(6):\n                                ghenv.Component.Params.Output[i+1].Name = outputNickNames[i]\n                                ghenv.Component.Params.Output[i+1].NickName = outputNickNames[i]\n                                ghenv.Component.Params.Output[i+1].Description = outputDescriptions[i]\n                                exec(\"%s = %s\" % (outputNickNames[i], generalOutputLists[i+1]))\n                            printThermalComfortIndexName(_comfortIndex, date, HOYs, PETresults)\n                        \n                        else:\n                            print printMsgWeather\n                            ghenv.Component.AddRuntimeMessage(level, printMsgWeather)\n                    else:\n                        print \"All inputs are ok. Please set \\\"_runIt\\\" to True, to calculate the chosen Thermal Comfort index\"\n                else:\n                    printMsg = \"Please input _dryBulbTemperature. As a single value, a list of values, or as a list from \\\"Import EPW\\\" component.\"\n                    print printMsg\n                    ghenv.Component.AddRuntimeMessage(level, printMsg)\n            else:\n                print printMsgLocation\n                ghenv.Component.AddRuntimeMessage(level, printMsgLocation)\n        else:\n            printMsgComfortIndex = \"Please input the desired _comfortIndex integer from 0 to 18\"\n            print printMsgComfortIndex\n            ghenv.Component.AddRuntimeMessage(level, printMsgComfortIndex)\n    else:\n        printMsg = \"You need a newer version of Ladybug to use this component.\" + \\\n            \"Use updateLadybug component to update userObjects.\\n\" + \\\n            \"If you have already updated userObjects drag the Ladybug_Ladybug component \" + \\\n            \"into the canvas and try again.\"\n        print printMsg\nelse:\n    printMsg = \"First please let the Ladybug fly...\"\n    print printMsg\n    ghenv.Component.AddRuntimeMessage(level, printMsg)\n",
  "language": "python",
  "imports": [
    "scriptcontext"
  ],
  "has_docstring": true
}