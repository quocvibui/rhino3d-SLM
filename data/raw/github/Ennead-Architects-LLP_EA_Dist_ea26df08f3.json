{
  "source_url": "https://github.com/Ennead-Architects-LLP/EA_Dist/blob/635520d89b8308b78eabf5b60bb80121d0fa3838/Apps/_revit/EnneaDuck.extension/EnneadTab%20Tailor.tab/Personal.panel/Generic%20Order.pulldown/06_group%20by%20creator.pushbutton/group%20by%20creaqtor_script.py",
  "repo": "Ennead-Architects-LLP/EA_Dist",
  "repo_stars": 0,
  "repo_description": null,
  "license": "unknown",
  "filepath": "Apps/_revit/EnneaDuck.extension/EnneadTab Tailor.tab/Personal.panel/Generic Order.pulldown/06_group by creator.pushbutton/group by creaqtor_script.py",
  "instruction": "Group by creaqtor script",
  "code": "__doc__ = \"xxx\"\r\n\r\n\r\n\r\n\"\"\"\r\n\r\nadd text to dim segement from a drop down list\r\n\"\"\"\r\nfrom pyrevit import DB,forms, script, revit\r\n\r\n\r\ndef created_by_who(el):\r\n    history = DB.WorksharingUtils.GetWorksharingTooltipInfo(revit.doc, el.Id)\r\n    if history:\r\n        return history.Creator\r\n    return \"\"\r\n\r\n\r\noutput = script.get_output()\r\noutput.close_others()\r\ngroups = DB.FilteredElementCollector(revit.doc).OfClass(DB.Group).WhereElementIsNotElementType().ToElements()\r\n\r\n\r\ngroup_names = set()\r\ngroup_collection = []\r\nfor group in groups:\r\n    if group.Name in group_names or \"members excluded\" in group.Name:\r\n        continue\r\n    group_names.add(group.Name)\r\n    group_collection.append(group)\r\nwith revit.Transaction(\"rename groups\"):\r\n    for group in group_collection:\r\n        print(\"^\"*10)\r\n        print(group.Name)\r\n        creator = created_by_who(group.GroupType)\r\n        print(creator)\r\n        if creator in group.Name:\r\n            print(\"skip, named this before\")\r\n            continue\r\n        group.GroupType.Name = \"{}_{}\".format(creator, group.Name)\r\n        print(\"new group name = \" + group.Name)\r\n\r\n########note to self to research\r\n#GUI window?\r\n#how did select from para window show extra icon  instance/type by list?\r\n#try to search from directory the name used for revit tab manager?\r\n\r\n\"\"\"\r\nfrom datetime import date\r\nprint(date.today())\r\n\"\"\"\r\n\"\"\"\r\nkeynotes = DB.FilteredElementCollector(revit.doc,revit.active_view.Id)\\\r\n              .OfCategory(DB.BuiltInCategory.OST_KeynoteTags)\\\r\n              .WhereElementIsNotElementType()\\\r\n              .ToElements()\r\n\"\"\"\r\n\r\n\"\"\"# ICollections format: System.Collections.Generic.List[DB.date type]([list data])\r\n    shapes = [shapes list]\r\n    shape_collection = System.Collections.Generic.List[DB.ElementId]([x.Id for x in shapes])\r\n    revit.active_view.IsolateElementsTemporary(shape_collection)\r\n\"\"\"\r\n\r\n\"\"\"##Rhino - Rhino3dmIO\r\n\r\nRhino3dmIO is a subset of RhinoCommon and it gives you access to openNurbs, allowing you to, amongst other things, read and write 3dm files.\r\n>>> from rpw.extras.rhino import Rhino as rc\r\n>>> pt1 = rc.Geometry.Point3d(0,0,0)\r\n>>> pt2 = rc.Geometry.Point3d(10,10,0)\r\n>>> line1 = rc.Geometry.Line(pt1, pt2)\r\n>>> line1.Length\r\n14.142135623730951\r\n>>>\r\n>>> pt1 = rc.Geometry.Point3d(10,0,0)\r\n>>> pt2 = rc.Geometry.Point3d(0,10,0)\r\n>>> line2 = rc.Geometry.Line(pt1, pt2)\r\n>>>\r\n>>> rc.Geometry.Intersect.Intersection.LineLine(line1, line2)\r\n(True, 0.5, 0.5)\r\n>>>\r\n>>> file3dm = f = rc.FileIO.File3dm()\r\n>>> file3md_options = rc.FileIO.File3dmWriteOptions()\r\n>>> file3dm.Objects.AddLine(line1)\r\n>>> filepath = 'c:/folder/test.3dm'\r\n>>> file3dm.Write(filepath, file3md_options)\r\n\"\"\"\r\n\r\n\"\"\"\r\noutput = pyrevit.output.get_output()\r\noutput.print_image(r'C:\\image.gif')\r\n\"\"\"\r\n\r\n\r\n\r\n\r\n\"\"\"\r\nno_sheet_views.sort(key = lambda x: x.ViewType, reverse = True)\r\n\"\"\"\r\n\r\n\r\n\"\"\"\r\nwith forms.WarningBar(title='Pick title corner point'):\r\n    ref_pt = revit.pick_point()\r\n\"\"\"\r\n\r\n\r\n\"\"\"\r\nsel_sheets = forms.select_sheets(title='Select Sheets That contain views that you want to do temperory template')\r\n\"\"\"\r\n\r\n\"\"\"\r\nres = forms.alert(options = [\"mark title corners at sheets\", \"remove existing marks from sheets.\"], msg = \"I want to [.....]\")\r\n\r\nif \"remove\" in res:\r\n    option = False\r\nelif \"mark\" in res:\r\n    option = True\r\nelse:\r\n    script.exit()\r\n\"\"\"\r\n\r\n\"\"\"\r\nforms.alert(msg = '{0} FILES RENAMED.'.format(sheetcount), sub_msg = fail_text)\r\n\"\"\"\r\n\r\n\r\n\r\n\"\"\"\r\nfrom pyrevit import forms\r\nitems = ['item1', 'item2', 'item3']\r\nres = forms.SelectFromList.show(items, button_name='Select Item')\r\nif res == 'item1':\r\n    do_stuff()\r\n~~~~~\r\nops = [viewsheet1, viewsheet2, viewsheet3]\r\nres = forms.SelectFromList.show(ops,\r\n                                multiselect=False,\r\n                                name_attr='Name',\r\n                                button_name='Select Sheet')\r\nif res.Id == viewsheet1.Id:\r\n    do_stuff()\r\n~~~\r\nforms.SelectFromList.show(\r\n        {'All': '1 2 3 4 5 6 7 8 9 0'.split(),\r\n         'Odd': '1 3 5 7 9'.split(),\r\n         'Even': '2 4 6 8 0'.split()},\r\n        title='MultiGroup List',\r\n        group_selector_title='Select Integer Range:',\r\n        multiselect=True\r\n    )\r\n~~~\r\nops = {'Sheet Set A': [viewsheet1, viewsheet2, viewsheet3],\r\n       'Sheet Set B': [viewsheet4, viewsheet5, viewsheet6]}\r\nres = forms.SelectFromList.show(ops,\r\n                                multiselect=True,\r\n                                name_attr='Name',\r\n                                group_selector_title='Sheet Sets',\r\n                                button_name='Select Sheets')\r\nif res.Id == viewsheet1.Id:\r\n    do_stuff()\r\n~~~\r\nfrom pyrevit import forms\r\n\r\nclass MyOption(forms.TemplateListItem):\r\n    @property\r\n    def name(self):\r\n        return \"Option: {}\".format(self.item)\r\n\r\nops = [MyOption('op1'), MyOption('op2', checked=True), MyOption('op3')]\r\nres = forms.SelectFromList.show(ops,\r\n                                multiselect=True,\r\n                                button_name='Select Item')\r\n~~~\r\n\r\nselected_views = forms.SelectFromList.show(no_sheet_views,\r\n                                multiselect=True,\r\n                                name_attr='Name',\r\n                                title = \"Those views are not on sheet\",\r\n                                button_name= \"Mark them with 'NoSheet-' prefix\",\r\n                                filterfunc=lambda x: x.ViewType not in [DB.ViewType.Legend, DB.ViewType.Schedule])\r\n\"\"\"\r\n\r\n\r\n\"\"\"\r\nDB.FilteredElementCollector(revit.doc).OfClass(DB.RevitLinkInstance).WhereElementIsNotElementType().ToElements()\r\n\r\n.OfCategory(DB.BuiltInCategory.OST_Massing)\r\n\"\"\"\r\n\r\n\r\n\r\n\"\"\"\r\nwith revit.Transaction(\"Mark NoSheet Views\"):\r\n    for view in selected_views:\r\n        new_name = \"NoSheet-\" + view.Name\r\n        view.Parameter[DB.BuiltInParameter.VIEW_NAME].Set(new_name)\r\n\"\"\"\r\n\r\n\r\n\r\n\"\"\"\r\ndef final_print_table():\r\n    table_data = []\r\n    for item in view_item_collection:\r\n        if item.view_name in view_item_collection_selected:\r\n            #temp_list = [item.critical_level_text, item.view_name, item.line_count]\r\n            temp_list = [ item.critical_level_text, item.view_name, item.line_count, output.linkify(item.id, title = \"Go To View\")]\r\n            table_data.append(temp_list)\r\n\r\n    output.print_table(table_data=table_data,title=\"Bad Views by Line Count \",columns=[ \"Critical Level\", \"View Name\", \"Line Count\", \"View Link\"],formats=['', '{}', '{} Lines', '{}'])\r\n\"\"\"\r\n\r\n\r\n\r\n\"\"\"\r\nselection = revit.get_selection()\r\n\r\nif len(selection) > 1:\r\n    forms.alert(\"Please select 1 tags only.\")\r\n    script.exit()\r\n\r\nif \"Tags\" not in selection[0].Category.Name:\r\n    forms.alert(\"This is not a tag.\")\r\n    script.exit()\r\n\"\"\"\r\n\"\"\"\r\nref_tag = revit.doc.GetElement(get_ref_tag_id())\r\n\"\"\"\r\n",
  "language": "python",
  "imports": [
    "RhinoCommon"
  ],
  "has_docstring": false
}