{
  "source_url": "https://github.com/PH-Tools/honeybee_grasshopper_ph_plus/blob/b89f9887488d9c10eb732ffafe910cec70be0752/honeybee_grasshopper_ph_plus/src/HBPH%2B%20-%20Export%20PDFs.py",
  "repo": "PH-Tools/honeybee_grasshopper_ph_plus",
  "repo_stars": 2,
  "repo_description": "Additional Honeybe-PH Grasshopper Components",
  "license": "GPL-3.0",
  "filepath": "honeybee_grasshopper_ph_plus/src/HBPH+ - Export PDFs.py",
  "instruction": "This component is used to create PDF report pages from the Honeybee-Model geometry. This \nis especially useful when submitting projects for compliance review and you need to generate\na batch of...",
  "code": "#\n# Honeybee-PH: A Plugin for adding Passive-House data to LadybugTools Honeybee-Energy Models\n# \n# This component is part of the PH-Tools toolkit <https://github.com/PH-Tools>.\n# \n# Copyright (c) 2022, PH-Tools and bldgtyp, llc <phtools@bldgtyp.com> \n# Honeybee-PH is free software; you can redistribute it and/or modify \n# it under the terms of the GNU General Public License as published \n# by the Free Software Foundation; either version 3 of the License, \n# or (at your option) any later version. \n# \n# Honeybee-PH is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of \n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the \n# GNU General Public License for more details.\n# \n# For a copy of the GNU General Public License\n# see <https://github.com/PH-Tools/honeybee_ph/blob/main/LICENSE>.\n# \n# @license GPL-3.0+ <http://spdx.org/licenses/GPL-3.0+>\n#\n\"\"\"\nThis component is used to create PDF report pages from the Honeybee-Model geometry. This \nis especially useful when submitting projects for compliance review and you need to generate\na batch of standardized report pages. This component will accept DataTrees where each brach of the \nDataTree represents a separate PDF file to output. \n-\nThis component will temporarily bake geometry and text annotations to the Rhnio scene, set the layer-states, and \ncontrol the active view. Once the PDF export is complete, the component should reset the Rhino\nlayer-states and active-view to the same state as before export.\n-\nNote: printing from Rhino is a huge pain. This exporter *seems* to work best when you set your DetailView to \n'Wireframe' display mode most of the time. If you are getting funny results, try setting your Display Mode\nand turning off things like shadows to see if that helps. If you are having trouble with 'draw-order' (ie: \nsome things 'in front' are showing up 'behind' etc., try setting '_raster' to True. Vector export seems to \ncause all sorts of unexpected results sometimes.\n-\nSet the component '_export_pdfs' to 'True' to run the exporter.\n-\nEM April 10, 2025\n    Args:\n        _save_folder: (str) The name of the target folder to save the PDF files to.\n        \n        _file_names: (Tree[str]) A Tree where each branch contains the name of the PDF file to export.\n        \n        _layout_names: (Tree[str]) A Tree of namea of the Rhino-Layout to use when exporting the PDF report.\n        \n        _layers_on: (List[str]) A list of the Layer names to leave 'on' (visible) when exporting\n            to PDF. When the exporter is run, all layers EXCEPT the ones listed here will be turned\n            off, and then the original layer-state will be reset when the PDF export is complete.\n            \n        _clipping_plane_locations: (Tree[ClippingPlaneLocation]): A Tree of ClippingPlaneLocation\n            objects which describe the location, normal, and target views of any Clipping Planes\n            in the Scene. This is useful when outputting things like floor plans and you would like \n            to isolate just a certain portion of the Rhino scene when exporting PDF drawings.\n            \n        _geom: (Tree[Rhino.Geometry]) A Tree of Rhino Geometry. Each branch of the tree will be baked\n            to the Rhino scene, exported as a PDF, and then removed from the scene.\n            \n        _geom_attributes: (Tree[ObjectAttributes]) A Tree of Rhino ObjectAttributes which will be \n            used to bake the objects to the scene.\n        \n        _model_annotations: (Tree[TextAnnotation]) A Tree of TextAnnotation objects. Create these objects \n            using the \"HBPH - Create Text Annotation\" component. Any TextAnnotations input here will be \n            baked to the Rhino Scene (Model-space).\n            \n        _layout_annotations: (Tree[TextAnnotation]) A Tree of TextAnnotation objects. Create these objects \n            using the \"HBPH - Create Text Annotation\" component. Any TextAnnotations input here will be \n            baked to the Rhino Layout (Paper-space).\n            \n        _raster: (bool) default=False (vector). Set True to output the PDF as a raster image. This is \n            sometimes needed when Rhino is unable to properly output vector artwork. If you are \n            having trouble with draw-order or line-weights / types, try setting to True.\n            \n        _remove_baked_items: (bool) default=True. If you need to troubleshoot, try setting this to \n            False in order to be able to clearly see and investigate the geometry and Annotations that \n            are created during the print-to-pdf process. Note that you should delete the generated geometry\n            and the new layers before running this PDF writing again. \n\n        _export_pdfs: (bool) Set True to run the exporter.\n\n    Returns:\n        file_paths_: The full path(s) to the PDF files created.\n\"\"\"\n\nimport scriptcontext as sc\nimport Rhino as rh\nimport rhinoscriptsyntax as rs\nimport ghpythonlib.components as ghc\nimport Grasshopper as gh\n\ntry:\n    from ph_gh_component_io import gh_io\nexcept ImportError as e:\n    raise ImportError('\\nFailed to import ph_gh_component_io:\\n\\t{}'.format(e))\n\ntry:\n    from honeybee_ph_plus_rhino.gh_compo_io.reporting import to_pdf\nexcept ImportError as e:\n    raise ImportError('\\nFailed to import honeybee_ph_plus_rhino:\\n\\t{}'.format(e))\n\n\n# ------------------------------------------------------------------------------\nimport honeybee_ph_plus_rhino._component_info_\nreload(honeybee_ph_plus_rhino._component_info_)\nghenv.Component.Name = \"HBPH+ - Export PDFs\"\nDEV = honeybee_ph_plus_rhino._component_info_.set_component_params(ghenv, dev=False)\nif DEV:\n    reload(gh_io)\n    reload(to_pdf)\n\n\n# ------------------------------------------------------------------------------\n# -- GH Interface\nIGH = gh_io.IGH( ghdoc, ghenv, sc, rh, rs, ghc, gh )\n\n# ------------------------------------------------------------------------------\nfile_paths_ = to_pdf.gen_file_paths(_save_folder, _file_names, _geom.BranchCount)\nlayout_names_ = to_pdf.gen_layout_names(_layout_names, _geom.BranchCount) \n\n\nif file_paths_ and _geom and layout_names_ and _export_pdfs:\n    to_pdf.export_pdfs(\n                IGH,\n                file_paths_,\n                layout_names_,\n                _layers_on,\n                _clipping_plane_locations,\n                _geom,\n                _geom_attributes,\n                _model_annotations,\n                _layout_annotations,\n                _remove_baked_objects,\n                _raster,\n            )\n",
  "language": "python",
  "imports": [
    "Rhino",
    "Rhino.Geometry",
    "ghpythonlib",
    "rhinoscriptsyntax",
    "scriptcontext"
  ],
  "has_docstring": true
}