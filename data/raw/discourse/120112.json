{
  "source_url": "https://discourse.mcneel.com/t/rhino-plugin-for-both-6-7-what-version-of-rhinocommon-do-i-need-to-ref/120112",
  "topic_id": 120112,
  "title": "Rhino plugin for both 6 & 7 - what version of Rhinocommon do I need to ref?",
  "question": "Hello,\n\n\nPreviously when referencing Rhinocommon 6.26.20147.6511 my plugins would work in both R6 & R7. Just made a new build pointing to the same version of Rhinocommon and it doesnâ€™t seem to work on R7. (Just updated to the latest 7.4 version.)\n\n\nGiven that limited information, is there something I am missing here with R7?\n\n\nAlso something funny happening here where I open Rhino 7, and on my taskbar it previews as a R6 iconâ€¦ \n\n\nMicrosoftTeams-image\n1076Ã—770 131 KB\n\n\n\n\nAny input is appreciated, thanks!\n\nMarco",
  "code_blocks": [
    {
      "code": "public override PlugInLoadTime LoadTime\n        {\n            get { return PlugInLoadTime.AtStartup; }\n        }\n    protected override LoadReturnCode OnLoad(ref string errorMessage)\n            {\n                try\n                {\n                    RhinoDoc.EndOpenDocument -= OnEndOpenDocument;\n                    RhinoDoc.CloseDocument -= OnCloseDocument;\n\n                    RhinoDoc.EndOpenDocument += OnEndOpenDocument;\n                    RhinoDoc.CloseDocument += OnCloseDocument;\n\n                    RhinoApp.WriteLine(\"RhinoTracker loaded ðŸ¦.\");\n                    RhinoApp.WriteLine(\"Hey {0}!!\", Environment.UserName);\n                }\n                catch(Exception ex)\n                {\n                    RhinoApp.WriteLine(ex.ToString());\n                }\n\n                return LoadReturnCode.Success;\n            }",
      "language": "csharp",
      "author": "marcotjuliani",
      "post_number": 5,
      "is_solution": false
    },
    {
      "code": "> The thread 0x5948 has exited with code 0 (0x0).\n> 'Rhino.exe' (CLR v4.0.30319: DefaultDomain): Loaded 'Microsoft.GeneratedCode'. \n> 'Rhino.exe' (CLR v4.0.30319: DefaultDomain): Loaded 'C:\\Program Files\\Enscape\\Bin64\\CsvHelper.dll'. Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.\n> 'Rhino.exe' (CLR v4.0.30319: DefaultDomain): Loaded 'C:\\Users\\marco.juliani\\AppData\\Roaming\\McNeel\\Rhinoceros\\6.0\\Plug-ins\\Marmot (b9b3c836-5b53-4f93-b359-e64bdf2a159b)\\6.0.0.0\\Marmot.rhp'. \n> 'Rhino.exe' (CLR v4.0.30319: DefaultDomain): Loaded 'C:\\Users\\marco.juliani\\AppData\\Roaming\\McNeel\\Rhinoceros\\6.0\\Plug-ins\\Twinmotion Direct Link 2020.2 (e24ee14a-9514-47da-8fe6-f6e61b20160e)\\Twinmotion Direct Link 2020.rhp'. Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.\n> 'Rhino.exe' (CLR v4.0.30319: DefaultDomain): Loaded 'C:\\Users\\marco.juliani\\AppData\\Roaming\\McNeel\\Rhinoceros\\6.0\\Plug-ins\\Speckle Rhino Plugin (512d9705-6f92-49ca-a606-d6d5c1ac6aa2)\\SpeckleWinR6.rhp'. Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.\n> 'Rhino.exe' (CLR v4.0.30319: DefaultDomain): Loaded 'C:\\Users\\marco.juliani\\AppData\\Roaming\\McNeel\\Rhinoceros\\6.0\\Plug-ins\\Speckle Rhino Plugin (512d9705-6f92-49ca-a606-d6d5c1ac6aa2)\\SpeckleCore.dll'. Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.\n> 'Rhino.exe' (CLR v4.0.30319: DefaultDomain): Loaded 'C:\\WINDOWS\\Microsoft.Net\\assembly\\GAC_MSIL\\System.Runtime.Extensions\\v4.0_4.0.0.0__b03f5f7f11d50a3a\\System.Runtime.Extensions.dll'. Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.\n> 'Rhino.exe' (CLR v4.0.30319: DefaultDomain): Loaded 'C:\\Users\\marco.juliani\\AppData\\Local\\SpeckleKits\\SpeckleCoreGeometry\\SpeckleCoreGeometryClasses.dll'. Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.\n> 'Rhino.exe' (CLR v4.0.30319: DefaultDomain): Loaded 'C:\\Users\\marco.juliani\\AppData\\Local\\SpeckleKits\\SpeckleCoreGeometry\\SpeckleCoreGeometryDynamo.dll'. Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.\n> 'Rhino.exe' (CLR v4.0.30319: DefaultDomain): Loaded 'C:\\Users\\marco.juliani\\AppData\\Local\\SpeckleKits\\SpeckleCoreGeometry\\SpeckleCoreGeometryRevit.dll'. Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.\n> 'Rhino.exe' (CLR v4.0.30319: DefaultDomain): Loaded 'C:\\Users\\marco.juliani\\AppData\\Local\\SpeckleKits\\SpeckleCoreGeometry\\SpeckleCoreGeometryRhino.dll'. Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.\n> 'Rhino.exe' (CLR v4.0.30319: DefaultDomain): Loaded 'C:\\Users\\marco.juliani\\AppData\\Local\\SpeckleKits\\SpeckleElements\\SpeckleElementsClasses.dll'. Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.\n> 'Rhino.exe' (CLR v4.0.30319: DefaultDomain): Loaded 'C:\\Users\\marco.juliani\\AppData\\Roaming\\McNeel\\Rhinoceros\\6.0\\Plug-ins\\Speckle Rhino Plugin (512d9705-6f92-49ca-a606-d6d5c1ac6aa2)\\Countly.dll'. Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.\n> 'Rhino.exe' (CLR v4.0.30319: DefaultDomain): Loaded 'C:\\Users\\marco.juliani\\AppData\\Roaming\\McNeel\\Rhinoceros\\6.0\\Plug-ins\\Speckle Rhino Plugin (512d9705-6f92-49ca-a606-d6d5c1ac6aa2)\\Microsoft.Threading.Tasks.dll'. Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.\n> The thread 0x433c has exited with code 0 (0x0).\n> 'Rhino.exe' (CLR v4.0.30319: DefaultDomain): Loaded 'C:\\Program Files\\Rhino 6\\Plug-ins\\Grasshopper\\GrasshopperPlugin.rhp'. Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.\n> 'Rhino.exe' (CLR v4.0.30319: DefaultDomain): Loaded 'C:\\Program Files\\Rhino 6\\Plug-ins\\Grasshopper\\Grasshopper.dll'. Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.\n> 'Rhino.exe' (CLR v4.0.30319: DefaultDomain): Loaded 'C:\\WINDOWS\\Microsoft.Net\\assembly\\GAC_MSIL\\Microsoft.VisualBasic\\v4.0_10.0.0.0__b03f5f7f11d50a3a\\Microsoft.VisualBasic.dll'. Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.\n> 'Rhino.exe' (CLR v4.0.30319: DefaultDomain): Loaded 'C:\\Program Files\\Rhino 6\\Plug-ins\\Grasshopper\\GH_IO.dll'. Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.\n> 'Rhino.exe' (CLR v4.0.30319: DefaultDomain): Loaded 'C:\\Program Files\\Rhino 6\\System\\NLog.dll'. Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.\n> 'Rhino.exe' (CLR v4.0.30319: DefaultDomain): Loaded 'C:\\Program Files\\Rhino 6\\System\\NLog.Targets.Syslog.dll'. Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.",
      "language": "unknown",
      "author": "marcotjuliani",
      "post_number": 6,
      "is_solution": false
    }
  ],
  "tags": [
    "csharp",
    "file-io",
    "geometry",
    "grasshopper",
    "rhinocommon"
  ],
  "has_accepted_answer": true,
  "category_id": 3,
  "posts_count": 10,
  "views": 948
}