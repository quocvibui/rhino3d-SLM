{
  "source_url": "https://discourse.mcneel.com/t/alignment-objects-at-the-same-distance-from-each-other/187869",
  "topic_id": 187869,
  "title": "Alignment objects at the same distance from each other",
  "question": "1\n2171×543 160 KB\n\nHi all.\n\nThis is the UV Curve of cylinder, which has a 60 mm in length.\n\nIn this example, there are three united groups inside the bounding boxes.\n\nThese groups need to be distributed at the same distance from each other.\n\n\nIn manual I make calculations as follows:\n\n\nI use the addition operation, length of each BB group together (10.84 + 13.19 + 20.97 = 45), then the resulting value subtract from the length of UV curve (60 - 45 = 15).\n\n\n2\n2125×492 158 KB\n\n\nThe resulting difference (15) is divided into the number of objects or groups (3) 15/3 = 5\n\nThis value (5) will be the same distance between objects.\n\nOne of the distances (5) divide into 2.   5/2 = 2.5. The resulting value  (2.5) will be the distance from the left and right sides of UV curve.\n\n\n3\n2304×464 149 KB\n\n\nCan someone help write a script that would make these calculations and move objects automatically?\n\n\nThanks in advance.",
  "code_blocks": [
    {
      "code": "import Rhino\nimport rhinoscriptsyntax as rs\nimport scriptcontext as sc\n\ndef AlignObjs():\n    frame=rs.GetObjects(\"Select frame\")\n    objects=rs.GetObjects(\"Select objects to align\")\n    \n    \n    total_length = frame\n    words_length = objects\n    \n    words_length =0\n    for wl in words_length:\n        words_length += wl\n\n    remainder = total_length-words_length\n    am = len(words)\n    increment = remainder / am\n    pos_x = increment/2\n    for i, word in enumerate(words):\n       if i == am-1:\n           break\n    word.xpos = pos_x\n    pox_x += increment\n    pos_x += word_lengths[i]\nAlignObjs()",
      "language": "python",
      "author": "leex",
      "post_number": 7,
      "is_solution": false
    },
    {
      "code": "import rhinoscriptsyntax as rs\n\ndef AlignObjs():\n    frame = rs.GetObjects(\"Select frame\")\n    frame_bbox = rs.BoundingBox(frame)\n    frame_left = frame_bbox[0][0]\n    frame_width = abs(frame_bbox[0][0] - frame_bbox[1][0])\n    \n    objects = rs.GetObjects(\"Select objects to align\")\n    bboxes = [rs.BoundingBox(obj) for obj in objects]\n    widths = [abs(bbox[0][0] - bbox[1][0]) for bbox in bboxes]\n    x_positions = [bbox[0][0] for bbox in bboxes]\n\n    width_sum = sum(widths)\n    gap = (frame_width - width_sum) / len(objects)\n    current_x = frame_left + (gap/2)\n    \n    for i, obj in enumerate(objects):\n        transform = [current_x - x_positions[i] ,0 ,0]\n        rs.MoveObject(obj, transform)\n        current_x += widths[i] + gap\n\nAlignObjs()",
      "language": "python",
      "author": "kev.r",
      "post_number": 12,
      "is_solution": false
    },
    {
      "code": "import rhinoscriptsyntax as rs\n\ndef onegroup_filt(rhino_object, geometry, component_index):\n    return rhino_object.GroupCount==1\n    \n    \ndef ConvertGroupsToBlocks():\n    msg=\"Select group of objects to convert to block\"\n    objs=rs.GetObjects(msg,group=True,preselect=True,custom_filter=onegroup_filt)\n    if not objs: return\n    group_set=set()\n    for obj in objs:\n        obj_g_names=rs.ObjectGroups(obj)\n        for g_name in obj_g_names:\n            group_set.add(g_name)\n    all_obj_groups=list(group_set)\n    \n    #all_obj_groups should now contain unique list of groups\n    for group in all_obj_groups:\n        g_objs=rs.ObjectsByGroup(group)\n        origin=rs.coerce3dpoint([0,0,0])\n        block=rs.AddBlock(g_objs,origin,group,delete_input=True)\n        rs.InsertBlock(block,origin)\n    \nConvertGroupsToBlocks()\n\n\n\ndef AlignObjs():\n    frame = rs.GetObjects(\"Select frame\")\n    frame_bbox = rs.BoundingBox(frame)\n    frame_left = frame_bbox[0][0]\n    frame_width = abs(frame_bbox[0][0] - frame_bbox[1][0])\n\n    objects = rs.GetObjects(\"Select objects to align\")\n    bboxes = [rs.BoundingBox(obj) for obj in objects]\n    widths = [abs(bbox[0][0] - bbox[1][0]) for bbox in bboxes]\n    x_positions = [bbox[0][0] for bbox in bboxes]\n\n    width_sum = sum(widths)\n    gap = (frame_width - width_sum) / len(objects)\n    current_x = frame_left + (gap/2)\n    \n    for i, obj in enumerate(objects):\n        transform = [current_x - x_positions[i] ,0 ,0]\n        rs.MoveObject(obj, transform)\n        current_x += widths[i] + gap\n        rs.UnselectAllObjects()\n\nAlignObjs()",
      "language": "python",
      "author": "leex",
      "post_number": 14,
      "is_solution": false
    },
    {
      "code": "import rhinoscriptsyntax as rs\n\ndef onegroup_filt(rhino_object, geometry, component_index):\n    return rhino_object.GroupCount==1\n    \n    \ndef ConvertGroupsToBlocks():\n    msg=\"Select group of objects to convert to block\"\n    objs=rs.GetObjects(msg,group=True,preselect=True,custom_filter=onegroup_filt)\n    if not objs: return\n    group_set=set()\n    for obj in objs:\n        obj_g_names=rs.ObjectGroups(obj)\n        for g_name in obj_g_names:\n            group_set.add(g_name)\n    all_obj_groups=list(group_set)\n    \n    #all_obj_groups should now contain unique list of groups\n    for group in all_obj_groups:\n        g_objs=rs.ObjectsByGroup(group)\n        origin=rs.coerce3dpoint([0,0,0])\n        block=rs.AddBlock(g_objs,origin,group,delete_input=True)\n        rs.InsertBlock(block,origin)\n    \nConvertGroupsToBlocks()\n\n\n\ndef AlignObjs():\n \n\n    objects = rs.GetObjects(\"Select objects to align\")\n    bboxes = [rs.BoundingBox(obj) for obj in objects]\n    \n    frame = rs.GetObjects(\"Select frame\")\n    frame_bbox = rs.BoundingBox(frame)\n    frame_left = frame_bbox[0][0]\n    frame_width = abs(frame_bbox[0][0] - frame_bbox[1][0])\n    \n    \n    widths = [abs(bbox[0][0] - bbox[1][0]) for bbox in bboxes]\n    x_positions = [bbox[0][0] for bbox in bboxes]\n\n    width_sum = sum(widths)\n    gap = (frame_width - width_sum) / len(objects)\n    current_x = frame_left + (gap/2)\n    \n    for i, obj in enumerate(objects):\n        transform = [current_x - x_positions[i] ,0 ,0]\n        rs.MoveObject(obj, transform)\n        current_x += widths[i] + gap\n        rs.UnselectAllObjects()\n\nAlignObjs()",
      "language": "python",
      "author": "leex",
      "post_number": 15,
      "is_solution": false
    },
    {
      "code": "import scriptcontext as sc\nimport rhinoscriptsyntax as rs\nimport Rhino\n\n\ndef AlignObjs():\n   \n    #SelectOneByOne\n    \n    msg = \"Select cures to sort\"\n    obj_ids = rs.GetObjects(msg, 4096)\n    if not obj_ids: return\n    \n    rh_objs = [rs.coercerhinoobject(obj_id, True, True) for obj_id in obj_ids]\n    \n    def SortFunction(rh_obj):\n        bbox = rh_obj.Geometry.GetBoundingBox(True)\n        return (-bbox.Center.Y, bbox.Center.X)\n    \n    rh_objs.sort(key=SortFunction)\n    \n    for i, rh_obj in enumerate(rh_objs):\n        bbox = rh_obj.Geometry.GetBoundingBox(True)\n       \n        \n    for i, rh_obj in enumerate(rh_objs):\n        bbox = rh_obj.Geometry.GetBoundingBox(True)\n        rs.SelectObject(rh_obj)\n        rs.Sleep(500)\n\n\n\n    #AlignObjs\n    objects = rs.GetObjects(\"Select objects to align\", preselect=True)\n    bboxes = [rs.BoundingBox(obj) for obj in objects]\n    \n    frame = rs.GetObjects(\"Select frame\")\n    frame_bbox = rs.BoundingBox(frame)\n    frame_left = frame_bbox[0][0]\n    frame_width = abs(frame_bbox[0][0] - frame_bbox[1][0])\n    \n    \n    widths = [abs(bbox[0][0] - bbox[1][0]) for bbox in bboxes]\n    x_positions = [bbox[0][0] for bbox in bboxes]\n\n    width_sum = sum(widths)\n    gap = (frame_width - width_sum) / len(objects)\n    current_x = frame_left + (gap/2)\n    \n    for i, obj in enumerate(objects):\n        transform = [current_x - x_positions[i] ,0 ,0]\n        BlockAligng=rs.MoveObject(obj, transform)\n        current_x += widths[i] + gap\n        rs.SelectObjects(BlockAligng)\n\n        \n        \n        \n    #BlocksToGroups\n    ids = rs.GetObjects(\"Select block instances to convert\", 4096, preselect=True)\n    if not ids: return\n    \n\n    for id in ids:\n        rs.UnselectAllObjects()\n        rs.SelectObject(id)\n        rs.Command(\"_ExplodeBlock\")\n        rs.Command(\"_Group\")\n        \n    rs.UnselectAllObjects()\n    \nAlignObjs()",
      "language": "python",
      "author": "leex",
      "post_number": 16,
      "is_solution": false
    },
    {
      "code": "import scriptcontext as sc\nimport rhinoscriptsyntax as rs\nimport Rhino\n\n\ndef AlignObjs():\n\n    objects = rs.GetObjects(\"Select objects to align\", preselect=True)\n    bboxes = [rs.BoundingBox(obj) for obj in objects]\n    \n    frame = rs.GetObjects(\"Select frame\")\n    frame_bbox = rs.BoundingBox(frame)\n    frame_left = frame_bbox[0][0]\n    frame_width = abs(frame_bbox[0][0] - frame_bbox[1][0])\n    \n    \n    widths = [abs(bbox[0][0] - bbox[1][0]) for bbox in bboxes]\n    x_positions = [bbox[0][0] for bbox in bboxes]\n\n    width_sum = sum(widths)\n    gap = (frame_width - width_sum) / len(objects)\n    current_x = frame_left + (gap/2)\n    \n    for i, obj in enumerate(objects):\n        transform = [current_x - x_positions[i] ,0 ,0]\n        BlockAligng=rs.MoveObject(obj, transform)\n        current_x += widths[i] + gap\n        rs.SelectObjects(BlockAligng)\n\n        \n        \n        \n    #BlocksToGroups\n    ids = rs.GetObjects(\"Select block instances to convert\", 4096, preselect=True)\n    if not ids: return\n    \n\n    for id in ids:\n        rs.UnselectAllObjects()\n        rs.SelectObject(id)\n        rs.Command(\"_ExplodeBlock\")\n        rs.Command(\"_Group\")\n        \n    rs.UnselectAllObjects()\n    \nAlignObjs()",
      "language": "python",
      "author": "leex",
      "post_number": 16,
      "is_solution": false
    },
    {
      "code": "import rhinoscriptsyntax as rs\n\ndef AlignX_EqualSpacing():\n    \"\"\"\n    Aligns objects horizontally with equal spacing.\n    - Supports a frame (rectangle) or guiding curve\n    - Equal gaps between objects\n    - Edge gaps are half the size of the inter-object gaps\n    - Preserves group structure and left-to-right order\n    Compatible with Rhino 7 and Rhino 8\n    \"\"\"\n\n    # Get selected objects including frame or guide curve\n    objs = rs.GetObjects(\"Select objects and a guiding curve or frame\", preselect=True)\n    if not objs:\n        rs.MessageBox(\n            \"Warning:\\n\\n\"\n            \"No objects selected for alignment!\\n\"\n            \"Please select the objects you want to align\\n\"\n            \"along with the guiding curve or frame.\", 48\n        )\n        return\n\n    # Identify the guiding frame or curve\n    frame = None\n    max_width = 0\n    objects_to_align = []\n\n    for obj in objs:\n        if rs.IsCurve(obj):  # Check if it's a guiding curve or frame\n            bbox = rs.BoundingBox(obj)\n            if bbox:\n                width = bbox[1][0] - bbox[0][0]\n                if width > max_width:\n                    if frame:\n                        objects_to_align.append(frame)\n                    frame = obj\n                    max_width = width\n                    continue\n        objects_to_align.append(obj)\n\n    if not frame:\n        rs.MessageBox(\n            \"Warning:\\n\\n\"\n            \"No guiding curve or frame found!\\n\"\n            \"Please include a horizontal guiding curve\\n\"\n            \"or a frame to align the objects.\", 48\n        )\n        return\n\n    if len(objects_to_align) == 0:\n        rs.MessageBox(\n            \"Warning:\\n\\n\"\n            \"Only a guiding curve or frame was selected.\\n\"\n            \"Please also select objects to align.\", 48\n        )\n        return\n\n    # Get frame's left and right X coordinates\n    frame_bbox = rs.BoundingBox(frame)\n    frame_start = min(pt[0] for pt in frame_bbox)\n    frame_end = max(pt[0] for pt in frame_bbox)\n    frame_width = frame_end - frame_start\n\n    # Separate grouped and ungrouped objects\n    grouped = {}\n    singles = []\n\n    for obj in objects_to_align:\n        grps = rs.ObjectGroups(obj)\n        if grps:\n            name = grps[0]\n            if name not in grouped:\n                grouped[name] = []\n            grouped[name].append(obj)\n        else:\n            singles.append(obj)\n\n    # Prepare a list of items to align\n    items = list(singles)\n    for g in grouped.values():\n        if g:\n            items.append(g[0])  # Add first object from each group as representative\n\n    # Collect width and position data for each item/group\n    items_data = []\n    for item in items:\n        if item in singles:\n            box = rs.BoundingBox(item)\n            items_data.append({\n                'width': box[1][0] - box[0][0],\n                'pos': box[0][0],\n                'obj': item,\n                'type': 'single'\n            })\n        else:\n            group_name = rs.ObjectGroups(item)[0]\n            members = rs.ObjectsByGroup(group_name)\n            boxes = [rs.BoundingBox(o) for o in members if rs.BoundingBox(o)]\n            min_x = min(b[0][0] for b in boxes)\n            max_x = max(b[1][0] for b in boxes)\n            items_data.append({\n                'width': max_x - min_x,\n                'pos': min_x,\n                'objects': members,\n                'type': 'group'\n            })\n\n    # Sort all items from left to right\n    items_data.sort(key=lambda x: x['pos'])\n    total_width = sum(i['width'] for i in items_data)\n    count = len(items_data)\n\n    # Calculate gaps between items and on sides\n    if count > 1:\n        gap = (frame_width - total_width) / (count - 1 + 1)  # N-1 gaps + 2 half-gaps\n        side_gap = gap / 2\n    else:\n        gap = 0\n        side_gap = (frame_width - total_width) / 2\n\n    if gap < 0:\n        rs.MessageBox(\n            \"Warning:\\n\\n\"\n            \"The frame or guiding curve is too small\\n\"\n            \"to fit all objects with equal gaps!\", 48\n        )\n        return\n\n    # Move each item into aligned position\n    current_x = frame_start + side_gap\n    for item in items_data:\n        dx = current_x - item['pos']\n        if item['type'] == 'single':\n            rs.MoveObject(item['obj'], (dx, 0, 0))\n        else:\n            for o in item['objects']:\n                rs.MoveObject(o, (dx, 0, 0))\n        current_x += item['width'] + gap\n\n    rs.UnselectAllObjects()\n\n\nif __name__ == \"__main__\":\n    AlignX_EqualSpacing()",
      "language": "python",
      "author": "leex",
      "post_number": 22,
      "is_solution": true
    }
  ],
  "tags": [
    "file-io",
    "geometry",
    "python",
    "rhinoscriptsyntax",
    "selection",
    "transformation",
    "ui"
  ],
  "has_accepted_answer": true,
  "category_id": 11,
  "posts_count": 22,
  "views": 568
}