{
  "source_url": "https://discourse.mcneel.com/t/currentdetail-wishlist-bug/4696",
  "topic_id": 4696,
  "title": "CurrentDetail() WishList/Bug?",
  "question": "Greetings,\n\nI have been doing some work with details and I think I have found a bug.  I am attempting to use the Layout string and Detail string to change the properties of a detail.  Here is the code I am using to get the detail guid from the two strings:\n\n\nimport rhinoscriptsyntax as rs\n\nID=rs.CurrentDetail(\"DRAWING\",\"Top\",False)\nprint \"Detail GUID: \"+str(ID)\n\n\n\nThis works fine and prints:\n\n\nDetail GUID: 5fe3178e-9134-4fa7-8cb2-195e599e689a\n\n\nHowever, when I attempt to check/change the properties of the identified detail like so:\n\n\nimport rhinoscriptsyntax as rs\n\nID=rs.CurrentDetail(\"DRAWING\",\"Top\",False)\nprint \"Detail GUID: \"+str(ID)\nprint rs.DetailLock(ID)\n\n\n\nI get the following error message:\n\n\nMessage: ‘module’ object has no attribute ‘errohandler’\n\n\nTraceback:\n\nline 188, in DetailLock, \"C:\\Users\\BVTC\\AppData\\Roaming\\McNeel\\Rhinoceros\\5.0\\Plug-ins\\IronPython (814d908a-e25c-493d-97e9-ee3861957f49)\\settings\\lib\\rhinoscript\\\nview.py\n\"\n\nline 6, in , “C:\\Users\\BVTC\\AppData\\Local\\Temp\\\nTempScript.py\n”\n\n\nHowever, if I call the rs.CurrentDetail() function twice like so:\n\n\nrs.CurrentDetail(\"DRAWING\",\"Top\",False)\nID=rs.CurrentDetail(\"DRAWING\",None,False)\nprint \"Detail GUID: \"+str(ID)\nprint rs.DetailLock(ID)\n\n\n\nEverything works fine, and it prints:\n\n\nDetail GUID: 047ebe3e-2b0e-4ab2-8b2c-aab005e252e4\n\nTrue\n\n\nIt would be nice if there were some way for me to do this without having to call rs.CurrentDetail() twice.  If anyone knows of a more efficient way to accomplish I would be very appreciative.\n\nThanks,\n\n5chmidt",
  "code_blocks": [
    {
      "code": "import rhinoscriptsyntax as rs\n\nID=rs.CurrentDetail(\"DRAWING\",\"Top\",False)\nprint \"Detail GUID: \"+str(ID)",
      "language": "python",
      "author": "5chmidt",
      "post_number": 1,
      "is_solution": false
    },
    {
      "code": "import rhinoscriptsyntax as rs\n\nID=rs.CurrentDetail(\"DRAWING\",\"Top\",False)\nprint \"Detail GUID: \"+str(ID)\nprint rs.DetailLock(ID)",
      "language": "python",
      "author": "5chmidt",
      "post_number": 1,
      "is_solution": false
    },
    {
      "code": "rs.CurrentDetail(\"DRAWING\",\"Top\",False)\nID=rs.CurrentDetail(\"DRAWING\",None,False)\nprint \"Detail GUID: \"+str(ID)\nprint rs.DetailLock(ID)",
      "language": "python",
      "author": "5chmidt",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "file-io",
    "geometry",
    "python",
    "rhinoscriptsyntax"
  ],
  "has_accepted_answer": false,
  "category_id": 11,
  "posts_count": 2,
  "views": 942
}