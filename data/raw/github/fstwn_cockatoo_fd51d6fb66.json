{
  "source_url": "https://github.com/fstwn/cockatoo/blob/d952ac5d2148ec29fba52e8eb75f0f43770c74ca/usrobj_src/Cockatoo_KnitNetworkStatistics.py",
  "repo": "fstwn/cockatoo",
  "repo_stars": 38,
  "repo_description": "Cockatoo is a prototypical open-source software toolkit for generating (3d-)knitting patterns from NURBS surface and mesh geometry directly inside Grasshopper.",
  "license": "MIT",
  "filepath": "usrobj_src/Cockatoo_KnitNetworkStatistics.py",
  "instruction": "Provides some statistical data for a KnitNetwork. Used to check how closely\nthe edges of the KnitNetwork match a given CourseHeight and StitchWidth.\n    Inputs:\n        KnitNetwork: A KnitNetwork for...",
  "code": "\"\"\"\nProvides some statistical data for a KnitNetwork. Used to check how closely\nthe edges of the KnitNetwork match a given CourseHeight and StitchWidth.\n    Inputs:\n        KnitNetwork: A KnitNetwork for analysis of edge lengths.\n                     {item, KnitNetwork}\n        CourseHeight: CourseHeight for comparison.\n                      {item, float}\n        StitchWidth: StitchWidth for comparison.\n                     {item, float}\n    Output:\n        SummaryText: A textual summary of the statistical data.\n                     NOTE: Values are rounded and always displayed in\n                     millimeters, regardless of model unit settings!\n                     {item, Text}\n        EdgeDeviation: Signed length deviation for all edges of the KnitNetwork\n                       in model units.\n                       {list, float}\n        EdgeDeviationFactor: Signed length deviation factor for all edges of the\n                             KnitNetwork.\n                             {list, float}\n        MinDeviation: Absolute minimum deviation in model units.\n                      {item, float}\n        MaxDeviation: Absolute maximum deviation in model units.\n                      {item, float}\n        AverageDeviation: Absolute average deviation in model units.\n                          {item, float}\n        Variance: Absolute variance in model units.\n                  {item, float}\n        StandardDeviation: Absolute standard deviation in model units.\n                           {item, float}\n    Remarks:\n        Author: Max Eschenbach\n        License: MIT License\n        Version: 200719\n\"\"\"\n\n# PYTHON STANDARD LIBRARY IMPORTS\nfrom __future__ import division\nfrom __future__ import print_function\nimport math\n\n# GHPYTHON SDK IMPORTS\nfrom ghpythonlib.componentbase import executingcomponent as component\nimport Grasshopper, GhPython\nimport System\nimport Rhino\nimport rhinoscriptsyntax as rs\n\n# GHENV COMPONENT SETTINGS\nghenv.Component.Name = \"KnitNetworkStatistics\"\nghenv.Component.NickName =\"KNS\"\nghenv.Component.Category = \"Cockatoo\"\nghenv.Component.SubCategory = \"06 KnitNetwork\"\n\n# LOCAL MODULE IMPORTS\ntry:\n    import cockatoo\nexcept ImportError:\n    errMsg = \"The Cockatoo python module seems to be not correctly \" + \\\n             \"installed! Please make sure the module is in you search \" + \\\n             \"path, see README for instructions!.\"\n    raise ImportError(errMsg)\n\nclass KnitNetworkStatistics(component):\n    \n    def RunScript(self, KnitNetwork, CourseHeight, StitchWidth):\n        \n        EdgeDeviation = []\n        EdgeDeviationFactor = []\n        AbsoluteDeviation = []\n        AbsoluteDeviationFactor = []\n        \n        if not KnitNetwork:\n            rml = self.RuntimeMessageLevel.Warning\n            self.AddRuntimeMessage(rml,\n                                   \"No KnitNetwork input!\")\n            return (Grasshopper.DataTree[object](),\n                    Grasshopper.DataTree[object](),\n                    Grasshopper.DataTree[object](),\n                    Grasshopper.DataTree[object](),\n                    Grasshopper.DataTree[object](),\n                    Grasshopper.DataTree[object](),\n                    Grasshopper.DataTree[object](),\n                    Grasshopper.DataTree[object]())\n        \n        for i, edge in enumerate(KnitNetwork.edges_iter(data=True)):\n            edgedata = edge[2]\n            if edgedata[\"warp\"]:\n                el = edgedata[\"geo\"].Length\n                # compute real deviation\n                dev = el - CourseHeight\n                EdgeDeviation.append(dev)\n                AbsoluteDeviation.append(abs(dev))\n                # compute percentage\n                devperc = dev / CourseHeight\n                EdgeDeviationFactor.append(devperc)\n                AbsoluteDeviationFactor.append(abs(devperc))\n            elif edgedata[\"weft\"]:\n                el = edgedata[\"geo\"].Length\n                # compute real deviation\n                dev = el - StitchWidth\n                EdgeDeviation.append(dev)\n                AbsoluteDeviation.append(abs(dev))\n                # compute percentage\n                devperc = dev / StitchWidth\n                EdgeDeviationFactor.append(devperc)\n                AbsoluteDeviationFactor.append(abs(devperc))\n        \n        # compute number of edges from deviation list\n        numedges = len(EdgeDeviation)\n        \n        if numedges == 0:\n            rml = self.RuntimeMessageLevel.Warning\n            self.AddRuntimeMessage(rml,\n                                   \"Input KnitNetwork has no edges!\")\n            return (Grasshopper.DataTree[object](),\n                    Grasshopper.DataTree[object](),\n                    Grasshopper.DataTree[object](),\n                    Grasshopper.DataTree[object](),\n                    Grasshopper.DataTree[object](),\n                    Grasshopper.DataTree[object](),\n                    Grasshopper.DataTree[object](),\n                    Grasshopper.DataTree[object]())\n        \n        # compute +- 1 % deviation amount\n        pm_one = [d for d in EdgeDeviationFactor if d > -0.01 and d <= 0.01]\n        pm_one_perc = round((len(pm_one) / numedges) * 100, 2)\n        \n        # compute +- 5 % deviation amount\n        pm_ofive = [d for d in EdgeDeviationFactor if d >= -0.05 and d <= 0.05]\n        pm_ofive_perc = round((len(pm_ofive) / numedges) * 100, 2)\n        \n        # compute +- 10 % deviation amount\n        pm_ten = [d for d in EdgeDeviationFactor if d >= -0.1 and d <= 0.1]\n        pm_ten_perc = round((len(pm_ten) / numedges) * 100, 2)\n        \n        # compute +- 20 % deviation amount\n        pm_twen = [d for d in EdgeDeviationFactor if d >= -0.2 and d <= 0.2]\n        pm_twen_perc = round((len(pm_twen) / numedges) * 100, 2)\n        \n        # compute +- 30 % deviation amount\n        pm_thir = [d for d in EdgeDeviationFactor if d >= -0.3 and d <= 0.3]\n        pm_thir_perc = round((len(pm_thir) / numedges) * 100, 2)\n        \n        # compute +- 40 % deviation amount\n        pm_four = [d for d in EdgeDeviationFactor if d >= -0.4 and d <= 0.4]\n        pm_four_perc = round((len(pm_four) / numedges) * 100, 2)\n        \n        # compute +- 50 % deviation amount\n        pm_five = [d for d in EdgeDeviationFactor if d >= -0.5 and d <= 0.5]\n        pm_five_perc = round((len(pm_five) / numedges) * 100, 2)\n        \n        # compute +- 60 % deviation amount\n        pm_six = [d for d in EdgeDeviationFactor if d >= -0.6 and d <= 0.6]\n        pm_six_perc = round((len(pm_six) / numedges) * 100, 2)\n        \n        # compute +- 70 % deviation amount\n        pm_seven = [d for d in EdgeDeviationFactor if d >= -0.7 and d <= 0.7]\n        pm_seven_perc = round((len(pm_seven) / numedges) * 100, 2)\n        \n        # compute +- 80 % deviation amount\n        pm_eight = [d for d in EdgeDeviationFactor if d >= -0.8 and d <= 0.8]\n        pm_eight_perc = round((len(pm_eight) / numedges) * 100, 2)\n        \n        # compute +- 90 % deviation amount\n        pm_nine = [d for d in EdgeDeviationFactor if d >= -0.9 and d <= 0.9]\n        pm_nine_perc = round((len(pm_nine) / numedges) * 100, 2)\n        \n        # compute +- 100 % deviation amount\n        pm_hund = [d for d in EdgeDeviationFactor if d >= -1 and d <= 1]\n        pm_hund_perc = round((len(pm_hund) / numedges) * 100, 2)\n        \n        # compute average, variance and standard deviation\n        AverageDeviation = (sum(AbsoluteDeviation)\n                             / len(AbsoluteDeviation))\n        Variance = (sum([((ed - AverageDeviation) ** 2)\n                         for ed in AbsoluteDeviation])\n                    / len(AbsoluteDeviation))\n        StandardDeviation = math.sqrt(Variance)\n        \n        # compute percentages\n        AveragePercentage = (sum(AbsoluteDeviationFactor)\n                             / len(AbsoluteDeviationFactor))\n        VariancePercentage = (sum([((ed - AveragePercentage) ** 2)\n                                   for ed in AbsoluteDeviationFactor])\n                              / len(AbsoluteDeviationFactor))\n        StandardPercentage = math.sqrt(VariancePercentage)\n        \n        # convert deviations to millimeters for readability\n        musys = Rhino.RhinoDoc.ActiveDoc.ModelUnitSystem\n        modelscale = Rhino.RhinoMath.UnitScale(musys,\n                                               Rhino.UnitSystem.Millimeters)\n        avg_mm = AverageDeviation * modelscale\n        var_mm = Variance * modelscale\n        sdev_mm = StandardDeviation * modelscale\n        \n        # compute minimum and maximum deviation\n        MinDeviation = min(AbsoluteDeviation)\n        MinPercentage = min(AbsoluteDeviationFactor)\n        MaxDeviation = max(AbsoluteDeviation)\n        MaxPercentage = max(AbsoluteDeviationFactor)\n        \n        # compile textual summary\n        Summary = []\n        txtsum_string = \"{} edges ({} %) are within +- {} % deviation.\"\n        Summary.append(\"KnitNetwork contains {} edges.\".format(numedges))\n        Summary.append(txtsum_string.format(len(pm_one), pm_one_perc, \"1\"))\n        Summary.append(txtsum_string.format(len(pm_ofive), pm_ofive_perc, \"5\"))\n        Summary.append(txtsum_string.format(len(pm_ten), pm_ten_perc, \"10\"))\n        Summary.append(txtsum_string.format(len(pm_twen), pm_twen_perc, \"20\"))\n        Summary.append(txtsum_string.format(len(pm_thir), pm_thir_perc, \"30\"))\n        Summary.append(txtsum_string.format(len(pm_four), pm_four_perc, \"40\"))\n        Summary.append(txtsum_string.format(len(pm_five), pm_five_perc, \"50\"))\n        Summary.append(txtsum_string.format(len(pm_six), pm_six_perc, \"60\"))\n        Summary.append(txtsum_string.format(len(pm_seven), pm_seven_perc, \"70\"))\n        Summary.append(txtsum_string.format(len(pm_eight), pm_eight_perc, \"80\"))\n        Summary.append(txtsum_string.format(len(pm_nine), pm_nine_perc, \"90\"))\n        Summary.append(txtsum_string.format(len(pm_hund), pm_hund_perc, \"100\"))\n        \n        Summary.append(\n            \"The minimum deviation is {} millimeters ({} %)\".format(\n                                            round(MinDeviation * modelscale, 2),\n                                            round(MinPercentage * 100, 2)))\n                                                    \n        Summary.append(\n            \"The maximum deviation is {} millimeters ({} %)\".format(\n                                            round(MaxDeviation * modelscale, 2),\n                                            round(MaxPercentage * 100, 2)))\n        Summary.append(\n            \"The average deviation is {} millimeters ({} %)\".format(\n                                            round(avg_mm, 2),\n                                            round(AveragePercentage * 100, 2)))\n        Summary.append(\n            \"The variance is {} millimeters ({} %)\".format(\n                                            round(var_mm, 2),\n                                            round(VariancePercentage * 100, 2)))\n        Summary.append(\n            \"The standard deviation is {} millimeters ({} %)\".format(\n                                            round(sdev_mm, 2),\n                                            round(StandardPercentage * 100, 2)))\n        \n        # return outputs if you have them; here I try it for you:\n        return (Summary,\n                EdgeDeviation,\n                EdgeDeviationFactor,\n                MinDeviation,\n                MaxDeviation,\n                AverageDeviation,\n                Variance,\n                StandardDeviation)\n",
  "language": "python",
  "imports": [
    "Rhino",
    "ghpythonlib",
    "rhinoscriptsyntax"
  ],
  "has_docstring": true
}