{
  "source_url": "https://github.com/Ennead-Architects-LLP/EA_Dist/blob/635520d89b8308b78eabf5b60bb80121d0fa3838/Apps/lib/EnneadTab/RHINO/RHINO_MATERIAL.py",
  "repo": "Ennead-Architects-LLP/EA_Dist",
  "repo_stars": 0,
  "repo_description": null,
  "license": "unknown",
  "filepath": "Apps/lib/EnneadTab/RHINO/RHINO_MATERIAL.py",
  "instruction": "Rhino material",
  "code": "#!/usr/bin/python\r\n# -*- coding: utf-8 -*-\r\nimport os\r\nimport sys\r\nroot_folder = os.path.abspath((os.path.dirname(os.path.dirname(os.path.abspath(__file__)))))\r\nsys.path.append(root_folder)\r\nimport ENVIRONMENT\r\nif ENVIRONMENT.IS_RHINO_ENVIRONMENT:\r\n    import Rhino # pyright: ignore\r\n    import rhinoscriptsyntax as rs\r\n    import scriptcontext as sc\r\n\r\n\r\n\r\ndef get_material_by_name(name, return_index = False):\r\n    mats = sc.doc.Materials\r\n    \"\"\"\r\n    print(\"searching material with name: \" + name)\r\n    for mat in mats:\r\n        print(mat.Name)\r\n    \"\"\"\r\n\r\n    mat = filter(lambda x: x.Name == name, mats)\r\n    if len(mat) != 0:\r\n        if return_index:\r\n            return mat[0].MaterialIndex\r\n        else:\r\n            return mat[0]\r\n    return None\r\n\r\n\r\ndef create_material(name, RGBAR, return_index = False):\r\n    # RGBAR = (r,g,b,t,R)\r\n    from System.Drawing import Color # pyright: ignore\r\n    import Rhino # pyright: ignore\r\n    material = Rhino.DocObjects.Material()\r\n    material.Name = name\r\n    material = Rhino.Render.RenderMaterial.CreateBasicMaterial(material, sc.doc)\r\n    sc.doc.RenderMaterials.Add(material)\r\n\r\n\r\n    sphere = Rhino.Geometry.Sphere(Rhino.Geometry.Plane.WorldXY, 500)\r\n    id = sc.doc.Objects.AddSphere(sphere)\r\n    obj = sc.doc.Objects.FindId(id)\r\n    obj.RenderMaterial = material\r\n    obj.CommitChanges()\r\n\r\n    material = get_material_by_name(name)\r\n    if material is None:\r\n        rs.TextOut(message = \"No material named [{}] found after creating material, contact Sen for help on why.\".format(name), title = ENVIRONMENT.PLUGIN_NAME)\r\n        return None, None\r\n    #material.CommitChanges()\r\n    #print \"begin changing material = {}\".format(material)\r\n    red, green, blue, transparency, reflectivity = RGBAR # trnasparency 0 = solid, 1 = see-thru,,,,,reflectivity 0 = matte, 255 = glossy\r\n    material.DiffuseColor = Color.FromArgb(red,green,blue)\r\n    #print material.DiffuseColor\r\n    material.Transparency = transparency\r\n    material.TransparentColor = Color.FromArgb(red,green,blue)\r\n    #print material.TransparentColor\r\n    material.ReflectionColor = Color.FromArgb(red,green,blue)\r\n    material.Reflectivity = reflectivity\r\n    material.ReflectionGlossiness = reflectivity\r\n    material.Shine = reflectivity\r\n    material.SpecularColor = Color.FromArgb(red,green,blue)\r\n    material.AmbientColor  = Color.FromArgb(red,green,blue)\r\n\r\n    material.CommitChanges()\r\n    #rs.DeleteObject(id)\r\n    if return_index:\r\n        return material.MaterialIndex, id\r\n    else:\r\n        return material, id#return the sample material ball so the material is visible to search. you can delete ball with this ID after script.\r\n\r\n\r\n\r\ndef create_material_by_type(name,\r\n                            RGBAR,\r\n                            transparency_color = None,\r\n                            type = 0,\r\n                            return_index = True):\r\n    \"\"\"\r\n    base_color_rgb ----> tuple of 3 int\r\n    type = 0 --->basic\r\n           1 --->glass\r\n           2 --->metal\r\n           3 --->plastic\r\n           4 --->emission\r\n           5 --->paint\r\n           6 --->plaster\r\n           10 ---> physically based\r\n\r\n    trnasparency 0 = solid, 1 = see-thru\r\n    reflectivity 0 = matte, 255 = glossy\r\n    return material index by default, otherwise return material\r\n    \"\"\"\r\n\r\n    import Rhino # pyright: ignore\r\n    import scriptcontext as sc\r\n    red, green, blue, transparency, reflectivity = RGBAR\r\n\r\n\r\n    bmtex = Rhino.Render.RenderContentType.NewContentFromTypeId(Rhino.Render.ContentUuids.BitmapTextureType)\r\n    bmtex.Filename = \"C:\\\\Users\\\\Nathan\\\\Pictures\\\\uvtester.png\"\r\n\r\n    simtex = bmtex.SimulatedTexture(Rhino.Render.RenderTexture.TextureGeneration.Allow)\r\n\r\n    #\r\n    #print(Rhino.Render.ContentUuids.PhysicallyBasedMaterialType)\r\n    #print(Rhino.Render.ContentUuids.GlassMaterialType)\r\n\r\n    def create_physical_based_mat():\r\n        # first create an empty PBR material\r\n        pbr_rm = Rhino.Render.RenderContentType.NewContentFromTypeId(Rhino.Render.ContentUuids.PhysicallyBasedMaterialType)\r\n\r\n        # to get to a Rhino.DocObjects.PhysicallyBasedMaterial we need to simulate the\r\n        # render material first.\r\n        sim = pbr_rm.SimulatedMaterial(Rhino.Render.RenderTexture.TextureGeneration.Allow)\r\n\r\n        # from the simulated material we can get the Rhino.DocObjects.PhysicallyBasedMaterial\r\n        pbr = sim.PhysicallyBased\r\n\r\n        # now we have an instance of a type that has all the API you need to set the PBR\r\n        # properties. For simple glass we set color to white, opacity to 0 and opacity\r\n        # IOR to 1.52\r\n        pbr.Opacity = 0.0\r\n        pbr.OpacityIOR = 1.52\r\n        pbr.BaseColor = Rhino.Display.Color4f.White\r\n\r\n        pbr.SetTexture(simtex.Texture(), Rhino.DocObjects.TextureType.PBR_BaseColor)\r\n\r\n        # convert it back to RenderMaterial\r\n        new_pbr = Rhino.Render.RenderMaterial.FromMaterial(pbr.Material, sc.doc)\r\n        # Set a good name\r\n        new_pbr.Name = name\r\n\r\n        # Set pbr ui sections visible\r\n        \"\"\"\r\n        new_pbr.SetParameter(\"pbr-show-ui-basic-metalrough\", True);\r\n        new_pbr.SetParameter(\"pbr-show-ui-subsurface\", True);\r\n        new_pbr.SetParameter(\"pbr-show-ui-specularity\", True);\r\n        new_pbr.SetParameter(\"pbr-show-ui-anisotropy\", True);\r\n        new_pbr.SetParameter(\"pbr-show-ui-sheen\", True);\r\n        new_pbr.SetParameter(\"pbr-show-ui-clearcoat\", True);\r\n        new_pbr.SetParameter(\"pbr-show-ui-opacity\", True);\r\n        new_pbr.SetParameter(\"pbr-show-ui-emission\", True);\r\n        new_pbr.SetParameter(\"pbr-show-ui-bump-displacement\", True);\r\n        new_pbr.SetParameter(\"pbr-show-ui-ambient-occlusion\", True);\r\n        \"\"\"\r\n\r\n        return new_pbr\r\n\r\n    if type == 10:\r\n        mat = create_physical_based_mat()\r\n\r\n\r\n    # Add it to the document\r\n    sc.doc.RenderMaterials.Add(mat)\r\n    if return_index:\r\n        return get_material_index(mat)##material name might surfix number if similar name exist, so the index should be get from final product not name.\r\n    else:\r\n        return mat\r\n\r\n\r\ndef get_material_index(mat):\r\n    return sc.doc.Materials.IndexOf(mat)\r\n",
  "language": "python",
  "imports": [
    "Rhino",
    "Rhino.Geometry",
    "rhinoscriptsyntax",
    "scriptcontext"
  ],
  "has_docstring": false
}