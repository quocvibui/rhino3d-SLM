{
  "source_url": "https://discourse.mcneel.com/t/ghpython-recomputes-inside-a-cluster/85073",
  "topic_id": 85073,
  "title": "GhPython recomputes inside a cluster",
  "question": "Hi everyone,\n\n\nI made a script in ghPython that the users can set True and pick layers from Rhino and use them in GH.\n\nEverything works fine until I clustered the whole GH script (including the ghpython components).\n\nEvery time I set a boolean True or False it recomputes the whole cluster and also the ghpython components. As a result, the ghpython compontent keeps asking for the layers everytime a boolean is True or False.\n\n\nI would like to ask if anyone knows a solution or has to suggest another workflow to do that.\n\nI am posting the script bellow. I have Rhino 6 SR 13\n\nI hope it makes sense, I am not a scripting expert, thanks in advance.\n\n\nimport rhinoscriptsyntax as rs\nimport scriptcontext as sc\nimport Rhino as r\nimport ghpythonlib as ghl\n\nsc.doc = r.RhinoDoc.ActiveDoc\n\nobjs = []\nlnames = []\ncols = []\nif go:\n    \n    layerPath = rs.GetLayers(\"Pick your layers for the Plots\")\n    \n    for i in range(len(layerPath)):\n        \n        obj = rs.ObjectsByLayer(layerPath[i])\n        objs.append(obj)\n        \n        lname = rs.LayerName(layerPath[i], fullpath=False)\n        lnames.append(lname)\n        \n        col = rs.LayerColor(layerPath[i])\n        cols.append(col)\n        \n    objects = ghl.treehelpers.list_to_tree(objs)\n    layerName = lnames\n    layerColour = cols\nsc.doc = ghdoc",
  "code_blocks": [
    {
      "code": "if not \"layerPath\" in sc.sticky.keys():\n    layerPath = rs.GetLayers(\"Pick your layers for the Plots\")\n    sc.sticky[\"layerPath\"] = layerPath # save to sticky\n\nlayerPath = sc.sticky[\"layerPath\"] # get from sticky",
      "language": "python",
      "author": "diff-arch",
      "post_number": 2,
      "is_solution": false
    },
    {
      "code": "import rhinoscriptsyntax as rs\nimport scriptcontext as sc\nimport Rhino as r\nimport ghpythonlib as ghl\n\nsc.doc = r.RhinoDoc.ActiveDoc\n\nobjs = []\nlnames = []\ncols = []\nif go:\n    \n    layerPath = rs.GetLayers(\"Pick your layers for the Plots\")\n    \n    for i in range(len(layerPath)):\n        \n        obj = rs.ObjectsByLayer(layerPath[i])\n        objs.append(obj)\n        \n        lname = rs.LayerName(layerPath[i], fullpath=False)\n        lnames.append(lname)\n        \n        col = rs.LayerColor(layerPath[i])\n        cols.append(col)\n        \n    objects = ghl.treehelpers.list_to_tree(objs)\n    layerName = lnames\n    layerColour = cols\nsc.doc = ghdoc",
      "language": "python",
      "author": "nikolaos.argy",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "boolean",
    "file-io",
    "grasshopper",
    "layers",
    "python",
    "rhinoscriptsyntax"
  ],
  "has_accepted_answer": false,
  "category_id": 2,
  "posts_count": 5,
  "views": 839
}