{
  "source_url": "https://github.com/TSRChapman/LandArchTools-for-Rhino/blob/43036cbbcab2bf756216f6a752f65e83aac3fccb/ShowRL.py",
  "repo": "TSRChapman/LandArchTools-for-Rhino",
  "repo_stars": 5,
  "repo_description": "Custom Tools for Rhino made for Landscape Architects",
  "license": "BSD-3-Clause",
  "filepath": "ShowRL.py",
  "instruction": "Copyright <2021> <Thomas Chapman>\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE\r\nWARRANTIES OF MERCHANTABILITY, FITNESS FOR A...",
  "code": "\"\"\"\r\n\r\nCopyright <2021> <Thomas Chapman>\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE\r\nWARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\r\nCOPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\r\nOTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n\r\n\"\"\"\r\n\r\n\r\n# Show RL of specified point and copy to clipboard\r\n# By Thomas Chapman on 01/10/2021\r\n\r\nimport rhinoscriptsyntax as rs\r\nimport scriptcontext as sc\r\nimport System\r\nimport Rhino as r\r\nimport Rhino.Input as ri\r\nimport Rhino.Commands as rc\r\nimport Rhino.Geometry as rg\r\n\r\n\r\ndef ShowRL():\r\n    try:\r\n\r\n        scale, imperial = scaling()\r\n        def GetPointDynamicDrawFunc(sender, args):\r\n            point = args.CurrentPoint\r\n\r\n            circle = rg.Circle(point, 1 * scale)\r\n            line01 = rg.Line(point, rg.Point3d(point.X + (1 * scale), point.Y, point.Z))\r\n            line02 = rg.Line(point, rg.Point3d(point.X - (1 * scale), point.Y, point.Z))\r\n            line03 = rg.Line(point, rg.Point3d(point.X, point.Y + (1 * scale), point.Z))\r\n            line04 = rg.Line(point, rg.Point3d(point.X, point.Y - (1 * scale), point.Z))\r\n            midpoint = line03.PointAt(0.5)\r\n\r\n            if imperial == False:\r\n                rl = \"+RL \" + str(round(point.Z * scale, 3)) + \" m\"\r\n            if imperial == True:\r\n                rl = \"+RL \" + str(round(point.Z * scale, 3)) + \" ft\"\r\n\r\n            args.Display.DrawLine(line01, blueColour, 4)\r\n            args.Display.DrawLine(line02, blueColour, 4)\r\n            args.Display.DrawLine(line03, blueColour, 4)\r\n            args.Display.DrawLine(line04, blueColour, 4)\r\n            args.Display.DrawCircle(circle, pinkColour, 2)\r\n            args.Display.DrawDot(midpoint, str(rl), greyColour, blackColour)\r\n\r\n        pinkColour = System.Drawing.Color.FromArgb(255, 0, 133)\r\n        blueColour = System.Drawing.Color.FromArgb(82, 187, 209)\r\n        greyColour = System.Drawing.Color.FromArgb(216, 220, 219)\r\n        blackColour = System.Drawing.Color.FromArgb(0, 0, 0)\r\n\r\n        gp = ri.Custom.GetPoint()\r\n        gp.DynamicDraw += GetPointDynamicDrawFunc\r\n        gp.Get()\r\n        if gp.CommandResult() == rc.Result.Success:\r\n            point = gp.Point()\r\n\r\n            if point:\r\n                pointZ = point.Z\r\n            pointZ = pointZ * scale\r\n\r\n            if imperial == False:\r\n                textDot = rs.AddTextDot(\"+RL \" + str(round(pointZ, 3)) + \" m\", point)\r\n            if imperial == True:\r\n                textDot = rs.AddTextDot(\"+RL \" + str(round(pointZ, 3)) + \" ft\", point)\r\n\r\n            # Add user key and value for later identification\r\n            rs.SetUserText(textDot, \"LandArchTools\", \"RLTextDot\", True)\r\n\r\n\r\n            # Copy RL to Clipboard\r\n            RL = str(round(pointZ, 3))\r\n            rs.ClipboardText(RL)\r\n\r\n    except:\r\n        print(\"Failed to execute\")\r\n        rs.EnableRedraw(True)\r\n        return\r\n\r\n\r\ndef scaling():\r\n    try:\r\n        unitNum = int(sc.doc.ModelUnitSystem)\r\n        # check to see if using metric\r\n\r\n        if (\r\n            unitNum != 1\r\n            and unitNum != 2\r\n            and unitNum != 3\r\n            and unitNum != 4\r\n            and unitNum != 5\r\n        ):\r\n            imperial = True\r\n            # struct unit system for cu2rrent file\r\n            unitSystem = System.Enum.ToObject(r.UnitSystem, unitNum)\r\n            # struct unitsystem obj for script use, using feet (9)\r\n            internalSystem = System.Enum.ToObject(r.UnitSystem, 9)\r\n            # Scale units to model units\r\n            scale = r.RhinoMath.UnitScale(internalSystem, unitSystem)\r\n            if scale:\r\n                return scale, imperial\r\n        else:\r\n            imperial = False\r\n            # struct unit system for current file\r\n            unitSystem = System.Enum.ToObject(r.UnitSystem, unitNum)\r\n            # struct unitsystem obj for script use, using meteres (4)\r\n            internalSystem = System.Enum.ToObject(r.UnitSystem, 4)\r\n            # Scale units to model units\r\n            scale = r.RhinoMath.UnitScale(internalSystem, unitSystem)\r\n            if scale:\r\n                return scale, imperial\r\n    except:\r\n        print(\"Failed to find system scale\")\r\n        rs.EnableRedraw(True)\r\n        return\r\n\r\n\r\nif __name__ == \"__main__\":\r\n    ShowRL()\r\n",
  "language": "python",
  "imports": [
    "Rhino",
    "Rhino.Geometry",
    "rhinoscriptsyntax",
    "scriptcontext"
  ],
  "has_docstring": true
}