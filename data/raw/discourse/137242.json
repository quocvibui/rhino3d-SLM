{
  "source_url": "https://discourse.mcneel.com/t/get-information-out-of-an-inactive-detail-view-possible/137242",
  "topic_id": 137242,
  "title": "Get information out of an inactive Detail view - possible?",
  "question": "Hello!\n\nI’m unsure if this is the right category, but anyway:\n\nIn the same manner as annotations can be associated to points inside a Detail (and even move with it) - is it possible in Python (or even GH Python) to pick a point of an inactive Detail and derive it’s coordinates?\n\nGot some homegrown VisualArq height annotation objects here, which can show their Z coordinate automatically when moved. They have to be placed into the model space. Yet annotations of all kinds are a 2D-thing, and thus should be placed on a Layout.\n\nSo, when such an object is placed, some kind of point picking session on top of the Detail view should be invoked, and this point’s coords be read and displayed.\n\n\nObviously such a thing is possible (regular annotations). Also in scripting / Grasshopper?\n\nJust doing a little research. A link to some helpful API page would be nice.\n\nThanks!",
  "code_blocks": [
    {
      "code": "import Rhino\nimport scriptcontext as sc\n\ndef test():\n    gp = Rhino.Input.Custom.GetPoint()\n    gp.SetCommandPrompt(\"Point location\")\n    gp.Get()\n    if gp.CommandResult() != Rhino.Commands.Result.Success:\n        return\n    \n    point = gp.Point()\n    objref = gp.PointOnObject()\n    if objref:\n        detail_sn = objref.SelectionViewDetailSerialNumber()\n        if detail_sn > 0:\n            detail = sc.doc.Objects.Find(detail_sn)\n            if isinstance(detail, Rhino.DocObjects.DetailViewObject):\n                if detail.Viewport.IsParallelProjection:\n                    print(\"Page location: {0}\".format(point.ToString()))\n                    point.Transform(detail.PageToWorldTransform)\n                    print(\"World location: {0}\".format(point.ToString()))\n        else:\n            print(\"World location: {0}\".format(point.ToString()))\n    else:\n        print(\"Point location: {0}\".format(point.ToString()))\n\nif __name__ == '__main__':\n    test()",
      "language": "python",
      "author": "dale",
      "post_number": 3,
      "is_solution": false
    },
    {
      "code": "Dim gp As New GetPoint()\n            gp.SetCommandPrompt(\"Point location\")\n            gp.Get()\n\n            If gp.CommandResult() <> Result.Success Then\n                Return gp.CommandResult()\n            End If\n\n            Dim point As Point3d = gp.Point()\n            Dim objref As Rhino.DocObjects.ObjRef = gp.PointOnObject()\n\n            If objref IsNot Nothing Then\n                Dim detail_sn As Integer = objref.SelectionViewDetailSerialNumber()\n                If detail_sn > 0 Then\n                    Dim detail As RhinoObject = doc.Objects.Find(detail_sn)\n                    If TypeOf detail Is DetailViewObject Then\n                        Dim detailObj As DetailViewObject = CType(detail, DetailViewObject)\n                        If detailObj.Viewport.IsParallelProjection Then\n                            RhinoApp.WriteLine(\"Page location: {0}\", point.ToString())\n                            point.Transform(detailObj.PageToWorldTransform)\n                            RhinoApp.WriteLine(\"World location: {0}\", point.ToString())\n                        End If\n                    End If\n                Else\n                    RhinoApp.WriteLine(\"World location: {0}\", point.ToString())\n                End If\n            Else\n                RhinoApp.WriteLine(\"Point location: {0}\", point.ToString())\n            End If\n\n            Return Result.Success",
      "language": "csharp",
      "author": "PeterKompier",
      "post_number": 4,
      "is_solution": false
    }
  ],
  "tags": [
    "file-io",
    "geometry",
    "grasshopper",
    "python",
    "rhinocommon",
    "transformation"
  ],
  "has_accepted_answer": false,
  "category_id": 11,
  "posts_count": 4,
  "views": 417
}