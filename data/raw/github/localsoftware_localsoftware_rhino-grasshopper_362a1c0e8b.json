{
  "source_url": "https://github.com/localsoftware/localsoftware_rhino-grasshopper/blob/4aafec57e33b9f09cce6fd73dcda12b17cf794a5/plugin_files/Make_Material.py",
  "repo": "localsoftware/localsoftware_rhino-grasshopper",
  "repo_stars": 0,
  "repo_description": null,
  "license": "BSD-2-Clause",
  "filepath": "plugin_files/Make_Material.py",
  "instruction": "Make material",
  "code": "ï»¿from ghpythonlib.componentbase import dotnetcompiledcomponent as component\nimport Grasshopper, GhPython\nimport System\nimport Rhino\nimport rhinoscriptsyntax as rs\nimport Grasshopper as gh\nimport scriptcontext as sc\nfrom Grasshopper.Kernel import GH_RuntimeMessageLevel as RML\n\nclass MyComponent(component):\n    def __new__(cls):\n        instance = Grasshopper.Kernel.GH_Component.__new__(cls,\n            \"MakeMaterial\", \"MakeMaterial\", \"\"\"Creates a new Material.\nReturns a new Material, a Render Material and a GH Preview Material using the parameters set as inputs.\nTo bake into Rhino you need to use the 'Bake with Attributes' LocalCode component. The material will be baked into a layer.\nBased on the work of Chris Hanley.\n    Typical usage:\nInput a name and a diffuse color and create a material.\nThe rest of the inputs are optional.\nUse the 'Material' output to assign the material to a geometry.\nPlug the 'GHMaterial' output to a 'Preview' component to visualize your material on GH objects.\"\"\", \"Extra\", \"LocalCode\")\n        return instance\n    \n    def get_ComponentGuid(self):\n        return System.Guid(\"d618faec-c27e-4411-bae2-3c3c9942dc3f\")\n    \n    def SetUpParam(self, p, name, nickname, description):\n        p.Name = name\n        p.NickName = nickname\n        p.Description = description\n        p.Optional = True\n    \n    def RegisterInputParams(self, pManager):\n        p = Grasshopper.Kernel.Parameters.Param_String()\n        self.SetUpParam(p, \"Name\", \"Name\", \"name string\")\n        p.Access = Grasshopper.Kernel.GH_ParamAccess.item\n        self.Params.Input.Add(p)\n        \n        p = Grasshopper.Kernel.Parameters.Param_Colour()\n        self.SetUpParam(p, \"diffuseColor\", \"diffuseColor\", \"diffuse color\")\n        p.Access = Grasshopper.Kernel.GH_ParamAccess.item\n        self.Params.Input.Add(p)\n        \n        p = Grasshopper.Kernel.Parameters.Param_Colour()\n        self.SetUpParam(p, \"specularColor\", \"specularColor\", \"specular color\")\n        p.Access = Grasshopper.Kernel.GH_ParamAccess.item\n        self.Params.Input.Add(p)\n        \n        p = Grasshopper.Kernel.Parameters.Param_Colour()\n        self.SetUpParam(p, \"emissionColor\", \"emissionColor\", \"Script input emissionColor.\")\n        p.Access = Grasshopper.Kernel.GH_ParamAccess.item\n        self.Params.Input.Add(p)\n        \n        p = Grasshopper.Kernel.Parameters.Param_Number()\n        self.SetUpParam(p, \"transparency\", \"transparency\", \"transparency from 0 to 1\")\n        p.Access = Grasshopper.Kernel.GH_ParamAccess.item\n        self.Params.Input.Add(p)\n        \n        p = Grasshopper.Kernel.Parameters.Param_Number()\n        self.SetUpParam(p, \"reflection\", \"reflection\", \"reflection range from 0 to 1\")\n        p.Access = Grasshopper.Kernel.GH_ParamAccess.item\n        self.Params.Input.Add(p)\n        \n        p = GhPython.Assemblies.MarshalParam()\n        self.SetUpParam(p, \"glossiness\", \"glossiness\", \"glossiness from 0 to 1\")\n        p.Access = Grasshopper.Kernel.GH_ParamAccess.item\n        self.Params.Input.Add(p)\n        \n        p = GhPython.Assemblies.MarshalParam()\n        self.SetUpParam(p, \"Make\", \"Make\", \"Script variable Make Material\")\n        p.Access = Grasshopper.Kernel.GH_ParamAccess.item\n        self.Params.Input.Add(p)\n        \n    \n    def RegisterOutputParams(self, pManager):\n        p = Grasshopper.Kernel.Parameters.Param_GenericObject()\n        self.SetUpParam(p, \"Material\", \"Material\", \"Render material for Rhino geometry\")\n        self.Params.Output.Add(p)\n        \n        p = Grasshopper.Kernel.Parameters.Param_GenericObject()\n        self.SetUpParam(p, \"GHMaterial\", \"GHMaterial\", \"Material for GH preview \")\n        self.Params.Output.Add(p)\n        \n    \n    def SolveInstance(self, DA):\n        p0 = self.marshal.GetInput(DA, 0)\n        p1 = self.marshal.GetInput(DA, 1)\n        p2 = self.marshal.GetInput(DA, 2)\n        p3 = self.marshal.GetInput(DA, 3)\n        p4 = self.marshal.GetInput(DA, 4)\n        p5 = self.marshal.GetInput(DA, 5)\n        p6 = self.marshal.GetInput(DA, 6)\n        p7 = self.marshal.GetInput(DA, 7)\n        result = self.RunScript(p0, p1, p2, p3, p4, p5, p6, p7)\n\n        if result is not None:\n            if not hasattr(result, '__getitem__'):\n                self.marshal.SetOutput(result, DA, 0, True)\n            else:\n                self.marshal.SetOutput(result[0], DA, 0, True)\n                self.marshal.SetOutput(result[1], DA, 1, True)\n        \n    def get_Internal_Icon_24x24(self):\n        o = \"iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAHYcAAB2HAY/l8WUAAAOUSURBVEhLtZbZTxNRFMb9Q1RAFpGWttMp1UJnwELD0ooxqCHiQkoiGhN54MEGTIz6AsoDPhiXxMREjFvUKGA0IUGJij6QiLKDUASNC8Fgcdd+nnNpsa1DNUYfvkznztzv951z7810UWBWcQUCjkMBv/3fi3wZcBTIB+D4D8rHIiaJG78SW7OkD6SPpPfBsd+JfGMD3pE+kUD6bIP/pYwpn4T3r2S6X0nj9jmo1lxWTAAnhorXzyw4ddyAWq8TNd5tOLB/Nw7u347DdcW4dsmKGYZxgOj5rAUB3AKadKEpHZs3F6Ou/iTab3ehp2cEg4Nj6O19inv3e9DU1ILamnK03zLS+1QNhwr30QSI5AqONJjgqajGo+5BTEw8w8DAABn3EqRHqK+vD2NjY3j8ZBTV1Xtx6SxDgh4LArjn1JaLZ0woLCqjtCMYHh7G6OioUH9//zwgJAYPDflQXr4Tne1mIBAL8FnB9PMsqIoFLncJKio88Hg88Hq91I4mdHd3Y3x8nMCDERCu5Nz5Fmxcn4Gvs2EL/wuA0p86ZoVOr6KoqAi5ublwOBxQVVWotLQUDQ0N6OzshM/nE20KVdHV1QWzvBptzRlUhaoB4N5/UbG1zAyjKQtutxuFhYURysvLg91uF88aGxupNUMi/eTkJDo6OpCYJKN2D7WJgv4KoAP04bUduQ4zVqwwiuRsxJVEg5xOpwBVVVWhubkZbW1tqKysxOIly7Flk0W0em6zhAPoQE1P2KHYZaSlGZCeni5MCgoK4HK5NBVqnyRJSElJoWBmlKwjAJuLra5RQZ5Dhk4nwWg00lUnrlarVcCys7ORk5MDRVGQmZkpxg0GA/R6PcxmM5anSjEqEGugoHyrhdJIYgKL05lMpggxlMW/+R1ZlsU1YZmEfbXWBdYguItOn1iFpXESTZoD/KkYFp9gxJ2bmVG76F0YgEp7+yK0DtpGWuIwSUkSNpRY8I3PQMQ5CAcET3LrZRulkWAwahuGi811Ot55Eh49yPqZXhPAEouj4uTRVUggCO8MLeOQkmm9UmlxW6/axLx5n3mAX6mPALDEFlNx47qNtqKMuHgJScmSaJtOT2npmpgoiQDFayx4eJf6Hm3O0qwgpGAl/jcKzp+xYdeODBS7Lch3yli31oLqKitartjwVRhpmItxUcECANb8F40MqLffZxR8mgo+4zHWX3/RosUVsRl/k2OZhksA/uu/inz8AJMCHHwHHr5bAAAAAElFTkSuQmCC\"\n        return System.Drawing.Bitmap(System.IO.MemoryStream(System.Convert.FromBase64String(o)))\n\n\n    def RunScript(self, Name, diffuseColor, specularColor, emissionColor, transparency,\n                  reflection, glossiness, Make):\n        GHMaterial = None\n        Material = None\n        \n        if Name == None:\n            print(\"Add a Name\")\n            self.AddRuntimeMessage(RML.Warning,\"Add a Name string\")\n            \n        if diffuseColor == None:\n            print(\"Add a diffuse color\")\n            self.AddRuntimeMessage(RML.Warning,\"Add a diffuse color\")\n        if Make:\n\n            for mat in Rhino.RhinoDoc.ActiveDoc.RenderMaterials:\n                if mat.Name == Name:\n                    Rhino.RhinoDoc.ActiveDoc.RenderMaterials.Remove(mat)#deletes the previous material\n            newMat = Rhino.DocObjects.Material()\n            newMat.Name = Name\n            newMat.DiffuseColor = diffuseColor\n            newMat.AmbientColor = diffuseColor\n            \n            \n            \n            \n            if specularColor != None:\n                newMat.SpecularColor = specularColor\n                newMat.ReflectionColor = specularColor\n\n            if emissionColor != None:\n                newMat.EmissionColor = emissionColor\n            \n            if transparency != None:\n                newMat.Transparency = transparency\n            else: \n                newMat.Transparency = 0\n\n            if glossiness != None:\n                Smoothness = min(max(glossiness, 0), 1);\n                newMat.ReflectionGlossiness = Smoothness\n            else:\n                newMat.ReflectionGlossiness = 0\n                \n            if reflection != None:\n                Reflection = min(max(reflection, 0), 1);\n                newMat.Reflectivity = Reflection\n            else:\n                newMat.Reflectivity = 0\n\n\n            Material = Rhino.Render.RenderMaterial.CreateBasicMaterial(newMat)\n            GHMaterial = gh.Kernel.Types.GH_Material(Material)  # GH preview material\n\n\n        # return outputs if you have them; here I try it for you:\n        return (Material, GHMaterial)\n\nimport GhPython\nimport System\n\nclass AssemblyInfo(GhPython.Assemblies.PythonAssemblyInfo):\n    def get_AssemblyName(self):\n        return \"MakeMaterial\"\n    \n    def get_AssemblyDescription(self):\n        return \"\"\"\"\"\"\n\n    def get_AssemblyVersion(self):\n        return \"0.1\"\n\n    def get_AuthorName(self):\n        return \"\"\n    \n    def get_Id(self):\n        return System.Guid(\"7f29287f-2f5a-470b-80ed-8b7b33b59666\")",
  "language": "python",
  "imports": [
    "Rhino",
    "ghpythonlib",
    "rhinoscriptsyntax",
    "scriptcontext"
  ],
  "has_docstring": false
}