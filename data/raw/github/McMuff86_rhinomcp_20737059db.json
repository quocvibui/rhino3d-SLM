{
  "source_url": "https://github.com/McMuff86/rhinomcp/blob/65db89d55c0a08af4dc19cd946bec19429db10cc/rhino_mcp_server/static/grips.py",
  "repo": "McMuff86/rhinomcp",
  "repo_stars": 0,
  "repo_description": null,
  "license": "Apache-2.0",
  "filepath": "rhino_mcp_server/static/grips.py",
  "instruction": null,
  "code": "import Rhino\n\nimport scriptcontext\n\nimport rhinocompat as compat\nfrom rhinoscript import utility as rhutil\n\n\ndef __neighborgrip(i, object_id, index, direction, enable):\n    rhobj = rhutil.coercerhinoobject(object_id, True, True)\n    grips = rhobj.GetGrips()\n    if not grips or len(grips)<=index: return scriptcontext.errorhandler()\n    grip = grips[index]\n    next_grip=None\n    if direction==0:\n        next_grip = grip.NeighborGrip(i,0,0,False)\n    else:\n        next_grip = grip.NeighborGrip(0,i,0,False)\n    if next_grip and enable:\n        next_grip.Select(True)\n        scriptcontext.doc.Views.Redraw()\n    return next_grip\n\n\ndef EnableObjectGrips(object_id, enable=True):\n    \"\"\"Enables or disables an object's grips. For curves and surfaces, these are\n    also called control points.\n    Parameters:\n      object_id (guid): identifier of the object\n      enable (bool, optional): if True, the specified object's grips will be turned on.\n        Otherwise, they will be turned off\n    Returns:\n      bool: True on success, False on failure\n    Example:\n      import rhinoscriptsyntax as  rs\n      objects = rs.GetObjects(\"Select  objects\")\n      if objects: [rs.EnableObjectGrips(obj)  for obj in objs]\n    See Also:\n      ObjectGripCount\n      ObjectGripsOn\n      ObjectGripsSelected\n      SelectObjectGrips\n      UnselectObjectGrips\n    \"\"\"\n    rhobj = rhutil.coercerhinoobject(object_id, True, True)\n    if enable!=rhobj.GripsOn:\n        rhobj.GripsOn = enable\n        scriptcontext.doc.Views.Redraw()\n\n\ndef GetObjectGrip(message=None, preselect=False, select=False):\n    \"\"\"Prompts the user to pick a single object grip\n    Parameters:\n      message (str, optional): prompt for picking\n      preselect (bool, optional): allow for selection of pre-selected object grip.\n      select (bool, optional): select the picked object grip.\n    Returns:\n      tuple(guid, number, point): defining a grip record.\n         [0] = identifier of the object that owns the grip\n         [1] = index value of the grip\n         [2] = location of the grip\n      None: on error\n    Example:\n      import rhinoscriptsyntax as rs\n      curve = rs.GetObject(\"Select a curve\", rs.filter.curve)\n      if curve:\n          rs.EnableObjectGrips( curve )\n          grip = rs.GetObjectGrip(\"Select a curve grip\")\n          if grip: print(grip[2])\n    See Also:\n      GetObjectGrips\n    \"\"\"\n    if not preselect:\n        scriptcontext.doc.Objects.UnselectAll()\n        scriptcontext.doc.Views.Redraw()\n    rc, grip = Rhino.Input.RhinoGet.GetGrip(message)\n    if rc!=Rhino.Commands.Result.Success: return scriptcontext.errorhandler()\n    if select:\n        grip.Select(True, True)\n        scriptcontext.doc.Views.Redraw()\n    return grip.OwnerId, grip.Index, grip.CurrentLocation\n\n\ndef GetObjectGrips(message=None, preselect=False, select=False):\n    \"\"\"Prompts user to pick one or more object grips from one or more objects.\n    Parameters:\n      message (str, optional): prompt for picking\n      preselect (bool, optional): allow for selection of pre-selected object grips\n      select (bool, optional) select the picked object grips\n    Returns:\n      list((guid, number, point), ...): containing one or more grip records. Each grip record is a tuple\n        [n][0] = identifier of the object that owns the grip\n        [n][1] = index value of the grip\n        [n][2] = location of the grip\n      None: on error\n    Example:\n      import rhinoscriptsyntax as rs\n      curves = rs.GetObjects(\"Select curves\", rs.filter.curves)\n      if curves:\n          for curve in curves: rs.EnableObjectGrips(curve)\n          grips = rs.GetObjectGrips(\"Select curve grips\")\n          if grips: for grip in grips: print(grip[0])\n    See Also:\n      GetObjectGrip\n    \"\"\"\n    if not preselect:\n        scriptcontext.doc.Objects.UnselectAll()\n        scriptcontext.doc.Views.Redraw()\n    getrc, grips = Rhino.Input.RhinoGet.GetGrips(message)\n    if getrc!=Rhino.Commands.Result.Success or not grips:\n        return scriptcontext.errorhandler()\n    rc = []\n    for grip in grips:\n        id = grip.OwnerId\n        index = grip.Index\n        location = grip.CurrentLocation\n        rc.append((id, index, location))\n        if select: grip.Select(True, True)\n    if select: scriptcontext.doc.Views.Redraw()\n    return rc\n\n\ndef NextObjectGrip(object_id, index, direction=0, enable=True):\n    \"\"\"Returns the next grip index from a specified grip index of an object\n    Parameters:\n      object_id (guid): identifier of the object\n      index (number): zero based grip index from which to get the next grip index\n      direction ([number, number], optional): direction to get the next grip index (0=U, 1=V)\n      enable (bool, optional): if True, the next grip index found will be selected\n    Returns:\n      number: index of the next grip on success\n      None: on failure\n    Example:\n      import rhinoscriptsyntax as rs\n      object_id = rs.GetObject(\"Select curve\", rs.filter.curve)\n      if object_id:\n          rs.EnableObjectGrips( object_id )\n          count = rs.ObjectGripCount( object_id )\n          for i in range(0,count,2):\n              rs.NextObjectGrip(object_id, i, 0, True)\n    See Also:\n      EnableObjectGrips\n      PrevObjectGrip\n    \"\"\"\n    return __neighborgrip(1, object_id, index, direction, enable)\n\n\ndef ObjectGripCount(object_id):\n    \"\"\"Returns number of grips owned by an object\n    Parameters:\n      object_id (guid): identifier of the object\n    Returns:\n      number: number of grips if successful\n      None: on error\n    Example:\n      import rhinoscriptsyntax as rs\n      obj = rs.GetObject(\"Select object\")\n      if rs.ObjectGripsOn(obj):\n          print(\"Grip count ={}\".format(rs.ObjectGripCount(obj)))\n    See Also:\n      EnableObjectGrips\n      ObjectGripsOn\n      ObjectGripsSelected\n      SelectObjectGrips\n      UnselectObjectGrips\n    \"\"\"\n    rhobj = rhutil.coercerhinoobject(object_id, True, True)\n    grips = rhobj.GetGrips()\n    if not grips: return scriptcontext.errorhandler()\n    return grips.Length\n\n\ndef ObjectGripLocation(object_id, index, point=None):\n    \"\"\"Returns or modifies the location of an object's grip\n    Parameters:\n      object_id (guid) identifier of the object\n      index (number): index of the grip to either query or modify\n      point (point, optional): 3D point defining new location of the grip\n    Returns:\n      point: if point is not specified, the current location of the grip referenced by index\n      point: if point is specified, the previous location of the grip referenced by index\n      None: on error\n    Example:\n      import rhinoscriptsyntax as rs\n      obj = rs.GetObject(\"Select curve\", rs.filter.curve)\n      if obj:\n          rs.EnableObjectGrips(obj)\n          point = rs.ObjectGripLocation(obj, 0)\n          point[0] = point[0] + 1.0\n          point[1] = point[1] + 1.0\n          point[2] = point[2] + 1.0\n          rs.ObjectGripLocation(obj, 0, point)\n          rs.EnableObjectGrips(obj, False)\n    See Also:\n      EnableObjectGrips\n      ObjectGripLocations\n    \"\"\"\n    rhobj = rhutil.coercerhinoobject(object_id, True, True)\n    if not rhobj.GripsOn: return scriptcontext.errorhandler()\n    grips = rhobj.GetGrips()\n    if not grips or index<0 or index>=grips.Length:\n        return scriptcontext.errorhandler()\n    grip = grips[index]\n    rc = grip.CurrentLocation\n    if point:\n        grip.CurrentLocation = rhutil.coerce3dpoint(point, True)\n        scriptcontext.doc.Objects.GripUpdate(rhobj, True)\n        scriptcontext.doc.Views.Redraw()\n    return rc\n\n\ndef ObjectGripLocations(object_id, points=None):\n    \"\"\"Returns or modifies the location of all grips owned by an object. The\n    locations of the grips are returned in a list of Point3d with each position\n    in the list corresponding to that grip's index. To modify the locations of\n    the grips, you must provide a list of points that contain the same number\n    of points at grips\n    Parameters:\n      object_id (guid): identifier of the object\n      points ([point, ...], optional) list of 3D points identifying the new grip locations\n    Returns:\n      list(point, ...): if points is not specified, the current location of all grips\n      list(point, ...): if points is specified, the previous location of all grips\n      None: if not successful\n    Example:\n      import rhinoscriptsyntax as rs\n      obj = rs.GetObject(\"Select curve\", rs.filter.curve)\n      if obj:\n          rs.EnableObjectGrips( obj )\n          points = rs.ObjectGripLocations(obj)\n          for point in points:  print(point)\n    See Also:\n      EnableObjectGrips\n      ObjectGripCount\n      ObjectGripLocation\n    \"\"\"\n    rhobj = rhutil.coercerhinoobject(object_id, True, True)\n    if not rhobj.GripsOn: return scriptcontext.errorhandler()\n    grips = rhobj.GetGrips()\n    if grips is None: return scriptcontext.errorhandler()\n    rc = [grip.CurrentLocation for grip in grips]\n    if points and len(points)==len(grips):\n        points = rhutil.coerce3dpointlist(points, True)\n        for i, grip in enumerate(grips):\n            point = points[i]\n            grip.CurrentLocation = point\n        scriptcontext.doc.Objects.GripUpdate(rhobj, True)\n        scriptcontext.doc.Views.Redraw()\n    return rc\n\n\ndef ObjectGripsOn(object_id):\n    \"\"\"Verifies that an object's grips are turned on\n    Parameters:\n      object_id (guid): identifier of the object\n    Returns:\n      bool: True or False indicating Grips state\n      None: on error\n    Example:\n      import rhinoscriptsyntax as rs\n      obj = rs.GetObject(\"Select object\")\n      if rs.ObjectGripsOn(obj):\n          print(\"Grip count = {}\".format(rs.ObjectGripCount(obj)))\n    See Also:\n      EnableObjectGrips\n      ObjectGripCount\n      ObjectGripsSelected\n      SelectObjectGrips\n      UnselectObjectGrips\n    \"\"\"\n    rhobj = rhutil.coercerhinoobject(object_id, True, True)\n    return rhobj.GripsOn\n\n\ndef ObjectGripsSelected(object_id):\n    \"\"\"Verifies that an object's grips are turned on and at least one grip\n    is selected\n    Parameters:\n      object_id (guid): identifier of the object\n    Returns:\n      bool: True or False indicating success or failure\n    Example:\n      import rhinoscriptsyntax as rs\n      obj = rs.GetObject(\"Select object\")\n      if rs.ObjectGripsSelected(obj):\n          rs.UnselectObjectGrips( obj )\n    See Also:\n      EnableObjectGrips\n      ObjectGripCount\n      ObjectGripsOn\n      SelectObjectGrips\n      UnselectObjectGrips\n    \"\"\"\n    rhobj = rhutil.coercerhinoobject(object_id, True, True)\n    if not rhobj.GripsOn: return False\n    grips = rhobj.GetGrips()\n    if grips is None: return False\n    for grip in grips:\n        if grip.IsSelected(False): return True\n    return False\n\n\ndef PrevObjectGrip(object_id, index, direction=0, enable=True):\n    \"\"\"Returns the previous grip index from a specified grip index of an object\n    Parameters:\n      object_id (guid): identifier of the object\n      index (number): zero based grip index from which to get the previous grip index\n      direction ([number, number], optional): direction to get the next grip index (0=U, 1=V)\n      enable (bool, optional): if True, the next grip index found will be selected\n    Returns:\n      number: index of the next grip on success\n      None: on failure\n    Example:\n      import rhinoscriptsyntax as rs\n      object_id = rs.GetObject(\"Select curve\", rs.filter.curve)\n      if object_id:\n          rs.EnableObjectGrips(object_id)\n          count = rs.ObjectGripCount(object_id)\n          for i in range(count-1, 0, -2):\n              rs.PrevObjectGrip(object_id, i, 0, True)\n    See Also:\n      EnableObjectGrips\n      NextObjectGrip\n    \"\"\"\n    return __neighborgrip(-1, object_id, index, direction, enable)\n\n\ndef SelectedObjectGrips(object_id):\n    \"\"\"Returns a list of grip indices indentifying an object's selected grips\n    Parameters:\n      object_id (guid): identifier of the object\n    Returns:\n      list(number): list of indices on success\n      None: on failure or if no grips are selected\n    Example:\n      import rhinoscriptsyntax as rs\n      obj = rs.GetObject(\"Select curve\", rs.filter.curve)\n      if obj:\n          rs.EnableObjectGrips( obj )\n          count = rs.ObjectGripCount( obj )\n          for i in range(0,count,2):\n              rs.SelectObjectGrip( obj, i )\n          grips = rs.SelectedObjectGrips(obj)\n          if grips: print(len(grips{}).format(\"grips selected\"))\n    See Also:\n      EnableObjectGrips\n      SelectObjectGrip\n      SelectObjectGrips\n    \"\"\"\n    rhobj = rhutil.coercerhinoobject(object_id, True, True)\n    if not rhobj.GripsOn: return None\n    grips = rhobj.GetGrips()\n    rc = []\n    if grips:\n        for i in compat.RANGE(grips.Length):\n            if grips[i].IsSelected(False): rc.append(i)\n    return rc\n\n\ndef SelectObjectGrip(object_id, index):\n    \"\"\"Selects a single grip owned by an object. If the object's grips are\n    not turned on, the grips will not be selected\n    Parameters:\n      object_id (guid) identifier of the object\n      index (number): index of the grip to select\n    Returns:\n      bool: True or False indicating success or failure\n    Example:\n      import rhinoscriptsyntax as rs\n      obj = rs.GetObject(\"Select curve\", rs.filter.curve)\n      if obj:\n          rs.EnableObjectGrips( obj )\n          count = rs.ObjectGripCount( obj )\n          for i in range(0,count,2): rs.SelectObjectGrip(obj,i)\n    See Also:\n      EnableObjectGrips\n      ObjectGripCount\n      SelectObjectGrips\n    \"\"\"\n    rhobj = rhutil.coercerhinoobject(object_id, True, True)\n    if not rhobj.GripsOn: return False\n    grips = rhobj.GetGrips()\n    if grips is None: return False\n    if index<0 or index>=grips.Length: return False\n    grip = grips[index]\n    if grip.Select(True,True)>0:\n        scriptcontext.doc.Views.Redraw()\n        return True\n    return False\n\n\ndef SelectObjectGrips(object_id):\n    \"\"\"Selects an object's grips. If the object's grips are not turned on,\n    they will not be selected\n    Parameters:\n      object_id (guid): identifier of the object\n    Returns:\n      number: Number of grips selected on success\n      None: on failure\n    Example:\n      import rhinoscriptsyntax as rs\n      obj = rs.GetObject(\"Select object\")\n      if rs.ObjectGripsSelected(obj)==False:\n          rs.SelectObjectGrips( obj )\n    See Also:\n      EnableObjectGrips\n      ObjectGripCount\n      SelectObjectGrip\n    \"\"\"\n    rhobj = rhutil.coercerhinoobject(object_id, True, True)\n    if not rhobj.GripsOn: return scriptcontext.errorhandler()\n    grips = rhobj.GetGrips()\n    if grips is None: return scriptcontext.errorhandler()\n    count = 0\n    for grip in grips:\n        if grip.Select(True,True)>0: count+=1\n    if count>0:\n        scriptcontext.doc.Views.Redraw()\n        return count\n    return scriptcontext.errorhandler()\n\n\ndef UnselectObjectGrip(object_id, index):\n    \"\"\"Unselects a single grip owned by an object. If the object's grips are\n    not turned on, the grips will not be unselected\n    Parameters:\n      object_id (guid): identifier of the object\n      index (number): index of the grip to unselect\n    Returns:\n      bool: True or False indicating success or failure\n    Example:\n      import rhinoscriptsyntax as rs\n      obj = rs.GetObject(\"Select curve\", rs.filter.curve)\n      if obj:\n          rs.EnableObjectGrips( obj )\n          count = rs.ObjectGripCount(obj)\n          for i in range(0,count,2):\n              rs.UnselectObjectGrip( obj, i )\n    See Also:\n      EnableObjectGrips\n      ObjectGripCount\n      UnselectObjectGrips\n    \"\"\"\n    rhobj = rhutil.coercerhinoobject(object_id, True, True)\n    if not rhobj.GripsOn: return False\n    grips = rhobj.GetGrips()\n    if grips is None: return False\n    if index<0 or index>=grips.Length: return False\n    grip = grips[index]\n    if grip.Select(False)==0:\n        scriptcontext.doc.Views.Redraw()\n        return True\n    return False\n\n\ndef UnselectObjectGrips(object_id):\n    \"\"\"Unselects an object's grips. Note, the grips will not be turned off.\n    Parameters:\n      object_id (guid): identifier of the object\n    Returns:\n      number: Number of grips unselected on success\n      None: on failure\n    Example:\n      import rhinoscriptsyntax as rs\n      obj = rs.GetObject(\"Select object\")\n      if rs.ObjectGripsSelected(obj): rs.UnselectObjectGrips(obj)\n    See Also:\n      EnableObjectGrips\n      ObjectGripCount\n      UnselectObjectGrip\n    \"\"\"\n    rhobj = rhutil.coercerhinoobject(object_id, True, True)\n    if not rhobj.GripsOn: return scriptcontext.errorhandler()\n    grips = rhobj.GetGrips()\n    if grips is None: return scriptcontext.errorhandler()\n    count = 0\n    for grip in grips:\n        if grip.Select(False)==0: count += 1\n    if count>0:\n        scriptcontext.doc.Views.Redraw()\n        return count\n    return scriptcontext.errorhandler()\n",
  "language": "python",
  "imports": [
    "Rhino",
    "rhinoscriptsyntax",
    "scriptcontext"
  ],
  "has_docstring": false
}