{
  "source_url": "https://discourse.mcneel.com/t/netcore-accountmanagement-is-not-supported-on-this-platform/188765",
  "topic_id": 188765,
  "title": "NETCore - AccountManagement is not supported on this platform",
  "question": "Rhino Version 8 SR9 (8.9.24194.18121, 2024-07-12) Commercial\n\n\nC# Script Component fails with package System.DirectoryServices.AccountManagement v. 8.0.0.0\n\n\n\n\nWorks ok with .net framework 4.8 v.4.0.0.0 (Rhino running with NETFramework)\n\n\nNo errors when installing via Install Package-tool\n\n\nNuget package can be found from %userprofile%/.nuget\\packages\\system.directoryservices.accountmanagement\\8.0.0\n\n\nCommand: SetDotNetRuntime → Currently running .NET in NETCore\n\n\n\n\nimage\n744×349 16.3 KB\n\n\n// Grasshopper Script Instance\n#region Usings\nusing System;\n#r \"nuget: System.DirectoryServices.AccountManagement\"\nusing System.DirectoryServices.AccountManagement;\n\nusing System.Linq;\nusing System.Collections;\nusing System.Collections.Generic;\nusing System.Drawing;\n\nusing Rhino;\nusing Rhino.Geometry;\n\nusing Grasshopper;\nusing Grasshopper.Kernel;\nusing Grasshopper.Kernel.Data;\nusing Grasshopper.Kernel.Types;\n\n\n#endregion\n\npublic class Script_Instance : GH_ScriptInstance\n{\n    #region Notes\n    /* \n      Members:\n        RhinoDoc RhinoDocument\n        GH_Document GrasshopperDocument\n        IGH_Component Component\n        int Iteration\n\n      Methods (Virtual & overridable):\n        Print(string text)\n        Print(string format, params object[] args)\n        Reflect(object obj)\n        Reflect(object obj, string method_name)\n    */\n    #endregion\n\n    private void RunScript(object x, object y, ref object a)\n    {\n        // Write your logic here\n        a = UserPrincipal.Current.DisplayName;\n    }\n}\n\n\n\n\n\n\nPlatformNotSupportedException: System.DirectoryServices.AccountManagement is not supported on this platform.\n\nat Script_Instance.RunScript(Object x, Object y, Object& a) in rhinocode:///grasshopper/1/a88ced93-8613-4ac1-8fa9-0e7402fa9148/b24263ae-8212-4bb5-ae55-aded8664a1b0:line 44\n\n\n\n\nBug?\n\n\nSame issue with Visual Studio components ( \nGH NET7 Visual Studio Template: Bitmap could not be found - Grasshopper Developer - McNeel Forum\n)",
  "code_blocks": [
    {
      "code": "// Grasshopper Script Instance\n#region Usings\nusing System;\n#r \"nuget: System.DirectoryServices.AccountManagement\"\nusing System.DirectoryServices.AccountManagement;\n\nusing System.Linq;\nusing System.Collections;\nusing System.Collections.Generic;\nusing System.Drawing;\n\nusing Rhino;\nusing Rhino.Geometry;\n\nusing Grasshopper;\nusing Grasshopper.Kernel;\nusing Grasshopper.Kernel.Data;\nusing Grasshopper.Kernel.Types;\n\n\n#endregion\n\npublic class Script_Instance : GH_ScriptInstance\n{\n    #region Notes\n    /* \n      Members:\n        RhinoDoc RhinoDocument\n        GH_Document GrasshopperDocument\n        IGH_Component Component\n        int Iteration\n\n      Methods (Virtual & overridable):\n        Print(string text)\n        Print(string format, params object[] args)\n        Reflect(object obj)\n        Reflect(object obj, string method_name)\n    */\n    #endregion\n\n    private void RunScript(object x, object y, ref object a)\n    {\n        // Write your logic here\n        a = UserPrincipal.Current.DisplayName;\n    }\n}",
      "language": "csharp",
      "author": "jhs",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "csharp",
    "geometry",
    "grasshopper",
    "rhinocommon"
  ],
  "has_accepted_answer": false,
  "category_id": 8,
  "posts_count": 13,
  "views": 813
}