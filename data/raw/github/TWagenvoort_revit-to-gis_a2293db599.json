{
  "source_url": "https://github.com/TWagenvoort/revit-to-gis/blob/8afed62e9378af0a7377198f89114eaa1ca21f05/GH_TEMPLATES.py",
  "repo": "TWagenvoort/revit-to-gis",
  "repo_stars": 0,
  "repo_description": null,
  "license": "MIT",
  "filepath": "GH_TEMPLATES.py",
  "instruction": "GRASSHOPPER READY-TO-USE TEMPLATES\nCopy-paste directly into Grasshopper Python Component",
  "code": "\"\"\"\nGRASSHOPPER READY-TO-USE TEMPLATES\nCopy-paste directly into Grasshopper Python Component\n\"\"\"\n\n# ============================================================================\n# TEMPLATE 1: SIMPLE LOAD & DISPLAY\n# ============================================================================\n# Grasshopper Python Component\n# Input: [None]\n# Output: objects, count, summary\n\nimport sys\nsys.path.insert(0, r\"C:\\Users\\Thijs W\\Desktop\\Revit to GIS\\scripts\")\n\nfrom gh_helper import GrassholperDataHelper\n\ntry:\n    helper = GrassholperDataHelper()\n    objects = helper.load_input_data()\n    count = len(objects) if objects else 0\n    summary = helper.get_summary()\n    \n    print(\"✅ Loaded {} objects\".format(count))\n    print(\"Types: {}\".format(summary[\"types\"]))\n    \nexcept Exception as e:\n    print(\"❌ Error: {}\".format(e))\n    objects = None\n    count = 0\n    summary = {\"error\": str(e)}\n\n# ============================================================================\n# TEMPLATE 2: LOAD + SCALE GEOMETRY\n# ============================================================================\n# Inputs: objects (from Template 1), scale_factor (Slider 0.5-2.0)\n# Output: processed_objects\n\nimport sys\nsys.path.insert(0, r\"C:\\Users\\Thijs W\\Desktop\\Revit to GIS\\scripts\")\n\nfrom gh_helper import GrassholperDataHelper\n\ntry:\n    helper = GrassholperDataHelper()\n    helper.current_data = objects if objects else []\n    \n    scale = scale_factor if 'scale_factor' in dir() else 1.0\n    \n    # Scale coordinates\n    for obj in helper.current_data:\n        geom = obj.get(\"geometry\", {})\n        coords = geom.get(\"coordinates\", [])\n        \n        def scale_coords(c, factor):\n            if isinstance(c[0], (list, tuple)):\n                return [scale_coords(sub, factor) for sub in c]\n            return [val * factor for val in c]\n        \n        geom[\"coordinates\"] = scale_coords(coords, scale)\n        obj[\"version\"] = obj.get(\"version\", 1) + 1\n    \n    processed_objects = helper.current_data\n    print(\"✅ Scaled {} objects by {}x\".format(len(processed_objects), scale))\n    \nexcept Exception as e:\n    print(\"❌ Error: {}\".format(e))\n    processed_objects = objects\n\n# ============================================================================\n# TEMPLATE 3: FILTER BY TYPE\n# ============================================================================\n# Inputs: objects, filter_type (Text: \"Wall\", \"Floor\", etc)\n# Output: filtered_objects\n\nimport sys\nsys.path.insert(0, r\"C:\\Users\\Thijs W\\Desktop\\Revit to GIS\\scripts\")\n\ntry:\n    filter_t = filter_type if 'filter_type' in dir() else \"Wall\"\n    \n    filtered_objects = [\n        obj for obj in objects \n        if obj.get(\"type\", \"\") == filter_t\n    ]\n    \n    print(\"✅ Filtered {} objects of type '{}'\".format(len(filtered_objects), filter_t))\n    \nexcept Exception as e:\n    print(\"❌ Error: {}\".format(e))\n    filtered_objects = objects\n\n# ============================================================================\n# TEMPLATE 4: ADD CUSTOM PROPERTIES\n# ============================================================================\n# Inputs: objects, custom_id (Text: \"MY_PROJECT\")\n# Output: objects_with_props\n\nimport sys\nsys.path.insert(0, r\"C:\\Users\\Thijs W\\Desktop\\Revit to GIS\\scripts\")\n\nfrom datetime import datetime\n\ntry:\n    custom_id = custom_id if 'custom_id' in dir() else \"GH_PROJECT\"\n    \n    objects_with_props = []\n    \n    for obj in objects:\n        obj[\"properties\"][\"custom_id\"] = custom_id\n        obj[\"properties\"][\"modified_in_gh\"] = True\n        obj[\"properties\"][\"gh_timestamp\"] = datetime.now().isoformat()\n        obj[\"version\"] = obj.get(\"version\", 1) + 1\n        \n        objects_with_props.append(obj)\n    \n    print(\"✅ Added properties to {} objects\".format(len(objects_with_props)))\n    \nexcept Exception as e:\n    print(\"❌ Error: {}\".format(e))\n    objects_with_props = objects\n\n# ============================================================================\n# TEMPLATE 5: SAVE OUTPUT\n# ============================================================================\n# Inputs: processed_objects (from any template above)\n# Output: output_file, success\n\nimport sys\nsys.path.insert(0, r\"C:\\Users\\Thijs W\\Desktop\\Revit to GIS\\scripts\")\n\nfrom gh_helper import GrassholperDataHelper\nfrom pathlib import Path\n\ntry:\n    helper = GrassholperDataHelper()\n    helper.current_data = processed_objects\n    \n    filepath = helper.save_output_data(processed_objects)\n    output_file = str(filepath)\n    success = True\n    \n    print(\"✅ Saved to: {}\".format(filepath))\n    \nexcept Exception as e:\n    print(\"❌ Error: {}\".format(e))\n    output_file = str(e)\n    success = False\n\n# ============================================================================\n# TEMPLATE 6: EXPORT TO ARCGIS ONLINE\n# ============================================================================\n# Inputs: processed_objects, agol_username (Text), agol_password (Text)\n# Output: agol_id, success, message\n\nimport sys\nsys.path.insert(0, r\"C:\\Users\\Thijs W\\Desktop\\Revit to GIS\\scripts\")\n\nfrom agol_exporter import AGOLExporter\n\ntry:\n    # Get credentials from inputs\n    user = agol_username if 'agol_username' in dir() else \"demo_user\"\n    pwd = agol_password if 'agol_password' in dir() else \"demo_pass\"\n    \n    exporter = AGOLExporter(user, pwd)\n    \n    success, result = exporter.export_to_agol(\n        processed_objects,\n        service_title=\"GH Modified - {}\".format(datetime.now().strftime(\"%Y%m%d\"))\n    )\n    \n    agol_id = result if success else None\n    message = \"✅ Success!\" if success else \"❌ Failed: {}\".format(result)\n    \n    print(message)\n    \nexcept Exception as e:\n    print(\"❌ Error: {}\".format(e))\n    agol_id = None\n    success = False\n    message = str(e)\n\n# ============================================================================\n# TEMPLATE 7: COMPLETE PIPELINE (ALL-IN-ONE)\n# ============================================================================\n# Input: [None - loads automatically]\n# Output: final_objects, output_file, agol_id\n\nimport sys\nsys.path.insert(0, r\"C:\\Users\\Thijs W\\Desktop\\Revit to GIS\\scripts\")\n\nfrom gh_helper import GrassholperPipeline, GrassholperDataHelper\nfrom agol_exporter import AGOLExporter\nfrom pathlib import Path\nfrom datetime import datetime\n\ntry:\n    # STEP 1: Load\n    pipeline = GrassholperPipeline()\n    data = pipeline.load_and_analyze()\n    \n    if not data:\n        raise Exception(\"No data loaded\")\n    \n    # STEP 2: Process (examples - modify as needed)\n    for obj in data:\n        # Example: Round coordinates\n        geom = obj.get(\"geometry\", {})\n        coords = geom.get(\"coordinates\", [])\n        \n        def round_coords(c, decimals=2):\n            if isinstance(c[0], (list, tuple)):\n                return [round_coords(sub, decimals) for sub in c]\n            return [round(val, decimals) for val in c]\n        \n        geom[\"coordinates\"] = round_coords(coords)\n        \n        # Add custom properties\n        obj[\"properties\"][\"gh_processed\"] = True\n        obj[\"properties\"][\"process_date\"] = datetime.now().isoformat()\n        obj[\"version\"] = obj.get(\"version\", 1) + 1\n    \n    # STEP 3: Save\n    helper = GrassholperDataHelper()\n    helper.current_data = data\n    output_path = helper.save_output_data(data)\n    \n    # STEP 4: Export to AGOL (optional)\n    agol_id = None\n    try:\n        exporter = AGOLExporter(\"username\", \"password\")\n        success, result = exporter.export_to_agol(data)\n        if success:\n            agol_id = result\n    except:\n        pass  # AGOL export failed, but that's OK\n    \n    final_objects = data\n    output_file = str(output_path)\n    \n    print(\"✅ Pipeline complete!\")\n    print(\"   Objects: {}\".format(len(final_objects)))\n    print(\"   File: {}\".format(output_file))\n    if agol_id:\n        print(\"   AGOL: {}\".format(agol_id))\n    \nexcept Exception as e:\n    print(\"❌ Error: {}\".format(e))\n    import traceback\n    traceback.print_exc()\n    final_objects = None\n    output_file = None\n    agol_id = None\n\n# ============================================================================\n# TEMPLATE 8: VISUALIZATION (Rhino Geometry)\n# ============================================================================\n# Inputs: processed_objects\n# Output: points, curves, colors\n\nimport sys\nsys.path.insert(0, r\"C:\\Users\\Thijs W\\Desktop\\Revit to GIS\\scripts\")\n\ntry:\n    from Rhino.Geometry import Point3d, Line, Curve, PolylineCurve\n    from System.Drawing import Color\n    \n    points = []\n    curves = []\n    colors = []\n    \n    # Color map for types\n    color_map = {\n        \"Wall\": Color.Red,\n        \"Floor\": Color.Blue,\n        \"Door\": Color.Green,\n        \"Window\": Color.Yellow,\n        \"Column\": Color.Magenta,\n    }\n    \n    for obj in processed_objects:\n        obj_type = obj.get(\"type\", \"Unknown\")\n        color = color_map.get(obj_type, Color.Gray)\n        geom = obj.get(\"geometry\", {})\n        coords = geom.get(\"coordinates\", [])\n        \n        if geom.get(\"type\") == \"Point\":\n            # Point\n            pt = Point3d(coords[0], coords[1], coords[2] if len(coords) > 2 else 0)\n            points.append(pt)\n            colors.append(color)\n        \n        elif geom.get(\"type\") == \"LineString\":\n            # Line/Polyline\n            pts = [Point3d(c[0], c[1], c[2] if len(c) > 2 else 0) for c in coords]\n            if len(pts) > 1:\n                curve = PolylineCurve(pts)\n                curves.append(curve)\n                colors.append(color)\n            else:\n                points.extend(pts)\n                colors.append(color)\n        \n        elif geom.get(\"type\") == \"Polygon\":\n            # Polygon\n            if coords:\n                pts = [Point3d(c[0], c[1], c[2] if len(c) > 2 else 0) for c in coords[0]]\n                if len(pts) > 1:\n                    curve = PolylineCurve(pts)\n                    curves.append(curve)\n                    colors.append(color)\n    \n    print(\"✅ Visualization ready!\")\n    print(\"   Points: {}\".format(len(points)))\n    print(\"   Curves: {}\".format(len(curves)))\n    \nexcept ImportError:\n    print(\"⚠️  Rhino.Geometry not available (use in Grasshopper)\")\n    points = []\n    curves = []\n    colors = []\nexcept Exception as e:\n    print(\"❌ Error: {}\".format(e))\n    points = []\n    curves = []\n    colors = []\n\n# ============================================================================\n# TEMPLATE 9: DATA TABLE (Properties Display)\n# ============================================================================\n# Inputs: processed_objects\n# Output: data_table\n\ntry:\n    # Create table-like structure\n    data_table = []\n    \n    for obj in processed_objects:\n        row = {\n            \"ID\": obj.get(\"id\", \"?\"),\n            \"Type\": obj.get(\"type\", \"?\"),\n            \"Version\": obj.get(\"version\", 1),\n            \"Properties\": str(obj.get(\"properties\", {}))[:50] + \"...\"\n        }\n        data_table.append(row)\n    \n    # Display as text\n    output = \"ID | Type | Ver | Properties\\n\"\n    output += \"---|------|-----|----------\\n\"\n    for row in data_table[:20]:  # First 20 rows\n        output += \"{} | {} | {} | {}\\n\".format(\n            row[\"ID\"][:15], \n            row[\"Type\"], \n            row[\"Version\"],\n            row[\"Properties\"][:30]\n        )\n    \n    if len(data_table) > 20:\n        output += \"... and {} more rows\".format(len(data_table) - 20)\n    \n    data_table = output\n    print(\"✅ Data table generated\")\n    \nexcept Exception as e:\n    print(\"❌ Error: {}\".format(e))\n    data_table = str(e)\n\n# ============================================================================\n# TEMPLATE 10: ERROR HANDLING WRAPPER\n# ============================================================================\n# Wrap any template above with this\n\ndef safe_execute(func):\n    \"\"\"Execute function with error handling\"\"\"\n    try:\n        result = func()\n        return result, True, \"Success\"\n    except Exception as e:\n        print(\"❌ Error: {}\".format(e))\n        import traceback\n        error_detail = traceback.format_exc()\n        return None, False, error_detail\n\n# Usage:\n# def my_process():\n#     helper = GrassholperDataHelper()\n#     return helper.load_input_data()\n#\n# result, success, message = safe_execute(my_process)\n\n# ============================================================================\n# TIPS & TRICKS\n# ============================================================================\n\n\"\"\"\nQUICK TIPS:\n1. Always add sys.path first\n2. Import only what you need\n3. Use try/except for debugging\n4. Print progress statements\n5. Output to multiple ports for flexibility\n6. Use Slider/Toggle/Text for inputs\n7. Connect Python components in sequence\n8. Right-click Python component → Show output\n9. Use \"View\" → \"Python Editor\" for better IDE\n10. Press Ctrl+Shift+M to minimize console\n\nCOMMON ERRORS:\n- \"ModuleNotFoundError\" → Check sys.path\n- \"FileNotFoundError\" → Check data/ directory exists\n- \"KeyError\" → Object doesn't have that property\n- IronPython issues → Use Python 3 in GH 2.0+\n\nDEBUGGING:\n1. Print intermediate values\n2. Check data/ folder for output files\n3. Look in Python console for errors\n4. Use print() statements liberally\n5. Test each template separately first\n\"\"\"\n",
  "language": "python",
  "imports": [
    "Rhino",
    "Rhino.Geometry"
  ],
  "has_docstring": true
}