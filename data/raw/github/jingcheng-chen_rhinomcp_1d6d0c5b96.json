{
  "source_url": "https://github.com/jingcheng-chen/rhinomcp/blob/615f0eae092d3d129f07fde519b28ca10d31dd6e/rhino_mcp_server/static/material.py",
  "repo": "jingcheng-chen/rhinomcp",
  "repo_stars": 299,
  "repo_description": "RhinoMCP connects Rhino 3D to AI Agent through the Model Context Protocol (MCP)",
  "license": "Apache-2.0",
  "filepath": "rhino_mcp_server/static/material.py",
  "instruction": "Material",
  "code": "import Rhino\nimport Rhino.DocObjects\n\nimport scriptcontext\n\nfrom rhinoscript import utility as rhutil\nfrom rhinoscript.layer import __getlayer\n\n\ndef AddMaterialToLayer(layer):\n    \"\"\"Add material to a layer and returns the new material's index. If the\n    layer already has a material, then the layer's current material index is\n    returned\n    Parameters:\n      layer (str): name of an existing layer.\n    Returns:\n      number: Material index of the layer if successful\n      None: if not successful or on error\n    Example:\n      import rhinoscriptsyntax as rs\n      layer = rs.CurrentLayer()\n      index = rs.LayerMaterialIndex(layer)\n      if index==-1: index = rs.AddMaterialToLayer(layer)\n    See Also:\n      LayerMaterialIndex\n      IsMaterialDefault\n    \"\"\"\n    layer = __getlayer(layer, True)\n    if layer.RenderMaterialIndex>-1: return layer.RenderMaterialIndex\n    material_index = scriptcontext.doc.Materials.Add()\n    layer.RenderMaterialIndex = material_index\n    scriptcontext.doc.Views.Redraw()\n    return material_index\n    #return scriptcontext.errorhandler()\n\n\ndef AddMaterialToObject(object_id):\n    \"\"\"Adds material to an object and returns the new material's index. If the\n    object already has a material, the the object's current material index is\n    returned.\n    Parameters:\n      object_id (guid): identifier of an object\n    Returns:\n      number: material index of the object\n    Example:\n      import rhinoscriptsyntax as rs\n      obj = rs.GetObject()\n      if obj:\n          index = rs.ObjectMaterialIndex(obj)\n          if index==-1: index = rs.AddMaterialToObject(obj)\n    See Also:\n      IsMaterialDefault\n      ObjectMaterialIndex\n      ObjectMaterialSource\n    \"\"\"\n    rhino_object = rhutil.coercerhinoobject(object_id, True, True)\n    attr = rhino_object.Attributes\n    if attr.MaterialSource!=Rhino.DocObjects.ObjectMaterialSource.MaterialFromObject:\n        attr.MaterialSource = Rhino.DocObjects.ObjectMaterialSource.MaterialFromObject\n        scriptcontext.doc.Objects.ModifyAttributes(rhino_object, attr, True)\n        attr = rhino_object.Attributes\n    material_index = attr.MaterialIndex\n    if material_index>-1: return material_index\n    material_index = scriptcontext.doc.Materials.Add()\n    attr.MaterialIndex = material_index\n    scriptcontext.doc.Objects.ModifyAttributes(rhino_object, attr, True)\n    return material_index\n\n    \ndef CopyMaterial(source_index, destination_index):\n    \"\"\"Copies definition of a source material to a destination material\n    Parameters:\n      source_index, destination_index (number): indices of materials to copy\n    Returns:\n      bool: True or False indicating success or failure\n    Example:\n      import rhinoscriptsyntax as rs\n      src = rs.LayerMaterialIndex(\"Default\")\n      dest = rs.LayerMaterialIndex(rs.CurrentLayer())\n      if src>=0 and dest>=0 and src!=dest:\n          rs.CopyMaterial( src, dest )\n    See Also:\n      LayerMaterialIndex\n      ObjectMaterialIndex\n    \"\"\"\n    if source_index==destination_index: return False\n    source = scriptcontext.doc.Materials[source_index]\n    if source is None: return False\n    rc = scriptcontext.doc.Materials.Modify(source, destination_index, True)\n    if rc: scriptcontext.doc.Views.Redraw()\n    return rc\n\n\ndef IsMaterialDefault(material_index):\n    \"\"\"Verifies a material is a copy of Rhino's built-in \"default\" material.\n    The default material is used by objects and layers that have not been\n    assigned a material.\n    Parameters:\n      material_index (number): the zero-based material index\n    Returns:\n      bool: True or False indicating success or failure\n    Example:\n      import rhinoscriptsyntax as rs\n      obj = rs.GetObject()\n      if obj:\n          index = rs.ObjectMaterialIndex(obj)\n          if rs.IsMaterialDefault(index):\n              print(\"Object is assigned default material.\")\n          else:\n              print(\"Object is not assigned default material.\")\n    See Also:\n      LayerMaterialIndex\n      ObjectMaterialIndex\n    \"\"\"\n    mat = scriptcontext.doc.Materials[material_index]\n    return mat and mat.IsDefaultMaterial\n\n\ndef IsMaterialReference(material_index):\n    \"\"\"Verifies a material is referenced from another file\n    Parameters:\n      material_index (number): the zero-based material index\n    Returns:\n      bool: True or False indicating success or failure\n    Example:\n      import rhinoscriptsyntax as rs\n      obj = rs.GetObject()\n      if obj:\n          index = rs.ObjectMaterialIndex(obj)\n          if rs.IsMaterialReference(index):\n              print(\"The material is referenced from another file.\")\n          else:\n              print(\"The material is not referenced from another file.\")\n    See Also:\n      IsLayerReference\n      IsLightReference\n      IsObjectReference\n    \"\"\"\n    mat = scriptcontext.doc.Materials[material_index]\n    return mat and mat.IsReference\n\n\ndef MatchMaterial(source, destination):\n    \"\"\"Copies the material definition from one material to one or more objects\n    Parameters:\n      source (number|guid): source material index -or- identifier of the source object.\n        The object must have a material assigned\n      destination ([guid, ...]) identifiers(s) of the destination object(s)\n    Returns:\n      number: number of objects that were modified if successful\n      None: if not successful or on error\n    Example:\n      import rhinoscriptsyntax as rs\n      obj = rs.GetObject(\"Select source object\")\n      if obj and rs.ObjectMaterialIndex(obj)>-1:\n          objects = rs.GetObjects(\"Select destination objects\")\n          if objects: rs.MatchMaterial( obj, objects )\n    See Also:\n      CopyMaterial\n      LayerMaterialIndex\n      ObjectMaterialIndex\n    \"\"\"\n    source_id = rhutil.coerceguid(source)\n    source_mat = None\n    if source_id:\n        rhobj = rhutil.coercerhinoobject(source_id, True, True)\n        source = rhobj.Attributes.MaterialIndex\n    mat = scriptcontext.doc.Materials[source]\n    if not mat: return scriptcontext.errorhandler()\n    destination_id = rhutil.coerceguid(destination)\n    if destination_id: destination = [destination]\n    ids = [rhutil.coerceguid(d) for d in destination]\n    rc = 0\n    for id in ids:\n        rhobj = scriptcontext.doc.Objects.Find(id)\n        if rhobj:\n            rhobj.Attributes.MaterialIndex = source\n            rhobj.Attributes.MaterialSource = Rhino.DocObjects.ObjectMaterialSource.MaterialFromObject\n            rhobj.CommitChanges()\n            rc += 1\n    if rc>0: scriptcontext.doc.Views.Redraw()\n    return rc\n\n\ndef MaterialBump(material_index, filename=None):\n    \"\"\"Returns or modifies a material's bump bitmap filename\n    Parameters:\n      material_index (number): zero based material index\n      filename (str, optional): the bump bitmap filename\n    Returns:\n      str: if filename is not specified, the current bump bitmap filename\n      str: if filename is specified, the previous bump bitmap filename\n      None: if not successful or on error\n    Example:\n      import rhinoscriptsyntax as rs\n      obj = rs.GetObject(\"Select object\")\n      if obj:\n          index = rs.ObjectMaterialIndex(obj)\n          if index>-1:\n              rs.MaterialBump( index, \"C:\\\\Users\\\\Steve\\\\Desktop\\\\bumpimage.png\" )\n    See Also:\n      MaterialColor\n      MaterialName\n      MaterialReflectiveColor\n      MaterialShine\n      MaterialTexture\n      MaterialTransparency\n    \"\"\"\n    mat = scriptcontext.doc.Materials[material_index]\n    if mat is None: return scriptcontext.errorhandler()\n    texture = mat.GetBumpTexture()\n    rc = texture.FileName if texture else \"\"\n    if filename:\n        mat.SetBumpTexture(filename)\n        mat.CommitChanges()\n        scriptcontext.doc.Views.Redraw()\n    return rc\n\n\ndef MaterialColor(material_index, color=None):\n    \"\"\"Returns or modifies a material's diffuse color.\n    Parameters:\n      material_index (number): zero based material index\n      color (color, optional): the new color value\n    Returns:\n      color: if color is not specified, the current material color\n      color: if color is specified, the previous material color\n      None: on error\n    Example:\n      import rhinoscriptsyntax as rs\n      obj = rs.GetObject(\"Select object\")\n      if obj:\n          index = rs.ObjectMaterialIndex(obj)\n          if index>-1:\n              rs.MaterialColor( index, (127, 255, 191) )\n    See Also:\n      MaterialBump\n      MaterialName\n      MaterialReflectiveColor\n      MaterialShine\n      MaterialTexture\n      MaterialTransparency\n    \"\"\"\n    mat = scriptcontext.doc.Materials[material_index]\n    if mat is None: return scriptcontext.errorhandler()\n    rc = mat.DiffuseColor\n    color = rhutil.coercecolor(color)\n    if color:\n        mat.DiffuseColor = color\n        mat.CommitChanges()\n        scriptcontext.doc.Views.Redraw()\n    return rc\n\n\ndef MaterialEnvironmentMap(material_index, filename=None):\n    \"\"\"Returns or modifies a material's environment bitmap filename.\n    Parameters:\n      material_index (number): zero based material index\n      filename (str, optional): the environment bitmap filename\n    Returns:\n      str: if filename is not specified, the current environment bitmap filename\n      str: if filename is specified, the previous environment bitmap filename\n      None: if not successful or on error\n    Example:\n      import rhinoscriptsyntax as rs\n      obj = rs.GetObject(\"Select object\")\n      if obj:\n          index = rs.ObjectMaterialIndex(obj)\n          if index>-1:\n              rs.MaterialEnvironmentMap( index, \"C:\\\\Users\\\\Steve\\\\Desktop\\\\emapimage.png\" )\n    See Also:\n      MaterialBump\n      MaterialTexture\n      MaterialTransparencyMap\n    \"\"\"\n    mat = scriptcontext.doc.Materials[material_index]\n    if mat is None: return scriptcontext.errorhandler()\n    texture = mat.GetEnvironmentTexture()\n    rc = texture.FileName if texture else \"\"\n    if filename:\n        mat.SetEnvironmentTexture(filename)\n        mat.CommitChanges()\n        scriptcontext.doc.Views.Redraw()\n    return rc\n\n\ndef MaterialName(material_index, name=None):\n    \"\"\"Returns or modifies a material's user defined name\n    Parameters:\n      material_index (number): zero based material index\n      name (str, optional): the new name\n    Returns:\n      str: if name is not specified, the current material name\n      str: if name is specified, the previous material name\n      None: on error\n    Example:\n      import rhinoscriptsyntax as rs\n      obj = rs.GetObject(\"Select object\")\n      if obj:\n          index = rs.ObjectMaterialIndex(obj)\n          if index>-1:\n              rs.MaterialName( index, \"Fancy_Material\" )\n    See Also:\n      MaterialBump\n      MaterialColor\n      MaterialReflectiveColor\n      MaterialShine\n      MaterialTexture\n      MaterialTransparency\n    \"\"\"\n    mat = scriptcontext.doc.Materials[material_index]\n    if mat is None: return scriptcontext.errorhandler()\n    rc = mat.Name\n    if name:\n        mat.Name = name\n        mat.CommitChanges()\n    return rc\n\n\ndef MaterialReflectiveColor(material_index, color=None):\n    \"\"\"Returns or modifies a material's reflective color.\n    Parameters:\n      material_index (number): zero based material index\n      color (color, optional): the new color value\n    Returns:\n      color: if color is not specified, the current material reflective color\n      color: if color is specified, the previous material reflective color\n      None: on error\n    Example:\n      import rhinoscriptsyntax as rs\n      obj = rs.GetObject(\"Select object\")\n      if obj:\n          index = rs.ObjectMaterialIndex(obj)\n          if index>-1:\n              rs.MaterialReflectiveColor( index, (191, 191, 255) )\n    See Also:\n      MaterialBump\n      MaterialColor\n      MaterialName\n      MaterialShine\n      MaterialTexture\n      MaterialTransparency\n    \"\"\"\n    mat = scriptcontext.doc.Materials[material_index]\n    if mat is None: return scriptcontext.errorhandler()\n    rc = mat.ReflectionColor\n    color = rhutil.coercecolor(color)\n    if color:\n        mat.ReflectionColor = color\n        mat.CommitChanges()\n        scriptcontext.doc.Views.Redraw()\n    return rc\n\n\ndef MaterialShine(material_index, shine=None):\n    \"\"\"Returns or modifies a material's shine value\n    Parameters:\n      material_index (number): zero based material index\n      shine (number, optional): the new shine value. A material's shine value ranges from 0.0 to 255.0, with\n        0.0 being matte and 255.0 being glossy\n    Returns:\n      number: if shine is not specified, the current material shine value\n      number: if shine is specified, the previous material shine value\n      None: on error\n    Example:\n      import rhinoscriptsyntax as rs\n      MAX_SHINE = 255.0\n      obj = rs.GetObject(\"Select object\")\n      if obj:\n          index = rs.ObjectMaterialIndex(obj)\n          if index>-1:\n              rs.MaterialShine( index, MAX_SHINE/2 )\n    See Also:\n      MaterialBump\n      MaterialColor\n      MaterialName\n      MaterialReflectiveColor\n      MaterialTexture\n      MaterialTransparency\n    \"\"\"\n    mat = scriptcontext.doc.Materials[material_index]\n    if mat is None: return scriptcontext.errorhandler()\n    rc = mat.Shine\n    if shine:\n        mat.Shine = shine\n        mat.CommitChanges()\n        scriptcontext.doc.Views.Redraw()\n    return rc\n\n\ndef MaterialTexture(material_index, filename=None):\n    \"\"\"Returns or modifies a material's texture bitmap filename\n    Parameters:\n      material_index (number): zero based material index\n      filename (str, optional): the texture bitmap filename\n    Returns:\n      str: if filename is not specified, the current texture bitmap filename\n      str: if filename is specified, the previous texture bitmap filename\n      None: if not successful or on error\n    Example:\n      import rhinoscriptsyntax as rs\n      obj = rs.GetObject(\"Select object\")\n      if obj:\n          index = rs.ObjectMaterialIndex(obj)\n          if index>-1:\n              rs.MaterialTexture( index, \"C:\\\\Users\\\\Steve\\\\Desktop\\\\textureimage.png\" )\n    See Also:\n      MaterialBump\n      MaterialColor\n      MaterialName\n      MaterialReflectiveColor\n      MaterialShine\n      MaterialTransparency\n    \"\"\"\n    mat = scriptcontext.doc.Materials[material_index]\n    if mat is None: return scriptcontext.errorhandler()\n    texture = mat.GetBitmapTexture()\n    rc = texture.FileName if texture else \"\"\n    if filename:\n        mat.SetBitmapTexture(filename)\n        mat.CommitChanges()\n        scriptcontext.doc.Views.Redraw()\n    return rc\n\n\ndef MaterialTransparency(material_index, transparency=None):\n    \"\"\"Returns or modifies a material's transparency value\n    Parameters:\n      material_index (number): zero based material index\n      transparency (number, optional): the new transparency value. A material's transparency value ranges from 0.0 to 1.0, with\n        0.0 being opaque and 1.0 being transparent\n    Returns:\n      number: if transparency is not specified, the current material transparency value\n      number: if transparency is specified, the previous material transparency value\n      None: on error\n    Example:\n      import rhinoscriptsyntax as rs\n      obj = rs.GetObject(\"Select object\")\n      if obj:\n          index = rs.ObjectMaterialIndex(obj)\n          if index>-1:\n              rs.MaterialTransparency( index, 0.50 )\n    See Also:\n      MaterialBump\n      MaterialColor\n      MaterialName\n      MaterialReflectiveColor\n      MaterialShine\n      MaterialTexture\n    \"\"\"\n    mat = scriptcontext.doc.Materials[material_index]\n    if mat is None: return scriptcontext.errorhandler()\n    rc = mat.Transparency\n    if transparency:\n        mat.Transparency = transparency\n        mat.CommitChanges()\n        scriptcontext.doc.Views.Redraw()\n    return rc\n\n\ndef MaterialTransparencyMap(material_index, filename=None):\n    \"\"\"Returns or modifies a material's transparency bitmap filename\n    Parameters:\n      material_index (number): zero based material index\n      filename (str, optional): the transparency bitmap filename\n    Returns:\n      str: if filename is not specified, the current transparency bitmap filename\n      str: if filename is specified, the previous transparency bitmap filename\n      None: if not successful or on error\n    Example:\n      import rhinoscriptsyntax as rs\n      obj = rs.GetObject(\"Select object\")\n      if obj:\n          index = rs.ObjectMaterialIndex(obj)\n          if index>-1:\n              rs.MaterialTransparencyMap( index, \"C:\\\\Users\\\\Steve\\\\Desktop\\\\texture.png\" )\n    See Also:\n      MaterialBump\n      MaterialEnvironmentMap\n      MaterialTexture\n    \"\"\"\n    mat = scriptcontext.doc.Materials[material_index]\n    if mat is None: return scriptcontext.errorhandler()\n    texture = mat.GetTransparencyTexture()\n    rc = texture.FileName if texture else \"\"\n    if filename:\n        mat.SetTransparencyTexture(filename)\n        mat.CommitChanges()\n        scriptcontext.doc.Views.Redraw()\n    return rc\n\n\ndef ResetMaterial(material_index):\n    \"\"\"Resets a material to Rhino's default material\n    Parameters:\n      material_index (number) zero based material index\n    Returns:\n      bool: True or False indicating success or failure\n    Example:\n      import rhinoscriptsyntax as rs\n      obj = rs.GetObject(\"Select object\")\n      if obj:\n          index = rs.ObjectMaterialIndex(obj)\n          if index>-1: rs.ResetMaterial(index)\n    See Also:\n      LayerMaterialIndex\n      ObjectMaterialIndex\n    \"\"\"\n    mat = scriptcontext.doc.Materials[material_index]\n    if mat is None: return False\n    rc = scriptcontext.doc.Materials.ResetMaterial(material_index)\n    scriptcontext.doc.Views.Redraw()\n    return rc\n",
  "language": "python",
  "imports": [
    "Rhino",
    "rhinoscriptsyntax",
    "scriptcontext"
  ],
  "has_docstring": false
}