{
  "source_url": "https://github.com/Ghaith89/BIMConstructionPlugin_VisualArq-Rhino3D/blob/6573341121d0c8a5b12aab6d9da1f79e15a7dc49/AddingPropertiesToBlocks.py",
  "repo": "Ghaith89/BIMConstructionPlugin_VisualArq-Rhino3D",
  "repo_stars": 1,
  "repo_description": "The script aims to inform all sellected blocks in RHino with BIM information from excel before export them as *.ifc to Revit",
  "license": "unknown",
  "filepath": "AddingPropertiesToBlocks.py",
  "instruction": "======================Get Rhino Referances======================#",
  "code": "#======================Get Rhino Referances======================#\r\nimport rhinoscriptsyntax as rs\r\nimport scriptcontext as sc\r\nimport Rhino as R\r\n\r\nimport clr\r\nimport sys\r\n\r\n\r\nsys.path.append(r\"C:\\Program Files\\Rhino 6\\System\") \r\nclr.AddReference (\"VisualARQ.Script.dll\")\r\nsys.path.append(r\"C:\\Users\\TishGhaith\\Downloads\\Microsoft.Office.Interop.Excel\")\r\nclr.AddReference (\"Microsoft.Office.Interop.Excel.dll\")\r\n\r\nimport VisualARQ.Script as va\r\n\r\nsys.path.append(r\"C:\\Users\\TishGhaith\\Desktop\")\r\nfrom Microsoft.Office.Interop import Excel\r\n\r\n#======================Get Rhino Referances========================#\r\n\r\n#======================Get Rhino Objects===========================#\r\nguids = rs.GetObjects('select objects')\r\n\r\n#======================Get Rhino Objects===========================#\r\n    \r\n#======================Synchronizing To Excel======================#\r\nex = Excel.ApplicationClass()   \r\nex.Visible = True\r\nex.DisplayAlerts = False   \r\nworkbook = ex.Workbooks.Open('C:\\Users\\TishGhaith\\Desktop\\ZZ.xlsx')\r\nws = workbook.Worksheets[1]\r\n#======================Synchronizing To Excel======================#\r\n\r\n\r\n#MakeSure That the previouseStyle is deleted\r\n\r\nfor i in guids:\r\n    ObjName = rs.ObjectName(i)\r\n    if va.IsElement(i):\r\n        rs.DeleteObject(i)\r\n        ExistedStyles = va.GetGenericElementStyleId(ObjName)\r\n        va.DeleteStyle(ExistedStyles)\r\n    else:\r\n        ExistedStyles = va.GetGenericElementStyleId(ObjName)\r\n        va.DeleteStyle(ExistedStyles)\r\n        \r\n#Make sure that all styles are deleted\r\nListStyles = va.GetAllGenericElementStyleIds()\r\n\r\nfor n in ListStyles:\r\n    va.DeleteStyle(n)\r\n\r\n\r\n\"\"\"\r\nM = rs.BlockNames(True)\r\nif len(M)>1:\r\n    for i in M:\r\n        if i == ObjName:\r\n            rs.DeleteBlock(i)\r\n\"\"\"\r\nva.IsElement\r\n\r\n\r\ndef redefigningBlocksOrigon(List_Blocks):\r\n    CorrectedBlocks = []\r\n    \r\n    \r\n    \r\n    for strObject in List_Blocks:\r\n        if rs.IsBlockInstance(strObject):\r\n            BlockName = rs.BlockInstanceName(strObject)\r\n            #Getting Block Parts\r\n            BlockParts = rs.ExplodeBlockInstance(strObject)\r\n            #Creating Block Base Point\r\n            BlockRef = R.Geometry.Point3d(0,0,0)\r\n            #Adding The Block Referance\r\n            rs.AddBlock(BlockParts, BlockRef, BlockName, True)\r\n            #Inserting The Block In its Place\r\n            WinBlock = rs.InsertBlock( BlockName, BlockRef, (1,1,1), 0, (0,0,1) )\r\n            #Modify Object Name\r\n            rs.ObjectName(WinBlock, BlockName)\r\n            CorrectedBlocks.append(WinBlock)\r\n    return CorrectedBlocks\r\n    \r\n\r\ndef CreatingElements(Block, RowNum,numProperties, PropRow):\r\n    #GetObjectName\r\n    ObjName = rs.BlockInstanceName(Block)\r\n    rs.ObjectName(Block, ObjName)\r\n    \r\n    \r\n    #va.DeleteStyle(styleId)\r\n    S = numProperties\r\n    ListPara = []\r\n    \r\n    #AddingParameters\r\n    \r\n    Ws = workbook.Worksheets[1]\r\n    Properties = []\r\n    co = 0\r\n    valRowNum = RowNum\r\n    for i in range(S):\r\n        \r\n        Parameter = Ws.Rows[PropRow].Value2[0,i]\r\n        if Ws.Rows[valRowNum].Value2[0,i] != None :\r\n            Value = Ws.Rows[valRowNum].Value2[0,i]\r\n        else:\r\n            Value = \"Non\"\r\n        \r\n        print (Value)\r\n        print (Parameter)\r\n        Properties.append(Parameter)\r\n        priceId = va.AddObjectParameter(Block,Parameter, va.ParameterType.Text, \"Specifications\", \"Name\" )\r\n        ListPara.append(priceId)\r\n        \r\n        va.SetParameterValue(priceId, Block, Value);\r\n        \r\n    return Block\r\n    \r\n#======================Cleaning Block List======================#\r\nCorrectedBlocks = redefigningBlocksOrigon(guids)\r\n#======================Cleaning Block List======================#\r\n\r\n\r\n#============================Input==============================#\r\nNumElements = 455\r\nNumberOfProperties = 68\r\nPropertiesRow = 9\r\nElemNaColNumber = 1\r\n#============================Input==============================#\r\n\r\n#======================Applying Methods=========================#\r\nrowNum = 1\r\n\r\nfor geo in CorrectedBlocks:\r\n    ObjName = rs.BlockInstanceName(geo)\r\n    num = 1\r\n    for l in range(NumElements+10):\r\n        num+=1\r\n        Name = ws.Rows[num].Value2[0,ElemNaColNumber]\r\n        \r\n        if str(Name)==ObjName:\r\n            rowName = Name\r\n            rowNum = num\r\n    CreatingElements(geo, rowNum,NumberOfProperties, PropertiesRow)\r\n\r\n#======================Applying Methods=========================#",
  "language": "python",
  "imports": [
    "Rhino",
    "rhinoscriptsyntax",
    "scriptcontext"
  ],
  "has_docstring": true
}