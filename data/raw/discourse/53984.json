{
  "source_url": "https://discourse.mcneel.com/t/textfield-formulas-with-python-script-not-updating/53984",
  "topic_id": 53984,
  "title": "Textfield formulas with python script not updating",
  "question": "I wrote a python script to import text into textfields, including text formulas. Essentially:\n\nrs.AddText(\"%<blockinstancecount(\"\"+line.rstrip()+\"\")>%\",…)\n\n\nIt seems Rhino doesn’t evaluate the inserted formula, it displays the full string as text.\n\nOnly after I manually modify the text the formula is evaluated.\n\n\nIs this a bug or am I missing something?\n\n\nThanks",
  "code_blocks": [
    {
      "code": "text = \"%<objectname(\" + chr(34) + str(id) + chr(34) + \")>%\"\n        \n        X = rs.AddText(\" \", pt, height)\n        \n        textObj= sc.doc.Objects.Find(X)\n        textObj.Geometry.TextFormula = text\n        \n        sc.doc.Objects.Replace(X, textObj.Geometry)",
      "language": "python",
      "author": "pascal",
      "post_number": 2,
      "is_solution": false
    }
  ],
  "tags": [
    "file-io",
    "geometry",
    "python"
  ],
  "has_accepted_answer": false,
  "category_id": 5,
  "posts_count": 3,
  "views": 642
}