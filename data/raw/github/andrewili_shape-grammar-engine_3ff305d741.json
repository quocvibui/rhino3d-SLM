{
  "source_url": "https://github.com/andrewili/shape-grammar-engine/blob/2859d8021442542561bdd1387deebc85e26f2d03/rhino-translators/exporter0.py",
  "repo": "andrewili/shape-grammar-engine",
  "repo_stars": 1,
  "repo_description": null,
  "license": "unknown",
  "filepath": "rhino-translators/exporter0.py",
  "instruction": "exporter0.py Continues is_file_exporter.py",
  "code": "#   exporter0.py\n#   Continues is_file_exporter.py\n\n# import rhinoscriptsyntax as rs\n\nclass Exporter(object):\n    def __init__(self):\n        self.sorted_coord_list = []\n        self.sorted_line_coord_index_pair_list = []\n        self.sorted_lpoint_coord_list = []      #\n        self.tab = '    '\n\n    def export_shape(self):\n        \"\"\"Prompts for labeled points, lines, and shape name. Writes a file in\n        IS format\n        \"\"\"\n        # selected_lines = rs.GetObjects('Select lines', rs.filter.curve)\n        selected_elements = rs.GetObjects(\n            'Select elements', \n            rs.filter.curve + rs.filter.textdot)\n        selected_lines, selected_textdots = (\n            self.sort_elements(selected_elements))\n        self.coord_pair_list = self.make_coord_pair_list(selected_lines)\n        self.coord_list = self.make_coord_list(selected_textdots)\n        self.sorted_coord_list = (\n            self.make_sorted_coord_list(\n                self.coord_list, self.coord_pair_list)\n            )\n        # self.sorted_coord_list = (\n        #     self.make_sorted_coord_list(self.coord_pair_list))\n        self.sorted_line_coord_index_pair_list = (\n            self.make_sorted_line_coord_index_pair_list(self.coord_pair_list))\n        is_string = self.compose_is_string(\n            self.sorted_coord_list, self.sorted_line_coord_index_pair_list)\n        self.write_file(is_string)\n\n    def sort_elements(self, elements):\n        \"\"\"Receives a list of line and textdot Guids:\n            [Guid, ...]\n        Returns a list of line Guids and a list of textdot Guids:\n            [line_Guid, ...]\n            [textdot_Guid, ...]\n        \"\"\"\n        line_type = 4\n        textdot_type = 8192\n        lines = []\n        textdots = []\n        for element in elements:\n            object_type = rs.ObjectType(element) \n            if object_type == line_type:\n                lines.append(element)\n            elif object_type == textdot_type:\n                textdots.append(element)\n        return (lines, textdots)\n\n    def make_coord_pair_list(self, lines_in):\n        \"\"\"Receives a list of line Guids:\n            [Guid, ...]\n        Returns a list of (non-unique) line coord pairs:\n            [((num, num, num), (num, num, num)), ...]\n        \"\"\"\n        coord_pair_list = []\n        for line in lines_in:\n            coord_pair = self.get_coord_pair(line)\n            coord_pair_list.append(coord_pair)\n        return coord_pair_list\n\n    def get_coord_pair(self, line_in):\n        \"\"\"Receives a line Guid:\n            Guid\n        Returns the line's coords:\n            [(num, num, num), (num, num, num)]\n        \"\"\"\n        point_pair = rs.CurvePoints(line_in)\n        coord_pair = []\n        for point in point_pair:\n            coord = (point.X, point.Y, point.Z)\n            coord_pair.append(coord)\n        return coord_pair\n\n    def make_coord_list(self, textdots):\n        \"\"\"Receives a list of textdot Guids:\n            [Guid, ...]\n        Returns a list of the textdots' coords:\n            [(num, num, num), ...]\n        \"\"\"\n        coord_list = []\n        for textdot in textdots:\n            point = rs.TextDotPoint(textdot)\n            coord = point.X, point.Y, point.Z\n            coord_list.append(coord)\n        return coord_list\n\n    def make_sorted_coord_list(self, coord_list_in, coord_pair_list):\n        \"\"\"Receives a list of line coord pairs and a list of coords:\n            [((num, num, num), (num, num, num)), ...]\n            [(num, num, num), ...]\n        Returns an ordered list of unique coords:\n            [(num, num, num), ...]\n        \"\"\"\n        coord_list = []\n        for coord in coord_list_in:\n            if not coord in coord_list:\n                coord_list.append(coord)\n        for coord_pair in coord_pair_list:\n            for coord in coord_pair:\n                if not coord in coord_list:\n                    coord_list.append(coord)\n        return sorted(coord_list)\n\n    # def make_sorted_coord_list(self, coord_pair_list):\n    #     \"\"\"Receives a list of line coord pairs:\n    #         [((num, num, num), (num, num, num)), ...]\n    #     Returns an ordered list of unique coords:\n    #         [(num, num, num), ...]\n    #     \"\"\"\n    #     coord_list = []\n    #     for coord_pair in coord_pair_list:\n    #         for coord in coord_pair:\n    #             if not coord in coord_list:\n    #                 coord_list.append(coord)\n    #     return sorted(coord_list)\n\n    def make_sorted_line_coord_index_pair_list(self, coord_pair_list):\n        \"\"\"Receives a list of line coord pairs:\n            [((num, num, num), (num, num, num)), ...]\n        Returns an ordered list of unique line coord index pairs from the\n        coord list:\n            [(int, int), ...]\n        \"\"\"\n        index_pair_list = []\n        for coord_pair in coord_pair_list:\n            index_pair = (\n                self.get_index_pair(self.sorted_coord_list, coord_pair))\n            if not index_pair in index_pair_list:\n                index_pair_list.append(index_pair)\n        return sorted(index_pair_list)\n\n    def get_index_pair(self, coord_list, coord_pair):\n        \"\"\"Receives an ordered list of unique coords and a coord pair:\n            [((num, num, num), (num, num, num)), ...]\n            ((num, num, num), (num, num, num))\n        Returns the index of the coord pair in the coord pair list:\n            int\n        \"\"\"\n        coord1, coord2 = coord_pair\n        index1 = coord_list.index(coord1)\n        index2 = coord_list.index(coord2)\n        index_pair = (index1, index2)\n        return index_pair\n\n    def compose_is_string(\n        self, \n        coord_list, \n        line_coord_index_pair_list, \n        lpoint_coord_index_list\n    ):\n        \"\"\"Receives 2 lists:\n            [(num, num, num), ...]\n            [(int, int), ...]\n        Returns a string in IS format:\n            <tab><name>\n            <tab><coord entry 1>\n            ...\n            <blank line>\n            <tab><line entry 1>\n            ...\n            <blank line>\n            <tab><point entry 1>\n            ...\n        \"\"\"\n        indented_name_string = self.make_indented_name_string()\n        indented_coord_entries_string = (\n            self.make_indented_coord_entries_string())\n        blank_line = ''\n        indented_line_entries_string = (\n            self.make_indented_line_entries_string())\n        indented_lpoint_entries_string = (\n            self.make_indented_lpoint_entries_string())\n        substrings = [\n            indented_name_string, \n            indented_coord_entries_string, \n            blank_line, \n            indented_line_entries_string,\n            indented_lpoint_entries_string,\n            blank_line] \n        string = '\\n'.join(substrings)\n        return string\n\n    # def compose_is_string(self, coord_list, line_coord_index_pair_list):\n    #     \"\"\"Receives 2 lists:\n    #         [(num, num, num), ...]\n    #         [(int, int), ...]\n    #     Returns a string in IS format:\n    #         <tab><name>\n    #         <tab><coord entry 1>\n    #         ...\n    #         <blank line>\n    #         <tab><line entry 1>\n    #         ...\n    #         <blank line>\n    #         <tab><point entry 1>\n    #         ...\n    #     \"\"\"\n    #     indented_name_string = self.make_indented_name_string()\n    #     indented_coord_entries_string = (\n    #         self.make_indented_coord_entries_string())\n    #     blank_line = ''\n    #     indented_line_entries_string = (\n    #         self.make_indented_line_entries_string())\n    #     substrings = [\n    #         indented_name_string, \n    #         indented_coord_entries_string, \n    #         blank_line, \n    #         indented_line_entries_string,\n    #         blank_line] \n    #     string = '\\n'.join(substrings)\n    #     return string\n\n    def make_header(self, shape_name='<shape name>'):\n        header = 'shape' + ' ' + shape_name\n        return header\n\n    def make_indented_name_string(self):\n        indented_name_string = self.tab + 'name'\n        return indented_name_string\n\n    def make_indented_coord_entries_string(self):\n        \"\"\"Returns a string composed of indented coord entry strings:\n            <tab><coord entry>\\n<...>\n        \"\"\"\n        indented_coord_entry_strings = []\n        for coord in self.sorted_coord_list:\n            indented_coord_entry_string = (\n                self.make_indented_coord_entry_string(coord))\n            indented_coord_entry_strings.append(indented_coord_entry_string)\n        indented_coord_entries_string = (\n            '\\n'.join(indented_coord_entry_strings))\n        return indented_coord_entries_string\n\n    def make_indented_coord_entry_string(self, coord):\n        \"\"\"Receives a coord:\n            (num, num, num)\n        Returns an indented coord entry string:\n            <tab>coords <i_str> <x_str> <y_str> <z_str>\n        \"\"\"\n        i = self.sorted_coord_list.index(coord)\n        i_str = str(i)\n        x, y, z = coord[0], coord[1], coord[2]\n        x_str, y_str, z_str = str(x), str(y), str(z)\n        components = [self.tab + 'coords', i_str, x_str, y_str, z_str]\n        indented_coord_entry_string = ' '.join(components)\n        return indented_coord_entry_string\n\n    def make_indented_line_entries_string(self):\n        \"\"\"Returns a string composed of indented line entry strings:\n            <tab><line entry>\\n<...>\n        \"\"\"\n        indented_line_entry_strings = []\n        for index_pair in self.sorted_line_coord_index_pair_list:\n            indented_line_entry_string = (\n                self.make_indented_line_entry_string(index_pair))\n            indented_line_entry_strings.append(indented_line_entry_string)\n        indented_line_entries_string = '\\n'.join(indented_line_entry_strings)\n        return indented_line_entries_string\n\n    def make_indented_line_entry_string(self, index_pair):\n        \"\"\"Receives a line coord index pair:\n            (int, int)\n        Returns an indented line coord entry string:\n            <tab>line <i_str> <coord_index_str_1> <coord_index_str_2>)\n        \"\"\"\n        i = self.sorted_line_coord_index_pair_list.index(index_pair) + 1\n        i_str = str(i)\n        coord_index_1, coord_index_2 = index_pair[0], index_pair[1]\n        coord_index_str_1, coord_index_str_2 = (\n            str(coord_index_1), str(coord_index_2))\n        components = [\n            self.tab + 'line',\n            i_str, \n            coord_index_str_1, \n            coord_index_str_2]\n        indented_line_entry_string = ' '.join(components)\n        return indented_line_entry_string\n\n    def make_indented_lpoint_entries_string(self):\n        \"\"\"Returns a string composed of indented lpoint entry strings:\n            <tab><lpoint entry>\\n<...>\n        \"\"\"\n        indented_lpoint_entry_strings = []\n        for lpoint in self.sorted_lpoint_list:  #\n            indented_lpoint_entry_string = '    Kilroy'\n            indented_lpoint_entry_strings.append(indented_lpoint_entry_string)\n        indented_lpoint_entries_string = (\n            '\\n'.join(indented_lpoint_entry_strings))\n        return indented_lpoint_entries_string\n\n    def write_file(self, string):\n        \"\"\"Prompts for a file name with is extension. Writes the string to the\n        file\n        \"\"\"\n        shape_name = rs.GetString(\n            'Enter the name of the shape', '<shape name>')\n        # filter = \"IS file (*.is)|*.is|All files (*.*)|*.*||\"\n        # long_file_name = (\n        #     rs.SaveFileName('Save shape as', filter, '', shape_name))\n        # if not long_file_name: return\n\n        header = ' '.join(['shape', shape_name])\n        headed_string = '\\n'.join([header, string])\n        # file = open(long_file_name, \"w\" )\n        # file.write(headed_string)\n        # file.close()\n        print(headed_string)\n\nif __name__ == '__main__':\n    # exporter = Exporter()\n    # exporter.export_shape()\n    import doctest\n    doctest.testfile('tests/exporter_test.txt')\n",
  "language": "python",
  "imports": [
    "rhinoscriptsyntax"
  ],
  "has_docstring": true
}