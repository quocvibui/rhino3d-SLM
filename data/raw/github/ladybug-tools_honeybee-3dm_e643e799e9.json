{
  "source_url": "https://github.com/ladybug-tools/honeybee-3dm/blob/256976aa1b173591f00699addf73f4377bcba142/honeybee_3dm/grid.py",
  "repo": "ladybug-tools/honeybee-3dm",
  "repo_stars": 2,
  "repo_description": "üêù ü¶è3DM - Honeybee extension for creating HBJSON model from Rhino 3dm",
  "license": "AGPL-3.0",
  "filepath": "honeybee_3dm/grid.py",
  "instruction": "Create Honeybee grid objects from objects in a rhino file.",
  "code": "\"\"\"Create Honeybee grid objects from objects in a rhino file.\"\"\"\n\n\nimport rhino3dm\n\nfrom honeybee_radiance.sensorgrid import SensorGrid\nfrom honeybee.typing import clean_and_id_string, clean_string\n\nfrom .togeometry import mesh_to_mesh3d, to_face3d\nfrom .layer import objects_on_layer, objects_on_parent_child\n\n\ndef import_grids(\n    rhino3dm_file, layer, tolerance, *, grid_controls=None, child_layer=False):\n    \"\"\"Creates Honeybee grids from a rhino3dm file.\n\n    This function assumes all the grid objects are under a layer named ``grid``.\n\n    Args:\n        rhino3dm_file: The rhino file from which Honeybee grids will be created.\n        layer: A Rhino3dm layer object.\n        tolerance: A rhino3dm tolerance object. Tolerance set in the rhino file.\n        grid_controls: A tuple of values for grid_size and grid_offset.\n            Defaults to None. This will employ the grid setting of (1.0, 1.0, 0.0)\n            for grid-size-x, grid-size-y, and grid-offset respectively.\n        child_layer: A bool. True will generate grids from the objects on the child layer\n            of a layer in addition to the objects on the parent layer. Defaults to False.\n        \n    Returns:\n        A list of Honeybee grids.\n    \"\"\"\n    hb_grids = []\n    # if objects on child layers are not requested\n    if not child_layer:\n        grid_objs = objects_on_layer(rhino3dm_file, layer)\n    \n    # if objects on child layers are requested\n    if child_layer:\n        grid_objs = objects_on_parent_child(rhino3dm_file, layer.Name)\n    \n    # Set default grid settings if not provided\n    if not grid_controls:\n        grid_controls = (1.0, 1.0, 0.0)\n\n    for obj in grid_objs:\n        geo = obj.Geometry\n        \n        # If it's a Mesh use it to create grids\n        # This is done so that if a user has created mesh with certain density\n        # the same can be used to create grids\n        if isinstance(geo, rhino3dm.Mesh):\n            mesh3d = mesh_to_mesh3d(geo)\n            name = obj.Attributes.Name\n            obj_name = name or clean_and_id_string('Grid')\n            args = [clean_string(obj_name), mesh3d]\n            hb_grids.append(SensorGrid.from_mesh3d(*args))\n\n        else:\n            try:\n                faces = to_face3d(obj, tolerance)\n            except AssertionError:\n                raise AssertionError(\n                f'Please check object with ID: {obj.Attributes.Id}.'\n                ' Either the object has faces too small for the grid size, or the'\n                ' object is not supported for grids. You should try again with a'\n                ' smaller grid size in the config file.'\n            )\n            name = obj.Attributes.Name\n            obj_name = name or clean_and_id_string('Grid')\n            args = [\n                clean_string(obj_name), faces, grid_controls[0], grid_controls[0],\n                grid_controls[1]]\n            hb_grids.append(SensorGrid.from_face3d(*args))\n\n    return hb_grids\n",
  "language": "python",
  "imports": [
    "rhino3dm"
  ],
  "has_docstring": true
}