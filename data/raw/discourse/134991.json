{
  "source_url": "https://discourse.mcneel.com/t/rhinocommon-unrollsurface-differs-from-unrollsrf-command/134991",
  "topic_id": 134991,
  "title": "RhinoCommon UnrollSurface differs from UnrollSrf command",
  "question": "Have a look at the file in attachment. When I use the UnrollSrf command I get a flat polysurface with smooth edges. When I use RhinoCommons UnrollSurface I get a surface with ugly jaggered edges. How can I achieve the result from the UnrollSrf command using Rhinocommon?\n\n\n\n\nimage\n1449Ã—685 40 KB\n\n\n\n\nFor repeating the problem, try this code using Python:\n\n\nimport rhinoscriptsyntax as rs\n\nobj = rs.GetObject()\nrs.UnrollSurface(obj)\n\n\n\n211214 UnrollSrf vs sr.UnrollSurface.3dm\n (116.0 KB)",
  "code_blocks": [
    {
      "code": "import rhinoscriptsyntax as rs\n\nobj_id = rs.GetObject(\"Surface to unroll\", 8, True, False)\nif obj_id:\n    rc = rs.UnrollSurface(obj_id, False, None, 0.00001)",
      "language": "python",
      "author": "clement",
      "post_number": 2,
      "is_solution": false
    },
    {
      "code": "import rhinoscriptsyntax as rs\n\nobj = rs.GetObject()\ntol = rs.UnitAbsoluteTolerance()\nrs.UnrollSurface(obj,False,None,tol)",
      "language": "python",
      "author": "siemen",
      "post_number": 3,
      "is_solution": false
    },
    {
      "code": "# input x type hint set to Brep\n\nimport Rhino\n\ndoc = Rhino.RhinoDoc.ActiveDoc\n\nx.Faces.SplitFacesAtTangents()\n\nfor face in x.Faces:\n    face.ShrinkFace(Rhino.Geometry.BrepFace.ShrinkDisableSide.ShrinkAllSides)\n\nunroll = Rhino.Geometry.Unroller(x)\nunroll.AbsoluteTolerance = doc.ModelAbsoluteTolerance\nunroll.RelativeTolerance = doc.ModelRelativeTolerance\n\nbreps, curves, points, dots = unroll.PerformUnroll()\n\na = Rhino.Geometry.Brep.JoinBreps(breps, doc.ModelAbsoluteTolerance)",
      "language": "python",
      "author": "kev.r",
      "post_number": 5,
      "is_solution": false
    },
    {
      "code": "import Rhino\nimport rhinoscriptsyntax as rs\n\nobj = rs.GetObject()\n\nbrep = rs.coercebrep(obj)\n\nbrep.Faces.SplitFacesAtTangents()\n\nfor face in brep.Faces:\n    face.ShrinkFace(Rhino.Geometry.BrepFace.ShrinkDisableSide.ShrinkAllSides)\n\nunroll = Rhino.Geometry.Unroller(brep)\nunroll.AbsoluteTolerance = Rhino.RhinoDoc.ActiveDoc.ModelAbsoluteTolerance\nunroll.RelativeTolerance = Rhino.RhinoDoc.ActiveDoc.ModelRelativeTolerance\n\nbreps, curves, points, dots = unroll.PerformUnroll()\n\na = Rhino.Geometry.Brep.JoinBreps(breps, Rhino.RhinoDoc.ActiveDoc.ModelAbsoluteTolerance)\n\nfor i in a:\n    Rhino.RhinoDoc.ActiveDoc.Objects.AddBrep(i)\n\nrs.Redraw()",
      "language": "python",
      "author": "siemen",
      "post_number": 6,
      "is_solution": false
    },
    {
      "code": "import Rhino\nimport scriptcontext as sc\n\ndef test_unroller():\n    filter = Rhino.DocObjects.ObjectType.Surface | Rhino.DocObjects.ObjectType.PolysrfFilter\n    rc, objref = Rhino.Input.RhinoGet.GetOneObject(\"Select surface or polysurface to unroll\", False, filter)\n    if not objref or rc != Rhino.Commands.Result.Success: \n        return\n    \n    brep = objref.Brep()\n    if not brep:\n        return\n        \n    bcopy = brep.DuplicateBrep()\n    bcopy.Compact()\n    bcopy.Faces.SplitFacesAtTangents()\n    for f in bcopy.Faces:\n        f.RebuildEdges(0.00001, True, True)\n    for f in bcopy.Faces:\n        f.ShrinkFace(Rhino.Geometry.BrepFace.ShrinkDisableSide.ShrinkAllSides)\n    bcopy.CullUnusedSurfaces()\n    for f in bcopy.Faces:\n        if f.OrientationIsReversed:\n            f.UnderlyingSurface().Reverse(1)\n        \n    unroll = Rhino.Geometry.Unroller(bcopy)\n    unroll.AbsoluteTolerance = sc.doc.ModelAbsoluteTolerance\n    unroll.RelativeTolerance = 0.01\n    out_breps, curves, points, dots = unroll.PerformUnroll()\n    if out_breps:\n        for b in out_breps:\n            sc.doc.Objects.AddBrep(b)\n            \n    sc.doc.Views.Redraw()\n\nif __name__==\"__main__\":\n    test_unroller()",
      "language": "python",
      "author": "dale",
      "post_number": 10,
      "is_solution": true
    },
    {
      "code": "import Rhino\nimport scriptcontext as sc\n\ndef test_unroller():\n    filter = Rhino.DocObjects.ObjectType.Surface | Rhino.DocObjects.ObjectType.PolysrfFilter\n    rc, objref = Rhino.Input.RhinoGet.GetOneObject(\"Select surface or polysurface to unroll\", False, filter)\n    if not objref or rc != Rhino.Commands.Result.Success: \n        return\n    \n    brep = objref.Brep()\n    if not brep:\n        return\n        \n    bcopy = brep.DuplicateBrep()\n    bcopy.Compact()\n    bcopy.Faces.SplitFacesAtTangents()\n    for f in bcopy.Faces:\n        f.RebuildEdges(0.00001, True, True)\n    for f in bcopy.Faces:\n        f.ShrinkFace(Rhino.Geometry.BrepFace.ShrinkDisableSide.ShrinkAllSides)\n    bcopy.CullUnusedSurfaces()\n    for f in bcopy.Faces:\n        if f.OrientationIsReversed:\n            f.UnderlyingSurface().Reverse(1)\n        \n    unroll = Rhino.Geometry.Unroller(bcopy)\n    unroll.AbsoluteTolerance = sc.doc.ModelAbsoluteTolerance\n    unroll.RelativeTolerance = 0.01\n    out_breps, curves, points, dots = unroll.PerformUnroll()\n    \n    if out_breps:\n        joinBrep = Rhino.Geometry.Brep.JoinBreps(out_breps,sc.doc.ModelAbsoluteTolerance*2.1)\n    \n    if joinBrep:\n        for b in joinBrep:\n            sc.doc.Objects.AddBrep(b)\n    sc.doc.Views.Redraw()\n\nif __name__==\"__main__\":\n    test_unroller()",
      "language": "python",
      "author": "siemen",
      "post_number": 14,
      "is_solution": false
    },
    {
      "code": "if out_breps:\n    joined_brep = Rhino.Geometry.Brep()\n    for b in out_breps:\n        joined_brep.Append(b)\n    joined_brep.JoinNakedEdges(0.0)\n\n    sc.doc.Objects.AddBrep(joined_brep)\n    sc.doc.Views.Redraw()",
      "language": "python",
      "author": "dale",
      "post_number": 15,
      "is_solution": false
    },
    {
      "code": "import rhinoscriptsyntax as rs\n\nobj = rs.GetObject()\nrs.UnrollSurface(obj)",
      "language": "python",
      "author": "siemen",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "csharp",
    "file-io",
    "geometry",
    "python",
    "rhinocommon",
    "rhinoscriptsyntax",
    "selection",
    "transformation"
  ],
  "has_accepted_answer": true,
  "category_id": 11,
  "posts_count": 17,
  "views": 2626
}