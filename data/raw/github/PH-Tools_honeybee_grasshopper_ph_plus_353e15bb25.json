{
  "source_url": "https://github.com/PH-Tools/honeybee_grasshopper_ph_plus/blob/b89f9887488d9c10eb732ffafe910cec70be0752/honeybee_ph_plus_rhino/gh_compo_io/hb_tools/win_create_geom.py",
  "repo": "PH-Tools/honeybee_grasshopper_ph_plus",
  "repo_stars": 2,
  "repo_description": "Additional Honeybe-PH Grasshopper Components",
  "license": "GPL-3.0",
  "filepath": "honeybee_ph_plus_rhino/gh_compo_io/hb_tools/win_create_geom.py",
  "instruction": "GHCompo Interface: HBPH+ - Create Rhino Geometry.",
  "code": "# -*- coding: utf-8 -*-\n# -*- Python Version: 2.7 -*-\n\n\"\"\"GHCompo Interface: HBPH+ - Create Rhino Geometry.\"\"\"\n\nfrom collections import OrderedDict\n\ntry:\n    from itertools import izip  # type: ignore\nexcept ImportError:\n    # Python 3\n    izip = zip\n\ntry:\n    from typing import Any\nexcept ImportError:\n    pass  # Python 3\n\ntry:\n    from Rhino.Geometry import Brep, LineCurve  # type: ignore\nexcept ImportError:\n    pass  # Outside Rhino\n\ntry:\n    from ph_gh_component_io import gh_io\nexcept ImportError as e:\n    raise ImportError(\"\\nFailed to import ph_gh_component_io:\\n\\t{}\".format(e))\n\ntry:\n    from honeybee_ph_plus_rhino.gh_compo_io.hb_tools import win_create_types\nexcept ImportError as e:\n    raise ImportError(\"\\nFailed to import honeybee_ph_plus_rhino:\\n\\t{}\".format(e))\n\n\nclass GHCompo_CreateWindowRhinoGeometry(object):\n    NAME_FORMAT = \"{}_C{}_R{}\"\n\n    def __init__(self, _IGH, _win_baselines, _win_names, _win_collection, *args, **kwargs):\n        # type: (gh_io.IGH, list[LineCurve], list[str], dict[str, win_create_types.WindowUnitType], *Any, **Any) -> None\n        self.IGH = _IGH\n        self.win_collection = _win_collection\n        self.win_baselines = _win_baselines\n        self.win_names = _win_names\n\n    def check_input(self):\n        if not self.win_baselines or not self.win_names:\n            return\n\n        if len(self.win_baselines) != len(self.win_names):\n            msg = \"The number of window-baselines and window-names must be the same.\"\n            raise Exception(msg)\n\n    def check_result(self, _win_type, _srfcs, _names):\n        if len(_srfcs) != len(_names):\n            msg = \"Failed to create window geometry for window type: {}\".format(_win_type)\n            raise Exception(msg)\n\n    def create_names(self, _id_data):\n        # type: (OrderedDict[int, dict[str, Any]]) -> list[str]\n        \"\"\"Create names for the window surfaces.\"\"\"\n        names = []\n        for id, data in _id_data.items():\n            type_name = data[\"type_name\"]\n            col = data[\"col\"]\n            row = data[\"row\"]\n            try:\n                names.append(self.NAME_FORMAT.format(type_name, col, row))\n            except Exception as e:\n                msg = \"Error creating the window name using the format: '{}'? \\n{}\".format(self.NAME_FORMAT, e)\n                self.IGH.error(msg)\n                names.append(\"{}\".format(type_name))\n        return names\n\n    def run(self):\n        # type: () -> tuple[list[Brep], list[str]]\n        \"\"\"Return a list of window surfaces and their names.\"\"\"\n        self.check_input()\n\n        win_surfaces_, surface_names_ = [], []\n        for baseline, name in izip(self.win_baselines, self.win_names):\n            try:\n                win_type = self.win_collection[name]\n            except KeyError:\n                msg = (\n                    \"Failed to find window type named: '{}' in the window-type-collection?\\n\"\n                    \"Valid type-names include: [{}]\".format(name, \", \".join(list(self.win_collection.keys())))\n                )\n                raise KeyError(msg)\n            surfaces, id_data = win_type.build(baseline)\n            self.check_result(win_type, surfaces, id_data)\n            win_surfaces_ += surfaces\n\n            # -- Create the name from the id-data\n            surface_names_ += self.create_names(id_data)\n\n        return win_surfaces_, surface_names_\n",
  "language": "python",
  "imports": [
    "Rhino",
    "Rhino.Geometry"
  ],
  "has_docstring": true
}