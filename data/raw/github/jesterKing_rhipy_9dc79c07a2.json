{
  "source_url": "https://github.com/jesterKing/rhipy/blob/a2d268e016554c968a7187ae2d27dd9d0afcadc1/create_doublesided_rendermaterial.py",
  "repo": "jesterKing/rhipy",
  "repo_stars": 2,
  "repo_description": "Python scripts and snippets for Rhino",
  "license": "Apache-2.0",
  "filepath": "create_doublesided_rendermaterial.py",
  "instruction": "DO NOT EDIT THIS FILE DIRECTLY. This is generated from a literate program with the VSCode extension Literate Programming (jesterking.literate). These literate programs are Rhino 3D scripts explaining how scripting works in Rhino 3D with Python. Read the literate programs at: https://jesterking.github.io/literate This code is part of the repository: https://github.com/jesterKing/rhipy The Literate Programming extension repository is at: https://github.com/jesterKing/literate Licensed under Apache 2.0 See https://github.com/jesterKing/rhipy/blob/master/LICENSE Copyright (C) Nathan 'jesterKing' Letwory",
  "code": "# DO NOT EDIT THIS FILE DIRECTLY. This is generated from a literate program\n# with the VSCode extension Literate Programming (jesterking.literate).\n#\n# These literate programs are Rhino 3D scripts explaining how scripting works\n# in Rhino 3D with Python.\n#\n# Read the literate programs at:\n#    https://jesterking.github.io/literate\n#\n# This code is part of the repository:\n#    https://github.com/jesterKing/rhipy\n#\n# The Literate Programming extension repository is at:\n#    https://github.com/jesterKing/literate\n#\n# Licensed under Apache 2.0\n# See https://github.com/jesterKing/rhipy/blob/master/LICENSE\n#\n# Copyright (C) Nathan 'jesterKing' Letwory\n#\n\nimport System\nimport Rhino.Display\nimport Rhino.Render\n\nimport scriptcontext\nimport random\n\n# get object selection\nobject_selection = [ob for ob in scriptcontext.doc.Objects if ob.IsSelected(False)]\n\n# only if we have a selection do the work\nif object_selection:\n    # create material\n    render_material = Rhino.Render.RenderContent.Create(\n        System.Guid(\"E6CD1973-B739-496E-AB69-32957FA48492\"),\n        Rhino.Render.RenderContent.ShowContentChooserFlags.None,\n        scriptcontext.doc)\n    render_material.BeginChange(Rhino.Render.RenderContent.ChangeContexts.Program)\n    render_material.Name = \"Double-Sided Material \" + System.Guid.NewGuid().ToString()\n    \n    front_material = Rhino.Render.RenderContent.Create(\n        Rhino.Render.RenderMaterial.MetalMaterialGuid,\n        render_material,\n        \"front\",\n        Rhino.Render.RenderContent.ShowContentChooserFlags.None,\n        scriptcontext.doc)\n    \n    back_material = Rhino.Render.RenderContent.Create(\n        Rhino.Render.RenderMaterial.PlasterMaterialGuid,\n        render_material,\n        \"back\",\n        Rhino.Render.RenderContent.ShowContentChooserFlags.None,\n        scriptcontext.doc)\n    random_color1 = Rhino.Display.Color4f(\n        random.random(),\n        random.random(),\n        random.random(),\n        1.0)\n    random_color2 = Rhino.Display.Color4f(\n        random.random(),\n        random.random(),\n        random.random(),\n        1.0)\n    # set color for front material\n    front_material.BeginChange(Rhino.Render.RenderContent.ChangeContexts.Program)\n    front_material.SetParameter(\"color\", random_color1)\n    # set color for back material\n    back_material.BeginChange(Rhino.Render.RenderContent.ChangeContexts.Program)\n    back_material.SetParameter(\"color\", random_color2)\n    render_material.EndChange()\n    \n    # assign\n    for ob in object_selection:\n        print(\"Adding material\", render_material.Name, \"to\", ob)\n        ob.RenderMaterial = render_material\n        ob.CommitChanges()\n\n\n",
  "language": "python",
  "imports": [
    "Rhino",
    "scriptcontext"
  ],
  "has_docstring": true
}