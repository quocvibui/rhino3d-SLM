{
  "source_url": "https://discourse.mcneel.com/t/rs-addfilletcurve-has-me-stumped/200734",
  "topic_id": 200734,
  "title": "rs.AddFilletCurve has me stumped",
  "question": "Hi All,\n\n\nI really need some help from someone in McNeel if possible as I think the problem is a bug in the add fillet curve command, maybe not and someone can tell me otherwise. I will be quite happy to find out either way.\n\n\nThis script is run from within another script and all variables are working it does everything except insert that last fillet curve.\n\n\nThe problem is the rs.AddFilletCurve for curves 4 and 5, the curves appear to be made correct yet the rs.AddFilletCurve fails to add a new curve to the document. As you will see I have used this command at the start of my script and in that context it works fine, I have also been able to manually add a fillet to curves 4 and 5 along with the radius as in the script.\n\n\nIt just doesnâ€™t want to play ball in the script, so please put me out of my misery I am always wanting to learn and this has been a day wasted for something I just cannot see.\n\n\nRoger\n\n\n#! python 3\n#import rhinoscriptsyntax as rs\n#import scriptcontext as sc\nimport math\nimport Rhino.UI\n#import System\n#import System.Collections.Generic\n#import Rhino\n\n#import Eto.Drawing as drawing\n#from Eto.Drawing import Padding\n#from Eto.Forms import Dialog, DropDown, DynamicLayout\n#import Eto.Forms as forms\n\n\n# Imports\nimport scriptcontext as sc\nimport Rhino\nfrom Rhino.UI import RhinoEtoApp\nimport Eto.Drawing as drawing\nfrom Eto.Drawing import Padding\nfrom Eto.Forms import Dialog, DropDown, DynamicLayout\nimport Eto.Forms as forms\nfrom System.Collections.ObjectModel import ObservableCollection\nimport configparser as cp\nimport System\nimport System.Collections.Generic\nimport os\nfrom pathlib import Path\nimport rhinoscriptsyntax as rs\n\n\n# New Rerun/Exit Dialog Class\nclass RerunExitDialog(forms.Dialog[bool]):\n    def __init__(self):\n        super().__init__()\n        self.Title = \"Rerun or Exit\"\n        self.Padding = drawing.Padding(10)\n        self.Resizable = False\n\n        # Create label\n        self.m_label = forms.Label()\n        self.m_label.Text = \"Do you want ...",
  "code_blocks": [
    {
      "code": "#! python 3\nimport rhinoscriptsyntax as rs\n\nline0 = rs.AddLine([0,0,0], [5,1,0])\nline1 = rs.AddLine([0,0,0], [1,5,0])\nfillet = rs.AddFilletCurve(line0, line1)\n\nrs.Redraw()",
      "language": "python",
      "author": "dale",
      "post_number": 2,
      "is_solution": false
    },
    {
      "code": "#! python 3\n#import rhinoscriptsyntax as rs\n#import scriptcontext as sc\nimport math\nimport Rhino.UI\n#import System\n#import System.Collections.Generic\n#import Rhino\n\n#import Eto.Drawing as drawing\n#from Eto.Drawing import Padding\n#from Eto.Forms import Dialog, DropDown, DynamicLayout\n#import Eto.Forms as forms\n\n\n# Imports\nimport scriptcontext as sc\nimport Rhino\nfrom Rhino.UI import RhinoEtoApp\nimport Eto.Drawing as drawing\nfrom Eto.Drawing import Padding\nfrom Eto.Forms import Dialog, DropDown, DynamicLayout\nimport Eto.Forms as forms\nfrom System.Collections.ObjectModel import ObservableCollection\nimport configparser as cp\nimport System\nimport System.Collections.Generic\nimport os\nfrom pathlib import Path\nimport rhinoscriptsyntax as rs\n\n\n# New Rerun/Exit Dialog Class\nclass RerunExitDialog(forms.Dialog[bool]):\n    def __init__(self):\n        super().__init__()\n        self.Title = \"Rerun or Exit\"\n        self.Padding = drawing.Padding(10)\n        self.Resizable = False\n\n        # Create label\n        self.m_label = forms.Label()\n        self.m_label.Text = \"Do you want to rerun the script or exit?\"   # Fixed: Added Text argument\n\n        # Create buttons\n        self.m_rerun_button = forms.Button()\n        self.m_rerun_button.Text = \"Rerun\"\n        self.m_exit_button = forms.Button() \n        self.m_exit_button.Text = \"Exit\"\n        # Set button actions \n        self.m_rerun_button.Click += lambda sender, e: self.Close(True)\n        self.m_exit_button.Click += lambda sender, e: self.Close(False)\n\n        # Create layout\n        layout = forms.DynamicLayout()\n        layout.Spacing = drawing.Size(5, 5)\n        layout.AddRow(self.m_label)\n        layout.AddRow(self.m_rerun_button, self.m_exit_button)\n\n        # Set the dialog content\n        self.Content = layout\n\n# Secondary script\ndef ASME_B_16_5_45_Long_Radius_Elbows():\n\n    try:\n\n        print(\"Config values in secondary script:\",config_values)\n\n        rad = float(config_values.get('dim 4'))\n        print(\"Radius1:\", rad)\n\n        curve1 = rs.GetObject(\"Select 1st curve to fit\", rs.filter.curve, True)\n        curve2 = rs.GetObject(\"Select 2nd curve to fit\", rs.filter.curve, True)\n\n        if not curve1 or not curve2:\n            print(\"Object selection canceled.\")\n            return\n\n        # CurveFilletPoints(curve_id_0, curve_id_1, radius, base_point_0, base_point_1, return_points)\n        fillet = rs.CurveFilletPoints(curve1, curve2, rad)\n        if fillet:\n            rs.AddPoint(fillet[0])\n            rs.ObjectName( rs.FirstObject(), 'NIP 1' )\n            rs.AddPoint(fillet[1])\n            rs.ObjectName( rs.FirstObject(), 'NIP 2' )\n            rs.AddPoint(fillet[2])\n            rs.ObjectName( rs.FirstObject(), 'NIP 3' )\n\n        curve3 = rs.AddFilletCurve(curve1, curve2, rad)\n\n        #point = rs.LineLineIntersection(curve1, curve2)\n        #if point:\n            #rs.AddPoint(point[0])\n            #rs.AddPoint(point[1])\n        \n        \n\n        param1 = rs.CurveClosestPoint(curve1, fillet[0])\n        print(\"Curve parameter1: {}\".format(param1))\n        rs.SplitCurve(curve1, param1)\n\n        param2 = rs.CurveClosestPoint(curve2, fillet[1])\n        print(\"Curve parameter2: {}\".format(param2))\n        rs.SplitCurve(curve2, param2)\n\n        if curve3:\n\n            OIP = (0,0,0)\n            #OIP = rs.AddPoint(0,0,0)\n            #rs.coerce3dpoint(OIP)\n            print(OIP)\n\n            OIP1 = (0,float(config_values.get('dim 1')),0)\n            rs.AddPoint(OIP1)\n            rs.ObjectName( rs.FirstObject(), 'OIP 1' )\n            print(OIP1)\n            \n\n            OIP2 = (float(config_values.get('dim 2')), float(config_values.get('dim 3')),0)\n            rs.AddPoint(OIP2)\n            rs.ObjectName( rs.FirstObject(), 'OIP 2' )\n            print(OIP2)\n\n            OIP3 = (float(config_values.get('dim 4')),float(config_values.get('dim 1')),0)\n            rs.AddPoint(OIP3) \n            rs.ObjectName( rs.FirstObject(), 'OIP 3' )\n            print(OIP3)\n\n\n            curve4 = rs.AddLine(OIP, OIP1)\n            print(curve4)\n            curve5 = rs.AddLine(OIP, OIP2)\n            print(curve5)\n\n            if curve4 and curve5:\n                print(\"Lines created successfully. Attempting to create fillet.\")\n                rs.AddFilletCurve(curve4, curve5, rad)\n\n       \n\n            #internal = rs.AddPipe(curve, 0, float(config_values.get('dim 3')) / 2)\n            #offset = (float(config_values.get('dim 2')) - float(config_values.get('dim 3'))) / 2\n            #rs.OffsetSurface(internal, offset, tolerance=None, both_sides=False, create_solid=True)\n            #rs.DeleteObject(internal)\n\n        print(\"End of 45 Long Radius Elbows\")\n\n    except Exception as e:\n        print(f\"Error in 45 Long Radius Elbows: {e}\")\n\n# Main script logic\n#if __name__ == \"__main__\":\ndef RunScript():\n\n\n    while True:\n        # Run the Pulled Bends function\n        ASME_B_16_5_45_Long_Radius_Elbows()\n\n        # Ask the user if they want to rerun the script or exit\n        rerun_dialog = RerunExitDialog()\n        rerun_result = rerun_dialog.ShowModal(Rhino.UI.RhinoEtoApp.MainWindow)\n\n        if not rerun_result:\n            print(\"Exiting script.\")\n            break\n\n# Execute the rerun logic\nRunScript()",
      "language": "python",
      "author": "RogerD",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "file-io",
    "geometry",
    "python",
    "rhinoscriptsyntax",
    "selection"
  ],
  "has_accepted_answer": false,
  "category_id": 3,
  "posts_count": 3,
  "views": 72
}