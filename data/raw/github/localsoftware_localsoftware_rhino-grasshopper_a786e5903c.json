{
  "source_url": "https://github.com/localsoftware/localsoftware_rhino-grasshopper/blob/4aafec57e33b9f09cce6fd73dcda12b17cf794a5/plugin_files/UnPickle_View.py",
  "repo": "localsoftware/localsoftware_rhino-grasshopper",
  "repo_stars": 0,
  "repo_description": null,
  "license": "BSD-2-Clause",
  "filepath": "plugin_files/UnPickle_View.py",
  "instruction": "Un pickle view",
  "code": "﻿from ghpythonlib.componentbase import dotnetcompiledcomponent as component\nimport Grasshopper, GhPython, System, Rhino, os\nimport rhinoscriptsyntax as rs\nimport cPickle as pickle\nfrom Grasshopper.Kernel import GH_RuntimeMessageLevel as RML\n\n\nclass MyComponent(component):\n    def __new__(cls):\n        instance = Grasshopper.Kernel.GH_Component.__new__(cls,\n            \"UnPickleView\", \"UnPickleView\", \"\"\"Deserializes view data from binary file.\nSets a view by un-pickling a pickled view file.\nReturns a site geometry, a camera vector and a focal point.\nBased on the work of Jackie Berry.\n    Typical usage:\nPlug in a slider or number to the siteNumber input of the component. This numbere will be the site number, and name of the pickle.\nIf you’re only working with one site, you can leave it empty.\nSpecify a path for the pickles. This is the folder where the pickles are.\nFinally plug in a boolean toggle component to the read input of the component.\nOnce you are ready to UnPickle the geometry, set it to true.\nThe component will return a site geometry a camera vector and a camera target.\"\"\", \"Extra\", \"LocalCode\")\n        return instance\n    \n    def get_ComponentGuid(self):\n        return System.Guid(\"0032ef71-cb63-41c1-9449-2ea7bccf3b0e\")\n    \n    def SetUpParam(self, p, name, nickname, description):\n        p.Name = name\n        p.NickName = nickname\n        p.Description = description\n        p.Optional = True\n    \n    def RegisterInputParams(self, pManager):\n        p = GhPython.Assemblies.MarshalParam()\n        self.SetUpParam(p, \"siteNumber\", \"siteNumber\", \"site number\")\n        p.Access = Grasshopper.Kernel.GH_ParamAccess.item\n        self.Params.Input.Add(p)\n        \n        p = GhPython.Assemblies.MarshalParam()\n        self.SetUpParam(p, \"layer\", \"layer\", \"layer name\")\n        p.Access = Grasshopper.Kernel.GH_ParamAccess.item\n        self.Params.Input.Add(p)\n        \n        p = GhPython.Assemblies.MarshalParam()\n        self.SetUpParam(p, \"path\", \"path\", \"path to source file directory.\")\n        p.Access = Grasshopper.Kernel.GH_ParamAccess.item\n        self.Params.Input.Add(p)\n        \n        p = GhPython.Assemblies.MarshalParam()\n        self.SetUpParam(p, \"read\", \"read\", \"boolean\")\n        p.Access = Grasshopper.Kernel.GH_ParamAccess.item\n        self.Params.Input.Add(p)\n        \n    \n    def RegisterOutputParams(self, pManager):\n        p = Grasshopper.Kernel.Parameters.Param_GenericObject()\n        self.SetUpParam(p, \"geometry\", \"geometry\", \"converted geometry\")\n        self.Params.Output.Add(p)\n        \n        p = Grasshopper.Kernel.Parameters.Param_GenericObject()\n        self.SetUpParam(p, \"vector\", \"vector\", \"camera view vector\")\n        self.Params.Output.Add(p)\n        \n        p = Grasshopper.Kernel.Parameters.Param_GenericObject()\n        self.SetUpParam(p, \"target\", \"target\", \"camera view target (3D Point)\")\n        self.Params.Output.Add(p)\n        \n        p = Grasshopper.Kernel.Parameters.Param_GenericObject()\n        self.SetUpParam(p, \"status\", \"status\", \"Script variable UnPickleView\")\n        self.Params.Output.Add(p)\n        \n    \n    def SolveInstance(self, DA):\n        p0 = self.marshal.GetInput(DA, 0)\n        p1 = self.marshal.GetInput(DA, 1)\n        p2 = self.marshal.GetInput(DA, 2)\n        p3 = self.marshal.GetInput(DA, 3)\n        result = self.RunScript(p0, p1, p2, p3)\n\n        if result is not None:\n            if not hasattr(result, '__getitem__'):\n                self.marshal.SetOutput(result, DA, 0, True)\n            else:\n                self.marshal.SetOutput(result[0], DA, 0, True)\n                self.marshal.SetOutput(result[1], DA, 1, True)\n                self.marshal.SetOutput(result[2], DA, 2, True)\n                self.marshal.SetOutput(result[3], DA, 3, True)\n        \n    def get_Internal_Icon_24x24(self):\n        o = \"iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAHYcAAB2HAY/l8WUAAAOsSURBVEhL3VRZTFNBFG1faV8XIy3QWgyltNhoVAREFLCLBfftw08//FGjwX0BXNAofqg/+uMSoyEu+AMYN1RiYtS4oEZE3IJGjVFQEXGpgiI0xzvzSqVaBfTPm5y8eXPnnnPn3pmR/TcWSSiMjdWW26y649Z/gM2mO24yiWXEl0fQMHKF2ag+d+poCppfu/CJ4Hv192DxTfQtPZQEfaSqlAkMzp1rATAOaHMDX3uADgI84X0M3wjEN2O62c8E3FuKBtBENvDJ1T1aXGh7R1k+Gy3FtIZZw0C+5YusYALOXgkgB+sK7DAZ1dizczDQ7qW5MWHWdRHYvLGHAn4Pnt7PhEYdwQI53KOjceXiCC6MdiqNL7CW+JYt7I0AlYatmTbJFCT/ATly58Wjsd4p8bCy9UqAZQUvKsqSfyIORWw/Dfbs6ixbDpYu6KkAnYyvPg8SbbpfSMPB645B2+ds5C9LYP89EKBsNqxJ5MEJ8VoU5Ns5rBZtCHFXNL9worDAxsbdCAQaq1QqMGK4Hl98XvhbCK1etH70Ij1N/wt5SlIkvn3JQd7S7nYQaOzUiVJja66m487NUTBEqmDQq3Dv1ihUX04nnzxIPnaMEbXVGRQ3Lthk99ZNYQQCjT1VLjVWLpej44Mb6/N5VhwbVttpzgNBUPB/cz81WpvphlMc41uxWBJIWpIbTxN0jrsKUGPbqLED7H2ChGdPpOBNg4uXgKGJxpXHUoL+kr1DpER5ctmYNbN/O83LlA6H9pG/hW4je0c6BUiwaK3U2E7QS4tH97PIR+8Woe5uJqzUdOZjFw5+ImdlZcnRbu02XQ35uM3bvX0QJ+XkHR7crkrnjSVfCNSqCEyZbMLECUaoAn5BEFB7bSTFU5I8+xwwPvLNIXAT+vZVXqipYotIhLa3d+eQEOI/YeXiBIoZK1WAYh/WZiAmWlVFPgUhaDFmo3i99PAwfHzrRGNDFkr2D+VnXVTJERWlQKxZyWEwRKDsYBLWrbIhOkpEXc1IvHyeAV+TE5UVqVQazQPii5NoQ00k5Fks2vr5s+NQuMbGr/uBfck4czINO7YNxD56QasvsZ2OR/WNTGzZOAgrlidg0XwLHA7xPcUXEfSM7LcmisqKBzez8PaVG+/r6e1vcOPKhQxke8y8JKePpOJ8ZRpSk2Pw/LGLr2t84oQlTqyTGLoxQZDN1evVxQZDADS2WHTFjkRdMbmL1Wqhlt0LjSaixGTScD8DNXu1xPDvpiK4pOGfTCb7Di+eCmvvWxIBAAAAAElFTkSuQmCC\"\n        return System.Drawing.Bitmap(System.IO.MemoryStream(System.Convert.FromBase64String(o)))\n\n    geometry, vector, target, status  = None, None, None, None\n\n    def RunScript(self, siteNumber, layer, path, read):\n        if path!=None and read==True and layer!=None:\n            try:\n                if siteNumber!=None:\n                    filepath = os.path.join(path,str(int(siteNumber))+layer)\n                else:\n                    filepath = os.path.join(path,layer)\n                f = open(filepath, 'rb')\n                data = pickle.load(f)\n                if len(data)>2:\n                    geometry = data[:-2]\n                    vector = data[-1]\n                    target = data[-2]\n                    status = \"file successfully loaded\"\n                    self.AddRuntimeMessage(RML.Remark,\"file successfully loaded\")\n                else:\n                    status = \"This doesn't look like a view file. \\nTry the UnpickleData component instead.\"\n                    self.AddRuntimeMessage(RML.Remark,\"This doesn't look like a view file. \\nTry the UnpickleData component instead.\")\n                f.close()\n\n            except:\n                status = 'Problem loading\\n\\n %s\\n\\nFile may not exist or the path may be invalid' % filepath\n                self.AddRuntimeMessage(RML.Remark,'Problem loading\\n\\n %s\\n\\nFile may not exist or the path may be invalid' % filepath)\n        else:\n            geometry, vector, target  = None, None, None\n            if path==None:\n                status = \"please provide path to source file directory.\"\n                self.AddRuntimeMessage(RML.Warning,\"please provide path to source file directory.\")\n            if layer==None:\n                status = \"please provide layer name of source file.\"\n                self.AddRuntimeMessage(RML.Warning,\"please provide layer name of source file.\")\n            if read!=True:\n                status = \"set read to True to unpickle view file.\"\n                self.AddRuntimeMessage(RML.Warning,\"set read to True to unpickle view file.\")\n\n        # return outputs if you have them; here I try it for you:\n        return (geometry, vector, target, status)\n\n\nimport GhPython\nimport System\n\nclass AssemblyInfo(GhPython.Assemblies.PythonAssemblyInfo):\n    def get_AssemblyName(self):\n        return \"UnPickleView\"\n    \n    def get_AssemblyDescription(self):\n        return \"\"\"\"\"\"\n\n    def get_AssemblyVersion(self):\n        return \"0.1\"\n\n    def get_AuthorName(self):\n        return \"\"\n    \n    def get_Id(self):\n        return System.Guid(\"47ed530f-c118-4471-8204-916377aefe3c\")",
  "language": "python",
  "imports": [
    "ghpythonlib",
    "rhinoscriptsyntax"
  ],
  "has_docstring": false
}