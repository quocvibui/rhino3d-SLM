{
  "source_url": "https://discourse.mcneel.com/t/move-along-z-axis-without-the-gumball-in-face-view/214838",
  "topic_id": 214838,
  "title": "Move along Z axis without the gumball in face view",
  "question": "Hello everyone!\n\n\nI was wondering if there were a easier way to align, let say the superior edge of a rectangle to an horizontale surface in FaceView. As shown below my usual workflow was to relocate the Gumball and to move the rectangle from it’s new origin. But I found it not very efficient, doest it existe a option within the displacement tool to force the displacement along a given axis just like in Blender for instance, when you can press X,Y or Z when moving an object to restrict the displacement to this given axis. Checking “project” will also do the trick with the displace tool in front view but again it’s not quick & easy. I’ve seen a command next to displace named “displace vertical” , but this only works in perspective view \n   I don’t know if this is the right place of development insights but adding \nthis feature inside the usual displace tool\n would be so practical!\n\n\nWith kind regards,\n\n\nCapture d’écran 2026-01-21 à 11.35.50\n1260×424 46.2 KB\n\n\nCapture d’écran 2026-01-21 à 11.36.21\n422×568 34.4 KB",
  "code_blocks": [
    {
      "code": "# -*- coding: utf-8 -*-\n\nimport Rhino\nimport Rhino.Geometry as rg\nimport Rhino.Input as ri\nimport Rhino.Input.Custom as ric\nimport scriptcontext as sc\nimport System\n\n\ndef constrain_point(base_point, target_point, mode):\n    # mode: 0=Free, 1=X, 2=Y, 3=Z\n    if mode == 0:\n        return target_point\n\n    dx = target_point.X - base_point.X\n    dy = target_point.Y - base_point.Y\n    dz = target_point.Z - base_point.Z\n\n    if mode == 1:  # X only\n        return rg.Point3d(base_point.X + dx, base_point.Y, base_point.Z)\n    if mode == 2:  # Y only\n        return rg.Point3d(base_point.X, base_point.Y + dy, base_point.Z)\n    if mode == 3:  # Z only\n        return rg.Point3d(base_point.X, base_point.Y, base_point.Z + dz)\n\n    return target_point\n\n\ndef axis_line_from_base(base_pt, mode, length=100000.0):\n    if mode == 1:  # X\n        return rg.Line(\n            base_pt + rg.Vector3d(-length, 0, 0), base_pt + rg.Vector3d(+length, 0, 0)\n        )\n    if mode == 2:  # Y\n        return rg.Line(\n            base_pt + rg.Vector3d(0, -length, 0), base_pt + rg.Vector3d(0, +length, 0)\n        )\n    if mode == 3:  # Z\n        return rg.Line(\n            base_pt + rg.Vector3d(0, 0, -length), base_pt + rg.Vector3d(0, 0, +length)\n        )\n    return None\n\n\ndef draw_geom_wire(display, geom, color, thickness=2):\n    \"\"\"\n    Draws common Rhino geometry as wireframe in the viewport.\n    (Mac-friendly).\n    \"\"\"\n    if isinstance(geom, rg.Curve):\n        display.DrawCurve(geom, color, thickness)\n        return\n\n    if isinstance(geom, rg.Brep):\n        display.DrawBrepWires(geom, color, thickness)\n        return\n\n    if isinstance(geom, rg.Mesh):\n        display.DrawMeshWires(geom, color)\n        return\n\n    if isinstance(geom, rg.Extrusion):\n        b = geom.ToBrep(True)\n        if b:\n            display.DrawBrepWires(b, color, thickness)\n        return\n\n    # fallback: bounding box\n    try:\n        bbox = geom.GetBoundingBox(True)\n        display.DrawBox(bbox, color, 1)\n    except:\n        pass\n\n\nclass MovePreviewPointGetter(Rhino.Input.Custom.GetPoint):\n\n    def __init__(self, base_pt, geoms, axis_mode_ref):\n        super(MovePreviewPointGetter, self).__init__()\n        self.base_pt = base_pt\n        self.geoms = geoms\n        self.axis_mode_ref = axis_mode_ref  # dict holding {\"value\": int}\n\n    def OnDynamicDraw(self, e):\n        try:\n            raw_pt = e.CurrentPoint\n            mode = self.axis_mode_ref[\"value\"]\n\n            constrained = constrain_point(self.base_pt, raw_pt, mode)\n\n            # Light gray rubber-band line (base -> constrained)\n            e.Display.DrawLine(\n                self.base_pt, constrained, System.Drawing.Color.LightGray, 1\n            )\n\n            # magenta marker at constrained point\n            e.Display.DrawPoint(\n                constrained, Rhino.Display.PointStyle.X, 8, System.Drawing.Color.Magenta\n            )\n\n            # blue wire preview geometry\n            move_vec = constrained - self.base_pt\n            xform = rg.Transform.Translation(move_vec)\n\n            for g in self.geoms:\n                g2 = g.Duplicate()\n                g2.Transform(xform)\n                draw_geom_wire(e.Display, g2, System.Drawing.Color.Blue, 2)\n\n        except:\n            # never let preview crash the command\n            pass\n\n\ndef move_with_axis_lock_and_preview():\n    # 1) Select objects\n    go = ric.GetObject()\n    go.SetCommandPrompt(\"Select objects to move\")\n    go.GroupSelect = True\n    go.SubObjectSelect = False\n    go.EnablePreSelect(True, True)\n\n    res = go.GetMultiple(1, 0)\n    if res != ri.GetResult.Object:\n        return\n\n    objrefs = [go.Object(i) for i in range(go.ObjectCount)]\n    if not objrefs:\n        return\n\n    # Duplicate geometry for preview\n    preview_geoms = []\n    for objref in objrefs:\n        rhobj = objref.Object()\n        if rhobj and rhobj.Geometry:\n            preview_geoms.append(rhobj.Geometry.Duplicate())\n\n    if not preview_geoms:\n        print(\"No previewable geometry found.\")\n        return\n\n    # 2) Base point\n    gp_base = ric.GetPoint()\n    gp_base.SetCommandPrompt(\"Point to move from\")\n    r = gp_base.Get()\n    if r != ri.GetResult.Point:\n        return\n    base_pt = gp_base.Point()\n\n    # axis mode state\n    axis_mode = {\"value\": 0}  # 0 free, 1 X, 2 Y, 3 Z\n\n    # 3) Second point with preview + options\n    gp = MovePreviewPointGetter(base_pt, preview_geoms, axis_mode)\n    gp.SetCommandPrompt(\"Point to move to\")\n\n    opt_free = gp.AddOption(\"Free\")\n    opt_x = gp.AddOption(\"X\")\n    opt_y = gp.AddOption(\"Y\")\n    opt_z = gp.AddOption(\"Vertical\")\n\n    while True:\n        res = gp.Get()\n\n        if res == ri.GetResult.Option:\n            idx = gp.OptionIndex()\n\n            if idx == opt_free:\n                axis_mode[\"value\"] = 0\n            elif idx == opt_x:\n                axis_mode[\"value\"] = 1\n            elif idx == opt_y:\n                axis_mode[\"value\"] = 2\n            elif idx == opt_z:\n                axis_mode[\"value\"] = 3\n\n            continue\n\n        if res == ri.GetResult.Point:\n            raw_target = gp.Point()\n            target = constrain_point(base_pt, raw_target, axis_mode[\"value\"])\n            break\n\n        return  # cancel / escape\n\n    # 4) Apply move transform\n    move_vec = target - base_pt\n    xform = rg.Transform.Translation(move_vec)\n\n    moved_any = False\n    for objref in objrefs:\n        rhobj = objref.Object()\n        if not rhobj:\n            continue\n\n        if sc.doc.Objects.Transform(rhobj, xform, True):\n            moved_any = True\n\n    if moved_any:\n        sc.doc.Views.Redraw()\n\n\nif __name__ == \"__main__\":\n    move_with_axis_lock_and_preview()",
      "language": "python",
      "author": "jeff_hammond",
      "post_number": 14,
      "is_solution": false
    }
  ],
  "tags": [
    "file-io",
    "geometry",
    "mesh",
    "python",
    "rhinocommon",
    "selection",
    "transformation"
  ],
  "has_accepted_answer": false,
  "category_id": 147,
  "posts_count": 18,
  "views": 95
}