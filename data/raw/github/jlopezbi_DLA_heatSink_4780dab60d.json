{
  "source_url": "https://github.com/jlopezbi/DLA_heatSink/blob/f082fb5c84ff5c72b0f1797b9d6370120bdfd9ad/testGrowRegion.py",
  "repo": "jlopezbi/DLA_heatSink",
  "repo_stars": 5,
  "repo_description": "grow coral shapes",
  "license": "unknown",
  "filepath": "testGrowRegion.py",
  "instruction": "testing grow region",
  "code": "# testing grow region\n\nimport rhinoscriptsyntax as rs\nimport heapq\nimport random\nimport math\nimport time\nimport Rhino\nimport scriptcontext\n#import System.Guid\n\ndef growRegion():\n\tfilter = Rhino.DocObjects.ObjectType.Mesh\n\trc, objRef = Rhino.Input.RhinoGet.GetOneObject(\"select testMesh\",False,filter)\n\tif not objRef or rc!=Rhino.Commands.Result.Success: return rc\n\tmesh  = objRef.Mesh()\n\tif not mesh: return\n\tmesh.Compact()\n\n\trandIdx = int(random.uniform(0,mesh.Vertices.Count-1))\n\ttVertIdxRoot = mesh.TopologyVertices.TopologyVertexIndex(randIdx)\n\tvertPnt = mesh.Vertices[randIdx]\n\trad = .1\n\trs.AddSphere(vertPnt,rad)\n\n\tgrowVerts = []\n\n\tstepSize = .01\n\tmaxGrowLen = .5\n\tminGrowLen = .02\n\tcutoffDist = .7\n\tgKernel = GKernel(stepSize,maxGrowLen,minGrowLen,cutoffDist)\n\tgKernel.plot()\n\n\n\tconVertsIdx = mesh.Vertices.GetConnectedVertices(randIdx)\n\tprint type(conVertsIdx)\n\t#conVertsIdx is an Array[int] in .NET framework.\n\tprint str(conVertsIdx.Length)\n\tfor i in range(conVertsIdx.Length):\n\t\tidx = conVertsIdx[i]\n\t\tif(idx != randIdx):\n\t\t\ttVertIdx = mesh.TopologyVertices.TopologyVertexIndex(idx)\n\t\t\tdist = lenBetweenTVerts(tVertIdxRoot,tVertIdx,mesh)\n\t\t\tlookUpIdx = int(round(dist/stepSize))\n\t\t\tdistStr = \"d:%1.2f,i:%d\"%(dist,lookUpIdx)\n\t\t\trs.AddTextDot(distStr, mesh.Vertices[idx])\n\t\t\tif(dist<cutoffDist):\n\t\t\t\tgrowVerts.append([idx,lookUpIdx])\n\t\telse:\n\t\t\tgrowVerts.append([idx,0])\n\n\t\"\"\"GROW REGION\"\"\"\n\tfor i in range(len(growVerts)):\n\t\tvertIdx = growVerts[i][0]\n\t\tkernelIdx = growVerts[i][1]\n\t\tgrowLength = gKernel.gaussKernel[kernelIdx]\n\n\t\tvert = mesh.Vertices[vertIdx]\n\t\tvertNormal = mesh.Normals[vertIdx]\n\t\tgrowVec = vertNormal.Multiply(vertNormal,growLength)\n\t\tnewLoc = rs.VectorAdd(vert,growVec)\n\t\t\n\t\t#normalArrow = rs.AddLine(vert,newLoc)\n\t\t#rs.CurveArrows(normalArrow,2)\n\t\t\n\t\tmesh.Vertices.SetVertex(vertIdx,newLoc.X,newLoc.Y,newLoc.Z)\n\t\tscriptcontext.doc.Objects.Replace(objRef, mesh)\t\t\t\n\n\ndef assignGrowLens(vertIdx,gaussKernel):\n\tpass\n\ndef lenBetweenTVerts(tVertIdx1,tVertIdx2,mesh):\n\t\tp1 = mesh.TopologyVertices[tVertIdx1]\n\t\tp2 = mesh.TopologyVertices[tVertIdx2]\n\t\treturn p1.DistanceTo(p2)\n\nclass GKernel:\n\tgaussKernel = []\n\tdef __init__(self,stepSize,maxGrowLen,minGrowLen,cutoffDist):\n\t\tself.stepSize = stepSize\n\t\tself.maxGrowLen = maxGrowLen\n\t\tself.minGrowLen = minGrowLen\n\t\tself.cutoffDist = cutoffDist\n\t\tself.gaussKernel = self.createGaussKernel()\n\n\n\tdef createGaussKernel(self):\n\t\tstepSize = self.stepSize\n\t\tmaxGrowLen = self.maxGrowLen\n\t\tminGrowLen = self.minGrowLen\n\t\tcutoffDist = self.cutoffDist\n\n\t\tdef gaussFunc(x,a,b,c):\n\t\t\treturn a*math.exp(-((x-b)**2.0)/(2.0*(c**2.0)))\n\n\t\tgaussKernel = []\n\n\t\ta = maxGrowLen\n\t\tb = 0\n\t\tc = math.sqrt(-(cutoffDist**2.0)/math.log(minGrowLen/maxGrowLen))\n\n\t\tx = 0\n\t\ty = maxGrowLen\n\t\tassert(y==gaussFunc(0,a,b,c)), \"problems with gaussFunc\"\n\t\twhile(x<cutoffDist):\n\t\t\ty = gaussFunc(x,a,b,c)\n\t\t\tgaussKernel.append(y)\n\n\t\t\tx +=stepSize\n\t\treturn gaussKernel\n\n\tdef plot(self):\n\t\tfor i in range(len(self.gaussKernel)):\n\t\t\tx = i*self.stepSize\n\t\t\ty = self.gaussKernel[i]\n\t\t\trs.AddPoint(x,y,0)\n\n\n\nif __name__==\"__main__\":\n\tgrowRegion()\n\n",
  "language": "python",
  "imports": [
    "Rhino",
    "rhinoscriptsyntax",
    "scriptcontext"
  ],
  "has_docstring": true
}