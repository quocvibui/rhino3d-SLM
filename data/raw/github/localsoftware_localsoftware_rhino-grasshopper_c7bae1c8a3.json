{
  "source_url": "https://github.com/localsoftware/localsoftware_rhino-grasshopper/blob/4aafec57e33b9f09cce6fd73dcda12b17cf794a5/plugin_files/Pickle_Data.py",
  "repo": "localsoftware/localsoftware_rhino-grasshopper",
  "repo_stars": 0,
  "repo_description": null,
  "license": "BSD-2-Clause",
  "filepath": "plugin_files/Pickle_Data.py",
  "instruction": "Pickle data",
  "code": "﻿from ghpythonlib.componentbase import dotnetcompiledcomponent as component\nimport Grasshopper, GhPython, System, Rhino, os\nimport rhinoscriptsyntax as rs\nimport scriptcontext as sc\nimport cPickle as pickle\nfrom Grasshopper.Kernel import GH_RuntimeMessageLevel as RML\n\nclass MyComponent(component):\n    def __new__(cls):\n        instance = Grasshopper.Kernel.GH_Component.__new__(cls,\n            \"PickleData\", \"PickleData\", \"\"\"Serializes Rhino data into a binary file.\nExports geometry into Python pickles that can be imported again later.\nPickles are a faster, lighter, and more efficient way to manage files than Rhino files.\nGeometry is serialized into pickles, which is a Python binary file.\nBased on the work of Jackie Berry.\n    Typical usage:\nPlug in the geometry you want to export into the data input of the component.\nThe geometry should be flattened. Plug in a slider or number to the siteNumber input of the component.\nPickle’s numbers always need to start with number one. This will name the pickle according to a specific site.\nIf you’re only working with one site, you can leave the siteNumber empty. Use a panel to type a layer name for the geometry you are exporting.\nPlug the panel into the layer input of the component. Specify a path for the pickles. This will be the folder where the pickles will be exported to.\nFinally plug a boolean toggle component to the write input of the component and set it to 'True'.\"\"\", \"Extra\", \"LocalCode\")\n        return instance\n    \n    def get_ComponentGuid(self):\n        return System.Guid(\"42c05bad-2191-4053-a42c-0973b8b5b300\")\n    \n    def SetUpParam(self, p, name, nickname, description):\n        p.Name = name\n        p.NickName = nickname\n        p.Description = description\n        p.Optional = True\n    \n    def RegisterInputParams(self, pManager):\n        p = Grasshopper.Kernel.Parameters.Param_GenericObject()\n        self.SetUpParam(p, \"data\", \"data\", \"geometry or data to serialize\")\n        p.Access = Grasshopper.Kernel.GH_ParamAccess.list\n        self.Params.Input.Add(p)\n        \n        p = GhPython.Assemblies.MarshalParam()\n        self.SetUpParam(p, \"siteNumber\", \"siteNumber\", \"local code site number (optional)\")\n        p.Access = Grasshopper.Kernel.GH_ParamAccess.item\n        self.Params.Input.Add(p)\n        \n        p = GhPython.Assemblies.MarshalParam()\n        self.SetUpParam(p, \"layer\", \"layer\", \"name of file\")\n        p.Access = Grasshopper.Kernel.GH_ParamAccess.item\n        self.Params.Input.Add(p)\n        \n        p = GhPython.Assemblies.MarshalParam()\n        self.SetUpParam(p, \"path\", \"path\", \"path of directory for target binary file.\")\n        p.Access = Grasshopper.Kernel.GH_ParamAccess.item\n        self.Params.Input.Add(p)\n        \n        p = GhPython.Assemblies.MarshalParam()\n        self.SetUpParam(p, \"write\", \"write\", \"Script input write.\")\n        p.Access = Grasshopper.Kernel.GH_ParamAccess.item\n        self.Params.Input.Add(p)\n        \n    \n    def RegisterOutputParams(self, pManager):\n        p = Grasshopper.Kernel.Parameters.Param_GenericObject()\n        self.SetUpParam(p, \"geometry\", \"geometry\", \"a data tree with serialized geometry\")\n        self.Params.Output.Add(p)\n        \n    \n    def SolveInstance(self, DA):\n        p0 = self.marshal.GetInput(DA, 0)\n        p1 = self.marshal.GetInput(DA, 1)\n        p2 = self.marshal.GetInput(DA, 2)\n        p3 = self.marshal.GetInput(DA, 3)\n        p4 = self.marshal.GetInput(DA, 4)\n        result = self.RunScript(p0, p1, p2, p3, p4)\n\n        if result is not None:\n            self.marshal.SetOutput(result, DA, 0, True)\n        \n    def get_Internal_Icon_24x24(self):\n        o = \"iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAHYcAAB2HAY/l8WUAAAMYSURBVEhL3ZVtSFNhFMfn1OUuDpVm0znRnCYtzZla2tamToXqm0SEkUFIZkpRlEkvUEFvUCgpGBYhLAxLsS8VhEhQUd8DCwJfRmKR0Xybqdm/89xtOq/PVfvQlw78GHvOOf8/957nea7ivwylIATfNiZqOpMSNR2rwZik6TAYhE7q3eOVWCHytgk/RkftGB22YnRoFbjteNuzBdR6zasgH8YwVfDdrTkRU1WVBlRVxM1TQ/+PV8lQE49D5XqkJAufSOMUESyqSSLLbl070vs+DzPjdrg/WxYYsuBrnxWuDxa4PnKg9RGXFdMT+eh4mAGdNqyb9ASvrDcizBkal8edD4Dw7FgMClF/YyNiY9SysDyrAxx49zIH4YKq3afNIujKm+4sShYAYyQ4LoEaL9Qls3csC8uLBmJ9Ea5fTmHruwmFUFQQNSwmJyTCfih36bzYIAvLzxtM2+AZsSExXt1DOUX21YsB7jz+1sDXU16mH6ecwtHcsLLBuVojV9gPz6CmMm6WcoqCplvGxUk2B3G4NBO2jmJ0tWciMlLFFWfwDI4e0U1TTmLAxGftwFQ+Wls2YW9pDHYWR+PM6SQ87crCgX16rsHZWslbkDWgAY3RgBz52iUi66LXoKvNjBPHEpCdGb6IliYTMEdPvKwB20X0e7Asbom4n9BQJQZ686iOxKbpSf14bAvisga/7BikZqVSyRX3U1URT/UOYJKE/Ei3ONeATvHzLjNXNBBLbhTwm55A7tww5AxevxBvxWUpcWjJwPdKeeIMrsFPGya/28S7JVBQSuPNVKoPGCiPAIPC5gbfHmZblBrbWtO4wowscyQ89K3AlGSoUkiv+rBBPGimupPraaGE9j81zVAzDbD9wWZsSAkn0SBRWFCHYD+dAbaF53cQq+UxR9DhLN2lG2MGSoM+7NmTRxkYGtiObwO5IjNuK/p7c/HYmYb7zSa8otlMjtDX6wvV9HtruAzmwdVnQUujia7s0HpmwIJ9HKrpKrin1YY4/STEq5zpJrXTnK52pqaonLG6hZw8KqdGo7pDeuWi8r8NheIPyMfxrkDZ9l8AAAAASUVORK5CYII=\"\n        return System.Drawing.Bitmap(System.IO.MemoryStream(System.Convert.FromBase64String(o)))\n\n\n    def RunScript(self, data, siteNumber, layer, path, write):\n        geometry = None\n        if path!=None and len(data)>0 and layer!=None and write==True:\n            try:\n                if siteNumber!=None:\n                    filename = os.path.join(path,str(int(siteNumber))+layer)\n                else:\n                    filename = os.path.join(path,layer)\n\n                f = open(filename, 'wb')\n                pickle.dump(data, f, -1)\n\n                f.close()\n                fcheck = open(filename,'rb')\n                geometry = pickle.load(fcheck)\n                if len(geometry)>0:\n                    print \"file pickled successfully.\"\n                    self.AddRuntimeMessage(RML.Remark,\"file pickled successfully.\")\n                else:\n                    print \"the file didn't save correctly, check your input data.\"\n                    self.AddRuntimeMessage(RML.Error,\"the file didn't save correctly, check your input data.\")\n                fcheck.close()\n            except:\n                print \"There was a problem saving the file. \\nThe path your provided may be invalid.\"\n                self.AddRuntimeMessage(RML.Error,\"There was a problem saving the file. \\nThe path your provided may be invalid.\")\n\n        else:\n            if not len(data)>0:\n                geometry = \"please add data or geometry you want to pickle.\"\n                self.AddRuntimeMessage(RML.Warning,\"please add data or geometry you want to pickle.\")\n            if layer==None:\n                geometry = \"please provide target file layer name.\"\n                self.AddRuntimeMessage(RML.Warning, \"please provide target file layer name.\")\n            if path==None:\n                geometry = \"please provide target directory for pickle file.\"\n                self.AddRuntimeMessage(RML.Warning, \"please provide target directory for pickle file.\")\n            if write!=True:\n                geometry = \"set write to True to save the file.\"\n                self.AddRuntimeMessage(RML.Warning, \"set write to True to save the file.\")\n            else:\n                geometry = \"something else went wrong, please check your inputs.\"\n                self.AddRuntimeMessage(RML.Error, \"something else went wrong, please check your inputs.\")\n\n        # return outputs if you have them; here I try it for you:\n        return geometry\n\n\nimport GhPython\nimport System\n\nclass AssemblyInfo(GhPython.Assemblies.PythonAssemblyInfo):\n    def get_AssemblyName(self):\n        return \"PickleData\"\n    \n    def get_AssemblyDescription(self):\n        return \"\"\"\"\"\"\n\n    def get_AssemblyVersion(self):\n        return \"0.1\"\n\n    def get_AuthorName(self):\n        return \"\"\n    \n    def get_Id(self):\n        return System.Guid(\"c82f13fc-b368-4b8d-b3ed-73240c5dfbff\")",
  "language": "python",
  "imports": [
    "ghpythonlib",
    "rhinoscriptsyntax",
    "scriptcontext"
  ],
  "has_docstring": false
}