{
  "source_url": "https://github.com/jackhymowitz/main/blob/7325131db23094f1a28bd184b6a68f864f41a729/01_GH_Components/py/BT_GroundContactElement.py",
  "repo": "jackhymowitz/main",
  "repo_stars": 0,
  "repo_description": "IDF2PH is a free open source toolkit for working with E+ and PHPP Energy Models",
  "license": "GPL-3.0",
  "filepath": "01_GH_Components/py/BT_GroundContactElement.py",
  "instruction": "Create a ground contact 'Floor Element' for use in writing to the 'Ground' worksheet. By Default, this will just create a single floor element. You can input up to 3 of these (as a flattened list)...",
  "code": "#\r\r\n# IDF2PHPP: A Plugin for exporting an EnergyPlus IDF file to the Passive House Planning Package (PHPP). Created by blgdtyp, llc\r\r\n# \r\r\n# This component is part of IDF2PHPP.\r\r\n# \r\r\n# Copyright (c) 2020, bldgtyp, llc <info@bldgtyp.com> \r\r\n# IDF2PHPP is free software; you can redistribute it and/or modify \r\r\n# it under the terms of the GNU General Public License as published \r\r\n# by the Free Software Foundation; either version 3 of the License, \r\r\n# or (at your option) any later version. \r\r\n# \r\r\n# IDF2PHPP is distributed in the hope that it will be useful,\r\r\n# but WITHOUT ANY WARRANTY; without even the implied warranty of \r\r\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the \r\r\n# GNU General Public License for more details.\r\r\n# \r\r\n# For a copy of the GNU General Public License\r\r\n# see <http://www.gnu.org/licenses/>.\r\r\n# \r\r\n# @license GPL-3.0+ <http://spdx.org/licenses/GPL-3.0+>\r\r\n#\r\r\n\"\"\"\r\r\nCreate a ground contact 'Floor Element' for use in writing to the 'Ground' worksheet. By Default, this will just create a single floor element. You can input up to 3 of these (as a flattened list) into the 'grndFloorElements_' input on the 'Create Excel Obj - Geom' component. \r\r\nHowever, if you also pass in the Honeybee Zones (into _HBZones) this will try and sort out the right ground element from the HB Geometry and parameters for each zone input. This info will be automatcally passed through to the Excel writer. If you have a simple situation, you can pass all of the Honeybee zones in at once, but if you need to set detailed parameters for multiple different floor types, first explode the Honeybee Zone object and then apply one of these components to each zone one at a time. Merge the zones back together before passing along.\r\r\n-\r\r\nEM July. 19, 2020\r\r\n    Args:\r\r\n        _HBZones: (list) <Optional> The Honeybee Zone Objects. \r\r\n        _type: (string): Input a floor element 'type'. Choose either:\r\r\n            > 01_SlabOnGrade\r\r\n            > 02_HeatedBasement\r\r\n            > 03_UnheatedBasement\r\r\n            > 04_SuspendedFloorOverCrawlspace\r\r\n        _floorSurfaces: (List) Rhino Surface objects which describe the ground-contact surface. If the surfaces have a U-Value assigned that will be read to create the object. Use the 'Set Surface Params' tool in Rhino to set paramets for the surface before inputing.\r\r\n        _exposedPerimCrvs: (List) Rhino Curve object(s) [or Surfaces] which describe the 'Exposed' perimeter of the ground contact surface(s). If these curves have a Psi-Value assigned that will be read and used to create the object. Use the 'Linear Thermal Bridge' tool in Rhino to assign Psi-Values to curves before inputing. If a surface is passed in, will use the total perimeter length of the surface as 'exposed' and apply a default Psi-Value of 0.05 W/mk for all edges.\r\r\n    Returns:\r\r\n        floorElement_: A single 'Floor Element' object. Input this into the 'grndFloorElements_' input on the 'Create Excel Obj - Geom' component to write to PHPP.\r\r\n        HBZones_: The Honeybee zone Breps to pass along to the next component\r\r\n\"\"\"\r\r\n\r\r\nghenv.Component.Name = \"BT_GroundContactElement\"\r\r\nghenv.Component.NickName = \"Create Floor Element\"\r\r\nghenv.Component.Message = 'JUL_19_2020'\r\r\nghenv.Component.IconDisplayMode = ghenv.Component.IconDisplayMode.application\r\r\nghenv.Component.Category = \"BT\"\r\r\nghenv.Component.SubCategory = \"01 | Model\"\r\r\n\r\r\nimport Rhino\r\r\nimport scriptcontext as sc\r\r\nimport rhinoscriptsyntax as rs\r\r\nfrom contextlib import contextmanager\r\r\nimport ghpythonlib.components as ghc\r\r\nimport Grasshopper.Kernel as ghK\r\r\nimport json\r\r\n\r\r\n# Classes and Defs\r\r\npreview = sc.sticky['Preview']\r\r\nPHPP_grnd_FloorElement = sc.sticky['PHPP_grnd_FloorElement']\r\r\nPHPP_grnd_SlabOnGrade = sc.sticky['PHPP_grnd_SlabOnGrade']\r\r\nPHPP_grnd_HeatedBasement = sc.sticky['PHPP_grnd_HeatedBasement']\r\r\nPHPP_grnd_UnheatedBasement= sc.sticky['PHPP_grnd_UnheatedBasement']\r\r\nPHPP_grnd_SuspendedFloor = sc.sticky['PHPP_grnd_SuspendedFloor']\r\r\nhb_hive = sc.sticky[\"honeybee_Hive\"]()\r\r\nHBZoneObjects = hb_hive.callFromHoneybeeHive(_HBZones)\r\r\n\r\r\ndef cleanInputs(_in, _nm, _default):\r\r\n    # Apply defaults if the inputs are Nones\r\r\n    out = _in if _in != None else _default\r\r\n    \r\r\n    # Check that output can be float\r\r\n    try:\r\r\n        # Check units\r\r\n        if _nm == \"thickness\":\r\r\n            if float(out.ToString()) > 1:\r\r\n                unitWarning = \"Check thickness units? Should be in METERS not MM.\" \r\r\n                ghenv.Component.AddRuntimeMessage(ghK.GH_RuntimeMessageLevel.Warning, unitWarning)\r\r\n            return float(out.ToString())\r\r\n        elif _nm == 'orientation':\r\r\n            return out\r\r\n        else:\r\r\n            return float(out.ToString())\r\r\n    except:\r\r\n        ghenv.Component.AddRuntimeMessage(ghK.GH_RuntimeMessageLevel.Error, '\"{}\" input should be a number'.format(_nm))\r\r\n        return out\r\r\n\r\r\ndef setupInputs(_type):\r\r\n    \r\r\n    direction = 'Please input a valid Floor Type into \"_type\". Input either:\\n'\\\r\r\n    '    1: Slab on Grade\\n'\\\r\r\n    '    2: Heated Basement\\n'\\\r\r\n    '    3: UnHeated Basement\\n'\\\r\r\n    '    4: Suspeneded Floor over Crawspace'\r\r\n    \r\r\n    # Setup Inputs based on type\r\r\n    inputs_slabOnGrade = {\r\r\n        4:{'name':'_perimInsulWidthOrDepth', 'desc':'(float) The width or depth (m) beyond the face of the building enclosure which the perimeter insualtion extends. For vertical, measure this length from the underside of the floor slab insulation. Default is 1 m.'},\r\r\n        5:{'name':'_perimInsulThickness', 'desc':'(float) Perimeter Insualtion Thickness (m). Default is 0.101 m'},\r\r\n        6:{'name':'_perimInsulConductivity', 'desc':'(float) Perimeter Insulation Thermal Conductivity (W/mk). Default is 0.04 W/m2k'},\r\r\n        7:{'name':'_perimInsulOrientation', 'desc':'(string) Perimeter Insulation Orientation. Input either \"Vertical\" or \"Horizontal\". Default is \"Vertical\".'}\r\r\n        }\r\r\n    \r\r\n    inputs_heatedBasement = {\r\r\n        6:{'name':'_wallBelowGrade_height', 'desc':'(float) Average height (m) from grade down to base of basement wall.'},\r\r\n        7:{'name':'_wallBelowGrade_Uvalue', 'desc':'(float) U-Value (W/m2k) of wall below grade.'},\r\r\n        }\r\r\n    \r\r\n    inputs_unheatedBasement =  {  \r\r\n        4:{'name':'_wallAboveGrade_height', 'desc':'(float) Average height (m) from grade up to top of  basement wall.'},\r\r\n        5:{'name':'_wallAboveGrade_Uvalue', 'desc':'(float) U-Value (W/m2k) of wall above grade.'},\r\r\n        6:{'name':'_wallBelowGrade_height', 'desc':'(float) Average height (m) from grade down to base of basement wall.'},\r\r\n        7:{'name':'_wallBelowGrade_Uvalue', 'desc':'(float) U-Value (W/m2k) of wall below grade.'},\r\r\n        8:{'name':'_basementFloor_Uvalue', 'desc':'(float) U-Value (W/m2k) of the basement floor slab.'},\r\r\n        9:{'name':'_basementAirChange', 'desc':'(float) Air exchange rate (ACH) in the unheated basement. A Typical value is 0.2ACH'},\r\r\n        10:{'name':'_basementVolume', 'desc':'(float) Air Volume (m3) of the unheated basement. The basement ventilation heat losses are calculated based on this volume and the air exchange.'}\r\r\n        }\r\r\n        \r\r\n    inputs_suspendedFloor =  {  \r\r\n        4:{'name':'_wallCrawlSpace_height', 'desc':'(float) Average height (m) of the crawl space walls.'},\r\r\n        5:{'name':'_wallCrawlSpace_Uvalue', 'desc':'(float) U-Value (W/m2k) of the crawl space walls.'},\r\r\n        6:{'name':'_crawlSpace_UValue', 'desc':'(float) U-Value of the floor under the crawl space. If the ground is not insulated, the heat transfer coefficient of 5.9 W/m2k must be used.'},\r\r\n        7:{'name':'_ventilationOpeningArea', 'desc':'(float) Total area (m2) of the ventilation openings of the crawl space.'},\r\r\n        8:{'name':'_windVelocityAt10m', 'desc':'(float) Average wind velocity (m/s) at 10m height in the selected location. Default is 4 m/s.'},\r\r\n        9:{'name':'_windShieldFactor', 'desc':'(float) Wind Shield Factor. Default is 0.05. Typical Values:\\n-Protected Site (city center): 0.02\\n-Average Site (suburb): 0.05\\n-Exposed Site (rural):0.10'}\r\r\n        }\r\r\n    \r\r\n    if _type == None:\r\r\n        inputs = {}\r\r\n        ghenv.Component.AddRuntimeMessage(ghK.GH_RuntimeMessageLevel.Warning, direction)\r\r\n    else:\r\r\n        if '1' in str(_type):\r\r\n            inputs = inputs_slabOnGrade\r\r\n        elif '2' in str(_type):\r\r\n            inputs = inputs_heatedBasement\r\r\n        elif '3' in str(_type):\r\r\n            inputs = inputs_unheatedBasement\r\r\n        elif '4' in str(_type):\r\r\n            inputs = inputs_suspendedFloor\r\r\n        else:\r\r\n            inputs = {}\r\r\n            ghenv.Component.AddRuntimeMessage(ghK.GH_RuntimeMessageLevel.Warning, direction)\r\r\n            \r\r\n    for inputNum in range(4, 11):\r\r\n        item = inputs.get(inputNum, {'name':'-', 'desc':'-'})\r\r\n        \r\r\n        ghenv.Component.Params.Input[inputNum].NickName = item.get('name')\r\r\n        ghenv.Component.Params.Input[inputNum].Name = item.get('name')\r\r\n        ghenv.Component.Params.Input[inputNum].Description = item.get('desc')\r\r\n        \r\r\n    return inputs\r\r\n\r\r\ndef updateFloorElement(_flag, _floorSurfaces, floorElement_, _zone, _flrType):\r\r\n    if _flag==True and len(_floorSurfaces)==0:\r\r\n        floorElement_.getParamsFromRH(_zone, _flrType)\r\r\n        setattr(_zone, 'PHPP_ground', floorElement_)\r\r\n    else:\r\r\n        if len(_floorSurfaces)>0:\r\r\n            setattr(_zone, 'PHPP_ground', floorElement_)\r\r\n        else:\r\r\n            setattr(_zone, 'PHPP_ground', None)\r\r\n\r\r\n# For some damn reason, have to instantiate these before run. \r\r\n# Must be a way to automate this but can't figure out right now so \r\r\n# doing it manually. \r\r\n_perimInsulWidthOrDepth = None\r\r\n_perimInsulThickness = None\r\r\n_perimInsulConductivity = None\r\r\n_perimInsulOrientation = None\r\r\n_wallBelowGrade_height = None\r\r\n_wallBelowGrade_Uvalue = None\r\r\n_wallAboveGrade_height = None\r\r\n_wallAboveGrade_Uvalue = None\r\r\n_basementFloor_Uvalue = None\r\r\n_basementAirChange = None\r\r\n_basementVolume = None\r\r\n_wallCrawlSpace_height = None\r\r\n_wallCrawlSpace_Uvalue = None\r\r\n_crawlSpace_UValue = None\r\r\n_ventilationOpeningArea = None\r\r\n_windVelocityAt10m = None\r\r\n_windShieldFactor = None\r\r\n\r\r\ninputNames = setupInputs(_type)\r\r\nghenv.Component.Attributes.Owner.OnPingDocument()\r\r\n\r\r\nif _type == None:\r\r\n    _type = ''\r\r\n\r\r\nif '1' in str(_type):\r\r\n    # Set the input data Explicitly\r\r\n    for input in ghenv.Component.Params.Input:\r\r\n        if input.Name == '_perimInsulWidthOrDepth':\r\r\n            for each in input.VolatileData.AllData(True):\r\r\n                _perimInsulWidthOrDepth = each\r\r\n        elif input.Name == '_perimInsulThickness':\r\r\n            for each in input.VolatileData.AllData(True):\r\r\n                _perimInsulThickness = each\r\r\n        elif input.Name == '_perimInsulConductivity':\r\r\n            for each in input.VolatileData.AllData(True):\r\r\n                _perimInsulConductivity = each\r\r\n        elif input.Name == '_perimInsulOrientation':\r\r\n            for each in input.VolatileData.AllData(True):\r\r\n                _perimInsulOrientation = each\r\r\n    \r\r\n    # Get user inputs, set defaults\r\r\n    depth = cleanInputs(_perimInsulWidthOrDepth, \"depth\", 1.0)\r\r\n    thickness = cleanInputs(_perimInsulThickness, \"thickness\", 0.101)\r\r\n    conductivity = cleanInputs(_perimInsulConductivity, \"lambda\", 0.04)\r\r\n    orientation = cleanInputs(_perimInsulOrientation, \"orientation\", 'Vetical')\r\r\n    \r\r\n    # Build Default Floor Element for use\r\r\n    # if no HB Zones are input\r\r\n    floorElement_ = PHPP_grnd_SlabOnGrade(None, _floorSurfaces, _exposedPerimCrvs, depth, thickness, conductivity, orientation)\r\r\n    \r\r\n    # Build Floor Elements for any HB Zones input\r\r\n    # See if any of the Zones include at least one SlabOnGrade surface?\r\r\n    anyZoneincludesSlabOnGrade = False\r\r\n    for zone in HBZoneObjects:\r\r\n        thisZoneincludesSlabOnGrade = False\r\r\n        for srfc in zone.surfaces:\r\r\n            if srfc.srfType[srfc.type] == 'SlabOnGrade':\r\r\n                anyZoneincludesSlabOnGrade = True\r\r\n                thisZoneincludesSlabOnGrade = True\r\r\n                break\r\r\n        \r\r\n        # Create a new Floor Element\r\r\n        floorElement_ = PHPP_grnd_SlabOnGrade( zone.name, _floorSurfaces, _exposedPerimCrvs, depth, thickness, conductivity, orientation)\r\r\n        \r\r\n        # Update the floor element with the HB Zone Params\r\r\n        updateFloorElement(thisZoneincludesSlabOnGrade, _floorSurfaces, floorElement_, zone, 'SlabOnGrade')\r\r\n    \r\r\n    if anyZoneincludesSlabOnGrade == False:\r\r\n        msg = \"I could not find any 'SlabOnGrade' elements in any of the HB zones input? Are you sure\\n\"\\\r\r\n        \"this is the right type of foundation? For now I will use the parameter values\\n\"\\\r\r\n        \"input here, but maybe double check your Rhino surface assignments?\"\r\r\n        ghenv.Component.AddRuntimeMessage(ghK.GH_RuntimeMessageLevel.Remark, msg)\r\r\n    \r\r\nelif '2' in str(_type):\r\r\n    # Set the input data Explicitly\r\r\n    for input in ghenv.Component.Params.Input:\r\r\n        if input.Name == '_wallBelowGrade_height':\r\r\n            for each in input.VolatileData.AllData(True):\r\r\n                _wallBelowGrade_height = each\r\r\n        elif input.Name == '_wallBelowGrade_Uvalue':\r\r\n            for each in input.VolatileData.AllData(True):\r\r\n                _wallBelowGrade_Uvalue = each\r\r\n    \r\r\n    # Clean the Inputs and check formats, types\r\r\n    wallHeight_BG = cleanInputs(_wallBelowGrade_height, \"height_bg\", 1.0)\r\r\n    wallU_BG = cleanInputs(_wallBelowGrade_Uvalue, \"Uvalue_bg\", 1.0)\r\r\n    \r\r\n    # Build Default Floor Element for use\r\r\n    # if no HB Zones are input\r\r\n    floorElement_ = PHPP_grnd_HeatedBasement( None, _floorSurfaces, _exposedPerimCrvs, wallHeight_BG, wallU_BG )\r\r\n    \r\r\n    # See if any of the Zone includes at least one UndergroundSlab surface?\r\r\n    anyZoneincludesUndergroundSlab = False\r\r\n    for zone in HBZoneObjects:\r\r\n        thisZoneincludesUndergroundSlab = False\r\r\n        for srfc in zone.surfaces:\r\r\n            if srfc.srfType[srfc.type] == 'UndergroundSlab':\r\r\n                anyZoneincludesUndergroundSlab = True\r\r\n                thisZoneincludesUndergroundSlab = True\r\r\n                break\r\r\n                \r\r\n        # Create a new Floor Element\r\r\n        floorElement_ = PHPP_grnd_HeatedBasement( zone.name, _floorSurfaces,  _exposedPerimCrvs, wallHeight_BG, wallU_BG )\r\r\n        \r\r\n        # Update the floor element with the HB Zone Params\r\r\n        updateFloorElement(thisZoneincludesUndergroundSlab, _floorSurfaces, floorElement_, zone, 'UndergroundSlab')\r\r\n    \r\r\n    if anyZoneincludesUndergroundSlab == False:\r\r\n        msg = \"I could not find any 'UndergroundSlab' elements in any of the HB zones input? Are you sure\\n\"\\\r\r\n        \"this is the right type of foundation? For now I will use the parameter values\\n\"\\\r\r\n        \"input here, but maybe double check your Rhino surface assignments?\"\r\r\n        ghenv.Component.AddRuntimeMessage(ghK.GH_RuntimeMessageLevel.Remark, msg)\r\r\n    \r\r\nelif '3' in str(_type):\r\r\n    # Set the input data Explicitly\r\r\n    for input in ghenv.Component.Params.Input:\r\r\n        if input.Name == '_wallAboveGrade_height':\r\r\n            for each in input.VolatileData.AllData(True):\r\r\n                _wallAboveGrade_height = each\r\r\n        elif input.Name == '_wallAboveGrade_Uvalue':\r\r\n            for each in input.VolatileData.AllData(True):\r\r\n                _wallAboveGrade_Uvalue = each\r\r\n        elif input.Name == '_wallBelowGrade_height':\r\r\n            for each in input.VolatileData.AllData(True):\r\r\n                _wallBelowGrade_height = each\r\r\n        elif input.Name == '_wallBelowGrade_Uvalue':\r\r\n            for each in input.VolatileData.AllData(True):\r\r\n                _wallBelowGrade_Uvalue = each\r\r\n        elif input.Name == '_basementFloor_Uvalue':\r\r\n            for each in input.VolatileData.AllData(True):\r\r\n                _basementFloor_Uvalue = each\r\r\n        elif input.Name == '_basementAirChange':\r\r\n            for each in input.VolatileData.AllData(True):\r\r\n                _basementAirChange = each\r\r\n        elif input.Name == '_basementVolume':\r\r\n            for each in input.VolatileData.AllData(True):\r\r\n                _basementVolume = each\r\r\n    \r\r\n    # Clean User Inputs\r\r\n    wallHeight_AG = cleanInputs(_wallAboveGrade_height, \"height_ag\", 1.0)\r\r\n    wallU_AG = cleanInputs(_wallAboveGrade_Uvalue, \"Uvalue_ag\", 1.0)\r\r\n    wallHeight_BG = cleanInputs(_wallBelowGrade_height, \"height_bg\", 1.0)\r\r\n    wallU_BG = cleanInputs(_wallBelowGrade_Uvalue, \"Uvalue_bg\", 1.0)\r\r\n    floorU = cleanInputs(_basementFloor_Uvalue, \"Uvalue\", 1.0)\r\r\n    ach = cleanInputs(_basementAirChange, \"ACH\", 0.2)\r\r\n    vol = cleanInputs(_basementVolume, \"Volume\", 1.0)\r\r\n    \r\r\n    # Build Default Floor Element for use\r\r\n    # if no HB Zones are input\r\r\n    floorElement_ = PHPP_grnd_UnheatedBasement(None, _floorSurfaces, _exposedPerimCrvs, wallHeight_AG,  wallU_AG, wallHeight_BG, wallU_BG, floorU, ach, vol )\r\r\n    \r\r\n    # See if any of the Zone includes at least one ExposedFloor surface?\r\r\n    anyZoneincludesSuspendedFloor = False\r\r\n    for zone in HBZoneObjects:\r\r\n        thisZoneincludesSuspendedFloor = False\r\r\n        for srfc in zone.surfaces:\r\r\n            if srfc.srfType[srfc.type] == 'ExposedFloor':\r\r\n                anyZoneincludesSuspendedFloor = True\r\r\n                thisZoneincludesSuspendedFloor = True\r\r\n                break\r\r\n        \r\r\n        floorElement_ = PHPP_grnd_UnheatedBasement( zone.name, _floorSurfaces, _exposedPerimCrvs, wallHeight_AG, wallU_AG, wallHeight_BG, wallU_BG, floorU, ach, vol )\r\r\n        \r\r\n        # Update the floor element with the HB Zone Params\r\r\n        updateFloorElement(thisZoneincludesSuspendedFloor, _floorSurfaces, floorElement_, zone, 'ExposedFloor')\r\r\n    \r\r\n    if anyZoneincludesSuspendedFloor == False:\r\r\n        msg = \"I could not find any 'ExposedFloor' elements in any of the HB zones input? Are you sure\\n\"\\\r\r\n        \"this is the right type of foundation? For now I will use the parameter values\\n\"\\\r\r\n        \"input here, but maybe double check your Rhino surface assignments?\"\r\r\n        ghenv.Component.AddRuntimeMessage(ghK.GH_RuntimeMessageLevel.Remark, msg)\r\r\n    \r\r\nelif '4' in str(_type):\r\r\n    # Set the input data Explicitly\r\r\n    for input in ghenv.Component.Params.Input:\r\r\n        if input.Name == '_wallCrawlSpace_height':\r\r\n            for each in input.VolatileData.AllData(True):\r\r\n                _wallCrawlSpace_height = each\r\r\n        elif input.Name == '_wallCrawlSpace_Uvalue':\r\r\n            for each in input.VolatileData.AllData(True):\r\r\n                _wallCrawlSpace_Uvalue = each\r\r\n        elif input.Name == '_crawlSpace_UValue':\r\r\n            for each in input.VolatileData.AllData(True):\r\r\n                _crawlSpace_UValue = each\r\r\n        elif input.Name == '_ventilationOpeningArea':\r\r\n            for each in input.VolatileData.AllData(True):\r\r\n                _ventilationOpeningArea = each\r\r\n        elif input.Name == '_windVelocityAt10m':\r\r\n            for each in input.VolatileData.AllData(True):\r\r\n                _windVelocityAt10m = each\r\r\n        elif input.Name == '_windShieldFactor':\r\r\n            for each in input.VolatileData.AllData(True):\r\r\n                _windShieldFactor = each\r\r\n    \r\r\n    # Clean user inputs\r\r\n    wallHeight = cleanInputs(_wallCrawlSpace_height, \"height\", 1.0)\r\r\n    wallU = cleanInputs(_wallCrawlSpace_Uvalue, \"Uvalue\", 1.0)\r\r\n    crawlspaceU = cleanInputs(_crawlSpace_UValue, \"Ucrawl\", 5.9)\r\r\n    ventOpening = cleanInputs(_ventilationOpeningArea, \"ventOpening\", 1.0)\r\r\n    windVelocity = cleanInputs(_windVelocityAt10m, \"velocity\", 4.0)\r\r\n    windFactor = cleanInputs(_windShieldFactor, \"windFactor\", 0.05)\r\r\n    \r\r\n    # Build Default Floor Element for use\r\r\n    # if no HB Zones are input\r\r\n    floorElement_ = PHPP_grnd_SuspendedFloor(None, _floorSurfaces, _exposedPerimCrvs, wallHeight, wallU, crawlspaceU, ventOpening, windVelocity, windFactor)\r\r\n    \r\r\n    # See if any of the Zone includes at least one ExposedFloor surface?\r\r\n    anyZoneincludesSuspendedFloor = False\r\r\n    for zone in HBZoneObjects:\r\r\n        thisZoneincludesSuspendedFloor = False\r\r\n        for srfc in zone.surfaces:\r\r\n            if srfc.srfType[srfc.type] == 'ExposedFloor':\r\r\n                anyZoneincludesSuspendedFloor = True\r\r\n                thisZoneincludesSuspendedFloor = True\r\r\n                break\r\r\n    \r\r\n        floorElement_ = PHPP_grnd_SuspendedFloor( zone.name, _floorSurfaces, _exposedPerimCrvs, wallHeight, wallU, crawlspaceU, ventOpening, windVelocity, windFactor)\r\r\n        \r\r\n        # Update the floor element with the HB Zone Params\r\r\n        updateFloorElement(thisZoneincludesSuspendedFloor, _floorSurfaces, floorElement_, zone, 'ExposedFloor')\r\r\n    \r\r\n    if anyZoneincludesSuspendedFloor == False:\r\r\n        msg = \"I could not find any 'ExposedFloor' elements in any of the HB zones input? Are you sure\\n\"\\\r\r\n        \"this is the right type of foundation? For now I will use the parameter values\\n\"\\\r\r\n        \"input here, but maybe double check your Rhino surface assignments?\"\r\r\n        ghenv.Component.AddRuntimeMessage(ghK.GH_RuntimeMessageLevel.Remark, msg)\r\r\n\r\r\n# Add modified Surfaces / Zones back to the HB dictionary\r\r\nif len(_HBZones)>0:\r\r\n    HBZones_  = hb_hive.addToHoneybeeHive(HBZoneObjects, ghenv.Component)\r\r\n\r\r\n# Preview\r\r\nif floorElement_ != None:\r\r\n    preview(floorElement_)\r\n",
  "language": "python",
  "imports": [
    "Rhino",
    "ghpythonlib",
    "rhinoscriptsyntax",
    "scriptcontext"
  ],
  "has_docstring": true
}