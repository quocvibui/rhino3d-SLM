{
  "source_url": "https://github.com/fstwn/cockatoo/blob/d952ac5d2148ec29fba52e8eb75f0f43770c74ca/usrobj_src/Cockatoo_CreateMeshFromKnitNetwork.py",
  "repo": "fstwn/cockatoo",
  "repo_stars": 38,
  "repo_description": "Cockatoo is a prototypical open-source software toolkit for generating (3d-)knitting patterns from NURBS surface and mesh geometry directly inside Grasshopper.",
  "license": "MIT",
  "filepath": "usrobj_src/Cockatoo_CreateMeshFromKnitNetwork.py",
  "instruction": "Create a mesh from a KnitNetwork by finding the cycles (faces) of the\nnetwork.\n---\n[NOTE] This algorithm relies on finding cycles (quads and triangles) for the\nsupplied network. This is not a trivial...",
  "code": "\"\"\"\nCreate a mesh from a KnitNetwork by finding the cycles (faces) of the\nnetwork.\n---\n[NOTE] This algorithm relies on finding cycles (quads and triangles) for the\nsupplied network. This is not a trivial task in 3d space - at least to my\nknowledge. Assigning a geometrybase to the KnitNetwork on initialization\nand choosing cyclesmode 1 or 2 greatly improves reliability!\nNone the less, success is very dependent on the curvature of the original\nsurface or mesh used.\n---\n[IMPLEMENTATION DETAIL] N-Gons are deliberately deactivated but can be activated\nwhen editing the function call inside the scripting component and increasing\nthe max_valence value.\n    Inputs:\n        Toggle: Set to True to activate the component.\n                {item, boolean}\n        KnitNetwork: The KnitNetwork to create the mesh from.\n                     {item, KnitNetwork}\n        CyclesMode: Determines how the neighbors of each node are sorted when\n                    finding the cycles of the network.\n                    [-1] equals to using the World XY plane\n                    [0] equals to using a plane normal to the origin nodes \n                        closest point on the geometrybase\n                    [1] equals to using a plane normal to the average of the \n                        origin and neighbor nodes' closest points on the\n                        geometrybase\n                    [2] equals to using an average plane between a plane fit to \n                        the origin and its neighbor nodes and a plane normal to \n                        the origin nodes closest point on the geometrybase.\n                    Defaults to -1.\n                    {item, int}\n    Outputs:\n        Mesh: The Rhino mesh. {item, mesh}\n    Remarks:\n        Author: Max Eschenbach\n        License: MIT License\n        Version: 200705\n\"\"\"\n\n# PYTHON STANDARD LIBRARY IMPORTS\nfrom __future__ import division\n\n# GHPYTHON SDK IMPORTS\nfrom ghpythonlib.componentbase import executingcomponent as component\nimport Grasshopper, GhPython\nimport System\nimport Rhino\nimport rhinoscriptsyntax as rs\n\n# GHENV COMPONENT SETTINGS\nghenv.Component.Name = \"CreateMeshFromKnitNetwork\"\nghenv.Component.NickName =\"CMFKN\"\nghenv.Component.Category = \"Cockatoo\"\nghenv.Component.SubCategory = \"06 KnitNetwork\"\n\n# LOCAL MODULE IMPORTS\ntry:\n    from cockatoo import KnitNetwork\n    from cockatoo import KnitDiNetwork\nexcept ImportError:\n    errMsg = \"The Cockatoo python module seems to be not correctly \" + \\\n             \"installed! Please make sure the module is in you search \" + \\\n             \"path, see README for instructions!.\"\n    raise ImportError(errMsg)\n\nclass CreateMeshFromKnitNetwork(component):\n    \n    def RunScript(self, Toggle, KN, CyclesMode):\n        \n        # sanitize inputs\n        if CyclesMode == None:\n            CyclesMode = -1\n        elif CyclesMode < 0:\n            CyclesMode = -1\n        elif CyclesMode > 2:\n            CyclesMode = 2\n        \n        # initialize Mesh\n        Mesh = Grasshopper.DataTree[Rhino.Geometry.Mesh]()\n        \n        if Toggle and KN:\n            if CyclesMode != -1 and not KN.graph[\"reference_geometry\"]:\n                errMsg = \"KnitNetwork has no reference geometry \" + \\\n                         \"attached! Will fall back to World XY plane.\"\n                rml = self.RuntimeMessageLevel.Warning\n                self.AddRuntimeMessage(rml, errMsg)\n            # create mesh from knitnetwork\n            if isinstance(KN, KnitNetwork):\n                Mesh = KN.create_mesh(mode=CyclesMode,\n                                      max_valence=4)\n            elif isinstance(KN, KnitDiNetwork):\n                if KN.verify_dual_form():\n                    Mesh = KnitNetwork(KN).create_mesh(mode=CyclesMode,\n                                                       max_valence=4)\n        elif Toggle and not KN:\n            rml = self.RuntimeMessageLevel.Warning\n            rMsg = \"No KnitNetwork input!\"\n            self.AddRuntimeMessage(rml, rMsg)\n        \n        return Mesh\n",
  "language": "python",
  "imports": [
    "Rhino",
    "Rhino.Geometry",
    "ghpythonlib",
    "rhinoscriptsyntax"
  ],
  "has_docstring": true
}