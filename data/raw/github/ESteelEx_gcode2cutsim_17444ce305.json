{
  "source_url": "https://github.com/ESteelEx/gcode2cutsim/blob/95aa5678ec3848954cd855838198d3c5a8802a51/RhinoInterface/select_obj.py",
  "repo": "ESteelEx/gcode2cutsim",
  "repo_stars": 2,
  "repo_description": "- gcode 2 cutsim code for 3D Simulation with Verifier Engine",
  "license": "unknown",
  "filepath": "RhinoInterface/select_obj.py",
  "instruction": "Select obj",
  "code": "import copy\nimport scriptcontext\ntry:\n    import rhinoscriptsyntax as rs\nexcept:\n    pass\n\n\ndef GetDAESettings():\n    e_str = \"\"\n    return e_str\n\n\ndef GetOBJSettings():\n    e_str = \"_Geometry=_Mesh \"\n    e_str += \"_EndOfLine=CRLF \"\n    e_str += \"_ExportRhinoObjectNames=_ExportObjectsAsOBJGroups \"\n    e_str += \"_ExportMeshTextureCoordinates=_Yes \"\n    e_str += \"_ExportMeshVertexNormals=_No \"\n    e_str += \"_CreateNGons=_No \"\n    e_str += \"_ExportMaterialDefinitions=_No \"\n    e_str += \"_YUp=_No \"\n    e_str += \"_WrapLongLines=Yes \"\n    e_str += \"_VertexWelding=_Welded \"\n    e_str += \"_WritePrecision=4 \"\n    e_str += \"_Enter \"\n\n    e_str += \"_DetailedOptions \"\n    e_str += \"_JaggedSeams=_No \"\n    e_str += \"_PackTextures=_No \"\n    e_str += \"_Refine=_Yes \"\n    e_str += \"_SimplePlane=_No \"\n\n    e_str += \"_AdvancedOptions \"\n    e_str += \"_Angle=50 \"\n    e_str += \"_AspectRatio=0 \"\n    e_str += \"_Distance=0.0\"\n    e_str += \"_Density=0 \"\n    e_str += \"_Density=0.45 \"\n    e_str += \"_Grid=0 \"\n    e_str += \"_MaxEdgeLength=0 \"\n    e_str += \"_MinEdgeLength=0.0001 \"\n\n    e_str += \"_Enter _Enter\"\n\n    return e_str\n\n\ndef GetSTLSettings():\n    eStr = \"_ExportFileAs=_Binary \"\n    eStr += \"_ExportUnfinishedObjects=_Yes \"\n    eStr += \"_UseSimpleDialog=_No \"\n    eStr += \"_UseSimpleParameters=_No \"\n    eStr += \"_Enter _DetailedOptions \"\n    eStr += \"_JaggedSeams=_No \"\n    eStr += \"_PackTextures=_No \"\n    eStr += \"_Refine=_Yes \"\n    eStr += \"_SimplePlane=_No \"\n    eStr += \"_AdvancedOptions \"\n    eStr += \"_Angle=15 \"\n    eStr += \"_AspectRatio=0 \"\n    eStr += \"_Distance=0.01 \"\n    eStr += \"_Grid=16 \"\n    eStr += \"_MaxEdgeLength=0 \"\n    eStr += \"_MinEdgeLength=0.0001 \"\n    eStr += \"_Enter _Enter\"\n\n    return eStr\n\n\nclass mesh_saver:\n    def __init__(self, fileName, filePath, settingsList):\n        self.fileName = fileName\n        self.filePath = filePath\n        self.settingsList = settingsList\n        self.arrLayers = self.layerNames()\n\n    # ------------------------------------------------------------------------------------------------------------------\n    def layerNames(self, sort=False):\n\n        rc = []\n        for layer in scriptcontext.doc.Layers:\n            if not layer.IsDeleted:\n                rc.append(layer.FullPath)\n\n        if sort:\n            rc.sort()\n\n        return rc\n\n    # ------------------------------------------------------------------------------------------------------------------\n    def initExportByLayer(self, fileType=\"obj\", visibleonly=False, byObject=False):\n        for layerName in self.arrLayers:\n            layer = scriptcontext.doc.Layers.FindByFullPath(layerName, True)\n            if layer >= 0:\n                layer = scriptcontext.doc.Layers[layer]\n                save = True\n                if visibleonly:\n                    if not layer.IsVisible:\n                        save = False\n                if rs.IsLayerEmpty(layerName):\n                    save = False\n                if save:\n                    cutName = layerName.split(\"::\")\n                    cutName = cutName[len(cutName)-1]\n                    objs = scriptcontext.doc.Objects.FindByLayer(cutName)\n                    if len(objs) > 0:\n                        if byObject:\n                            i = 0\n                            for obj in objs:\n                                i += 1\n                                self.saveObjectsToFile(cutName+\"_\"+str(i), [obj], fileType)\n                        else:\n                            self.saveObjectsToFile(cutName, objs, fileType)\n\n    # ------------------------------------------------------------------------------------------------------------------\n    def initExportBySelection(self, fileType=\"obj\"):\n\n        self.saveSelectionToFile(self.filePath + self.fileName, fileType)\n\n    # ------------------------------------------------------------------------------------------------------------------\n    def saveObjectsToFile(self, name, objs, fileType):\n\n        rs.EnableRedraw(False)\n\n        if len(objs) > 0:\n            settings = self.settingsList[\"Get\" + fileType.upper() + \"Settings\"]()\n            rs.UnselectAllObjects()\n            for obj in objs:\n                obj.Select(True)\n            name = \"\".join(name.split(\" \"))\n            command = '-_Export \"{}{}{}\" {}'.format(self.filePath, name, \".\" + fileType.lower(), settings)\n            rs.Command(command, True)\n            rs.EnableRedraw(True)\n\n    # ------------------------------------------------------------------------------------------------------------------\n    def saveSelectionToFile(self, name, fileType):\n\n        settings = self.settingsList[\"Get\" + fileType.upper() + \"Settings\"]()\n        command = '-_Export \"{}{}{}\" {}'.format(self.filePath, self.fileName, \".\" + fileType.lower(), settings)\n        rs.Command(command, True)\n\n\n# ----------------------------------------------------------------------------------------------------------------------\ndef run_saver(objId):\n    print \"//export run started/////////////\"\n\n    settingsList = {\n        'GetDAESettings': GetDAESettings,\n        'GetOBJSettings': GetOBJSettings,\n        'GetSTLSettings': GetSTLSettings\n    }\n\n    fileName = r'Mesh'\n    filePath = r'D:\\StoreDaily\\\\'\n    MS = mesh_saver(fileName, filePath, settingsList)\n\n    # MS.initExportByLayer(\"stl\", True, False)\n    MS.initExportBySelection(fileType=\"stl\")\n\n    print \"//export run ended/////////////\"\n\ntry:\n    rs.UnselectAllObjects()\n    objId = rs.GetObjects(message='Please select an Object: ', select=True)\n\n    print 'SAVING STL'\n    run_saver(objId)\n\nexcept:\n    raise\n    pass",
  "language": "python",
  "imports": [
    "rhinoscriptsyntax",
    "scriptcontext"
  ],
  "has_docstring": false
}