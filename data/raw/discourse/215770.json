{
  "source_url": "https://discourse.mcneel.com/t/help-with-eto/215770",
  "topic_id": 215770,
  "title": "Help with Eto",
  "question": "Hello, Iâ€™m creating a table to generate a sole scale. However, when I click the Calculate button, Rhino is closing unexpectedly. Any help or guidance would be greatly appreciated.\n\n\nimport rhinoscriptsyntax as rs\nimport Rhino as r\nimport Eto.Forms as f\nimport Eto.Drawing as d\nimport System\n\n\nclass EscalaSolado(f.Form):\n    def __init__(self):\n        super(EscalaSolado, self).__init__()\n\n        self.Title = \"Sole Scaling\"\n        self.Size = d.Size(700,570)\n        self.Resizable = True\n\n        # ----------- Fields -----------\n        self.StarCode = f.Label()\n        self.StarCode.Text = \"Start Code\"\n        self.StarForms = f.TextBox()\n\n        self.EndCode = f.Label()\n        self.EndCode.Text = \"End Code\"\n        self.EndForms = f.TextBox()\n\n        self.BaseCode = f.Label()\n        self.BaseCode.Text = \"Base Code\"\n        self.BaseForms = f.TextBox()\n\n        self.HalSize = f.Label()\n        self.HalSize.Text = \"Half Size\"\n        self.DropEscala = f.DropDown()\n        self.DropEscala.Items.Add(\"0.5\")\n        self.DropEscala.Items.Add(\"1\")\n        self.DropEscala.SelectedIndex = 0\n\n        self.TamXModelo = f.Label()\n        self.TamXModelo.Text = \"Model Size X\"\n        self.TamXForms = f.TextBox()\n\n        self.TamYModelo = f.Label()\n        self.TamYModelo.Text = \"Model Size Y\"\n        self.TamYForms = f.TextBox()\n\n        self.TamZModelo = f.Label()\n        self.TamZModelo.Text = \"Model Size Z\"\n        self.TamZForms = f.TextBox()\n\n        self.FatorXEscala = f.Label()\n        self.FatorXEscala.Text = \"Scale Factor X\"\n        self.FatorXForms = f.TextBox()\n        self.FatorXForms.Text = \"5\"\n\n        self.FatorYEscala = f.Label()\n        self.FatorYEscala.Text = \"Scale Factor Y\"\n        self.FatorYForms = f.TextBox()\n        self.FatorYForms.Text = \"3\"\n\n        self.FatorZEscala = f.Label()\n        self.FatorZEscala.Text = \"Scale Factor Z\"\n        self.FatorZForms = f.TextBox()\n        self.FatorZForms.Text = \"3\"\n\n        # ----------- Buttons -----------\n...",
  "code_blocks": [
    {
      "code": "import rhinoscriptsyntax as rs\nimport Rhino as r\nimport Eto.Forms as f\nimport Eto.Drawing as d\nimport System\n\n\nclass EscalaSolado(f.Form):\n    def __init__(self):\n        super(EscalaSolado, self).__init__()\n\n        self.Title = \"Sole Scaling\"\n        self.Size = d.Size(700,570)\n        self.Resizable = True\n\n        # ----------- Fields -----------\n        self.StarCode = f.Label()\n        self.StarCode.Text = \"Start Code\"\n        self.StarForms = f.TextBox()\n\n        self.EndCode = f.Label()\n        self.EndCode.Text = \"End Code\"\n        self.EndForms = f.TextBox()\n\n        self.BaseCode = f.Label()\n        self.BaseCode.Text = \"Base Code\"\n        self.BaseForms = f.TextBox()\n\n        self.HalSize = f.Label()\n        self.HalSize.Text = \"Half Size\"\n        self.DropEscala = f.DropDown()\n        self.DropEscala.Items.Add(\"0.5\")\n        self.DropEscala.Items.Add(\"1\")\n        self.DropEscala.SelectedIndex = 0\n\n        self.TamXModelo = f.Label()\n        self.TamXModelo.Text = \"Model Size X\"\n        self.TamXForms = f.TextBox()\n\n        self.TamYModelo = f.Label()\n        self.TamYModelo.Text = \"Model Size Y\"\n        self.TamYForms = f.TextBox()\n\n        self.TamZModelo = f.Label()\n        self.TamZModelo.Text = \"Model Size Z\"\n        self.TamZForms = f.TextBox()\n\n        self.FatorXEscala = f.Label()\n        self.FatorXEscala.Text = \"Scale Factor X\"\n        self.FatorXForms = f.TextBox()\n        self.FatorXForms.Text = \"5\"\n\n        self.FatorYEscala = f.Label()\n        self.FatorYEscala.Text = \"Scale Factor Y\"\n        self.FatorYForms = f.TextBox()\n        self.FatorYForms.Text = \"3\"\n\n        self.FatorZEscala = f.Label()\n        self.FatorZEscala.Text = \"Scale Factor Z\"\n        self.FatorZForms = f.TextBox()\n        self.FatorZForms.Text = \"3\"\n\n        # ----------- Buttons -----------\n        self.BotaoSel = f.Button()\n        self.BotaoSel.Text = \"Select\"\n        self.BotaoSel.Click += self.SelecionarModelo\n\n        self.BotaoCalcular = f.Button()\n        self.BotaoCalcular.Text = \"Calculate\"\n        self.BotaoCalcular.Click += self.CalcularTabela\n\n        self.BotaoGerar = f.Button()\n        self.BotaoGerar.Text = \"Generate\"\n\n        # ----------- Grid -----------\n        self.GridEscala = f.GridView()\n        self.GridEscala.Size = d.Size(-1, -1)\n\n        col_codigo = f.GridColumn()\n        col_codigo.HeaderText = \"Code\"\n        col_codigo.DataCell = f.TextBoxCell(0)\n        col_codigo.Width = 80\n\n        col_base = f.GridColumn()\n        col_base.HeaderText = \"Base\"\n        col_base.DataCell = f.TextBoxCell(1)\n        col_base.Width = 80\n\n        col_x = f.GridColumn()\n        col_x.HeaderText = \"X\"\n        col_x.DataCell = f.TextBoxCell(2)\n        col_x.Width = 80\n\n        col_y = f.GridColumn()\n        col_y.HeaderText = \"Y\"\n        col_y.DataCell = f.TextBoxCell(3)\n        col_y.Width = 80\n\n        col_z = f.GridColumn()\n        col_z.HeaderText = \"Z\"\n        col_z.DataCell = f.TextBoxCell(4)\n        col_z.Width = 80\n\n        self.GridEscala.Columns.Add(col_codigo)\n        self.GridEscala.Columns.Add(col_base)\n        self.GridEscala.Columns.Add(col_x)\n        self.GridEscala.Columns.Add(col_y)\n        self.GridEscala.Columns.Add(col_z)\n\n        # ----------- Layout -----------\n        topLayout = f.DynamicLayout()\n        topLayout.Spacing = d.Size(5, 5)\n\n        topLayout.AddRow(self.StarCode,self.StarForms,self.TamXModelo,self.TamXForms,self.FatorXEscala,self.FatorXForms,self.BotaoSel)\n        topLayout.AddRow(self.EndCode,self.EndForms,self.TamYModelo,self.TamYForms,self.FatorYEscala,self.FatorYForms,self.BotaoCalcular)\n        topLayout.AddRow(self.BaseCode,self.BaseForms,self.TamZModelo,self.TamZForms,self.FatorZEscala,self.FatorZForms,self.BotaoGerar)\n        topLayout.AddRow(self.HalSize,self.DropEscala)\n\n        bottomLayout = f.DynamicLayout()\n        bottomLayout.AddRow(None)\n\n        mainLayout = f.DynamicLayout()\n        mainLayout.Padding = d.Padding(10)\n        mainLayout.Spacing = d.Size(5, 5)\n\n        mainLayout.Add(topLayout)\n        mainLayout.Add(self.GridEscala, yscale=True)\n        mainLayout.Add(bottomLayout)\n\n        self.Content = mainLayout\n\n\n    # ----------- Visual Debug -----------\n    def MostrarErro(self, ex):\n        f.MessageBox.Show(\n            str(ex),\n            \"Script Error\",\n            f.MessageBoxButtons.OK,\n            f.MessageBoxType.Error\n        )\n\n\n    def SelecionarModelo(self, sender, e):\n        try:\n            obj = rs.GetObject(\"Select the Model\", preselect=True)\n            if not obj:\n                return\n\n            Box = rs.BoundingBox(obj)\n            ValorX = rs.Distance(Box[0], Box[1])\n            ValorY = rs.Distance(Box[1], Box[2])\n            ValorZ = rs.Distance(Box[0], Box[4])\n\n            self.TamXForms.Text = f\"{ValorX:.5f}\"\n            self.TamYForms.Text = f\"{ValorY:.5f}\"\n            self.TamZForms.Text = f\"{ValorZ:.5f}\"\n\n        except Exception as ex:\n            self.MostrarErro(ex)\n\n\n    def CalcularTabela(self, sender, e):\n        try:\n            start = float(self.StarForms.Text)\n            end = float(self.EndForms.Text)\n            base = float(self.BaseForms.Text)\n\n            tamX = float(self.TamXForms.Text)\n            tamY = float(self.TamYForms.Text)\n            tamZ = float(self.TamZForms.Text)\n\n            fatorX = float(self.FatorXForms.Text)\n            fatorY = float(self.FatorYForms.Text)\n            fatorZ = float(self.FatorZForms.Text)\n\n            passo = float(self.DropEscala.SelectedValue)\n\n            if passo <= 0:\n                raise Exception(\"Half Size must be greater than zero\")\n\n        except Exception as ex:\n            self.MostrarErro(ex)\n            return\n\n        dados = System.Collections.ArrayList()\n\n        atual = start\n        contador = 0\n\n        while atual <= end + 0.0001:\n\n            diferenca = atual - base\n\n            escalaX = tamX + (diferenca * fatorX)\n            escalaY = tamY + (diferenca * fatorY)\n            escalaZ = tamZ + (diferenca * fatorZ)\n\n            linha = System.Array[object]([\n                f\"{atual:.2f}\",\n                f\"{base:.2f}\",\n                f\"{escalaX:.2f}\",\n                f\"{escalaY:.2f}\",\n                f\"{escalaZ:.2f}\"\n            ])\n\n            dados.Add(linha)\n\n            atual += passo\n            contador += 1\n\n            if contador > 1000:\n                raise Exception(\"Too many rows generated. Check the values.\")\n\n        self.GridEscala.DataStore = dados\n\n\ndef main():\n    form = EscalaSolado()\n    form.Owner = r.UI.RhinoEtoApp.MainWindow\n    form.Show()\n\n\nmain()",
      "language": "python",
      "author": "Roberto_da_Silva_Kum",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "file-io",
    "geometry",
    "python",
    "rhinoscriptsyntax",
    "selection",
    "transformation",
    "ui"
  ],
  "has_accepted_answer": true,
  "category_id": 11,
  "posts_count": 3,
  "views": 30
}