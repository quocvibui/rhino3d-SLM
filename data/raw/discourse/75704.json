{
  "source_url": "https://discourse.mcneel.com/t/visual-studio-designer-and-controls/75704",
  "topic_id": 75704,
  "title": "Visual studio designer and controls",
  "question": "HI\n\nSo far I’ve been able to build and install the rhinocommons plugin example but I don’t seem to be able to find the visual designer. I wan’t to add a form with the usual controls like listbox and buttons and textboxes. So far I’ve only been able to add these things programatically but it is very tedious. Can anybody show how to add these things using visual studios built in resources.\n\n\nThanks\n\nme.",
  "code_blocks": [
    {
      "code": "Imports System\nImports System.Collections.Generic\nImports Rhino\nImports Rhino.Commands\nImports Rhino.Geometry\nImports Rhino.Input\nImports Rhino.Input.Custom\nImports System.Windows.Forms '**********************\n\nNamespace rp2\n\n    <System.Runtime.InteropServices.Guid(\"7fd2cb16-5f16-4df0-bfbf-ddec24eb93bf\")>\n    Public Class rp2Command\n        Inherits Command\n        Dim WithEvents form2 As New Form ' ***************************\n        Dim WithEvents btnExit As New Button()\n        Shared _instance As rp2Command\n\n        Public Sub New()\n            ' Rhino only creates one instance of each command class defined in a\n            ' plug-in, so it is safe to store a refence in a static field.\n            _instance = Me\n        End Sub\n\n        '''<summary>The only instance of this command.</summary>\n        Public Shared ReadOnly Property Instance() As rp2Command\n            Get\n                Return _instance\n            End Get\n        End Property\n\n        '''<returns>The command name as it appears on the Rhino command line.</returns>\n        Public Overrides ReadOnly Property EnglishName() As String\n            Get\n                Return \"rp2Command\"\n            End Get\n        End Property\n\n        Protected Overrides Function RunCommand(ByVal doc As RhinoDoc, ByVal mode As RunMode) As Result\n            ' TODO: start here modifying the behaviour of your command.\n            ' ---\n\n            '********* FORM STUFF *******************************************************\n            ' SET UP A NEW FORM\n            ' Dav create a new form ' from: https://stackoverflow.com/questions/10791898/how-can-i-add-a-new-windows-form-and-then-add-a-picturebox-programmatically\n            '   Dim form2 As New Form  ' <--------- error here: type form is not defined.\n            form2.Size = New System.Drawing.Size(250, 300)\n            form2.BackColor = Drawing.Color.CadetBlue\n            form2.Text = \"Hello from form 2\"\n            form2.Show()\n            form2.TopMost = True\n            ' SET UP A EXIT BUTTON\n            btnExit.Name = \"btnExit\"\n            btnExit.Location = New System.Drawing.Point(100, 200)\n            btnExit.Size = New System.Drawing.Size(100, 25)\n            btnExit.Text = \"EXIT\"\n            btnExit.TabIndex = 1\n            form2.Controls.Add(btnExit)\n            ' ********* end of form stuff ***********************************************\n\n            RhinoApp.WriteLine(\"The {0} command will add a line right now.\", EnglishName)\n\n            Dim pt0 As Point3d\n            Using getPointAction As New GetPoint()\n                getPointAction.SetCommandPrompt(\"Please select the start point\")\n                If getPointAction.[Get]() <> GetResult.Point Then\n                    RhinoApp.WriteLine(\"No start point was selected.\")\n                    Return getPointAction.CommandResult()\n                End If\n                pt0 = getPointAction.Point()\n            End Using\n\n            Dim pt1 As Point3d\n            Using getPointAction As New GetPoint()\n                getPointAction.SetCommandPrompt(\"Please select the end point\")\n                getPointAction.SetBasePoint(pt0, True)\n                AddHandler getPointAction.DynamicDraw,\n                    Sub(sender, e) e.Display.DrawLine(pt0, e.CurrentPoint, System.Drawing.Color.DarkRed)\n                If getPointAction.[Get]() <> GetResult.Point Then\n                    RhinoApp.WriteLine(\"No end point was selected.\")\n                    Return getPointAction.CommandResult()\n                End If\n                pt1 = getPointAction.Point()\n            End Using\n\n            doc.Objects.AddLine(pt0, pt1)\n            doc.Views.Redraw()\n            RhinoApp.WriteLine(\"The {0} command added one line to the document.\", EnglishName)\n            '' ---\n\n            Return Result.Success\n        End Function\n        Private Sub Button_btnExit_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnExit.Click\n            ' This is the E X I T   B U T T O N\n            '  form2.Dispose()\n            '  form2 = Nothing\n            form2.Close()\n            ' PROBLEM - after closing the form I cant run the plugin again.\n            ' Here is the error information:\n            ' An exception of type 'System.ObjectDisposedException' occurred in System.Windows.Forms.dll but was not handled in user code\n            ' Additional information: Cannot access a disposed object.\n            ' If there is a handler for this exception, the program may be safely continued.\n        End Sub\n    End Class\nEnd Namespace",
      "language": "csharp",
      "author": "crouchorama",
      "post_number": 3,
      "is_solution": false
    }
  ],
  "tags": [
    "csharp",
    "geometry",
    "rhinocommon",
    "ui"
  ],
  "has_accepted_answer": false,
  "category_id": 3,
  "posts_count": 4,
  "views": 622
}