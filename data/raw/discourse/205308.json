{
  "source_url": "https://discourse.mcneel.com/t/extend-multi-sides-with-preview-python/205308",
  "topic_id": 205308,
  "title": "Extend Multi Sides with Preview (Python)",
  "question": "Hi everyone!\n\n\nIâ€™ve been meaning to create this Python script for Rhino for a long time, and I finally made it happen. It lets you extend surface edges quickly and easily, featuring a live preview so you can see the changes before applying them.\n\n\nYou just select the edges, set the extension length and step, and the surfaces update immediately. The script remembers your last settings to make repeated use smoother.\n\n\nHope this tool makes your workflow a bit easier. Give it a try!\n\n\n\"\"\"\nExtend Multi Sides for Rhino\nAuthor: leex\nDate: 2025-06-01\n\nThis script allows you to extend surface edges with live preview and adjustable step.\nSelect edges, set extension length, preview, and apply.\nThe script remembers your last used settings, which are saved to your system TEMP folder as ExtendMultiSides_last_value.txt.\n\nEnjoy!\n\"\"\"\n\n\n\nimport Rhino\nimport scriptcontext as sc\nimport System.Drawing\nimport os\nimport tempfile\n\ndef get_settings_path():\n    tempdir = tempfile.gettempdir()\n    return os.path.join(tempdir, \"ExtendMultiSides_last_value.txt\")\n\ndef save_last_value(val):\n    path = get_settings_path()\n    try:\n        with open(path, \"w\") as f:\n            f.write(str(val))\n    except:\n        pass\n\ndef load_last_value(default=2.01):\n    path = get_settings_path()\n    try:\n        if os.path.exists(path):\n            with open(path, \"r\") as f:\n                return float(f.read())\n    except:\n        pass\n    return default\n\ndef edge_has_only_seam_trims(edge, brep):\n    trims = edge.TrimIndices()\n    if not trims:\n        return False\n    for trim_index in trims:\n        trim = brep.Trims[trim_index]\n        if trim.TrimType != Rhino.Geometry.BrepTrimType.Seam:\n            return False\n    return True\n\ndef is_periodic_edge(edge, brep):\n    return edge_has_only_seam_trims(edge, brep)\n\ndef get_previews(objs_faces, dist):\n    preview_ids = []\n    if hasattr(get_previews, \"preview_ids\"):\n        for pid in get_previews.preview_ids:\n            sc.doc.Objects.Delete(pid, True)\n   ...",
  "code_blocks": [
    {
      "code": "\"\"\"\nExtend Multi Sides for Rhino\nAuthor: leex\nDate: 2025-06-01\n\nThis script allows you to extend surface edges with live preview and adjustable step.\nSelect edges, set extension length, preview, and apply.\nThe script remembers your last used settings, which are saved to your system TEMP folder as ExtendMultiSides_last_value.txt.\n\nEnjoy!\n\"\"\"\n\n\n\nimport Rhino\nimport scriptcontext as sc\nimport System.Drawing\nimport os\nimport tempfile\n\ndef get_settings_path():\n    tempdir = tempfile.gettempdir()\n    return os.path.join(tempdir, \"ExtendMultiSides_last_value.txt\")\n\ndef save_last_value(val):\n    path = get_settings_path()\n    try:\n        with open(path, \"w\") as f:\n            f.write(str(val))\n    except:\n        pass\n\ndef load_last_value(default=2.01):\n    path = get_settings_path()\n    try:\n        if os.path.exists(path):\n            with open(path, \"r\") as f:\n                return float(f.read())\n    except:\n        pass\n    return default\n\ndef edge_has_only_seam_trims(edge, brep):\n    trims = edge.TrimIndices()\n    if not trims:\n        return False\n    for trim_index in trims:\n        trim = brep.Trims[trim_index]\n        if trim.TrimType != Rhino.Geometry.BrepTrimType.Seam:\n            return False\n    return True\n\ndef is_periodic_edge(edge, brep):\n    return edge_has_only_seam_trims(edge, brep)\n\ndef get_previews(objs_faces, dist):\n    preview_ids = []\n    if hasattr(get_previews, \"preview_ids\"):\n        for pid in get_previews.preview_ids:\n            sc.doc.Objects.Delete(pid, True)\n    for obj_id, data in objs_faces.items():\n        brep = data[\"brep\"]\n        faces_dict = data[\"faces\"]\n        for face_index, isos in faces_dict.items():\n            face = brep.Faces[face_index]\n            ext_face = face\n            for iso in isos:\n                ext_face = ext_face.Extend(iso, dist, True) or ext_face\n            pid = sc.doc.Objects.AddBrep(ext_face.ToBrep())\n            rhobj = sc.doc.Objects.Find(pid)\n            if rhobj:\n                rhobj.Attributes.ObjectColor = System.Drawing.Color.FromArgb(120, 80, 220, 80)\n                rhobj.Attributes.ColorSource = Rhino.DocObjects.ObjectColorSource.ColorFromObject\n                rhobj.CommitChanges()\n            preview_ids.append(pid)\n    sc.doc.Views.Redraw()\n    get_previews.preview_ids = preview_ids\n    return preview_ids\n\ndef remove_previews():\n    if hasattr(get_previews, \"preview_ids\"):\n        for pid in get_previews.preview_ids:\n            sc.doc.Objects.Delete(pid, True)\n        get_previews.preview_ids = []\n\ndef ExtendMultiSides():\n    go = Rhino.Input.Custom.GetObject()\n    go.SetCommandPrompt(\"Select edges to extend\")\n    go.GeometryFilter = Rhino.DocObjects.ObjectType.EdgeFilter\n    go.SubObjectSelect = True\n    go.EnablePreSelect(True, True)\n    go.GetMultiple(1, 0)\n    if go.ObjectCount == 0:\n        return\n\n    objs_faces = {}\n    for i in range(go.ObjectCount):\n        objref = go.Object(i)\n        obj_id = objref.ObjectId\n        brep = objref.Brep()\n        ci = objref.GeometryComponentIndex\n        trim = None\n        edge = None\n        if str(ci.ComponentIndexType) == \"BrepEdge\":\n            edge = brep.Edges[ci.Index]\n            trim = edge.Trims[0] if edge.Trims else None\n        elif str(ci.ComponentIndexType) == \"BrepTrim\":\n            trim = brep.Trims[ci.Index]\n            edge = trim.Edge\n        if not trim or not edge:\n            continue\n        if is_periodic_edge(edge, brep):\n            continue\n        face = trim.Face\n        face_index = face.FaceIndex\n        if obj_id not in objs_faces:\n            objs_faces[obj_id] = {\"brep\": brep, \"faces\": {}}\n        if face_index not in objs_faces[obj_id][\"faces\"]:\n            objs_faces[obj_id][\"faces\"][face_index] = set()\n        objs_faces[obj_id][\"faces\"][face_index].add(trim.IsoStatus)\n\n    dist = load_last_value(default=2.01)\n    step = 0.25\n\n    get_previews(objs_faces, dist)\n    set_length = True\n\n    done = False\n    while not done:\n        gn = Rhino.Input.Custom.GetNumber()\n        gn.SetCommandPrompt(\"Enter extension length (Press Esc when done). Step: {:.2f}\".format(step))\n        less_option = gn.AddOption(\"Less\")\n        more_option = gn.AddOption(\"More\")\n        step_option = gn.AddOption(\"SetStep\")\n        done_option = gn.AddOption(\"Done\")\n        gn.SetDefaultNumber(dist)\n        gn.SetLowerLimit(0.01, True)\n        result = gn.Get()\n        if result == Rhino.Input.GetResult.Option:\n            idx = gn.Option().Index\n            if idx == less_option:\n                dist = max(dist - step, 0.01)\n                set_length = True\n                get_previews(objs_faces, dist)\n                continue\n            elif idx == more_option:\n                dist = dist + step\n                set_length = True\n                get_previews(objs_faces, dist)\n                continue\n            elif idx == step_option:\n                gn_step = Rhino.Input.Custom.GetNumber()\n                gn_step.SetCommandPrompt(\"Enter new step value\")\n                gn_step.SetDefaultNumber(step)\n                gn_step.SetLowerLimit(0.001, True)\n                step_result = gn_step.Get()\n                if step_result == Rhino.Input.GetResult.Number:\n                    step = gn_step.Number()\n                continue\n            elif idx == done_option:\n                done = True\n                break\n        elif result == Rhino.Input.GetResult.Number:\n            dist = gn.Number()\n            set_length = True\n            get_previews(objs_faces, dist)\n            continue\n        else:\n            break\n\n    remove_previews()\n\n    if set_length:\n        for obj_id, data in objs_faces.items():\n            brep = data[\"brep\"]\n            faces_dict = data[\"faces\"]\n            new_breps = []\n            for i, face in enumerate(brep.Faces):\n                if i in faces_dict:\n                    ext_face = face\n                    extending_isos = set(faces_dict[i])\n                    for iso in extending_isos:\n                        ext_face = ext_face.Extend(iso, dist, True) or ext_face\n                    new_breps.append(ext_face.ToBrep())\n                else:\n                    dupl = face.DuplicateFace(False)\n                    if dupl:\n                        new_breps.append(dupl)\n            joined = Rhino.Geometry.Brep.JoinBreps(new_breps, sc.doc.ModelAbsoluteTolerance)\n            sc.doc.Objects.Delete(obj_id, True)\n            if joined and len(joined) == 1:\n                sc.doc.Objects.AddBrep(joined[0])\n            elif joined:\n                for jb in joined:\n                    sc.doc.Objects.AddBrep(jb)\n        sc.doc.Views.Redraw()\n        save_last_value(dist)\n\nif __name__ == \"__main__\":\n    ExtendMultiSides()",
      "language": "python",
      "author": "leex",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "file-io",
    "geometry",
    "python",
    "rhinocommon",
    "selection",
    "transformation"
  ],
  "has_accepted_answer": false,
  "category_id": 11,
  "posts_count": 2,
  "views": 145
}