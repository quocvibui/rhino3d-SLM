{
  "source_url": "https://github.com/ThinkWithPbody/YifuDesignLab/blob/1c14bf10cf862fc2f667ad91dc9377a19a27bb90/docs/Wiki/Attachments/Rhino/HatchFromCenterline.py",
  "repo": "ThinkWithPbody/YifuDesignLab",
  "repo_stars": 0,
  "repo_description": null,
  "license": "GPL-3.0",
  "filepath": "docs/Wiki/Attachments/Rhino/HatchFromCenterline.py",
  "instruction": "Hatch from centerline",
  "code": "import rhinoscriptsyntax as rs\r\nimport Rhino.Geometry as rg\r\n\r\ndef offset_and_hatch_curves():\r\n    # Get input curves\r\n    curves = rs.GetObjects(\"Select curves to offset and hatch\", 4, preselect=True)\r\n    if not curves:\r\n        return\r\n\r\n    # Get the current active layer\r\n    active_layer = rs.CurrentLayer()\r\n    if not active_layer:\r\n        return\r\n    \r\n    # Get offset distance\r\n    distance = rs.GetReal(\"Offset distance\", 0.05, 1e-10)\r\n    if not distance:\r\n        return\r\n\r\n    # Ask if curves should be joined\r\n    join_curves = rs.GetBoolean(\"Join curves?\", (\"Join\", \"No\", \"Yes\"), False)[0]\r\n\r\n    # Ask if sublayers should be created for centerlines and border curves\r\n    create_centerline_layer = rs.GetBoolean(\"Keep centerlines?\", (\"Centerline\", \"No\", \"Yes\"), False)[0]\r\n    create_border_layer = rs.GetBoolean(\"Keep border curves?\", (\"Border\", \"No\", \"Yes\"), False)[0]\r\n\r\n    # Disable viewport redraw\r\n    rs.EnableRedraw(False)\r\n\r\n    hatches = []\r\n    border_curves = []\r\n    \r\n    # Join curves based on user preference\r\n    if join_curves:\r\n        # Copy input curves\r\n        copied_curves = [rs.CopyObject(curve) for curve in curves]\r\n        curves = rs.JoinCurves(copied_curves, delete_input=True)\r\n\r\n    # Get list of available hatch patterns\r\n    hatch_patterns = rs.HatchPatternNames()\r\n    \r\n    # Get hatch pattern\r\n    hatch_pattern = rs.GetString(\"Hatch pattern name\", \"Solid\", hatch_patterns)\r\n    if not hatch_pattern:\r\n        return\r\n\r\n    for curve in curves:\r\n        # Offset curve on both sides\r\n        offset_pos = rs.OffsetCurve(curve, [0, 0, 0], distance)\r\n        offset_neg = rs.OffsetCurve(curve, [0, 0, 0], -distance)\r\n        \r\n        if offset_pos and offset_neg:\r\n            # Create closing lines\r\n            start_line = rs.AddLine(rs.CurveStartPoint(offset_pos), rs.CurveStartPoint(offset_neg))\r\n            end_line = rs.AddLine(rs.CurveEndPoint(offset_pos), rs.CurveEndPoint(offset_neg))\r\n\r\n            # Join curves to create closed shape\r\n            border_curve = rs.JoinCurves([offset_pos, offset_neg, start_line, end_line], True)\r\n            \r\n            if border_curve:\r\n                # Create hatch\r\n                hatch = rs.AddHatch(border_curve, hatch_pattern, 1, 0)\r\n                if hatch:\r\n                    hatches.append(hatch)\r\n\r\n                # Store border curve for later deletion if not keeping it\r\n                border_curves.extend(border_curve)\r\n\r\n                # Handle centerline curve based on user choice\r\n                if create_centerline_layer:\r\n                    rs.ObjectLayer(curve, None)  # Temporarily set layer to None (not assigned yet)\r\n\r\n                if create_border_layer:\r\n                    for bc in border_curve:\r\n                        rs.ObjectLayer(bc, None)  # Temporarily set layer to None (not assigned yet)\r\n\r\n                for h in hatches:\r\n                    rs.ObjectLayer(h, None)  # Temporarily set layer to None (not assigned yet)\r\n\r\n    # Create layers only after all operations are finalized\r\n    centerline_layer = None\r\n    border_layer = None\r\n    \r\n    if create_centerline_layer:\r\n        centerline_layer = rs.AddLayer(\"Centerlines\", color=rs.LayerColor(active_layer), parent=active_layer)\r\n        \r\n    if create_border_layer:\r\n        border_layer = rs.AddLayer(\"Borders\", color=rs.LayerColor(active_layer), parent=active_layer)\r\n\r\n    # Create hatch layer and copy properties from the active layer\r\n    hatch_layer = rs.AddLayer(\"Hatches\", color=rs.LayerColor(active_layer), parent=active_layer)\r\n\r\n    # Move objects to appropriate layers only if keeping them\r\n    for curve in curves:\r\n        if create_centerline_layer:\r\n            rs.ObjectLayer(curve, centerline_layer)\r\n        else:\r\n            rs.DeleteObject(curve)  # Delete centerline curve if not keeping\r\n\r\n    for border_curve in border_curves:\r\n        if create_border_layer:\r\n            rs.ObjectLayer(border_curve, border_layer)\r\n        else:\r\n            rs.DeleteObject(border_curve)  # Delete border curve if not keeping\r\n\r\n    for h in hatches:\r\n        rs.ObjectLayer(h, hatch_layer)  # Move hatches to their layer\r\n\r\n    # Group hatches if requested (optional)\r\n    if hatches:\r\n        group_hatch_objects(hatches)\r\n\r\n    # Enable viewport redraw again\r\n    rs.EnableRedraw(True)\r\n\r\ndef group_hatch_objects(hatches):\r\n    group_name = \"Hatch Group\"\r\n    \r\n    # Create a group for all hatches\r\n    group_id = rs.AddGroup(group_name)\r\n    \r\n    for hatch in hatches:\r\n        if rs.IsObject(hatch):\r\n            rs.AddObjectsToGroup(hatch, group_id)\r\n\r\n# Run the function\r\noffset_and_hatch_curves()\r\n",
  "language": "python",
  "imports": [
    "Rhino",
    "Rhino.Geometry",
    "rhinoscriptsyntax"
  ],
  "has_docstring": false
}