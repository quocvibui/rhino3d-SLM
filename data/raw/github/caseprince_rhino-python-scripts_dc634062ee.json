{
  "source_url": "https://github.com/caseprince/rhino-python-scripts/blob/639ae6ea1dd6cc00408db4f7a97ae689e61fc589/ripple-shade.py",
  "repo": "caseprince/rhino-python-scripts",
  "repo_stars": 0,
  "repo_description": "Parametric lampshades for 3D Printing in RhinoScript",
  "license": "unknown",
  "filepath": "ripple-shade.py",
  "instruction": "Ripple shade",
  "code": "import rhinoscriptsyntax as rs\nimport math\nfrom utils.easing import easeInOutSine\nfrom utils.reset import reset\nfrom utils.geom import box2pt\n\nreset()\n\ndef shortest_angle_distance(angle1, angle2):\n    diff = abs(angle1 - angle2)\n    return min(diff, 2 * math.pi - diff)\n\nradius_mm = 90\nnumPoints = 400\nheight = 356\nslices = 300\namplitude = 1.5\nwavelengthStart = 1.1 #2\nwavelengthMultiplier = 0.008\n# rocks = ([radius_mm, 0, 50], [0, radius_mm, 300], [0, -radius_mm, 225], [-radius_mm, 0, 125])\n# rocks = ([radius_mm, 0, 50])\n# z, angle, radius, waveOffset\nrocks = ([50, math.pi * 0.2, 100, 0], \n         [220, math.pi * 0.5, 70, 0], \n         [125, math.pi * 0.9, 50, math.pi], \n         [300, math.pi * 1.2, 90, 0], \n         [100, math.pi * 1.6, 140, math.pi], \n         [270, math.pi * 1.85, 30, 0])\n\ncurves = []\ncurves2 = []\nfor s in range(slices + 1):\n    points = []\n    points2 = []\n    z = s * height / slices\n    for i in range(numPoints + 1):   \n        angle = 2 * math.pi * i / numPoints\n        x = radius_mm * math.cos(angle)\n        y = radius_mm * math.sin(angle)\n        pointOnCylinder = (x, y, z)\n        radOffset = 0.0\n        for rock in rocks:\n            \n            # dist = rs.Distance(rock, pointOnCylinder) + 4\n            distY = rock[0] - z\n            distX = shortest_angle_distance(rock[1], angle) * radius_mm\n            dist = math.sqrt(distX * distX + distY * distY)\n\n            ripplePeak = rock[2]\n            rippleAttack = ripplePeak * 0.3\n            rippleDecay = ripplePeak * 2.5\n\n            wavelength = wavelengthStart + dist * wavelengthMultiplier\n\n            if (dist < rippleDecay and dist > rippleAttack):\n                waveForm = math.sin(dist / wavelength + rock[3]) * amplitude\n                if (dist < ripplePeak):\n                    radOffset += easeInOutSine(dist - rippleAttack, 0, waveForm, ripplePeak - rippleAttack)\n                else:\n                    radOffset += easeInOutSine(rippleDecay - dist, 0, waveForm, rippleDecay - ripplePeak)\n                    \n        x2 = (radius_mm + radOffset) * math.cos(angle)\n        y2 = (radius_mm + radOffset) * math.sin(angle)\n        points.append([x2,y2,z])\n\n        x2 = (radius_mm + radOffset - 1) * math.cos(angle)\n        y2 = (radius_mm + radOffset - 1) * math.sin(angle)\n        points2.append([x2,y2,z])\n\n    curves.append(rs.AddInterpCurve(points))\n    curves2.append(rs.AddInterpCurve(points2))\n\nsurf = rs.AddLoftSrf(curves)\nsurf2 = rs.AddLoftSrf(curves2)\nrs.DeleteObjects(curves)\nrs.DeleteObjects(curves2)\n\ncyl = rs.AddCylinder([0,0,0], height, radius_mm + 10)\n\n# parts = rs.BooleanSplit(cyl, (surf, surf2)) # this method doesn't exist?\n# rs.DeleteObjects(parts[0], parts[2])\n\n# Offsetting without z distortion would be nice. This is close but not quite right: \n# ...Could trim off the top and bottom of the cylinder...  \n# rs.OffsetSurface(surf, 1, -0.1, False, True)\n\ncollarOffset = 68\ncollar = rs.AddCylinder([0,0,collarOffset], 8, 28)\nhole = rs.AddCylinder([0,0,collarOffset], 8, 20.5)\ncollar = rs.BooleanDifference(collar, hole)\n\nnumSpokes = 12\nspokeThickness = 2.2\nspokeRadius = radius_mm + 10\nspokes = []\nfor i in range(numSpokes):\n    spoke = box2pt([spokeThickness / -2, 27, collarOffset], [spokeThickness / 2, spokeRadius, collarOffset + 8])\n    rs.CurrentView(\"Right\") # This can oddly affect the ShearObject function\n    rs.ShearObject(spoke, [0,27,0], [0, spokeRadius, 0], -45)\n    rs.RotateObject(spoke, [0,0,collarOffset], i * 360 / numSpokes, [0,0,1])\n    spokes.append(spoke)\n\nspokes.append(collar)\nrs.BooleanUnion(spokes)\n\nrs.ViewDisplayMode(\"Perspective\", \"Shaded\")\nrs.ViewDisplayMode(\"Perspective\", \"Rendered\")\n",
  "language": "python",
  "imports": [
    "rhinoscriptsyntax"
  ],
  "has_docstring": false
}