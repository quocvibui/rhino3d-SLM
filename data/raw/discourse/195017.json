{
  "source_url": "https://discourse.mcneel.com/t/find-block-explode-group/195017",
  "topic_id": 195017,
  "title": "Find block & explode & group",
  "question": "Hi all, I did a short script in python in Rhino 5 before. It works in Rhino 5, but for some reason it doesn’t work in Rhino 7. I am not sure what’s wrong… Hope you can help, thanks\n\nThe script is as below:\n\nimport rhinoscriptsyntax as rs\n\nimport scriptcontext\n\n\ndef explodeBlocks():\n\n\nrs.Command(\"_SelBlockInstance\")\nBlocks = rs.GetObjects(\"Pick Blocks\",4096,False,True,False)\n\nif Blocks is None:return\n\nfor b in Blocks:\n    \n    if scriptcontext.escape_test(False):    #Break if press 'ESC'\n        break\n    \n    rs.SelectObject(b)\n    rs.Command(\"_ExplodeBlock\")\n    rs.Command(\"_SelLast\")\n    item = rs.GetObjects(\"Pick items\",0,False,True,True)\n    if len(item) == 1:continue     #if the block has one item only,then don't group\n    rs.Command(\"_Group\")\n    rs.Command(\"_SelNone\")\n    \n    if scriptcontext.escape_test(False):    #Break if user press 'ESC'\n        break\nrs.Command(\"_SelAll\")\nrs.ZoomSelected()\n\n\n\nexplodeBlocks()\n\n\nimage\n1108×884 82.2 KB",
  "code_blocks": [
    {
      "code": "rs.Command(\"_SelBlockInstance\")\nBlocks = rs.GetObjects(\"Pick Blocks\",4096,False,True,False)\n\nif Blocks is None:return\n\nfor b in Blocks:\n    \n    if scriptcontext.escape_test(False):    #Break if press 'ESC'\n        break\n    \n    rs.SelectObject(b)\n    rs.Command(\"_ExplodeBlock\")\n    rs.Command(\"_SelLast\")\n    item = rs.GetObjects(\"Pick items\",0,False,True,True)\n    if len(item) == 1:continue     #if the block has one item only,then don't group\n    rs.Command(\"_Group\")\n    rs.Command(\"_SelNone\")\n    \n    if scriptcontext.escape_test(False):    #Break if user press 'ESC'\n        break\nrs.Command(\"_SelAll\")\nrs.ZoomSelected()",
      "language": "python",
      "author": "Jack_Zeng",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "file-io",
    "python",
    "rhinoscriptsyntax",
    "selection"
  ],
  "has_accepted_answer": false,
  "category_id": 11,
  "posts_count": 4,
  "views": 110
}