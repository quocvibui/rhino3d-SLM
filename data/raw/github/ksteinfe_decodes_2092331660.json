{
  "source_url": "https://github.com/ksteinfe/decodes/blob/b876d6d01ea23ccbf4558182582a822b008cf2b8/src/decodes/io/rhinoscript/group.py",
  "repo": "ksteinfe/decodes",
  "repo_stars": 43,
  "repo_description": "a platform agnostic generative design library for 3d designers",
  "license": "GPL-3.0",
  "filepath": "src/decodes/io/rhinoscript/group.py",
  "instruction": null,
  "code": "import scriptcontext\nfrom . import utility as rhutil\n\ndef AddGroup(group_name=None):\n    \"\"\"Adds a new empty group to the document\n    Parameters:\n      group_name[opt] = name of the new group. If omitted, rhino automatically\n          generates the group name\n    Returns:\n      name of the new group if successful\n      None is not successful or on error\n    \"\"\"\n    index = -1\n    if group_name is None:\n        index = scriptcontext.doc.Groups.Add()\n    else:\n        if not isinstance(group_name, str): group_name = str(group_name)\n        index = scriptcontext.doc.Groups.Add( group_name )\n    rc = scriptcontext.doc.Groups.GroupName(index)\n    if rc is None: return scriptcontext.errorhandler()\n    return rc\n\n\ndef AddObjectsToGroup(object_ids, group_name):\n    \"\"\"Adds one or more objects to an existing group.\n    Parameters:\n      object_ids = list of Strings or Guids representing the object identifiers\n      group_name = the name of an existing group\n    Returns:\n      number of objects added to the group\n    \"\"\"\n    if not isinstance(group_name, str): group_name = str(group_name)\n    index = scriptcontext.doc.Groups.Find(group_name, True)\n    object_ids = rhutil.coerceguidlist(object_ids)\n    if index<0 or not object_ids: return 0\n    if not scriptcontext.doc.Groups.AddToGroup(index, object_ids): return 0\n    return len(object_ids)\n\n\ndef AddObjectToGroup(object_id, group_name):\n    \"\"\"Adds a single object to an existing group.\n    Parameters:\n      object_id = String or Guid representing the object identifier\n      group_name = the name of an existing group\n    Returns:\n      True or False representing success or failure\n    \"\"\"\n    object_id = rhutil.coerceguid(object_id)\n    if not isinstance(group_name, str): group_name = str(group_name)\n    index = scriptcontext.doc.Groups.Find(group_name, True)\n    if object_id is None or index<0: return False\n    return scriptcontext.doc.Groups.AddToGroup(index, object_id)\n\n\ndef DeleteGroup(group_name):\n    \"\"\"Removes an existing group from the document. Reference groups cannot be\n    removed. Deleting a group does not delete the member objects\n    Parameters:\n      group_name = the name of an existing group\n    Returns:\n      True or False representing success or failure\n    \"\"\"\n    if not isinstance(group_name, str): group_name = str(group_name)\n    index = scriptcontext.doc.Groups.Find(group_name, True)\n    return scriptcontext.doc.Groups.Delete(index)\n\n\ndef GroupCount():\n    \"Returns the number of groups in the document\"\n    return scriptcontext.doc.Groups.Count\n\n\ndef GroupNames():\n    \"\"\"Returns the names of all the groups in the document\n    None if no names exist in the document\n    \"\"\"\n    names = scriptcontext.doc.Groups.GroupNames(True)\n    if names is None: return None\n    return list(names)\n\n\ndef HideGroup(group_name):\n    \"\"\"Hides a group of objects. Hidden objects are not visible, cannot be\n    snapped to, and cannot be selected\n    Parameters:\n      group_name = the name of an existing group\n    Returns:\n      The number of objects that were hidden\n    \"\"\"\n    index = scriptcontext.doc.Groups.Find(group_name, True)\n    if index<0: return 0\n    return scriptcontext.doc.Groups.Hide(index);\n\n\ndef IsGroup(group_name):\n    \"\"\"Verifies the existance of a group\n    Paramters:\n      group_name = the name of the group to check for\n    Returns:\n      True or False\n    \"\"\"\n    if not isinstance(group_name, str): group_name = str(group_name)\n    return scriptcontext.doc.Groups.Find(group_name, True)>=0\n\n\ndef IsGroupEmpty(group_name):\n    \"\"\"Verifies that an existing group is empty, or contains no object members\n    Parameters:\n      group_name = the name of an existing group\n    Returns:\n      True or False if group_name exists\n      None if group_name does not exist\n    \"\"\"\n    if not isinstance(group_name, str): group_name = str(group_name)\n    index = scriptcontext.doc.Groups.Find(group_name, True)\n    if index<0: return scriptcontext.errorhandler()\n    return scriptcontext.doc.Groups.GroupObjectCount(index)>0\n\n\ndef LockGroup(group_name):\n    \"\"\"Locks a group of objects. Locked objects are visible and they can be\n    snapped to. But, they cannot be selected\n    Parameters:\n      group_name = the name of an existing group\n    Returns:\n      Number of objects that were locked if successful\n      None on error\n    \"\"\"\n    if not isinstance(group_name, str): group_name = str(group_name)\n    index = scriptcontext.doc.Groups.Find(group_name, True)\n    if index<0: return scriptcontext.errorhandler()\n    return scriptcontext.doc.Groups.Lock(index);\n\n\ndef RemoveObjectFromAllGroups(object_id):\n    \"\"\"Removes a single object from any and all groups that it is a member.\n    Neither the object nor the group can be reference objects\n    Parameters:\n      object_id = the object identifier\n    Returns:\n      True or False indicating success or failure\n    \"\"\"\n    rhinoobject = rhutil.coercerhinoobject(object_id, True, True)\n    if rhinoobject.GroupCount<1: return False\n    attrs = rhinoobject.Attributes\n    attrs.RemoveFromAllGroups()\n    return scriptcontext.doc.Objects.ModifyAttributes(rhinoobject, attrs, True)\n\n\ndef RemoveObjectFromGroup(object_id, group_name):\n    \"\"\"Remove a single object from an existing group\n    Parameters:\n      object_id = the object identifier\n      group_name = the name of an existing group\n    Returns:\n      True or False indicating success or failure\n    \"\"\"\n    count = RemoveObjectsFromGroup(object_id, group_name)\n    return not (count is None or count<1)\n\n\ndef RemoveObjectsFromGroup(object_ids, group_name):\n    \"\"\"Removes one or more objects from an existing group\n    Parameters:\n      object_ids = a list of object identifiers\n      group_name = the name of an existing group\n    Returns:\n      The number of objects removed from the group is successful\n      None on error\n    \"\"\"\n    if not isinstance(group_name, str): group_name = str(group_name)\n    index = scriptcontext.doc.Groups.Find(group_name, True)\n    if index<0: return scriptcontext.errorhandler()\n    id = rhutil.coerceguid(objects_ids, False)\n    if id: object_ids = [id]\n    objects_removed = 0\n    for id in object_ids:\n        rhinoobject = rhutil.coercerhinoobject(id, True, True)\n        attrs = rhinoobject.Attributes\n        attrs.RemoveFromGroup(index)\n        if scriptcontext.doc.Objects.ModifyAttributes(rhinoobject, attrs, True):\n            objects_removed+=1\n    return objects_removed\n\n\ndef RenameGroup(old_name, new_name):\n    \"\"\"Renames an existing group\n    Parameters:\n      old_name = the name of an existing group\n      new_name = the new group name\n    Returns:\n      the new group name if successful\n      None on error\n    \"\"\"\n    if not isinstance(old_name, str): old_name = str(old_name)\n    index = scriptcontext.doc.Groups.Find(old_name, True)\n    if index<0: return scriptcontext.errorhandler()\n    if not isinstance(new_name, str): new_name = str(new_name)\n    if scriptcontext.doc.Groups.ChangeGroupName(index, new_name):\n        return new_name\n    return scriptcontext.errorhandler()\n\n\ndef ShowGroup(group_name):\n    \"\"\"Shows a group of previously hidden objects. Hidden objects are not\n    visible, cannot be snapped to, and cannot be selected\n    Parameters:\n      group_name = the name of an existing group\n    Returns:\n      The number of objects that were shown if successful\n      None on error  \n    \"\"\"\n    if not isinstance(group_name, str): group_name = str(group_name)\n    index = scriptcontext.doc.Groups.Find(group_name, True)\n    if index<0: return scriptcontext.errorhandler()\n    return scriptcontext.doc.Groups.Show(index);\n\n\ndef UnlockGroup(group_name):\n    \"\"\"Unlocks a group of previously locked objects. Lockes objects are visible,\n    can be snapped to, but cannot be selected\n    Parameters:\n      group_name = the name of an existing group\n    Returns:\n      The number of objects that were unlocked if successful\n      None on error  \n    \"\"\"\n    if not isinstance(group_name, str): group_name = str(group_name)\n    index = scriptcontext.doc.Groups.Find(group_name, True)\n    if index<0: return scriptcontext.errorhandler()\n    return scriptcontext.doc.Groups.Unlock(index);\n",
  "language": "python",
  "imports": [
    "scriptcontext"
  ],
  "has_docstring": false
}