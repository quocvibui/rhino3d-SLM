{
  "source_url": "https://github.com/CADacombs/rhinopython/blob/541b4ade49f1dda6a3861d12b9e2613405182082/spb_RhinoObject_MemoryEstimate.py",
  "repo": "CADacombs/rhinopython",
  "repo_stars": 37,
  "repo_description": "Python scripts for Rhinoceros (Rhino, Rhino3D).",
  "license": "LGPL-3.0",
  "filepath": "spb_RhinoObject_MemoryEstimate.py",
  "instruction": "All memory sizes are output in MB.\r\nSize of each block definition is only obtained and added once.",
  "code": "\"\"\"\r\nAll memory sizes are output in MB.\r\nSize of each block definition is only obtained and added once.\r\n\"\"\"\r\n\r\n#! python 2  Must be on a line number less than 32.\r\nfrom __future__ import absolute_import, division, print_function, unicode_literals\r\n\r\n\"\"\"\r\n200603: Created.\r\n250130: Now, input of Nothing will select all normal breps. Added information to printed report.\r\n\"\"\"\r\n\r\nimport Rhino\r\nimport Rhino.DocObjects as rd\r\nimport Rhino.Geometry as rg\r\nimport scriptcontext as sc\r\n\r\n\r\ndef _getAllNormalObjects():\r\n    oes = rd.ObjectEnumeratorSettings()\r\n    oes.LockedObjects = False # Default is True.\r\n    return list(sc.doc.Objects.GetObjectList(oes))\r\n\r\n\r\ndef _getMemoryEstimate(rhObj):\r\n    if isinstance(rhObj, rd.InstanceObject):\r\n        iME = 0\r\n        rdInstDef = rhObj.InstanceDefinition\r\n        for rgO in rdInstDef.GetObjects():\r\n            uint_MEs_ThisObj = _getMemoryEstimate(rgO)\r\n            iME += uint_MEs_ThisObj\r\n        return iME\r\n    else:\r\n        return rhObj.MemoryEstimate()\r\n\r\n\r\ndef main():\r\n\r\n    res, objrefs = Rhino.Input.RhinoGet.GetMultipleObjects(\r\n        \"Select objects <All normal>\",\r\n        acceptNothing=True,\r\n        filter=rd.ObjectType.AnyObject)\r\n\r\n    if res == Rhino.Commands.Result.Cancel: return\r\n\r\n    if objrefs:\r\n        rdObjs = [_.Object() for _ in objrefs]\r\n    else:\r\n        rdObjs = _getAllNormalObjects()\r\n\r\n    iMB_Divisor = 1024**2\r\n\r\n    uint_MEs_Total = 0\r\n\r\n    sDef_Names = []\r\n\r\n    for rdO in rdObjs:\r\n        if isinstance(rdO, rd.InstanceObject):\r\n            # Size of each block definition is only obtained and added once.\r\n            rdInstDef = rdO.InstanceDefinition\r\n            if rdInstDef.Name in sDef_Names:\r\n                continue\r\n            else:\r\n                sDef_Names.append(rdInstDef.Name)\r\n\r\n        uint_MEs_ThisObj = _getMemoryEstimate(rdO)\r\n\r\n        if len(rdObjs) < 11:\r\n            print(\"{:.3f} MB in {}\".format(\r\n                uint_MEs_ThisObj/iMB_Divisor,\r\n                rdO.GetType().Name))\r\n\r\n        uint_MEs_Total += uint_MEs_ThisObj\r\n\r\n    if len(rdObjs) > 1:\r\n        print(\"Total: {:.3f} MB in {} objects.\".format(\r\n            uint_MEs_Total/iMB_Divisor,\r\n            len(rdObjs)))\r\n\r\n\r\nif __name__ == '__main__': main()",
  "language": "python",
  "imports": [
    "Rhino",
    "Rhino.Geometry",
    "scriptcontext"
  ],
  "has_docstring": true
}