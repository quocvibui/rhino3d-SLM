{
  "source_url": "https://github.com/cadop/dhart/blob/0d9627783b04b974fb130ab70c9135fb624e725f/src/Python/dhart/Examples/Rhino/RhinoDisplayViewAnalysis.py",
  "repo": "cadop/dhart",
  "repo_stars": 15,
  "repo_description": "A library for creating Navigation Graphs, Visibility graphs, Raycasting used in design analysis, architecture, robotics, and human factors.",
  "license": "GPL-3.0",
  "filepath": "src/Python/dhart/Examples/Rhino/RhinoDisplayViewAnalysis.py",
  "instruction": "Rhino display view analysis",
  "code": "import rhinoscriptsyntax as rs\nimport json\nimport scriptcontext as sc\nimport Rhino\nfrom colorsys import hsv_to_rgb, rgb_to_hsv\nfrom System.Drawing import Color\nfrom Rhino.Display import PointStyle, ColorHSV\n\n\npoint_style = PointStyle.Circle\nPoint3d = Rhino.Geometry.Point3d\ncolor = Color.Cyan\nradius = 7\n\nclass json_graph:\n    def __init__(self, nodes, edges):\n        self.nodes = nodes\n        self.edges = edges\n\n    def getEdges(self):\n        return [\n            (self.nodes[edge[0]],\n            self.nodes[edge[1]])\n            for edge in self.edges\n        ]\n\ndef decode_json(filepath):\n    try:\n        with open(filepath) as in_path:\n            json_dict = json.load(in_path)\n    except:\n        print(\"FAIL\")\n        exit()\n\n    return json_dict\n\ndef SetupDisplay():\n    # Check to see if the display was created yet, if not make a new one\n    if \"display2\" not in sc.sticky:\n        print('display Not in sticky')\n        sc.sticky[\"display2\"] = Rhino.Display.CustomDisplay(True)# Get the display from sticky context then clear it\n    \n    display = sc.sticky[\"display2\"]\n    display.Clear()\n    # display.Enabled = False\n    return display\n\ndef calcColors(Scores):\n    Colors = []\n    max_v = max(Scores)\n    min_v = min(Scores)\n    print('maxmin')\n    print(max_v)\n    print(min_v)\n    print('')\n    for point in Scores:\n        #scaling the point set\n        try: normalized = (point-min_v)/(max_v-min_v)\n        except: normalized = 0\n        color= colorbar(normalized)\n        Colors.append(color)\n    return Colors\n\ndef colorbar(val):\n    \n    r = min(max(0, 1.5-abs(1-4*(val-0.5))),1)\n    g = min(max(0, 1.5-abs(1-4*(val-0.25))),1)\n    b = min(max(0, 1.5-abs(1-4*val)),1)            #conver to hsv?\n    tmp_color = rgb_to_hsv(r*255,g*255,b*255)\n    return ColorHSV(tmp_color[0],tmp_color[1],tmp_color[2])\n    #return (tmp_color[0],tmp_color[1],tmp_color[2])\n\n\njson_path = \".\\\\dhart\\\\dhart\\\\Examples\\\\out_vg_score.json\"\npush_off = 120\n\n\nin_json = decode_json(json_path)\njg = json_graph(in_json[\"nodes\"], in_json[\"edges\"])\ncolors = calcColors(in_json[\"vg_count\"])\n\ndisplay = SetupDisplay()\n\nfor node, scored_color in zip(jg.nodes, colors):\n    node_to_add = Point3d(node[0], node[1], node[2]+push_off)\n    display.AddPoint(node_to_add, scored_color, point_style, radius)\n",
  "language": "python",
  "imports": [
    "Rhino",
    "Rhino.Geometry",
    "rhinoscriptsyntax",
    "scriptcontext"
  ],
  "has_docstring": false
}