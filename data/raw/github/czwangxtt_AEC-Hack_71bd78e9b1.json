{
  "source_url": "https://github.com/czwangxtt/AEC-Hack/blob/ea37ba9dd33431ffbcda31359afe5b1dae26b8a1/rhino-ui/ui.py",
  "repo": "czwangxtt/AEC-Hack",
  "repo_stars": 1,
  "repo_description": null,
  "license": "unknown",
  "filepath": "rhino-ui/ui.py",
  "instruction": null,
  "code": "import Rhino\nimport rhinoscriptsyntax as rs\nimport scriptcontext as sc\nimport traceback\n\n\nimport Eto\n\nimport os\nFORM_KEY = 'AECademy_modeless_form'\nBIN_FOLDER = \"{}\\\\bin\".format(os.path.dirname(os.path.realpath(__file__)))\nimport sys\nsys.path.append(os.path.dirname(os.path.realpath(__file__)))\nsys.path.append(BIN_FOLDER)\nimport utility\nreload(utility)\n\n\ndef try_catch(func):\n    def wrapper(*args, **kwargs):\n        try:\n            return func(*args, **kwargs)\n        except Exception as e:\n            rs.TextOut(traceback.format_exc())\n            return None\n        \n    return wrapper\n\n\nclass AECedamyUI(Eto.Forms.Form):\n\n    # Initializer\n    @try_catch\n    def __init__(self):\n \n        self.data = None\n        self.main_url = \"https://github.com/zsenarchitect/AEC-Hack\"\n        \n        \n        # Basic form initialization\n        self.initiate_form()\n        # Create the form's controls\n        self.build_form()\n        \n        self.check_ui()\n\n\n    # Basic form initialization\n    def initiate_form(self):\n        self.Title = 'AECademy'\n        self.Padding = Eto.Drawing.Padding(5)\n        self.Resizable = True\n        self.Maximizable = False\n        self.Minimizable = False\n        self.ShowInTaskbar = False\n        \n        self.MinimumSize = Eto.Drawing.Size(200, 150)\n        \n        \n        \n        # self.resource_folder = \"{}\\\\bin\".format(Path.cwd().parent)\n        self.resource_folder = BIN_FOLDER\n\n        # FormClosed event handler\n        self.Closed += self.form_close_clicked\n\n    \n    # Create all of the controls used by the form\n    def build_form(self):\n        # Create table layout\n        layout = Eto.Forms.TableLayout()\n        layout.Padding = Eto.Drawing.Padding(10)\n        layout.Spacing = Eto.Drawing.Size(5, 5)\n\n        layout.Rows.Add(self.build_logo())\n        \n        A = Eto.Forms.Label(Text = 'Search Database with your sketch!\\nScan QR code below to begin sketching!' )\n        A.TextColor = Eto.Drawing.Color.FromArgb(255, 255, 255)\n        # A.Font = Eto.Drawing.Font(size = 20)\n        # A.HorizontalAlignment = Eto.Forms.HorizontalAlignment.Center\n        # A.FontFamily = Eto.Drawing.FontFamily(\"Cascadia Mono\")\n        layout.Rows.Add(A)\n        layout.Rows.Add(self.build_qr_code())\n        layout.Rows.Add(Rhino.UI.Controls.Divider())\n        layout.Rows.Add(self.create_user_buttons())\n        \n        layout.BackgroundColor = Eto.Drawing.Color.FromArgb(0, 0, 0)\n        \n        # Set the content\n        self.Content = layout\n\n            \n    def build_logo(self):\n        self.logo = Eto.Forms.ImageView()\n        logo_path = r\"{}\\\\logo.png\".format(self.resource_folder)\n        temp_bitmap = Eto.Drawing.Bitmap(logo_path)\n        self.logo.Image = temp_bitmap.WithSize(200,200)\n        return self.logo\n\n\n    def build_qr_code(self):\n        layout = Eto.Forms.TableLayout(Spacing = Eto.Drawing.Size(5, 5))\n        self.qr_code = Eto.Forms.ImageView()\n        qr_code_path = r\"{}\\\\QR.png\".format(self.resource_folder)\n        temp_bitmap = Eto.Drawing.Bitmap(qr_code_path)\n        self.qr_code.Image = temp_bitmap.WithSize(100,100)\n        \n        bt_open_url = Eto.Forms.Button(Text = ' Open In Browser ')\n        bt_open_url.Click += self.open_url_clicked\n        bt_open_url.BackgroundColor = Eto.Drawing.Color.FromArgb(50,50,50)\n        bt_open_url.TextColor = Eto.Drawing.Color.FromArgb(255, 255, 255)\n        \n        layout.Rows.Add(Eto.Forms.TableRow(None, self.qr_code, None))\n        layout.Rows.Add(Eto.Forms.TableRow(None, bt_open_url, None))\n        return layout\n\n\n    def create_user_buttons(self):\n        # Action button, func TBD\n        self.bt_action = Eto.Forms.Button(Text = ' Aquire! ')\n        self.bt_action.Click += self.action_bt_clicked\n        self.bt_action.BackgroundColor = Eto.Drawing.Color.FromArgb(50,50,50)\n        self.bt_action.TextColor = Eto.Drawing.Color.FromArgb(255, 255, 255)\n        \n        bt_fetch = Eto.Forms.Button(Text = ' Get Update! ')\n        bt_fetch.Click += self.fetch_bt_clicked\n        bt_fetch.BackgroundColor = Eto.Drawing.Color.FromArgb(50,50,50)\n        bt_fetch.TextColor = Eto.Drawing.Color.FromArgb(255, 255, 255)\n\n\n        self.bt_upload = Eto.Forms.Button(Text = ' Publish! ')\n        self.bt_upload.Click += self.fetch_bt_clicked\n        self.bt_upload.BackgroundColor = Eto.Drawing.Color.FromArgb(50,50,50)\n        self.bt_upload.TextColor = Eto.Drawing.Color.FromArgb(255, 255, 255)\n        \n        \n        layout = Eto.Forms.TableLayout(Spacing = Eto.Drawing.Size(5, 5))\n        layout.Rows.Add(Eto.Forms.TableRow(None,bt_fetch, self.bt_action, self.bt_upload, None))\n        return layout\n\n    def check_ui(self):\n        if self.data:\n            self.bt_action.Enabled = True\n            self.bt_action.BackgroundColor = Eto.Drawing.Color.FromArgb(50,50,50)\n            self.bt_upload.Enabled = True\n            self.bt_upload.BackgroundColor = Eto.Drawing.Color.FromArgb(50,50,50)\n        else:\n            self.bt_action.Enabled = False\n            self.bt_action.BackgroundColor = Eto.Drawing.Color.FromArgb(100 ,200,200)\n            self.bt_upload.Enabled = True\n            self.bt_upload.BackgroundColor = Eto.Drawing.Color.FromArgb(100,150,150)\n\n    @try_catch\n    def action_bt_clicked(self, sender, e):\n        self.check_ui()\n        if not self.data:\n            return\n        print (\"importing\")\n        utility.import_to_rhino(self.data)\n        \n        \n    @try_catch\n    def open_url_clicked(self, sender, e):\n        import webbrowser\n        webbrowser.open(self.main_url)\n        \n    @try_catch\n    def fetch_bt_clicked(self, sender, e):\n        print (\"fetching\")\n        self.data = utility.fetch_from_web()\n        self.check_ui()\n        \n        \n    @try_catch\n    def form_close_clicked(self, sender, e):\n\n        # Dispose of the form and remove it from the sticky dictionary\n        if sc.sticky.has_key(FORM_KEY):\n            form = sc.sticky[FORM_KEY]\n            if form:\n                form.Dispose()\n                form = None\n            sc.sticky.Remove(FORM_KEY)\n            \n\n@try_catch\ndef show_ui():\n    # See if the form is already visible\n    if sc.sticky.has_key(FORM_KEY):\n        return\n        \n\n    # Create and show form\n    form = AECedamyUI()   \n    form.Owner = Rhino.UI.RhinoEtoApp.MainWindow\n    form.Show()\n    sc.sticky[FORM_KEY] = form\n\n\n######################  main code below   #########\nif __name__ == \"__main__\":\n\n    show_ui()\n\n\n",
  "language": "python",
  "imports": [
    "Rhino",
    "rhinoscriptsyntax",
    "scriptcontext"
  ],
  "has_docstring": false
}