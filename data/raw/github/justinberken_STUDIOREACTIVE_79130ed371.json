{
  "source_url": "https://github.com/justinberken/STUDIOREACTIVE/blob/0cbd908a9930187288c3438cd7f80e40145631e1/scripts/MULTI_LINE_ORIENT.py",
  "repo": "justinberken/STUDIOREACTIVE",
  "repo_stars": 0,
  "repo_description": "STUDIO REACTIVE LLC WEBSITE",
  "license": "unknown",
  "filepath": "scripts/MULTI_LINE_ORIENT.py",
  "instruction": "MULTI LINE ORIENT\nOrients a group of objects from a single reference line onto multiple target lines.\nWorks like 2-point orient but for multiple targets at once.",
  "code": "\"\"\"\nMULTI LINE ORIENT\nOrients a group of objects from a single reference line onto multiple target lines.\nWorks like 2-point orient but for multiple targets at once.\n\nUsage:\n1. Select the objects to orient\n2. Select the reference/source line\n3. Select the target lines\n4. Objects will be copied and oriented to each target line\n\"\"\"\n\nimport rhinoscriptsyntax as rs\nimport Rhino.Geometry as rg\nimport scriptcontext as sc\n\ndef get_line_endpoints(curve_id):\n    \"\"\"Get the start and end points of a curve/line.\"\"\"\n    start = rs.CurveStartPoint(curve_id)\n    end = rs.CurveEndPoint(curve_id)\n    return start, end\n\ndef orient_objects_to_line(object_ids, source_start, source_end, target_start, target_end, copy=True):\n    \"\"\"\n    Orient objects from source line to target line using 2-point orientation.\n    Returns the IDs of the oriented objects (copies if copy=True).\n    \"\"\"\n    # Create the transformation\n    # We need to:\n    # 1. Move from source_start to target_start\n    # 2. Rotate to align source direction with target direction\n    # 3. Scale if the lines are different lengths\n    \n    source_vec = rs.VectorCreate(source_end, source_start)\n    target_vec = rs.VectorCreate(target_end, target_start)\n    \n    source_length = rs.VectorLength(source_vec)\n    target_length = rs.VectorLength(target_vec)\n    \n    if source_length == 0 or target_length == 0:\n        print(\"Error: Zero length line detected\")\n        return None\n    \n    # Normalize vectors\n    source_unit = rs.VectorUnitize(source_vec)\n    target_unit = rs.VectorUnitize(target_vec)\n    \n    # Calculate scale factor\n    scale_factor = target_length / source_length\n    \n    # Build transformation matrix\n    # Step 1: Move source_start to origin\n    xform_to_origin = rg.Transform.Translation(-source_start[0], -source_start[1], -source_start[2])\n    \n    # Step 2: Scale uniformly\n    xform_scale = rg.Transform.Scale(rg.Point3d.Origin, scale_factor)\n    \n    # Step 3: Rotate from source direction to target direction\n    source_vec_rg = rg.Vector3d(source_unit[0], source_unit[1], source_unit[2])\n    target_vec_rg = rg.Vector3d(target_unit[0], target_unit[1], target_unit[2])\n    xform_rotate = rg.Transform.Rotation(source_vec_rg, target_vec_rg, rg.Point3d.Origin)\n    \n    # Step 4: Move origin to target_start\n    xform_to_target = rg.Transform.Translation(target_start[0], target_start[1], target_start[2])\n    \n    # Combine transformations (order matters: apply right to left)\n    xform_combined = xform_to_target * xform_rotate * xform_scale * xform_to_origin\n    \n    # Apply transformation\n    if copy:\n        new_ids = rs.CopyObjects(object_ids)\n        rs.TransformObjects(new_ids, xform_combined)\n        return new_ids\n    else:\n        rs.TransformObjects(object_ids, xform_combined)\n        return object_ids\n\ndef main():\n    # Step 1: Select objects to orient\n    object_ids = rs.GetObjects(\"Select objects to orient\", preselect=True)\n    if not object_ids:\n        print(\"No objects selected. Exiting.\")\n        return\n    \n    print(\"Selected {} object(s)\".format(len(object_ids)))\n    \n    # Step 2: Select the reference/source line\n    source_line = rs.GetObject(\"Select the REFERENCE line (source)\", rs.filter.curve)\n    if not source_line:\n        print(\"No reference line selected. Exiting.\")\n        return\n    \n    source_start, source_end = get_line_endpoints(source_line)\n    print(\"Reference line: {} to {}\".format(source_start, source_end))\n    \n    # Step 3: Select target lines\n    target_lines = rs.GetObjects(\"Select TARGET lines\", rs.filter.curve)\n    if not target_lines:\n        print(\"No target lines selected. Exiting.\")\n        return\n    \n    print(\"Selected {} target line(s)\".format(len(target_lines)))\n    \n    # Step 4: Ask user if they want to copy or move\n    copy_option = rs.GetString(\"Copy objects to targets?\", \"Yes\", [\"Yes\", \"No\"])\n    make_copies = (copy_option != \"No\")\n    \n    # Step 5: Orient objects to each target line\n    rs.EnableRedraw(False)\n    \n    all_new_objects = []\n    success_count = 0\n    \n    for i, target_line in enumerate(target_lines):\n        target_start, target_end = get_line_endpoints(target_line)\n        \n        # Always copy for all targets except possibly the last one if not copying\n        should_copy = make_copies or (i < len(target_lines) - 1)\n        \n        result = orient_objects_to_line(\n            object_ids,\n            source_start, source_end,\n            target_start, target_end,\n            copy=should_copy\n        )\n        \n        if result:\n            if should_copy:\n                all_new_objects.extend(result)\n            success_count += 1\n            print(\"Oriented to target line {} of {}\".format(i + 1, len(target_lines)))\n    \n    rs.EnableRedraw(True)\n    \n    print(\"\\n=== COMPLETE ===\")\n    print(\"Successfully oriented objects to {} target line(s)\".format(success_count))\n    if all_new_objects:\n        print(\"Created {} new object(s)\".format(len(all_new_objects)))\n        rs.SelectObjects(all_new_objects)\n\nif __name__ == \"__main__\":\n    main()\n",
  "language": "python",
  "imports": [
    "Rhino",
    "Rhino.Geometry",
    "rhinoscriptsyntax",
    "scriptcontext"
  ],
  "has_docstring": true
}