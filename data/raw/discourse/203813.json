{
  "source_url": "https://discourse.mcneel.com/t/create-named-clipping-plane/203813",
  "topic_id": 203813,
  "title": "Create Named Clipping Plane?",
  "question": "Hello,\n\n\nI’m successfully creating a Clipping Plane in the model but failing to set its name attribute to my name argument.\n\n\nI simply want to be able to call my function “CreateClippingPlane” and pass an optional name and height argument. The height arg is working. The name is not.\n\n\nThanks in advance for your help!\n\n\nHere’s my code so far:\n\n\n    def CreateClippingPlane(name=None, height=None):\n        \"\"\"Create a new, named clipping plane at specified height\"\"\"\n        try:\n            view = UI.viewport\n            viewport = view.ActiveViewport\n\n            print(\"CreateClippingPlane Call\")\n            # Check if a clipping plane matching the name already exists\n            existing_clipping_planes = Display.GetAllClippingPlanes()\n\n            if existing_clipping_planes is not None:\n                # print(f\"existing_clipping_planes: {existing_clipping_planes}\")\n                for cp in existing_clipping_planes:\n                    print(f\"existing clipping plane name: {cp.Name}\")\n                    if cp.Name == name:\n                        print(f\"clipping plane matching named: '{name}' already exists!\")\n                        return\n\n                print(f\"no clipping plane matching name: {name} found...\")\n\n            print(\"no clipping planes found in document\")\n\n            # If matching clipping plane is not found or none exist in document, continue\n            height_plane = Plane(Point3d(0, 0, height), Vector3d(0, 0, -1))\n\n            # cp_attr = Rhino.DocObjects.ObjectAttributes()\n            # cp_attr.Name = name  # Set the clipping plane name to the user passed name above\n            \n            # cp_history = Rhino.DocObjects.HistoryRecord()\n\n            clipped_viewports = [viewport.Id]\n\n            cp = scriptcontext.doc.Objects.AddClippingPlane(\n                plane=height_plane,\n                uMagnitude=100,\n                vMagnitude=100,\n                clippedViewportIds=clipped_viewports\n                )\n\n            # cp = script...",
  "code_blocks": [
    {
      "code": "def CreateClippingPlane(name=None, height=None):\n        \"\"\"Create a new, named clipping plane at specified height\"\"\"\n        try:\n            view = UI.viewport\n            viewport = view.ActiveViewport\n\n            print(\"CreateClippingPlane Call\")\n            # Check if a clipping plane matching the name already exists\n            existing_clipping_planes = Display.GetAllClippingPlanes()\n\n            if existing_clipping_planes is not None:\n                # print(f\"existing_clipping_planes: {existing_clipping_planes}\")\n                for cp in existing_clipping_planes:\n                    print(f\"existing clipping plane name: {cp.Name}\")\n                    if cp.Name == name:\n                        print(f\"clipping plane matching named: '{name}' already exists!\")\n                        return\n\n                print(f\"no clipping plane matching name: {name} found...\")\n\n            print(\"no clipping planes found in document\")\n\n            # If matching clipping plane is not found or none exist in document, continue\n            height_plane = Plane(Point3d(0, 0, height), Vector3d(0, 0, -1))\n\n            # cp_attr = Rhino.DocObjects.ObjectAttributes()\n            # cp_attr.Name = name  # Set the clipping plane name to the user passed name above\n            \n            # cp_history = Rhino.DocObjects.HistoryRecord()\n\n            clipped_viewports = [viewport.Id]\n\n            cp = scriptcontext.doc.Objects.AddClippingPlane(\n                plane=height_plane,\n                uMagnitude=100,\n                vMagnitude=100,\n                clippedViewportIds=clipped_viewports\n                )\n\n            # cp = scriptcontext.doc.Objects.AddClippingPlane(\n            #     height_plane,\n            #     100,\n            #     100,\n            #     clipped_viewports,\n            #     cp_attr,\n            #     cp_history\n            #     )\n\n\n            if cp:\n                cp_obj = rs.coercerhinoobject(cp, True, True)\n                cp.Name = name\n                # cp_obj.AddClipViewport(viewport, commit=True)\n                # view.Redraw()  # Refresh the viewport\n                print(f\"cp {name} added to viewport {viewport.Name}\")\n            else:\n                print(\"clipping plane not added...\")\n\n\n        except Exception as ex:\n            Rhino.RhinoApp.WriteLine(f\"CreateClippingPlane Exception: {ex}\")",
      "language": "python",
      "author": "michaelvollrath",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "geometry",
    "python"
  ],
  "has_accepted_answer": true,
  "category_id": 3,
  "posts_count": 3,
  "views": 61
}