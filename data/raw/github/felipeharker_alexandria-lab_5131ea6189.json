{
  "source_url": "https://github.com/felipeharker/alexandria-lab/blob/1d3696f4b28ecc45579b5fbe5809a7e00699fa08/alexandria-application-files/alexandria-scripts/ghpython/linear_nest.py",
  "repo": "felipeharker/alexandria-lab",
  "repo_stars": 1,
  "repo_description": "a repo of documents, links, visual assets, drawings, videos, articles, etc. I find interesting. Brain dump, catch-all repo with limited structure. ",
  "license": "unknown",
  "filepath": "alexandria-application-files/alexandria-scripts/ghpython/linear_nest.py",
  "instruction": "Cut stock nesting visualizer (1D) for Grasshopper",
  "code": "# ALEXANDRIA IO SPEC (standardized)\n# Inputs:\n# - CutLengths (GH: L) | list[float] | Requested cut lengths\n# - StockLength (GH: StockLen) | float | Per-stock bar length\n# - RowSpacing (GH: Spacing) | float | Vertical spacing between rows\n# Outputs:\n# - StockLines (GH: StockLines) | list[Rhino.Geometry.Line] | Stock bar lines\n# - CutLines (GH: CutLines) | list[Rhino.Geometry.Line] | Placed cuts as lines\n# - StickIds (GH: StickIds) | list[int] | Stock index per cut\n\n\"\"\"Cut stock nesting visualizer (1D) for Grasshopper\n\nInputs:\n    L        : list[float]  - required cut lengths (same units as StockLen)\n    StockLen : float        - stock length (e.g. 288 for 24')\n    Spacing  : float        - vertical spacing between each stock bar in the drawing\n\nOutputs:\n    StockLines : list[rg.Line] - full-length stock bars\n    CutLines   : list[rg.Line] - one line per cut, positioned on its stock bar\n    StickIds   : list[int]     - index of stock bar for each cut (0-based)\n\"\"\"\n\nimport Rhino.Geometry as rg\n\n# ----------------------------------------------------------------------\n# Initialize outputs\n# ----------------------------------------------------------------------\nStockLines = []\nCutLines = []\nStickIds = []\n\n# ----------------------------------------------------------------------\n# Coerce and validate inputs (no top-level returns)\n# ----------------------------------------------------------------------\n\n# Stock length\nstock_len = 0.0\nif StockLen is not None:\n    try:\n        stock_len = float(StockLen)\n    except:\n        stock_len = 0.0\n\n# Spacing between stock bars\nspacing = 0.0\nif Spacing is not None:\n    try:\n        spacing = float(Spacing)\n    except:\n        spacing = 0.0\n\nif spacing < 0.0:\n    spacing = 0.0\n\n# Collect valid cut lengths\ncuts_raw = []\nif L is not None:\n    for x in L:\n        if x is None:\n            continue\n        try:\n            v = float(x)\n        except:\n            continue\n        if v > 0.0:\n            cuts_raw.append(v)\n\n# If inputs are not usable, do nothing (outputs stay empty)\nif stock_len <= 0.0:\n    # invalid stock length\n    pass\nelif not cuts_raw:\n    # no valid cuts\n    pass\nelse:\n    # ------------------------------------------------------------------\n    # First-Fit Decreasing bin packing (no kerf)\n    # ------------------------------------------------------------------\n\n    # Sort cuts from longest to shortest\n    cuts_sorted = sorted(cuts_raw, reverse=True)\n\n    # Each stick = {'used': float, 'cuts': [lengths]}\n    sticks = []\n\n    for c_len in cuts_sorted:\n        placed = False\n\n        # Try to place in existing sticks\n        for stick in sticks:\n            if stick['used'] + c_len <= stock_len + 1e-6:\n                stick['cuts'].append(c_len)\n                stick['used'] += c_len\n                placed = True\n                break\n\n        # If it did not fit anywhere, start a new stick\n        if not placed:\n            sticks.append({'cuts': [c_len], 'used': c_len})\n\n    # ------------------------------------------------------------------\n    # Generate 2D line geometry\n    # ------------------------------------------------------------------\n\n    for si, stick in enumerate(sticks):\n        # Vertical position for this stock bar\n        y = si * spacing\n\n        # Full stock line\n        stock_start = rg.Point3d(0.0, y, 0.0)\n        stock_end   = rg.Point3d(stock_len, y, 0.0)\n        StockLines.append(rg.Line(stock_start, stock_end))\n\n        # Cuts laid out from left to right along this bar\n        x = 0.0\n        for c_len in stick['cuts']:\n            p0 = rg.Point3d(x, y, 0.0)\n            p1 = rg.Point3d(x + c_len, y, 0.0)\n            CutLines.append(rg.Line(p0, p1))\n            StickIds.append(si)\n            x += c_len\n",
  "language": "python",
  "imports": [
    "Rhino",
    "Rhino.Geometry"
  ],
  "has_docstring": true
}