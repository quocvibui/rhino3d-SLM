{
  "source_url": "https://github.com/ibois-epfl/Manis-timber-plate-joinery-solver/blob/9b0d22db181d4f55f01816440a5c0a31cda502bc/Gh%20compilation%20files/assembly.py",
  "repo": "ibois-epfl/Manis-timber-plate-joinery-solver",
  "repo_stars": 12,
  "repo_description": "A grasshopper plugin to create joints between timber panels and export CNC toolpath and robot trajectories for fully automated workflow from design to fabrication to assembly.",
  "license": "MIT",
  "filepath": "Gh compilation files/assembly.py",
  "instruction": "Get the compatible vector of assembly of each plate in the model according to the sequence.",
  "code": "\"\"\"Get the compatible vector of assembly of each plate in the model according to the sequence.\"\"\"\r\n\r\nfrom ghpythonlib.componentbase import dotnetcompiledcomponent as component\r\nimport Grasshopper, GhPython\r\nimport System\r\nimport rhinoscriptsyntax as rs\r\nfrom Grasshopper import DataTree\r\nfrom Grasshopper.Kernel.Data import GH_Path\r\n\r\n__author__ = \"Nicolas Rogeau\"\r\n__laboratory__ = \"IBOIS, Laboratory for Timber Construction\" \r\n__university__ = \"EPFL, Ecole Polytechnique Federale de Lausanne\"\r\n__funding__ = \"NCCR Digital Fabrication, ETH Zurich\"\r\n__version__ = \"2021.09\"\r\n\r\nclass MyComponent(component):\r\n    def __new__(cls):\r\n        instance = Grasshopper.Kernel.GH_Component.__new__(cls,\r\n            \"Assembly Vectors\", \"Assembly\", \"\"\"Get the compatible vector of assembly of each plate in the model according to the sequence.\"\"\", \"Manis\", \"Assembly\")\r\n        return instance\r\n    \r\n    def get_ComponentGuid(self):\r\n        return System.Guid(\"e0d11629-ce08-4079-abbd-d04a3c8be866\")\r\n    \r\n    def SetUpParam(self, p, name, nickname, description):\r\n        p.Name = name\r\n        p.NickName = nickname\r\n        p.Description = description\r\n        p.Optional = True\r\n    \r\n    def RegisterInputParams(self, pManager):\r\n        p = Grasshopper.Kernel.Parameters.Param_GenericObject()\r\n        self.SetUpParam(p, \"module\", \"module\", \"Plate module.\")\r\n        p.Access = Grasshopper.Kernel.GH_ParamAccess.list\r\n        self.Params.Input.Add(p)\r\n        \r\n    \r\n    def RegisterOutputParams(self, pManager):\r\n        p = Grasshopper.Kernel.Parameters.Param_Vector()\r\n        self.SetUpParam(p, \"assembly\", \"assembly\", \"Assembly vector of each plate in the module.\")\r\n        self.Params.Output.Add(p)\r\n\r\n        p = Grasshopper.Kernel.Parameters.Param_GenericObject()\r\n        self.SetUpParam(p, \"relatives\", \"relatives\", \"Neighbours concerned by the assembly.\")\r\n        self.Params.Output.Add(p)\r\n\r\n        p = Grasshopper.Kernel.Parameters.Param_GenericObject()\r\n        self.SetUpParam(p, \"spaces\", \"spaces\", \"Intersection of insertion spaces with relatives.\")\r\n        self.Params.Output.Add(p)\r\n    \r\n    def SolveInstance(self, DA):\r\n        p0 = self.marshal.GetInput(DA, 0)\r\n        result = self.RunScript(p0)\r\n\r\n        if result is not None:\r\n            if not hasattr(result, '__getitem__'):\r\n                self.marshal.SetOutput(result, DA, 0, True)\r\n            else:\r\n                self.marshal.SetOutput(result[0], DA, 0, True)\r\n                self.marshal.SetOutput(result[1], DA, 1, True)\r\n                self.marshal.SetOutput(result[2], DA, 2, True)\r\n        \r\n    def get_Internal_Icon_24x24(self):\r\n        o = \"iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAJOgAACToAYJjBRwAAABgSURBVEhL7Y1BCoAwDAT7Jh/b71aDHjROui3UkxkYKKHslIP2sXhc6flYTQYkGZBkQDId2Gp9qMjAdY35QcAPKj0yYNAQSQwFDBq8GzEcMGjY7PEKKP04/QnEIzo/XtoOlgiQW/tjAjsAAAAASUVORK5CYII=\"\r\n        return System.Drawing.Bitmap(System.IO.MemoryStream(System.Convert.FromBase64String(o)))\r\n\r\n\r\n    def RunScript(self, module):\r\n\r\n        assembly = None\r\n        relatives = None\r\n        spaces = None\r\n\r\n        def list_to_datatree(raggedList):\r\n            rl = raggedList\r\n            result = DataTree[object]()\r\n            for i in range(len(rl)):\r\n                temp = []\r\n                for j in range(len(rl[i])):\r\n                    temp.append(rl[i][j])\r\n                path = GH_Path(i)\r\n                result.AddRange(temp, path)\r\n            return result\r\n\r\n        if module:\r\n            if len(module)==1:\r\n                module = module[0]\r\n                assembly = []\r\n                for vec in module.assembly_vectors:\r\n                    if vec == \"gravity\": vec = rs.VectorCreate((0,0,-1),(0,0,0))\r\n                    assembly.append(vec) \r\n                relatives = list_to_datatree(module.assembly_relatives)\r\n                spaces = list_to_datatree(module.assembly_spaces)\r\n            else: self.AddRuntimeMessage(Grasshopper.Kernel.GH_RuntimeMessageLevel.Warning, 'Please provide only one module as input.')\r\n        else: self.AddRuntimeMessage(Grasshopper.Kernel.GH_RuntimeMessageLevel.Warning, 'Waiting to get a module as input.')\r\n        return (assembly, relatives, spaces)\r\n\r\nclass AssemblyInfo(GhPython.Assemblies.PythonAssemblyInfo):\r\n    def get_AssemblyName(self):\r\n        return \"Assembly Vectors\"\r\n    \r\n    def get_AssemblyDescription(self):\r\n        return \"\"\"\"\"\"\r\n\r\n    def get_AssemblyVersion(self):\r\n        return \"0.1\"\r\n\r\n    def get_AuthorName(self):\r\n        return \"Nicolas Rogeau\"\r\n    \r\n    def get_Id(self):\r\n        return System.Guid(\"1237da5a-deaa-4f59-9a40-b5844136a364\")",
  "language": "python",
  "imports": [
    "ghpythonlib",
    "rhinoscriptsyntax"
  ],
  "has_docstring": true
}