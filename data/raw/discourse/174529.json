{
  "source_url": "https://discourse.mcneel.com/t/help-w-gpt-generated-python-script/174529",
  "topic_id": 174529,
  "title": "Help w/ GPT generated Python script",
  "question": "Hi all, whilst I am learning Python myself at the moment I figured I’d use ChatGPT to write some code for me to create some parametric designs. With the code below I get the following error message on line 64:\n\n\nSystemError: error return without exception set\n\n\nKeeping in mind I’ve barely done any debugging before, any tips on what’s going on here? Have also attached a GH file with the curve input internalised.\n\n\nGPT_fail.gh\n (1.9 KB)\n\n\nimport Rhino.Geometry as rg\nimport math\nimport ghpythonlib.components as ghcomp\n\ndef project_curve_to_plane(curve, plane):\n    # Project the curve onto the plane\n    projected_curve = rg.Curve.ProjectToPlane(curve, plane)\n    return projected_curve\n\ndef create_star_of_david(center_point, size):\n    angle = 360 / 6  # 6 points for the Star of David\n    points = []\n    \n    for i in range(6):\n        angle_rad = math.radians(angle * i)\n        x = center_point.X + size * math.cos(angle_rad)\n        y = center_point.Y + size * math.sin(angle_rad)\n        points.append(rg.Point3d(x, y, center_point.Z))\n    \n    star_of_david = rg.PolylineCurve(points)\n    return star_of_david\n\ndef create_repeating_weaving_pattern(curve, weave_height, x_count):\n    weaving_pattern = []\n\n    # Project the curve onto the XY plane\n    plane = rg.Plane.WorldXY\n    projected_curve = project_curve_to_plane(curve, plane)\n\n    for i in range(x_count):\n        # Calculate the parameter 't' value\n        t_value = i / (x_count - 1)\n\n        # Evaluate the projected curve at the current 't' value\n        eval_point = projected_curve.PointAt(t_value)\n\n        # Get the tangent vector at the evaluated point\n        tangent_vector = projected_curve.TangentAt(t_value)\n\n        # Create a Star of David at the evaluated point\n        star_of_david = create_star_of_david(eval_point, weave_height)\n\n        # Offset the Star of David along the tangent direction of the projected curve\n        translation_vector = tangent_vector * weave_height\n        star_of_david.Translate(t...",
  "code_blocks": [
    {
      "code": "import Rhino.Geometry as rg\nimport math\nimport ghpythonlib.components as ghcomp\n\ndef project_curve_to_plane(curve, plane):\n    # Project the curve onto the plane\n    projected_curve = rg.Curve.ProjectToPlane(curve, plane)\n    return projected_curve\n\ndef create_star_of_david(center_point, size):\n    angle = 360 / 6  # 6 points for the Star of David\n    points = []\n    \n    for i in range(6):\n        angle_rad = math.radians(angle * i)\n        x = center_point.X + size * math.cos(angle_rad)\n        y = center_point.Y + size * math.sin(angle_rad)\n        points.append(rg.Point3d(x, y, center_point.Z))\n    \n    star_of_david = rg.PolylineCurve(points)\n    return star_of_david\n\ndef create_repeating_weaving_pattern(curve, weave_height, x_count):\n    weaving_pattern = []\n\n    # Project the curve onto the XY plane\n    plane = rg.Plane.WorldXY\n    projected_curve = project_curve_to_plane(curve, plane)\n\n    for i in range(x_count):\n        # Calculate the parameter 't' value\n        t_value = i / (x_count - 1)\n\n        # Evaluate the projected curve at the current 't' value\n        eval_point = projected_curve.PointAt(t_value)\n\n        # Get the tangent vector at the evaluated point\n        tangent_vector = projected_curve.TangentAt(t_value)\n\n        # Create a Star of David at the evaluated point\n        star_of_david = create_star_of_david(eval_point, weave_height)\n\n        # Offset the Star of David along the tangent direction of the projected curve\n        translation_vector = tangent_vector * weave_height\n        star_of_david.Translate(translation_vector)\n\n        # Add the Star of David to the weaving pattern\n        weaving_pattern.append(star_of_david)\n\n    # Transform the weaving pattern back to the original curve's coordinate system\n    transform = rg.Transform.PlaneToPlane(plane, rg.Plane.WorldXY)\n    weaving_pattern = [rg.Curve.Transform(curve, transform) for curve in weaving_pattern]\n\n    return weaving_pattern\n\n# Main script\nif __name__ == \"__main__\":\n    # Get the Grasshopper document\n    ghdoc = ghenv.Component.OnPingDocument()\n\n    # Input: Curve, weaving height, and number of repetitions along 't'\n    # Assuming you have a Curve parameter named \"InputCurve\" connected to your Grasshopper script\n    input_curve_param = ghenv.Component.Params.Input[0]  # Assuming the Curve is the first input parameter\n    input_curve = input_curve_param.VolatileData.AllData(True)[0]  # Access the first curve in the Rhino document\n\n    weave_height = 10.0  # You can adjust the weaving height as needed\n    x_count = 10  # Number of repetitions along 't', adjust as needed\n\n    # Generate the repeating weaving pattern for the Curve\n    weaving_pattern = create_repeating_weaving_pattern(input_curve, weave_height, x_count)\n\n    # Output: Display the weaving pattern in the Rhino document\n    for pattern_curve in weaving_pattern:\n        ghdoc.Objects.AddCurve(pattern_curve)",
      "language": "python",
      "author": "Hayden_Opperman",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "file-io",
    "geometry",
    "grasshopper",
    "python",
    "rhinocommon",
    "transformation"
  ],
  "has_accepted_answer": false,
  "category_id": 2,
  "posts_count": 1,
  "views": 195
}