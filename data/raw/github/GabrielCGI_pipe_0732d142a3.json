{
  "source_url": "https://github.com/GabrielCGI/pipe/blob/83403152db2222f3a02f99c2ed3155509b0453e9/rhino/script_batchExport_stp.py",
  "repo": "GabrielCGI/pipe",
  "repo_stars": 0,
  "repo_description": "Bloom pipeline ",
  "license": "unknown",
  "filepath": "rhino/script_batchExport_stp.py",
  "instruction": "Script batch export stp",
  "code": "\n#! python3\n\nimport os\nimport rhinoscriptsyntax as rs\nimport scriptcontext as sc\nimport math\n\nimport System\nimport System.Collections.Generic\nimport Rhino\n\n\n# Set the input folder containing .3dm files\ninput_folder = r'C:\\Users\\j.monti\\Documents\\julia\\swaChristmas\\3Ddata'\n\n# Set the output folder where OBJ files will be saved\noutput_folder = r'C:\\Users\\j.monti\\Documents\\julia\\swaChristmas\\3Ddata_out'\n\nselected_preset = \"high\"  # Change this to the desired preset: \"low\", \"high\", or \"ultrahigh\"\n\n# Define common settings\ncommon_settings = (\n    \"_Geometry=_Mesh \"\n    \"_EndOfLine=CRLF \"\n    \"_ExportRhinoObjectNames=2 \"\n    \"_ExportGroupNameLayerNames=1\"\n    \"_ExportMeshTextureCoordinates=_Yes \"\n    \"_ExportMeshVertexNormals=_Yes \"\n    \"_CreateNGons=_No \"\n    \"_ExportMaterialDefinitions=_Yes \"\n    \"_YUp=_Yes \"\n    \"_WrapLongLines=Yes \"\n    \"_VertexWelding=_Welded \"\n    \"_WritePrecision=17 \"\n    \"_Enter \"\n    \"_DetailedOptions \"\n    \"_JaggedSeams=_No \"\n    \"_PackTextures=_No \"\n    \"_Refine=_Yes \"\n    \"_SimplePlane=_No \"\n)\n\n# Define quality presets\npresets = {\n    \"low\": (\n        common_settings +\n        \"_AdvancedOptions \"\n        \"_Angle=20 \"\n        \"_AspectRatio=0 \"\n        \"_Distance=0.0 \"\n        \"_Density=0 \"\n        \"_Grid=0 \"\n        \"_MaxEdgeLength=0 \"\n        \"_MinEdgeLength=0.0001 \"\n        \"_Enter _Enter\"\n    ),\n    \"high\": (\n        common_settings +\n        \"_AdvancedOptions \"\n        \"_Angle=20 \"\n        \"_AspectRatio=0 \"\n        \"_Distance=0.0 \"\n        \"_Density=1 \"\n        \"_Grid=0 \"\n        \"_MaxEdgeLength=0.2 \"\n        \"_MinEdgeLength=0.0001 \"\n        \"_Enter _Enter\"\n    ),\n}\n\n# Function to export .3dm to OBJ with specified options\ndef export_to_obj(file_path, settings):\n    rs.EnableRedraw(False)\n    rs.DocumentModified(False)\n    rs.Command(\"_-Open \\\"\" + file_path + \"\\\" _NoSave _Enter\")\n\n    # Scale all objects from the world center by 0.1 to convert from mm to cm\n    scale_factor = 0.1\n    rs.ScaleObjects(rs.AllObjects(), [0, 0, 0], [scale_factor, scale_factor, scale_factor], copy=False)\n\n    rs.UnselectAllObjects()\n    all_objects = rs.AllObjects()\n    if all_objects:\n        rs.SelectObjects(all_objects)\n    name = os.path.splitext(os.path.basename(file_path))[0]\n    settings_str = settings\n    command = f'-_Export \"{output_folder}/{name}_{selected_preset}.obj\" {settings_str} _Enter'\n    rs.Command(command, True)\n    rs.EnableRedraw(True)\n\n# List all .3dm files in the input folder\ninput_files = [f for f in os.listdir(input_folder) if f.endswith(\".stp\")]\n\n# Loop through each .3dm file and export to OBJ using the selected quality preset\n\n\nfor input_file in input_files:\n    # Create the full path for the input .3dm file\n    input_path = os.path.join(input_folder, input_file)\n\n    # Export the opened file to OBJ format with the selected preset\n    export_to_obj(input_path, presets[selected_preset])\n\n    print(f\"Exported {input_file} to OBJ with {selected_preset} preset\")",
  "language": "python",
  "imports": [
    "Rhino",
    "rhinoscriptsyntax",
    "scriptcontext"
  ],
  "has_docstring": false
}