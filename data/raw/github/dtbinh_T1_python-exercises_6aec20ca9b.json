{
  "source_url": "https://github.com/dtbinh/T1_python-exercises/blob/f4710c3dc2ba8ddb3e3e9069ab8d65df674463ab/07_ur_online/shifted_frames_setup/compas/packages/compas_fabrication/fabrication/grasshopper/helpers/mesh.py",
  "repo": "dtbinh/T1_python-exercises",
  "repo_stars": 0,
  "repo_description": null,
  "license": "unknown",
  "filepath": "07_ur_online/shifted_frames_setup/compas/packages/compas_fabrication/fabrication/grasshopper/helpers/mesh.py",
  "instruction": null,
  "code": "from __future__ import print_function\nimport sys\n\ntry:\n    import rhinoscriptsyntax as rs\n    import ghpythonlib.components as ghcomp\nexcept ImportError:\n    import platform\n    if platform.python_implementation() == 'IronPython':\n        raise\n    \nfrom compas.datastructures.mesh import Mesh\nfrom compas_fabrication.fabrication.grasshopper import xdraw_mesh\nfrom compas.utilities.colors import color_to_colordict\n\ndef mesh_from_guid(guid, **kwargs):\n    \"\"\"Creates an instance of a compAS mesh class from an identifier\n    in Rhino/Grasshopper.\n\n    This function is almost identical to ``mesh_from_guid`` in the core\n    framework, but there were some import issues when used from within\n    Grasshopper, but eventually, it should be migrated into the core.\n    \"\"\"\n    trimesh = ghcomp.Triangulate(rs.coercemesh(guid))[0]\n    vertices = [map(float, vertex) for vertex in rs.MeshVertices(trimesh)]\n    faces = map(list, rs.MeshFaceVertices(trimesh))\n    faces = [face[: -1] if face[-2] == face[-1] else face for face in faces]\n    mesh = Mesh.from_vertices_and_faces(vertices, faces)\n    mesh.attributes.update(kwargs)\n    return mesh\n\n\ndef draw_mesh(mesh,\n              layer=None,\n              show_faces=True,\n              show_vertices=False,\n              show_edges=False,\n              show_wireframe=False,\n              vertexcolor=None,\n              edgecolor=None,\n              wireframecolor=None,\n              facecolor=None,\n              ):\n    \"\"\"\n    Draw a mesh object in Grasshopper.\n\n    Parameters:\n        mesh (compas.datastructures.mesh.Mesh): The mesh object.\n        show_faces (bool): Optional. Show the faces. Default is ``True``.\n        show_vertices (bool): Optional. Show the vertices. Default is ``True``.\n        show_edges (bool): Optional. Show the edges. Default is ``True``.\n        vertexcolor (str, tuple, list, dict): Optional. The vertex color specification. Default is ``None``.\n        edgecolor (str, tuple, list, dict): Optional. The edge color specification. Default is ``None``.\n        facecolor (str, tuple, list, dict): Optional. The face color specification. Default is ``None``.\n        redraw (bool): Optional. Redraw instructions. Default is ``True``.\n\n    Note:\n        Colors can be specified in different ways:\n\n        * str: A hexadecimal color that will be applied to all elements subject to the specification.\n        * tuple, list: RGB color that will be applied to all elements subject to the specification.\n        * dict: RGB or hex color dict with a specification for some or all of the related elements.\n\n    Important:\n        RGB colors should specify color values between 0 and 255.\n\n    \"\"\"\n\n    vertexcolor = color_to_colordict(vertexcolor,\n                                     mesh.vertices(),\n                                     default=mesh.attributes['color.vertex'],\n                                     colorformat='rgb',\n                                     normalize=False)\n\n    edgecolor = color_to_colordict(edgecolor,\n                                   mesh.edges(),\n                                   default=mesh.attributes['color.edge'],\n                                   colorformat='rgb',\n                                   normalize=False)\n\n    # facecolor = color_to_colordict(facecolor,\n    #                                mesh.faces(),\n    #                                default=mesh.attributes['color.face'],\n    #                                colorformat='rgb',\n    #                                normalize=False)\n\n    if show_faces:\n        key_index = {key: index for index, key in enumerate(mesh.vertices())}\n        xyz       = [mesh.vertex_coordinates(key) for key in mesh.vertices()]\n        faces     = []\n        color     = mesh.attributes['color.face']\n\n        for fkey in mesh.face:\n            face = mesh.face_vertices(fkey, ordered=True)\n            v = len(face)\n\n            if v < 3:\n                print('Degenerate face: {0} => {1}'.format(fkey, face))\n            elif v == 3:\n                faces.append([key_index[k] for k in face + [face[-1]]])\n            elif v == 4:\n                faces.append([key_index[k] for k in face])\n            else:\n                c = len(xyz)\n                xyz.append(mesh.face_center(fkey))\n                for i in range(-1, len(face) - 1):\n                    key = face[i]\n                    nbr = face[i + 1]\n                    vertices = [c, key_index[key], key_index[nbr], key_index[nbr]]\n                    faces.append(vertices)\n\n        return xdraw_mesh(xyz, faces, color)\n    \n    \n#     if show_edges:\n#         lines = []\n#         color = mesh.attributes['color.edge']\n#         for u, v in mesh.edges():\n#             lines.append({\n#                 'start': mesh.vertex_coordinates(u),\n#                 'end'  : mesh.vertex_coordinates(v),\n#                 'name' : '{0}.edge.{1}-{2}'.format(mesh.attributes['name'], repr(u), repr(v)),\n#                 'color': edgecolor.get((u, v), color),\n#             })\n#         xdraw_lines(lines)\n# \n#     if show_wireframe:\n#         lines = []\n#         color = mesh.attributes['color.edge']\n#         for u, v in mesh.wireframe():\n#             lines.append({\n#                 'start': mesh.vertex_coordinates(u),\n#                 'end'  : mesh.vertex_coordinates(v),\n#                 'name' : '{0}.edge.{1}-{2}'.format(mesh.attributes['name'], repr(u), repr(v)),\n#                 'color': edgecolor.get((u, v), color),\n#             })\n#         xdraw_lines(lines)\n# \n#     if show_vertices:\n#         points = []\n#         color  = mesh.attributes['color.vertex']\n#         for key in mesh.vertices():\n#             points.append({\n#                 'pos'  : mesh.vertex_coordinates(key),\n#                 'name' : '{0}.vertex.{1}'.format(mesh.attributes['name'], repr(key)),\n#                 'color': vertexcolor.get(key, color),\n#             })\n#         xdraw_points(points)\n",
  "language": "python",
  "imports": [
    "ghpythonlib",
    "rhinoscriptsyntax"
  ],
  "has_docstring": false
}