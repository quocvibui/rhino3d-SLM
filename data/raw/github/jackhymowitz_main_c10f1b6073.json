{
  "source_url": "https://github.com/jackhymowitz/main/blob/7325131db23094f1a28bd184b6a68f864f41a729/01_GH_Components/py/BT_Airtightness.py",
  "repo": "jackhymowitz/main",
  "repo_stars": 0,
  "repo_description": "IDF2PH is a free open source toolkit for working with E+ and PHPP Energy Models",
  "license": "GPL-3.0",
  "filepath": "01_GH_Components/py/BT_Airtightness.py",
  "instruction": "Will calculate the PHPP Envelope Airtightness using the PHPP Rooms as the reference volume. Connect the ouputs from this component to a Honeybee 'setEPZoneLoads' and then set the Infiltration...",
  "code": "#\r\r\n# IDF2PHPP: A Plugin for exporting an EnergyPlus IDF file to the Passive House Planning Package (PHPP). Created by blgdtyp, llc\r\r\n# \r\r\n# This component is part of IDF2PHPP.\r\r\n# \r\r\n# Copyright (c) 2020, bldgtyp, llc <info@bldgtyp.com> \r\r\n# IDF2PHPP is free software; you can redistribute it and/or modify \r\r\n# it under the terms of the GNU General Public License as published \r\r\n# by the Free Software Foundation; either version 3 of the License, \r\r\n# or (at your option) any later version. \r\r\n# \r\r\n# IDF2PHPP is distributed in the hope that it will be useful,\r\r\n# but WITHOUT ANY WARRANTY; without even the implied warranty of \r\r\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the \r\r\n# GNU General Public License for more details.\r\r\n# \r\r\n# For a copy of the GNU General Public License\r\r\n# see <http://www.gnu.org/licenses/>.\r\r\n# \r\r\n# @license GPL-3.0+ <http://spdx.org/licenses/GPL-3.0+>\r\r\n#\r\r\n\"\"\"\r\r\nWill calculate the PHPP Envelope Airtightness using the PHPP Rooms as the reference volume. Connect the ouputs from this component to a Honeybee 'setEPZoneLoads' and then set the Infiltration Schedule to 'CONSTANT'. Use a Honeybee 'Constant Schedule' with a value of 1 and a _schedTypeLimit of 'FRACTIONAL', then connect that to an HB 'setEPZoneSchdeules' component.\r\r\n-\r\r\nEM Aug. 10, 2020\r\r\n\r\r\n    Args:\r\r\n        _HBZones: Honeybee Zones to apply this leakage rate to.\r\r\n        _n50: (ACH) The target ACH leakage rate\r\r\n        _q50: (m3/hr-m2-surface) The target leakage rate per m2 of exposed surface area\r\r\n        _blowerPressure: (Pascal) Blower Door pressure for the airtightness measurement. Default is 50Pa\r\r\n    Returns:\r\r\n        _HBZones: Connect to the '_HBZones' input on the Honeybee 'setEPZoneLoads' Component\r\r\n        infiltrationRatePerFloorArea_: (m3/hr-m2-floor)\r\r\n        infiltrationRatePerFacadeArea_: (m3/hr-m2-facade) Connect to the 'infilRatePerArea_Facade_' input on the Honeybee 'setEPZoneLoads' Component\r\r\n\"\"\"\r\r\n\r\r\nghenv.Component.Name = \"BT_Airtightness\"\r\r\nghenv.Component.NickName = \"Airtightness\"\r\r\nghenv.Component.Message = 'AUG_10_2020'\r\r\nghenv.Component.IconDisplayMode = ghenv.Component.IconDisplayMode.application\r\r\nghenv.Component.Category = \"BT\"\r\r\nghenv.Component.SubCategory = \"01 | Model\"\r\r\n\r\r\nimport scriptcontext as sc\r\r\nimport rhinoscriptsyntax as rs\r\r\nimport ghpythonlib.components as ghc\r\r\nimport Grasshopper.Kernel as ghK\r\r\nimport math\r\r\n\r\r\nhb_hive = sc.sticky[\"honeybee_Hive\"]()\r\r\nHBZoneObjects = hb_hive.callFromHoneybeeHive(_HBZones)\r\r\ninfiltrationRatePerFloorArea_ = []\r\r\ninfiltrationRatePerFacadeArea_ = []\r\r\n\r\r\n# Clean up inputs\r\r\nn50 = _n50 if _n50 else 0 # ACH\r\r\nq50 = _q50 if _q50 else 0 # m3/m2-facade\r\r\nblowerPressure = _blowerPressure if _blowerPressure else 50 # Pa\r\r\n\r\r\nfor zone in HBZoneObjects:\r\r\n    if 'PHPProoms' not in zone.__dict__.keys():\r\r\n        msg = \"Could not get the Volume for zone: '{}'. Be sure that you\\n\"\\\r\r\n        \"Be sure that you use this component AFTER the 'PHPP Rooms from Rhino' component\\n\"\\\r\r\n        \"and that you have valid 'rooms' in the model in order to determin the volume correctly.\".format(zone.name)\r\r\n        ghenv.Component.AddRuntimeMessage(ghK.GH_RuntimeMessageLevel.Warning, msg)\r\r\n        continue\r\r\n    \r\r\n    # --------------------------------------------------------------------------\r\r\n    # Get all the relevant information needed from the zones\r\r\n    zoneVolume_Vn50 = sum([room.RoomNetClearVolume for room in zone.PHPProoms])\r\r\n    zoneFloorArea_Gross = zone.getFloorArea()\r\r\n    zoneVolume_Gross = zone.getZoneVolume()\r\r\n    zoneExposedSurfaceArea = zone.getExposedArea()\r\r\n    flowBy_n50 = zoneVolume_Vn50 * n50 / 3600\r\r\n    flowBy_q50 = zoneExposedSurfaceArea * q50 / 3600\r\r\n    \r\r\n    print 'Zone PHPP Room Volumes: {} m3'.format(zoneVolume_Vn50)\r\r\n    print 'Zone Floor Area (from EP Model): {:.1f} m2'.format(zoneFloorArea_Gross)\r\r\n    print 'Zone Volume: {:.1f} m3'.format(zoneVolume_Gross)\r\r\n    print 'Zone Exposed Surface Area: {:.1f} m2'.format(zoneExposedSurfaceArea)\r\r\n    print 'Zone Infiltration Flow by n50: {:.1f} m3/hr ({:.4f} m3/s) @ 50Pa'.format(flowBy_n50*60*60, flowBy_n50)\r\r\n    print 'Zone Infiltration Flow by q50: {:.1f} m3/hr ({:.4f} m3/s) @ 50Pa'.format(flowBy_q50*60*60, flowBy_q50)\r\r\n    print '----'\r\r\n    # --------------------------------------------------------------------------\r\r\n    # Decide which flow rate to use and Calc Standard\r\r\n    # Flow Rate incorporating Blower Pressure\r\r\n    if flowBy_n50 != 0.0:\r\r\n        standardFlowRate = flowBy_n50/(math.pow((blowerPressure/4),0.63)) # m3/s\r\r\n    elif flowBy_q50 != 0.0:\r\r\n        standardFlowRate = flowBy_q50/(math.pow((blowerPressure/4),0.63)) # m3/s\r\r\n    else:\r\r\n        standardFlowRate = 0\r\r\n    \r\r\n    # --------------------------------------------------------------------------\r\r\n    # Calc the Zone's Infiltration Rate in m3/hr-2 of floor area (zone gross)\r\r\n    zoneinfilRatePerFloorArea = standardFlowRate /  zoneFloorArea_Gross  #m3/s---> m3/hr-m2\r\r\n    infiltrationRatePerFloorArea_.append(zoneinfilRatePerFloorArea)\r\r\n    \r\r\n    zoneinfilRatePerFacadeArea = standardFlowRate /  zoneExposedSurfaceArea  #m3/s---> m3/hr-m2\r\r\n    infiltrationRatePerFacadeArea_.append(zoneinfilRatePerFacadeArea)\r\r\n    \r\r\n    print 'Zone Infiltration Flow Per Unit of Floor Area: {:.4f} m3/hr-m2 ({:.6f} m3/s-m2) @ Normal Pressure'.format(zoneinfilRatePerFloorArea*60*60, zoneinfilRatePerFloorArea)\r\r\n    print 'Zone Infiltration Flow Per Unit of Facade Area: {:.4f} m3/hr-m2 ({:.6f} m3/s-m2) @ Normal Pressure'.format(zoneinfilRatePerFacadeArea*60*60, zoneinfilRatePerFacadeArea)\r\r\n    print 'Zone Infiltration ACH: {:.4f} @ Normal Pressure'.format(standardFlowRate*60*60 / zoneVolume_Gross)\r\r\n    print 'zone Ref Volume: {:.02f} m3'.format(zoneVolume_Vn50)\r\r\n\r\r\nif _HBZones:\r\r\n    HBZones_ = _HBZones\r\n",
  "language": "python",
  "imports": [
    "ghpythonlib",
    "rhinoscriptsyntax",
    "scriptcontext"
  ],
  "has_docstring": true
}