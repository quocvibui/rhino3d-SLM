{
  "source_url": "https://github.com/ladybug-tools/ladybug-legacy/blob/d90db02f2776febbb38100dea26ec0c93e77aa53/src/Ladybug_Solar%20Water%20Heating%20System.py",
  "repo": "ladybug-tools/ladybug-legacy",
  "repo_stars": 202,
  "repo_description": ":beetle: Ladybug is an environmental plugin for Grasshopper.",
  "license": "NOASSERTION",
  "filepath": "src/Ladybug_Solar Water Heating System.py",
  "instruction": "Use this component to define Solar water heating system settings.\n-\nIf nothing inputed, the following swh system will be used by default:\n- glazed flat plate collectors\n- active\n- closed loop\n- 1...",
  "code": "# Solar water heating system\n#\n# Ladybug: A Plugin for Environmental Analysis (GPL) started by Mostapha Sadeghipour Roudsari\n# \n# This file is part of Ladybug.\n# \n# Copyright (c) 2013-2020, Djordje Spasic <djordjedspasic@gmail.com> \n# Ladybug is free software; you can redistribute it and/or modify \n# it under the terms of the GNU General Public License as published \n# by the Free Software Foundation; either version 3 of the License, \n# or (at your option) any later version. \n# \n# Ladybug is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of \n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the \n# GNU General Public License for more details.\n# \n# You should have received a copy of the GNU General Public License\n# along with Ladybug; If not, see <http://www.gnu.org/licenses/>.\n# \n# @license GPL-3.0+ <http://spdx.org/licenses/GPL-3.0+>\n\n\"\"\"\nUse this component to define Solar water heating system settings.\n-\nIf nothing inputed, the following swh system will be used by default:\n- glazed flat plate collectors\n- active\n- closed loop\n- 1 story\n- unshaded\n-\nProvided by Ladybug 0.0.69\n    \n    input:\n        collectorType_: Type of the collector. The following ones can be used:\n                        -\n                        0 - unglazed flat plate\n                        Least expensive.\n                        Mostly used for single home domestic how water heating and for heating swimming pools.\n                        More cost efficient in tropical and subtropical environments. They can also be used in moderate climates for seasonal usage.\n                        Can output water temperatures up to 30C (86F).\n                        -\n                        1 - glazed flat plate\n                        Less expensive.\n                        More cost efficient in warm and mild-warm climates. But also used in temperate climates.\n                        Mostly used for single home domestic how water heating, space heating and space cooling. And for heating swimming pools.\n                        Can output water temperatures up to 60C (140F).\n                        - \n                        2 - evacuated tube\n                        The most expensive.\n                        More cost efficient in cold temperate and cold climates (with low ambient temperature, for example: during winter) and during overcast skies.\n                        Evacuated tube collectors (or concentrating collectors) are typically used for industrial applications, or multi residential or commercial buildings for space heating and space cooling. \n                        Can output water temperatures higher than 90C (194F) degrees, up to 177C (350F).\n                        -\n                        -\n                        If not supplied, glazed flat plate collectors (1) will be used.\n        activeSWHsystem_: Define whether the swh system is active (pumped) or passive (not pumped).\n                          -\n                          0 - passive (not pumped) swh system\n                          Less expensive.\n                          More efficient in warm and mild-warm climates.\n                          Does not require electricity to operate.\n                          Is used for domestic hot water heating and space heating of a single home.\n                          If positioned on a roof require putting a storage tank above the collector, and therefor impose the roof construction to be able to carry the weight of the storage tank.\n                          SWHsurface component supports passive swh systems with auxiliary heater.\n                          -\n                          1 - active (pumped) swh system\n                          More expensive.\n                          More efficient in temperate and cold climates.\n                          Require electricity to operate and battery back-up in case of power outage.\n                          Can be used for domestic hot water heating, space heating and space cooling of a single home, building or several buildings (central heating).\n                          More efficient in warm and mild-warm climates, where it rarely freezes\n                          -\n                          -\n                          If not supplied, active (pumped) loop will be used.\n        openLoop_: Define whether the swh system has an open (indirect) or closed (indirect) solar loop.\n                   -\n                   0 - closed (indirect) loop\n                   Usage of heatexchanger. Antifreeze is a working fluid.\n                   More expensive.\n                   More efficient in temperate and cold climates where freezing may occur.\n                   Also suitable for locations with hard water hardness (mineral content).\n                   -\n                   1 - open (direct) loop\n                   No usage of heatexchangers. Water is the working fluid.\n                   Less expensive.\n                   More efficient in warm and mild-warm climates, where it rarely freezes (air temperature never drops below 5C(41F) degrees).\n                   Only suitable for locations with low water hardness (mineral content) otherwise limescale will form in solar collectors.\n                   -\n                   -\n                   If not supplied, closed (indirect) loop will be used.\n        numberOfStories_: Total number of stories plus basement (if there is a basement).\n                          This input is used to calculate the total piping length in the solar loop, based on an assumption that the storage tank will be located at the lowest story (basement or ground floor), and solar collectors are located at the roof.\n                          -\n                          Example 1:\n                          a house with a ground floor, first floor and a basement - has 3 stories total.\n                          Example 2:\n                          a house with a ground floor, first floor, second floor and without a basement - has 3 stories total.\n                          -\n                          If sollar collectors are used on a ground instead of roof, use the \"Solar Water Heating System Detailed\" component instead of this one to enter the exact pipe length of the solar loop.\n                          -\n                          -\n                          If not supplied, \"1\" story will be used as a default value (a house with only a ground floor, without a basement).\n        skyExposureFactor_: Continuous Sky Exposure Factor - portion of the visible sky (dome). It defines the shading of the diffuse irradiance components. It ranges from 0 to 1.\n                            Import it from \"Sunpath shading\" component's \"skyExposureFactor\" output.\n                            -\n                            If not supplied, 1 will be used as a default value (SWHsurface is unshaded).\n                            -\n                            Unitless.\n        beamIndexPerHour_: Transmission index of beam (direct) irradiance for each hour during a year. It ranges from 0-1.\n                           Import it from \"Sunpath shading\" component's \"beamIndexPerHour\" output.\n                           -\n                           If not supplied, a value of 1 for each hour during a year, will be used (SWHsurface is unshaded).\n                           -\n                           Unitless.\n        \n    output:\n        readMe!: ...\n        SWHsystemSettings: A list of all Solar water heating system settings. Plug it to SWHsurface component's \"SWHsystemSettings_\" input.\n\"\"\"\n\nghenv.Component.Name = \"Ladybug_Solar Water Heating System\"\nghenv.Component.NickName = \"SolarWaterHeatingSystem\"\nghenv.Component.Message = 'VER 0.0.69\\nJUL_07_2020'\nghenv.Component.IconDisplayMode = ghenv.Component.IconDisplayMode.application\nghenv.Component.Category = \"LB-Legacy\"\nghenv.Component.SubCategory = \"4 | Renewables\"\n#compatibleLBVersion = VER 0.0.61\\nDEC_01_2015\ntry: ghenv.Component.AdditionalHelpFromDocStrings = \"3\"\nexcept: pass\n\nimport Grasshopper.Kernel as gh\nimport scriptcontext as sc\n\n\ndef SWHsystemInputData(collectorType, activeSWHsystem, openLoop, numberOfStories, skyExposureFactor, beamIndexPerHour):\n    \n    if (collectorType == 0):\n        # unglazed flat plate\n        collectorOpticalEfficiency = 0.87\n        collectorThermalLoss = 21\n        collectorActiveAreaPercent = 90\n        IAMcoefficient = 0.1\n        deliveryWaterTemperature = 30\n    elif (collectorType == 2):\n        # evacuated tube\n        collectorOpticalEfficiency = 0.5\n        collectorThermalLoss = 1.5\n        collectorActiveAreaPercent = 90\n        IAMcoefficient = -0.05\n        deliveryWaterTemperature = 60\n    elif (collectorType == 1) or (collectorType < 0) or (collectorType > 2):\n        print \"Collector type smaller than \\\"0\\\" and larger than \\\"2\\\" are not supported.\\nGlazed flat plate type will be used as default.\"\n        # glazed flat plate\n        collectorType = 1\n        collectorOpticalEfficiency = 0.7\n        collectorThermalLoss = 4\n        collectorActiveAreaPercent = 90\n        IAMcoefficient = 0.1\n        deliveryWaterTemperature = 60\n    \n    if activeSWHsystem:\n        # active swh system (with pumps(s))\n        mechanicalRoomTemperatureData = [20 for i in range(8760)]  # default value 20C for each hour = tank storage located inside the building\n        pumpPower = None  # will be calculated based on SWH active area\n        pumpEfficiency = 0.85  # default value for flat plate glazed collectors\n    else:\n        # passive swh system (without pump(s))\n        mechanicalRoomTemperatureData = [\"air temperature\"]  # will be equal to air temperature\n        pumpPower = 0\n        pumpEfficiency = 0\n    \n    if openLoop:\n        # open (direct) loop swh system\n        workingFluidHeatCapacity = 4180  # default value for water\n        heatExchangerEffectiveness = 1\n    else:\n        # closed (indirect) loop swh system\n        workingFluidHeatCapacity = 3840  # default value for water-ethylenglycol 34%\n        heatExchangerEffectiveness = 0.8  # default\n    \n    if (numberOfStories == None) or (numberOfStories <= 0):\n        numberOfStories = 1\n    numberOfStories = numberOfStories + 1  # (plus roof)\n    pipeLength = 10 * numberOfStories  # in meters\n    \n    flowRatePerM2 = 0.012  # default value for flat plate collectors\n    \n    if (skyExposureFactor == None) or (skyExposureFactor < 0) or (skyExposureFactor > 1):\n        skyExposureFactor = 1  # default - no shading\n    \n    if (len(beamIndexPerHour) == 0) or (beamIndexPerHour[0] is \"\"):\n        beamIndexPerHourData = [1 for i in range(0,8760)]  # default - no shading\n    elif (len(beamIndexPerHour) == 8767):\n        beamIndexPerHourData = beamIndexPerHour[7:]\n    elif (len(beamIndexPerHour) == 8760):\n        beamIndexPerHourData = beamIndexPerHour\n    else:\n        SWHsystemSettings = None\n        validSWHsystemData = False\n        printMsg = \"Something is wrong with your \\\"beamIndexPerHour_\\\" input. Please use \\\"beamIndexPerHour\\\" output from \\\"Sunpath shading\\\" component to generate them.\"\n        \n        return SWHsystemSettings, validSWHsystemData, printMsg\n    \n    maxWorkingTemperature = 95  # default\n    dischargeTemperature = maxWorkingTemperature-3  # default\n    avrJanuaryColdWaterTemperature = None  # will be calculated from lb_photovoltaics.inletWaterTemperature()\n    pipeDiameter = None  # will be calculated based on sqrt(4 * flowRatePerM2 * collectorActiveArea / flowSpeed / pi)\n    pipeInsulationThickness = None  # will be calculated based on pipeDiameter\n    pipeInsulationConductivity = 0.027  # default for Polyurethane (PUR)\n    tankSizeLiters = None  # will be calculated based on 1.5 * HWCdailyAveragePerYear\n    tankLoss = 0.3  # default\n    heightDiameterTankRatio = 2.6  # default\n    \n    # printing\n    if mechanicalRoomTemperatureData[0] != \"air temperature\":\n        averageAnnualMechanicalRoomTemp = sum(mechanicalRoomTemperatureData)/len(mechanicalRoomTemperatureData)\n    else:\n        averageAnnualMechanicalRoomTemp = \"will be calculated based on air temperature\"\n    \n    SWHsystemSettings = [collectorOpticalEfficiency, collectorThermalLoss, collectorActiveAreaPercent, workingFluidHeatCapacity, flowRatePerM2, IAMcoefficient, skyExposureFactor, beamIndexPerHourData, maxWorkingTemperature, dischargeTemperature, deliveryWaterTemperature, avrJanuaryColdWaterTemperature, mechanicalRoomTemperatureData, pipeLength, pipeDiameter, pipeInsulationThickness, pipeInsulationConductivity, pumpPower, pumpEfficiency, tankSizeLiters, tankLoss, heightDiameterTankRatio, heatExchangerEffectiveness]\n    \n    printOutputMsg = \\\n    \"\"\"\nInput data:\n\nCollector type: %s\nActive SWH system: %s\nOpen loop: %s\nAverage annual Transmission index of beam irradiance (-): %s\n\n\nResults in the following SWH system settings:\n\nCollector optical efficiency (-): %0.2f\nCollector thermal loss (W/m2/C): %0.2f\nCollector active area percent (percent): %0.2f\nWorking fluid heat capacity (J/kg/C): %0.2f\nFlow rate per M2 (kg/s/m2): %0.3f\nIAM modifier coefficient (-): %0.2f\nSky View Factor (-): %0.2f\nAverage annual Transmission index of beam irradiance (-): %0.2f\n-----\nMax working temperature (C): %0.2f\nDischarge temperature (C): %0.2f\nDelivery water temperature (C): %0.2f\nAverage January cold water temperature (C): %s\nAverage mechanical room temperature (C): %s\n-----\nPipe length (m): %0.2f\nPipe diameter (mm): %s\nPipe insulation thickness (mm): %s\nPipe insulation conductivity (W/m/C): %0.2f\nPump power (W): %s\nPump efficiency (-): %0.2f\n-----\nTank size (l): %s\nTank loss (W/m2/C): %0.2f\nHeight-diameter tank ratio (-): %0.2f\nHeat exchanger effectiveness (-): %0.2f\n    \"\"\" % (collectorType, activeSWHsystem, openLoop, sum(beamIndexPerHourData)/8760, collectorOpticalEfficiency, collectorThermalLoss, collectorActiveAreaPercent, workingFluidHeatCapacity, flowRatePerM2, IAMcoefficient, skyExposureFactor, sum(beamIndexPerHourData)/len(beamIndexPerHourData), maxWorkingTemperature, dischargeTemperature, deliveryWaterTemperature, avrJanuaryColdWaterTemperature, averageAnnualMechanicalRoomTemp, pipeLength, pipeDiameter, pipeInsulationThickness, pipeInsulationConductivity, pumpPower, pumpEfficiency, tankSizeLiters, tankLoss, heightDiameterTankRatio, heatExchangerEffectiveness)\n    print printOutputMsg\n    \n    validSWHsystemData = True\n    printMsg = \"ok\"\n    \n    return SWHsystemSettings, validSWHsystemData, printMsg\n\n\nlevel = gh.GH_RuntimeMessageLevel.Warning\nif sc.sticky.has_key(\"ladybug_release\"):\n    if sc.sticky[\"ladybug_release\"].isCompatible(ghenv.Component):\n        lb_photovoltaics = sc.sticky[\"ladybug_Photovoltaics\"]()\n        \n        SWHsystemSettings, validSWHsystemData, printMsg = SWHsystemInputData(collectorType_, activeSWHsystem_, openLoop_, numberOfStories_, skyExposureFactor_, beamIndexPerHour_)\n        if not validSWHsystemData:\n            print printMsg\n            ghenv.Component.AddRuntimeMessage(level, printMsg)\n    else:\n        printMsg = \"You need a newer version of Ladybug to use this component.\" + \\\n            \"Use updateLadybug component to update userObjects.\\n\" + \\\n            \"If you have already updated userObjects drag the Ladybug_Ladybug component \" + \\\n            \"into the canvas and try again.\"\n        print printMsg\nelse:\n    printMsg = \"First please let the Ladybug fly...\"\n    print printMsg\n    ghenv.Component.AddRuntimeMessage(level, printMsg)",
  "language": "python",
  "imports": [
    "scriptcontext"
  ],
  "has_docstring": true
}