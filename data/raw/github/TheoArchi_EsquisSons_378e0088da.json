{
  "source_url": "https://github.com/TheoArchi/EsquisSons/blob/00d1b02f7ce3e190b5c4c3429d3e84756c29bfdb/Components_Uncompiled_for%20ghpython/EsquisSons_Launcher.py",
  "repo": "TheoArchi/EsquisSons",
  "repo_stars": 3,
  "repo_description": "Esquissons is a grasshopper plugin which help you to design with sound ;)",
  "license": "NOASSERTION",
  "filepath": "Components_Uncompiled_for ghpython/EsquisSons_Launcher.py",
  "instruction": "EsquisSons Launcher\nUse 2 boolean toggles to launch the app and then start the sound module :)\n-\nAAU / Theo Marchal / BETA VERSION / AVRIL2020",
  "code": "\n\"\"\"EsquisSons Launcher\nUse 2 boolean toggles to launch the app and then start the sound module :)\n-\nAAU / Theo Marchal / BETA VERSION / AVRIL2020\"\"\"\n\nfrom ghpythonlib.componentbase import executingcomponent as component\nimport Grasshopper, GhPython\nimport System\nimport Rhino\nimport rhinoscriptsyntax as rs\n\nclass MyComponent(component):\n    \n    def RunScript(self, Open_Esquissons, On_Off, Alt_path_Optionnal):\n        \n        __author__ = \"theomarchal\"\n        self.Params.Input[0].Description = \"Boolean input, set True to run the Sound Algorythm\"\n        self.Params.Input[0].Description = \"General Status of Esquis'Sons! module\"\n        self.Params.Input[1].Description = \"Alternative Path to -EsquisSons.exe/app-\"\n        self.Name = \"EsquisSons Launcher\"\n        self.NickName = \"Launcher\" \n        self.Message = \"EsquisSons V3\"\n        self.Category = \"EsquisSons\"\n        self.SubCategory = \"0/ EsquisSons\"\n        import os\n        import OSC\n        import platform\n        import time\n        import subprocess\n        import Grasshopper.Kernel as gh\n\n        rem = gh.GH_RuntimeMessageLevel.Remark\n        ero = gh.GH_RuntimeMessageLevel.Error\n        war = gh.GH_RuntimeMessageLevel.Warning\n        \n        \n        esqpath = Alt_path_Optionnal\n        \n        if esqpath is None:\n            \n            if platform.system() == 'Windows':\n                #esqpath = os.environ[\"USERPROFILE\"]+'\\Documents\\EsquisSons\\EsquisSons.exe'\n                esqpath = os.getenv('APPDATA')+'\\Grasshopper\\Libraries\\EsquisSons\\EsquisSons.exe'\n            \n            if platform.system() == 'Darwin':\n                esqpath = '/applications/EsquisSons.app'\n            \n        c = OSC.OSCClient()\n        d = OSC.OSCClient()\n        c.connect(('127.0.0.1', 58234))  \n        oscmsg = OSC.OSCMessage()\n        oscmsg.append(\"no message\")\n        oscmsg.append(\"no int\")\n        \n        if Open_Esquissons == True :\n            try :\n                if platform.system() == 'Windows':\n                    os.startfile(esqpath)\n                    error = ''\n                if platform.system() == 'Darwin':\n                    subprocess.call(['open', esqpath])\n                    error =''\n            except :\n                error = 'True'\n            if error == 'True' :\n                self.AddRuntimeMessage(war, \"EsquisSons can't be open ! \"+esqpath+' can not be found Please check the installation !')\n                self.Message = \"EsquisSons is OFF\"\n            else :\n                if On_Off == True :\n                    oscmsg[1] = 1\n                    oscmsg[0] = \"EsquisSons\\\\ is\\\\ Online!\\\\ Let's\\\\ make\\\\ some\\\\ noise\"\n                    self.AddRuntimeMessage(rem, 'EsquisSons! is Online ! Lets make some noise !')\n                    self.Message = \"EsquisSons is ON\"\n                else :\n                    oscmsg[0] = 'EsquisSons\\\\ is\\\\ not\\\\ Online\\\\ turn\\\\ it\\\\ on\\\\ (in\\\\ Gh)\\\\ to\\\\ start\\\\ the\\\\ sketch'\n                    self.AddRuntimeMessage(war, 'EsquisSons app should be open ! Now turn it ON with a boolean Toogle (On_Off input)!')\n                    self.Message = \"Almost there : Turn it on !\"\n        else :\n            if On_Off is True :\n                oscmsg[1] = 1\n                oscmsg[0] = \"EsquisSons\\\\ is\\\\ Online!\\\\ Let's\\\\ make\\\\ some\\\\ noise\"\n                self.AddRuntimeMessage(war, 'Message sent, EsquisSons should be online but...Check if Esquissons app is open ! (if not, use the Open_esquissons input with boolean toggle ;)')\n                self.Message = \"EsquisSons is ON\"\n            else :\n                self.AddRuntimeMessage(ero, 'EsquisSons is not Online and probably not Open, You should Open_esquissons, then turn it On with On_Off !')\n                oscmsg[0] = \"EsquisSons\\\\ is\\\\ not\\\\ Online\\\\ turn\\\\ it\\\\ on\\\\ (in\\\\ Gh)\\\\ to\\\\ start\\\\ the\\\\ sketch\"\n                oscmsg[1] = \"0\"\n                self.Message = \"EsquisSons is OFF\"\n        \n        \n            \n        c.send(oscmsg)\n        return \n",
  "language": "python",
  "imports": [
    "Rhino",
    "ghpythonlib",
    "rhinoscriptsyntax"
  ],
  "has_docstring": true
}