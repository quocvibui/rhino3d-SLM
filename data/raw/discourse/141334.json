{
  "source_url": "https://discourse.mcneel.com/t/add-material-with-python-script/141334",
  "topic_id": 141334,
  "title": "Add material with python script",
  "question": "Hello,\n\n\nI have modified an example found online to add a new PBR material to the scene. If I run this script again, it creates a new material labled …(1), …(2), etc. How can I keep track of the current number lable added? Can I find and delete / use materials added with previous runs of the script?\n\n\nAssignPBR.py\n (2.3 KB)\n\n\nAlso I have found this example \npython - How to replace all pixels of a certain RGB value with another RGB value in OpenCV - Stack Overflow\n which would help a bit with the preparation (since the metallic part of my .jpgs is always the same color). Can I inbuild this into my script so that I only need to prepare the “main_texture” and have the rhino python script do the rest for me?\n\n\nThank you in advance",
  "code_blocks": [
    {
      "code": "import scriptcontext as sc\n\nmyrm = [rm for rm in sc.doc.RenderMaterials if rm.Name==\"MyPBRMaterial\"]",
      "language": "python",
      "author": "nathanletwory",
      "post_number": 5,
      "is_solution": false
    },
    {
      "code": "import scriptcontext as sc\n\nfor o in sc.doc.Objects:\n    o.RenderMaterial = myrm\n    o.CommitChanges()",
      "language": "python",
      "author": "nathanletwory",
      "post_number": 5,
      "is_solution": false
    }
  ],
  "tags": [
    "file-io",
    "geometry",
    "materials",
    "python"
  ],
  "has_accepted_answer": false,
  "category_id": 11,
  "posts_count": 9,
  "views": 1306
}