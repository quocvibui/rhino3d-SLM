{
  "source_url": "https://github.com/CADacombs/rhinopython/blob/541b4ade49f1dda6a3861d12b9e2613405182082/spb_NurbsSrf_selCoplanarGrips.py",
  "repo": "CADacombs/rhinopython",
  "repo_stars": 37,
  "repo_description": "Python scripts for Rhinoceros (Rhino, Rhino3D).",
  "license": "LGPL-3.0",
  "filepath": "spb_NurbsSrf_selCoplanarGrips.py",
  "instruction": "Spb nurbs srf sel coplanar grips",
  "code": "\"\"\"\r\n\"\"\"\r\n\r\n#! python 2  Must be on a line number less than 32.\r\nfrom __future__ import absolute_import, division, print_function, unicode_literals\r\n\r\n\"\"\"\r\n210801-02: Created.\r\n211106: Tolerance is now creeped up from RhinoMath.ZeroTolerance to select only grips that\r\n        are collectively within the tolerance, not independently with reference grips.\r\n        Bug fixed during numeric input.\r\n250125-27: Added selection of grips per one grip and parallel plane per option.\r\n\"\"\"\r\n\r\nimport Rhino\r\nimport Rhino.DocObjects as rd\r\nimport Rhino.Geometry as rg\r\nimport Rhino.Input as ri\r\nimport scriptcontext as sc\r\n\r\nfrom clr import StrongBox\r\n\r\n\r\nclass Opts:\r\n\r\n    keys = []\r\n    values = {}\r\n    names = {}\r\n    riOpts = {}\r\n    listValues = {}\r\n    stickyKeys = {}\r\n\r\n\r\n    key = 'bDeterminePlaneBy3PlusGripPick'; keys.append(key)\r\n    values[key] = False\r\n    names[key] = 'DeterminePlaneBy'\r\n    riOpts[key] = ri.Custom.OptionToggle(values[key], '1GripWith||Plane', 'AtLeast3Grips')\r\n    stickyKeys[key] = '{}({})'.format(key, __file__)\r\n\r\n    key = 'iParallelWithPlane'; keys.append(key)\r\n    values[key] = 0\r\n    listValues[key] = (\r\n        'CPlaneXY',\r\n        'CPlaneYZ',\r\n        'CPlaneZX',\r\n        'WorldXY',\r\n        'WorldYZ',\r\n        'WorldZX',\r\n        )\r\n    stickyKeys[key] = '{}({})'.format(key, __file__)\r\n\r\n    key = 'fPlanarityTol'; keys.append(key)\r\n    values[key] = sc.doc.ModelAbsoluteTolerance\r\n    riOpts[key] = ri.Custom.OptionDouble(values[key])\r\n    stickyKeys[key] = '{}({})({})'.format(key, __file__, sc.doc.Name)\r\n\r\n    key = 'bSearchOtherSrfs'; keys.append(key)\r\n    values[key] = False\r\n    riOpts[key] = ri.Custom.OptionToggle(values[key], 'No', 'Yes')\r\n    stickyKeys[key] = '{}({})'.format(key, __file__)\r\n\r\n    key = 'bEnableGrips'; keys.append(key)\r\n    values[key] = False\r\n    names[key] = 'OtherSrfsGrips'\r\n    riOpts[key] = ri.Custom.OptionToggle(values[key], 'VisibleOnly', 'EnableAsNeeded')\r\n    stickyKeys[key] = '{}({})'.format(key, __file__)\r\n\r\n    key = 'bEcho'; keys.append(key)\r\n    values[key] = True\r\n    riOpts[key] = ri.Custom.OptionToggle(values[key], 'No', 'Yes')\r\n    stickyKeys[key] = '{}({})'.format(key, __file__)\r\n\r\n    key = 'bDebug'; keys.append(key)\r\n    values[key] = False\r\n    riOpts[key] = ri.Custom.OptionToggle(values[key], 'No', 'Yes')\r\n    stickyKeys[key] = '{}({})'.format(key, __file__)\r\n\r\n\r\n    for key in keys:\r\n        if key not in names:\r\n            names[key] = key[1:]\r\n\r\n\r\n    # Load sticky.\r\n    for key in stickyKeys:\r\n        if stickyKeys[key] in sc.sticky:\r\n            if key in riOpts:\r\n                riOpts[key].CurrentValue = values[key] = sc.sticky[stickyKeys[key]]\r\n            else:\r\n                # For OptionList.\r\n                values[key] = sc.sticky[stickyKeys[key]]\r\n\r\n\r\n    @classmethod\r\n    def addOption(cls, go, key):\r\n\r\n        idxOpt = None\r\n\r\n        if key in cls.riOpts:\r\n            if key[0] == 'b':\r\n                idxOpt = go.AddOptionToggle(\r\n                        cls.names[key], cls.riOpts[key])[0]\r\n            elif key[0] == 'f':\r\n                idxOpt = go.AddOptionDouble(\r\n                    cls.names[key], cls.riOpts[key])[0]\r\n            elif key[0] == 'i':\r\n                idxOpt = go.AddOptionInteger(\r\n                    englishName=cls.names[key], intValue=cls.riOpts[key])[0]\r\n        elif key in cls.listValues:\r\n            idxOpt = go.AddOptionList(\r\n                englishOptionName=cls.names[key],\r\n                listValues=cls.listValues[key],\r\n                listCurrentIndex=cls.values[key])\r\n        else:\r\n            print(\"{} is not a valid key in Opts.\".format(key))\r\n\r\n        return idxOpt\r\n\r\n\r\n    @classmethod\r\n    def setValue(cls, key, idxList=None):\r\n\r\n        if key == 'fPlanarityTol':\r\n            if cls.riOpts[key].CurrentValue < 0.0:\r\n                cls.riOpts[key].CurrentValue = cls.values[key] = cls.riOpts[key].InitialValue\r\n            elif cls.riOpts[key].CurrentValue < Rhino.RhinoMath.ZeroTolerance:\r\n                cls.riOpts[key].CurrentValue = cls.values[key] = Rhino.RhinoMath.ZeroTolerance\r\n            else:\r\n                cls.values[key] = cls.riOpts[key].CurrentValue\r\n            sc.sticky[cls.stickyKeys[key]] = cls.values[key]\r\n            return\r\n\r\n        if key in cls.riOpts:\r\n            cls.values[key] = cls.riOpts[key].CurrentValue\r\n        elif key in cls.listValues:\r\n            cls.values[key] = idxList\r\n        else:\r\n            return\r\n\r\n        sc.sticky[cls.stickyKeys[key]] = cls.values[key]\r\n\r\n\r\ndef _getAllNormalBreps():\r\n    oes = rd.ObjectEnumeratorSettings()\r\n    oes.LockedObjects = False # Default is True.\r\n    oes.ObjectTypeFilter = rd.ObjectType.Brep\r\n    return list(sc.doc.Objects.GetObjectList(oes))\r\n    return [rdB for rdB in sc.doc.Objects.GetObjectList(oes) if rdB.BrepGeometry.IsSurface]\r\n\r\n\r\ndef getInput():\r\n    \"\"\"\r\n    Get grips with optional input.\r\n    \"\"\"\r\n\r\n    idxs_Opt = {}\r\n    def addOption(key): idxs_Opt[key] = Opts.addOption(go, key)\r\n\r\n    while True:\r\n        go = ri.Custom.GetObject()\r\n\r\n        if Opts.values['bDeterminePlaneBy3PlusGripPick']:\r\n            go.SetCommandPrompt(\"Select at least 3 grips for coplanar reference\")\r\n        else:\r\n            go.SetCommandPrompt(\"Select 1 grip for coplanar reference\")\r\n\r\n        go.GeometryFilter = rd.ObjectType.Grip\r\n\r\n        go.AcceptNumber(True, acceptZero=False)\r\n\r\n        bResetGetObject = False\r\n\r\n        while True:\r\n            go.ClearCommandOptions()\r\n            idxs_Opt.clear()\r\n\r\n            key = 'AllSrfGripsOn'; idxs_Opt[key] = go.AddOption(key)\r\n            addOption('bDeterminePlaneBy3PlusGripPick')\r\n            if not Opts.values['bDeterminePlaneBy3PlusGripPick']:\r\n                addOption('iParallelWithPlane')\r\n            addOption('fPlanarityTol')\r\n            addOption('bSearchOtherSrfs')\r\n            if Opts.values['bSearchOtherSrfs']:\r\n                addOption('bEnableGrips')\r\n            addOption('bEcho')\r\n            addOption('bDebug')\r\n\r\n            res = go.GetMultiple(\r\n                minimumNumber=3 if Opts.values['bDeterminePlaneBy3PlusGripPick'] else 1,\r\n                maximumNumber=0 if Opts.values['bDeterminePlaneBy3PlusGripPick'] else 1)\r\n\r\n            if res == ri.GetResult.Cancel:\r\n                go.Dispose()\r\n                return\r\n\r\n            if res == ri.GetResult.Object:\r\n                objrefs = go.Objects()\r\n                go.Dispose()\r\n                return objrefs\r\n\r\n            if res == ri.GetResult.Number:\r\n                key = 'fPlanarityTol'\r\n                Opts.riOpts[key].CurrentValue = go.Number()\r\n                Opts.setValue(key)\r\n                continue\r\n\r\n            if go.Option().Index == idxs_Opt['AllSrfGripsOn']:\r\n                bRedraw = False\r\n                for rdB in _getAllNormalBreps():\r\n                    if not rdB.GripsOn:\r\n                        rdB.GripsOn = True # This doesn't work on polysurface breps.\r\n                        if rdB.GripsOn:\r\n                            bRedraw = True\r\n                if bRedraw:\r\n                    sc.doc.Views.Redraw()\r\n                continue\r\n\r\n            # An option was selected.\r\n            for key in idxs_Opt:\r\n                if go.Option().Index == idxs_Opt[key]:\r\n                    Opts.setValue(key, go.Option().CurrentListOptionIndex)\r\n                    if key == 'bDeterminePlaneBy3PlusGripPick':\r\n                        bResetGetObject = True\r\n                    break\r\n\r\n            if bResetGetObject:\r\n                go.Dispose()\r\n                break\r\n\r\n\r\ndef _colinearDeviation(pts):\r\n    line = rg.Line(pts[0], pts[-1])\r\n    #sc.doc.Objects.AddLine(line_EndEnd)\r\n    devs = []\r\n    for iP in xrange(1, len(pts)-1):\r\n        dev = line.DistanceTo(\r\n            testPoint=pts[iP],\r\n            limitToFiniteSegment=True)\r\n        devs.append(dev)\r\n    return max(devs)\r\n\r\n\r\ndef _areColinear(pts, fLinearTol):\r\n    line = rg.Line(pts[0], pts[-1])\r\n    #sc.doc.Objects.AddLine(line_EndEnd)\r\n    devs = []\r\n    for iP in xrange(1, len(pts)-1):\r\n        fDist = line.DistanceTo(\r\n            testPoint=pts[iP],\r\n            limitToFiniteSegment=True)\r\n        if fDist > fLinearTol:\r\n            return False\r\n    return True\r\n\r\n\r\ndef _tryGetPlane(ref_pts, fPlanarityTol):\r\n    strongbox_plane = StrongBox[rg.Plane]()\r\n    strongbox_double = StrongBox[float]()\r\n\r\n    plane_fit_res = rg.Plane.FitPlaneToPoints(ref_pts, strongbox_plane, strongbox_double)\r\n    if plane_fit_res != rg.PlaneFitResult.Success:\r\n        return (\r\n            False,\r\n            None,\r\n            \"Plane could not be fit through reference point.  {}\".format(plane_fit_res)\r\n            )\r\n\r\n    planarity = strongbox_double.Value\r\n    if planarity > fPlanarityTol:\r\n        return (\r\n            False,\r\n            None,\r\n            \"Plane fit through reference points is out of tolerance ({}).\".format(planarity)\r\n            )\r\n\r\n    plane = strongbox_plane.Value\r\n\r\n    if not plane.IsValid:\r\n        return (\r\n            False,\r\n            None,\r\n            \"Reference points may be colinear.\"\r\n            )\r\n\r\n    fColinearTol = 10.0 * sc.doc.ModelAbsoluteTolerance\r\n\r\n    fColinearDev = _colinearDeviation(ref_pts)\r\n    if fColinearDev <= fColinearTol:\r\n        return (\r\n            False,\r\n            None,\r\n            \"Reference points are colinear within {}.\".format(fColinearDev)\r\n            )\r\n\r\n    # Retired: Faster routine but doesn't provide deviation distance.\r\n    #if _areColinear(ref_pts, fColinearTol):\r\n    #    return (\r\n    #        False,\r\n    #        None,\r\n    #        \"Reference points are colinear within the {} tolerance.\".format(fColinearTol)\r\n    #        )\r\n\r\n    return True, plane, None\r\n\r\n\r\ndef _findCoplanarGrips_Per_1Grip_and_parallelPlane(rhObj, rdGrip_Ref, plane_Parallel, fPlanarityTol):\r\n\r\n    if not rhObj.GripsOn:\r\n        rhObj.GripsOn = True\r\n        if not rhObj.GripsOn:\r\n            return\r\n\r\n    rdGrips_All_of_obj = rhObj.GetGrips()\r\n    if rdGrips_All_of_obj is None:\r\n        return\r\n\r\n    plane_Ref = rg.Plane(plane_Parallel)\r\n    plane_Ref.Origin = rdGrip_Ref.CurrentLocation\r\n\r\n    #sc.doc.Objects.AddSurface(rg.PlaneSurface(plane_Ref))\r\n\r\n    rdGrips_Added = []\r\n\r\n    sEval = \"fPlanarityTol\"; print(sEval,'=',eval(sEval))\r\n\r\n    for rdGrip in rdGrips_All_of_obj:\r\n\r\n        if rdGrip.Id == rdGrip_Ref.Id:\r\n            continue\r\n\r\n        pt = rdGrip.CurrentLocation\r\n\r\n        dist = abs(plane_Ref.DistanceTo(pt)) # abs because this method returns a signed distance.\r\n\r\n        if dist <= fPlanarityTol:\r\n            #sEval = \"dist\"; print(sEval,'=',eval(sEval))\r\n            rdGrips_Added.append(rdGrip)\r\n\r\n    return rdGrips_Added\r\n\r\n\r\ndef _findCoplanarGrips_AddingWithRefGrips(rhObj, rdGrips_Ref, fPlanarityTol):\r\n    \"\"\"\r\n    The tolerance creeps from ZeroTolerance to fPlanarityTol so that grips are added more in the\r\n    order of how coplanar they are will grips already in list, and less by their\r\n    order from GetGrips().\r\n    \"\"\"\r\n    if not rhObj.GripsOn:\r\n        rhObj.GripsOn = True\r\n        if not rhObj.GripsOn:\r\n            return\r\n\r\n    # APC = ArePointsCoplanar.\r\n    rdGrips_Passed = []\r\n    gGrips_Ref = [_.Id for _ in rdGrips_Ref]\r\n    pts_Passed = [_.CurrentLocation for _ in rdGrips_Ref]\r\n\r\n    rdGrips_toCheck = [_ for _ in rhObj.GetGrips() if _.Id not in gGrips_Ref]\r\n    if rdGrips_toCheck is None:\r\n        return\r\n\r\n    iExponent = 0\r\n    fTol = Rhino.RhinoMath.ZeroTolerance\r\n    bMaxTolReach = fPlanarityTol < fTol\r\n\r\n    while not bMaxTolReach:\r\n        sc.escape_test()\r\n\r\n        fTol = Rhino.RhinoMath.ZeroTolerance*(10**(iExponent))\r\n\r\n        if fTol >= fPlanarityTol:\r\n            fTol = fPlanarityTol\r\n            bMaxTolReach = True\r\n\r\n        rdGrips_Failed = []\r\n\r\n        for rdGrip in rdGrips_toCheck:\r\n            pt = rdGrip.CurrentLocation\r\n\r\n            if rg.Point3d.ArePointsCoplanar(pts_Passed+[pt], tolerance=fTol):\r\n                rdGrips_Passed.append(rdGrip)\r\n                pts_Passed.append(pt)\r\n            else:\r\n                rdGrips_Failed.append(rdGrip)\r\n\r\n            if not rdGrips_Failed:\r\n                return rdGrips_Passed\r\n\r\n        rdGrips_toCheck = rdGrips_Failed\r\n\r\n        iExponent += 1\r\n\r\n    return rdGrips_Passed\r\n\r\n\r\ndef _printGripsAddedFeedback(rdGrips_Added, rdGrips_Ref):\r\n    if not rdGrips_Added:\r\n        print(\"No grips were added to the selection of {}.\".format(\r\n            len(rdGrips_Ref)))\r\n    else:\r\n        print(\"{} grips were added to the selection of {} for a total of {}.\".format(\r\n            len(rdGrips_Added), len(rdGrips_Ref), len(rdGrips_Added) + len(rdGrips_Ref)))\r\n\r\n\r\ndef selectGrips_planePerMultipleGrips(objref_Grips_Ref, fPlanarityTol=Rhino.RhinoMath.ZeroTolerance, bSearchOtherSrfs=False, bEnableGrips=True, bEcho=True, bDebug=False):\r\n    \"\"\"\r\n    \"\"\"\r\n\r\n    rdGrips_Ref = []\r\n    pts_Grips_Refs = []\r\n    gOwners_of_RefGrips = []\r\n\r\n    for o in objref_Grips_Ref:\r\n        rdGrip_Ref = o.Object()\r\n        rdGrips_Ref.append(rdGrip_Ref)\r\n        pts_Grips_Refs.append(rdGrip_Ref.CurrentLocation)\r\n        gOwners_of_RefGrips.append(rdGrip_Ref.OwnerId)\r\n\r\n    #sEval = \"gOwners_of_RefGrips\"; print(sEval,'=',eval(sEval))\r\n\r\n    bSuccess, plane, sLog = _tryGetPlane(pts_Grips_Refs, fPlanarityTol)\r\n    if not bSuccess:\r\n        if bEcho and sLog: print(sLog)\r\n        return\r\n\r\n    rdGrips_Added_All = []\r\n\r\n    for gOwner in set(gOwners_of_RefGrips):\r\n        rdOwner = sc.doc.Objects.FindId(gOwner)\r\n        rdGrips_Added_this_object = _findCoplanarGrips_AddingWithRefGrips(\r\n            rdOwner,\r\n            rdGrips_Ref=rdGrips_Ref,\r\n            fPlanarityTol=fPlanarityTol,\r\n            )\r\n        rdGrips_Added_All.extend(rdGrips_Added_this_object)\r\n\r\n    if bSearchOtherSrfs:\r\n        iter = rd.ObjectEnumeratorSettings()\r\n        iter.LockedObjects = False\r\n\r\n        for rdObj in sc.doc.Objects.GetObjectList(iter):\r\n            if rdObj.ObjectType != rd.ObjectType.Brep:\r\n                continue\r\n            if rdObj.BrepGeometry.Faces.Count > 1:\r\n                continue\r\n            if rdObj.Id in gOwners_of_RefGrips:\r\n                continue\r\n            bGripsWereEnabled = rdObj.GripsOn\r\n            if not bEnableGrips and not bGripsWereEnabled:\r\n                continue\r\n\r\n            rdGrips_Added_this_object = _findCoplanarGrips_AddingWithRefGrips(\r\n                rdObj,\r\n                rdGrips_Ref=rdGrips_Ref,\r\n                fPlanarityTol=fPlanarityTol,\r\n                )\r\n\r\n            if rdGrips_Added_this_object:\r\n                rdGrips_Added_All.extend(rdGrips_Added_this_object)\r\n            else:\r\n                if not bGripsWereEnabled:\r\n                    rdObj.GripsOn = False\r\n\r\n    for rdGrip_Ref in rdGrips_Ref:\r\n        rdGrip_Ref.Select(True, syncHighlight=True) # For persistant selection.\r\n\r\n    for rdGrip in rdGrips_Added_All:\r\n        rdGrip.Select(True, syncHighlight=True) # For persistant selection.\r\n\r\n    if bEcho:\r\n        _printGripsAddedFeedback(rdGrips_Added_All, rdGrips_Ref)\r\n\r\n\r\ndef _getParallelToPlane(iParallelWithPlane):\r\n    if Opts.listValues['iParallelWithPlane'][iParallelWithPlane] == 'CPlaneXY':\r\n        return sc.doc.Views.ActiveView.ActiveViewport.ConstructionPlane()\r\n    if Opts.listValues['iParallelWithPlane'][iParallelWithPlane] == 'CPlaneYZ':\r\n        cplane = sc.doc.Views.ActiveView.ActiveViewport.ConstructionPlane()\r\n        return rg.Plane(origin=cplane.Origin, normal=cplane.XAxis)\r\n    if Opts.listValues['iParallelWithPlane'][iParallelWithPlane] == 'CPlaneZX':\r\n        cplane = sc.doc.Views.ActiveView.ActiveViewport.ConstructionPlane()\r\n        return rg.Plane(origin=cplane.Origin, normal=-cplane.YAxis)\r\n    elif Opts.listValues['iParallelWithPlane'][iParallelWithPlane] == 'WorldXY':\r\n        return rg.Plane.WorldXY\r\n    elif Opts.listValues['iParallelWithPlane'][iParallelWithPlane] == 'WorldYZ':\r\n        return rg.Plane.WorldYZ\r\n    elif Opts.listValues['iParallelWithPlane'][iParallelWithPlane] == 'WorldZX':\r\n        return rg.Plane.WorldZX\r\n    #elif Opts.listValues['iParallelWithPlane'][iParallelWithPlane] == 'View':\r\n    #    return sc.doc.Views.ActiveView.ActiveViewport.GetCameraFrame()[1].ZAxis\r\n    #elif Opts.listValues['iParallelWithPlane'][iParallelWithPlane] == 'Custom':\r\n    #    return Opts.values['vectCustom']\r\n    raise Exception(\"What happened?\")\r\n\r\n\r\ndef selectGrips_Per_1Grip_and_parallelPlane(objref_Grip_Ref, iParallelWithPlane=3, fPlanarityTol=Rhino.RhinoMath.ZeroTolerance, bSearchOtherSrfs=False, bEnableGrips=True, bEcho=True, bDebug=False):\r\n    \"\"\"\r\n    \"\"\"\r\n\r\n    rdGrip_Ref = objref_Grip_Ref.Object()\r\n    rdOwner = sc.doc.Objects.FindId(rdGrip_Ref.OwnerId)\r\n\r\n    plane_Parallel = _getParallelToPlane(Opts.values['iParallelWithPlane'])\r\n\r\n    rdGrips_Added_All = _findCoplanarGrips_Per_1Grip_and_parallelPlane(\r\n        rdOwner,\r\n        rdGrip_Ref=rdGrip_Ref,\r\n        plane_Parallel=plane_Parallel,\r\n        fPlanarityTol=fPlanarityTol,\r\n        )\r\n\r\n    if bSearchOtherSrfs:\r\n        iter = rd.ObjectEnumeratorSettings()\r\n        iter.LockedObjects = False\r\n\r\n        for rdObj in sc.doc.Objects.GetObjectList(iter):\r\n            if rdObj.ObjectType != rd.ObjectType.Brep:\r\n                continue\r\n            if rdObj.BrepGeometry.Faces.Count > 1:\r\n                continue\r\n            if rdObj.Id == rdGrip_Ref.OwnerId:\r\n                continue\r\n            bGripsWereEnabled = rdObj.GripsOn\r\n            if not bEnableGrips and not bGripsWereEnabled:\r\n                continue\r\n\r\n            rdGrips_Added_this_object = _findCoplanarGrips_Per_1Grip_and_parallelPlane(\r\n                rdObj,\r\n                rdGrip_Ref=rdGrip_Ref,\r\n                plane_Parallel=plane_Parallel,\r\n                fPlanarityTol=fPlanarityTol,\r\n                )\r\n\r\n            if rdGrips_Added_this_object:\r\n                rdGrips_Added_All.extend(rdGrips_Added_this_object)\r\n            else:\r\n                if not bGripsWereEnabled:\r\n                    rdObj.GripsOn = False\r\n\r\n    rdGrip_Ref.Select(True, syncHighlight=True) # For persistant selection.\r\n\r\n    for rdGrip in rdGrips_Added_All:\r\n        rdGrip.Select(True, syncHighlight=True) # For persistant selection.\r\n\r\n    if bEcho:\r\n        _printGripsAddedFeedback(rdGrips_Added_All, [rdGrip_Ref])\r\n\r\n\r\ndef main():\r\n\r\n    objrefx = getInput()\r\n    if objrefx is None: return\r\n\r\n    bDeterminePlaneBy3PlusGripPick = Opts.values['bDeterminePlaneBy3PlusGripPick']\r\n    iParallelWithPlane = Opts.values['iParallelWithPlane']\r\n    fPlanarityTol = Opts.values['fPlanarityTol']\r\n    bSearchOtherSrfs = Opts.values['bSearchOtherSrfs']\r\n    bEnableGrips = Opts.values['bEnableGrips']\r\n    bEcho = Opts.values['bEcho']\r\n    bDebug = Opts.values['bDebug']\r\n\r\n    if not bDebug: sc.doc.Views.RedrawEnabled = False\r\n\r\n    Rhino.RhinoApp.SetCommandPrompt(\"Working ...\")\r\n\r\n    if bDeterminePlaneBy3PlusGripPick:\r\n\r\n        selectGrips_planePerMultipleGrips(\r\n            objrefx,\r\n            fPlanarityTol=fPlanarityTol,\r\n            bSearchOtherSrfs=bSearchOtherSrfs,\r\n            bEnableGrips=bEnableGrips,\r\n            bEcho=bEcho,\r\n            bDebug=bDebug,\r\n        )\r\n    else:\r\n        selectGrips_Per_1Grip_and_parallelPlane(\r\n            objrefx[0],\r\n            iParallelWithPlane=iParallelWithPlane,\r\n            fPlanarityTol=fPlanarityTol,\r\n            bSearchOtherSrfs=bSearchOtherSrfs,\r\n            bEnableGrips=bEnableGrips,\r\n            bEcho=bEcho,\r\n            bDebug=bDebug,\r\n        )\r\n\r\n    sc.doc.Views.RedrawEnabled = True\r\n\r\n\r\nif __name__ == '__main__': main()",
  "language": "python",
  "imports": [
    "Rhino",
    "Rhino.Geometry",
    "scriptcontext"
  ],
  "has_docstring": false
}