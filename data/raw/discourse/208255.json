{
  "source_url": "https://discourse.mcneel.com/t/bug-worksession-is-null-after-rhinodoc-openheadless/208255",
  "topic_id": 208255,
  "title": "BUG: Worksession is null after RhinoDoc.OpenHeadless",
  "question": "After opening a headless Rhino document the Worksession property unexpectedly becomes null, leaving orphaned layers and objects in the original document. This behavior is not expected, as the original documentâ€™s Worksession should remain intact\n\n\n// Assume 'doc' is already open main RhinoDoc instance\ndoc.Worksession != null; // good \nRhino.RhinoDoc headlessDoc = Rhino.RhinoDoc.OpenHeadless(refPath);\nheadlessDoc.Dispose();\ndoc.Worksession == null; // unexpected",
  "code_blocks": [
    {
      "code": "// Assume 'doc' is already open main RhinoDoc instance\ndoc.Worksession != null; // good \nRhino.RhinoDoc headlessDoc = Rhino.RhinoDoc.OpenHeadless(refPath);\nheadlessDoc.Dispose();\ndoc.Worksession == null; // unexpected",
      "language": "csharp",
      "author": "jomo150",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "file-io",
    "layers"
  ],
  "has_accepted_answer": false,
  "category_id": 3,
  "posts_count": 1,
  "views": 31
}