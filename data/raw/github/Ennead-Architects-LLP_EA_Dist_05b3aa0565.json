{
  "source_url": "https://github.com/Ennead-Architects-LLP/EA_Dist/blob/635520d89b8308b78eabf5b60bb80121d0fa3838/Apps/lib/EnneadTab/RHINO/RHINO_PROJ_DATA.py",
  "repo": "Ennead-Architects-LLP/EA_Dist",
  "repo_stars": 0,
  "repo_description": null,
  "license": "unknown",
  "filepath": "Apps/lib/EnneadTab/RHINO/RHINO_PROJ_DATA.py",
  "instruction": "Rhino proj data",
  "code": "import os\r\nimport sys\r\nimport json\r\nroot_folder = os.path.abspath((os.path.dirname(os.path.dirname(os.path.abspath(__file__)))))\r\nsys.path.append(root_folder)\r\nimport ENVIRONMENT\r\n\r\nif ENVIRONMENT.IS_RHINO_ENVIRONMENT:\r\n    import Rhino # pyright: ignore\r\n    import rhinoscriptsyntax as rs\r\n    import scriptcontext as sc\r\n\r\n\r\n\r\nclass DocKeys:\r\n    \"\"\"standardlize the keys for the document data\"\"\"\r\n    PreferredGrasshopperFile = \"Preferred Grasshopper File\"\r\n    GrasshopperInput = \"Grasshopper Input\"\r\n    GFA_TARGET_DICT = \"GFA Target Dict\"\r\n    \r\n\r\ndef inspect_document_data():\r\n    \"\"\"Print all document data sections and entries in the current Rhino file.\r\n    \r\n    Displays data in format: [section]entry : value\r\n    Returns None if no document data is found.\r\n    \"\"\"\r\n    if not rs.IsDocumentData():\r\n        print (\"No document data found\")\r\n        return \r\n    all_sections = rs.GetDocumentData()\r\n    for section in all_sections:\r\n        all_entries = rs.GetDocumentData(section)\r\n        for entry in all_entries:\r\n            print (\"[{}]{} : {}\".format(section, entry, rs.GetDocumentData(section, entry)))\r\n\r\n\r\ndef get_rhino_project_data():\r\n    \"\"\"Retrieve and parse all document data from the current Rhino file.\r\n    \r\n    Returns:\r\n        dict: Nested dictionary containing all document data organized by sections.\r\n            Structure: {section: {entry: value}}\r\n            Values are automatically parsed in following order:\r\n            1. JSON dictionary\r\n            2. Boolean (true/false)\r\n            3. Numeric (float/integer)\r\n            4. String (default)\r\n            \r\n        Returns empty dict if no document data exists.\r\n    \"\"\"\r\n    if not rs.IsDocumentData():\r\n        return dict()\r\n\r\n    data = dict()\r\n    all_sections = rs.GetDocumentData()\r\n    for section in all_sections:\r\n        data[section] = dict()  # Initialize nested dictionary for each section\r\n        all_entries = rs.GetDocumentData(section)\r\n        for entry in all_entries:\r\n            value = rs.GetDocumentData(section, entry)\r\n            try:\r\n                # Try parsing as JSON (dict)\r\n                value = json.loads(value)\r\n            except:\r\n                # Try parsing as bool\r\n                if value.lower() in ('true', 'false'):\r\n                    value = value.lower() == 'true'\r\n                else:\r\n                    try:\r\n                        # Try parsing as float\r\n                        value = float(value)\r\n                        # Convert to int if no decimal places\r\n                        if value.is_integer():\r\n                            value = int(value)\r\n                    except:\r\n                        # Keep as string if all other parsing fails\r\n                        pass\r\n            data[section][entry] = value\r\n    return data\r\n\r\n\r\ndef set_rhino_project_data(data):\r\n    \"\"\"Store project data into the Rhino document dictionary.\r\n    \r\n    Args:\r\n        data (dict): Nested dictionary containing project data to save.\r\n            Expected structure: {section: {entry: value}}\r\n            Dictionary values are automatically converted to JSON strings.\r\n            All other values are converted to strings.\r\n    \"\"\"\r\n    for section in data:\r\n        for entry in data[section]:\r\n            value = data[section][entry]\r\n            if isinstance(value, dict):\r\n                value = json.dumps(value)\r\n            else:\r\n                value = str(value)\r\n            rs.SetDocumentData(section, entry, value)\r\n\r\n\r\n\r\ndef get_plugin_data():\r\n    \"\"\"Retrieve plugin-specific data from the document dictionary.\r\n    \r\n    Returns:\r\n        dict: Dictionary containing plugin data.\r\n            Returns empty dict if no plugin section exists.\r\n    \"\"\"\r\n    data = get_rhino_project_data()\r\n    return data.get(ENVIRONMENT.PLUGIN_NAME, dict())\r\n\r\n\r\ndef set_plugin_data(data):\r\n    \"\"\"Store plugin-specific data in the document dictionary.\r\n    \r\n    Args:\r\n        data (dict): Dictionary containing plugin data to save.\r\n            Data will be stored under the 'plugin_name' section.\r\n            Existing plugin data will be overwritten.\r\n    \"\"\"\r\n    project_data = get_rhino_project_data()\r\n    project_data[ENVIRONMENT.PLUGIN_NAME] = data\r\n    set_rhino_project_data(project_data)\r\n\r\n\r\n",
  "language": "python",
  "imports": [
    "Rhino",
    "rhinoscriptsyntax",
    "scriptcontext"
  ],
  "has_docstring": false
}