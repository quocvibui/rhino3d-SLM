{
  "source_url": "https://github.com/TfedUD/PyPH/blob/87fe2ec207a8b0ddcd3fbb682ea71368c11b580a/PyPH_GH/ghuser_py/PyPH%20-%20PHIUS%20MF%20Calculator.py",
  "repo": "TfedUD/PyPH",
  "repo_stars": 0,
  "repo_description": "Python toolkit for working with Passive House energy models",
  "license": "GPL-3.0",
  "filepath": "PyPH_GH/ghuser_py/PyPH - PHIUS MF Calculator.py",
  "instruction": "Calculate lighting and electrical (MEL) loads according to the PHIUS Multifamily \nCalculator (Floor Method).\n-----\n-\nEM September 28, 2021\n    Args:\n        \n        lighting_frac_HE_ext_: (float)...",
  "code": "#\n# PyPH: A Plugin for aadding Passive-House data to LadybugTools Models\n# \n# This component is part of the PH-Tools toolkit <https://github.com/PH-Tools>.\n# \n# Copyright (c) 2021, PH-Tools and bldgtyp, llc <phtools@bldgtyp.com> \n# PyPH is free software; you can redistribute it and/or modify \n# it under the terms of the GNU General Public License as published \n# by the Free Software Foundation; either version 3 of the License, \n# or (at your option) any later version. \n# \n# PyPH is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of \n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the \n# GNU General Public License for more details.\n# \n# For a copy of the GNU General Public License\n# see <https://github.com/PH-Tools/PyPH/blob/main/LICENSE>.\n# \n# @license GPL-3.0+ <http://spdx.org/licenses/GPL-3.0+>\n#\n\"\"\"\nCalculate lighting and electrical (MEL) loads according to the PHIUS Multifamily \nCalculator (Floor Method).\n-----\n-\nEM September 28, 2021\n    Args:\n        \n        lighting_frac_HE_ext_: (float) Fraction of the exterior lighting which is 'high efficiency'\n        lighting_frac_HE_int_: (float) Fraction of the interior lighting which is 'high efficiency'\n        lighting_frac_HE_garage_: (float) Fraction of the garage lighting which is 'high efficiency'\n        _HB_rooms: (Honeybee Rooms): The Honeybee Rooms to calculate the values for\n    Returns:\n        lighting_exterior_: (kWh/dwelling-unit) Pass these values to a PHX Appliances component to set the values.\n        lighting_interior_: (kWh/dwelling-unit) Pass these values to a PHX Appliances component to set the values.\n        lighting_garage_: (kWh/dwelling-unit) Pass these values to a PHX Appliances component to set the values.\n        mel_: (kWh/dwelling-unit) Pass these values to a PHX Appliances component to set the values.\n        HB_rooms_: The Honeybee Rooms\n        ----\n        non_res_spaces_: For PHIUS Multifamily calculator. Copy/Paste values to spreadsheet\n        non_res_space_types_: For PHIUS Multifamily calculator. Copy/Paste values to spreadsheet\n\"\"\"\n\nimport scriptcontext as sc\nimport Rhino as rh\nimport rhinoscriptsyntax as rs\nimport ghpythonlib.components as ghc\nimport Grasshopper as gh\n\n\nimport PHX.programs.occupancy\nimport PyPH_Rhino.phius_MF_electric\nimport PyPH_Rhino.gh_io\n\n# --\nimport PyPH_GH._component_info_\nreload(PyPH_GH._component_info_)\nghenv.Component.Name = \"PyPH - PHIUS MF Calculator\"\nDEV = True\nPyPH_GH._component_info_.set_component_params(ghenv, dev='SEP_28_2021')\n\nif DEV:\n    reload(PHX.programs.occupancy)\n    reload(PyPH_Rhino.phius_MF_electric)\n    reload(PyPH_Rhino.gh_io)\n\n# -- GH Interface\nIGH = PyPH_Rhino.gh_io.IGH( ghdoc, ghenv, sc, rh, rs, ghc, gh )\n\nlighting_exterior_ = []\nlighting_interior_ = []\nlighting_garage_ = []\nmel_ = []\nnon_res_spaces_ = []\nnon_res_space_types_ = []\nspace_types_dict = {}\nHB_rooms_ = []\n\nstories_dict = PyPH_Rhino.phius_MF_electric.sort_rooms_by_story(_HB_rooms)\nfor room_list in stories_dict.values():\n    # -- Filter Residential Rooms from Non-Residential\n    non_res_rooms = []\n    res_rooms = []\n    for room in room_list:\n        room_occupancy = PHX.programs.occupancy.ZoneOccupancy.from_dict( room.user_data.get('phx', {}).get('zone_occupancy', {}) )\n        if room_occupancy.num_dwelling_units > 0:\n            res_rooms.append(room)\n        else:\n           non_res_rooms.append(room)\n    \n    # -- Calc Non-Residential Values\n    for room in non_res_rooms:\n        # -- Calculate all values using Honeybee Program first\n        lighting = PyPH_Rhino.phius_MF_electric.hb_lighting_values(room)\n        mel = PyPH_Rhino.phius_MF_electric.hb_mel_values(room)\n        \n        # -- For PHIUS MF Spreadsheet\n        room_type = room.properties.energy.program_type.display_name\n        space_types_dict[room_type] = (\n                    room_type,\n                    lighting.util_day_per_yr,\n                    lighting.daily_operating_hrs,\n                    lighting.w_sf,\n                    mel.kWh_sf_yr,\n                    )\n        \n        results = PyPH_Rhino.phius_MF_electric.annual_lighting_and_mel(room, lighting, mel)\n        lighting_exterior_.append(0)\n        lighting_interior_.append(results.lighting_annual_kWh)\n        lighting_garage_.append(0)\n        mel_.append(results.mel_annual_kWh)\n        non_res_spaces_.extend(results.spaces)\n        \n        HB_rooms_.append(room)\n    \n    # -- Calculate Residential Values\n    attrs = PyPH_Rhino.phius_MF_electric.get_room_attributes(res_rooms)\n    \n    l_ext = PyPH_Rhino.phius_MF_electric.story_lighting_exterior(attrs.m2_per_unit, attrs.num_dwelling_units, lighting_frac_HE_ext_)\n    l_int = PyPH_Rhino.phius_MF_electric.story_lighting_interior(attrs.m2_per_unit, attrs.num_dwelling_units, lighting_frac_HE_int_)\n    l_gar = PyPH_Rhino.phius_MF_electric.story_lighting_garage(attrs.num_dwelling_units, lighting_frac_HE_garage_)\n    mel = PyPH_Rhino.phius_MF_electric.story_mel(attrs.m2_per_unit, attrs.num_dwelling_units, attrs.num_bedrooms)\n    \n    for room in res_rooms:\n        lighting_exterior_.append( l_ext / attrs.num_dwelling_units )\n        lighting_interior_.append( l_int / attrs.num_dwelling_units )\n        lighting_garage_.append( l_gar / attrs.num_dwelling_units )\n        mel_.append( mel / attrs.num_dwelling_units )\n        \n        HB_rooms_.append(room)\n\n\n# -- For PHIUS MF Calculator Spreadsheet\nfor k, v in space_types_dict.items():\n    non_res_space_types_.append(\"{},{},{},{},{}\".format(*v) )\n",
  "language": "python",
  "imports": [
    "Rhino",
    "ghpythonlib",
    "rhinoscriptsyntax",
    "scriptcontext"
  ],
  "has_docstring": true
}