{
  "source_url": "https://github.com/PH-Tools/honeybee_grasshopper_ph/blob/c433bc8e66f3a51fd05ee4c485f4c54c03d2a569/honeybee_ph_rhino/gh_compo_io/space_add_spc.py",
  "repo": "PH-Tools/honeybee_grasshopper_ph",
  "repo_stars": 6,
  "repo_description": "Honeybe-PH plugin for Rhino / Grasshopper ",
  "license": "GPL-3.0",
  "filepath": "honeybee_ph_rhino/gh_compo_io/space_add_spc.py",
  "instruction": "GHCompo Interface: HBPH - Add Spaces.",
  "code": "# -*- Python Version: 2.7 -*-\n# -*- coding: utf-8 -*-\n\n\"\"\"GHCompo Interface: HBPH - Add Spaces.\"\"\"\n\ntry:\n    from typing import List, Optional, Tuple\nexcept ImportError:\n    pass  # IronPython 2.7\n\ntry:\n    from Rhino.Geometry import Point3d  # type: ignore\nexcept ImportError as e:\n    raise ImportError(\"Failed to import Rhino.Geometry.\\n{}\".format(e))\n\ntry:\n    from ladybug_rhino.fromgeometry import from_point3d\nexcept ImportError as e:\n    raise ImportError(\"\\nFailed to import ladybug_rhino:\\n\\t{}\".format(e))\n\ntry:\n    from honeybee import room\nexcept ImportError as e:\n    raise ImportError(\"\\nFailed to import honeybee:\\n\\t{}\".format(e))\n\ntry:\n    from honeybee_ph import space\nexcept ImportError as e:\n    raise ImportError(\"\\nFailed to import honeybee_ph:\\n\\t{}\".format(e))\n\ntry:\n    from honeybee_ph_rhino import gh_io\n    from honeybee_ph_rhino.make_spaces import make_space\nexcept ImportError as e:\n    raise ImportError(\"\\nFailed to import honeybee_ph_rhino:\\n\\t{}\".format(e))\n\ntry:\n    from ph_units.converter import convert\n    from ph_units.parser import parse_input\nexcept ImportError as e:\n    raise ImportError(\"\\nFailed to import ph_units:\\n\\t{}\".format(e))\n\n\nclass GHCompo_AddPHSpaces(object):\n    def __init__(self, _IGH, _spaces, _offset_dist, _inh_rm_nms, _hb_rooms):\n        # type: (gh_io.IGH, List[space.Space], Optional[float], bool, List[room.Room]) -> None\n\n        self.IGH = _IGH\n        self.spaces = _spaces\n        self.offset_dist = _offset_dist or \"0.1 M\"\n        self.inherit_room_names = _inh_rm_nms\n        self.hb_rooms = _hb_rooms\n\n    def ready(self):\n        return all([len(self.spaces) != 0 and len(self.hb_rooms) != 0])\n\n    def run(self):\n        # type: () -> Tuple[List[room.Room], List[Point3D], List[room.Room]]\n        if not self.ready():\n            return self.hb_rooms, [], []\n\n        # ---------------------------------------------------------------------\n        # -- Get the offset distance in Rhino document units\n        val, unit = parse_input(self.offset_dist)\n        doc_unit_name = self.IGH.get_rhino_unit_system_name()\n        offset_dist = convert(val, unit or doc_unit_name, doc_unit_name)\n\n        # ---------------------------------------------------------------------\n        # -- Clean up the input spaces, host in the HB-Rooms\n        spaces = [make_space.offset_space_reference_points(self.IGH, sp, offset_dist) for sp in self.spaces]\n        (\n            hb_rooms_,\n            un_hosted_spaces,\n            open_rooms_,\n        ) = make_space.add_spaces_to_honeybee_rooms(spaces, self.hb_rooms, self.inherit_room_names)\n\n        # ---------------------------------------------------------------------\n        # -- Warn if any open rooms\n        if open_rooms_:\n            msg = \"Error: Honeybee-Room are not closed: {}\".format(open_rooms_)\n            self.IGH.error(msg)\n\n        # ---------------------------------------------------------------------\n        # -- If any un_hosted_spaces, pull out their center points for troubleshooting\n        # -- and raise a user-warning\n        check_pts_ = [from_point3d(lbt_pt) for space_data in un_hosted_spaces for lbt_pt in space_data.reference_points]\n        if un_hosted_spaces:\n            msg = \"Error: No host Honeybee-Rooms were found for the Spaces: '{}'\".format(\n                \"\\n\".join([spd.space.full_name for spd in un_hosted_spaces])\n            )\n            print(msg)\n            self.IGH.error(msg)\n\n        # ---------------------------------------------------------------------\n        return hb_rooms_, check_pts_, open_rooms_\n",
  "language": "python",
  "imports": [
    "Rhino",
    "Rhino.Geometry"
  ],
  "has_docstring": true
}