{
  "source_url": "https://discourse.mcneel.com/t/python-script-embedded-in-rhino-button-issue/189761",
  "topic_id": 189761,
  "title": "Python Script Embedded in Rhino Button Issue",
  "question": "Hi All,\n\n\nI have a downloaded a python script to convert material colours to object colours for the purpose of exporting to autocad. It works perfectly when running it from the python script interface through rhino, but for some unknown reason when I embedded that script within a custom rhino button it doesn’t seem to work.\n\n\nI am a little unsure what is causing the issue as I have several custom buttons set-up in the same manner that work perfectly. Below is the original python code embedded in the rhino button.\n\n\n! _-RunPythonScript (\n\n\nimport rhinoscriptsyntax as rs\n\n\ndef MaterialColorToObject():\n\nids = rs.GetObjects(“Select objects”,preselect=True)\n\nif not ids:return\n\n\nfor id in ids:\n    idx = rs.ObjectMaterialIndex(id)\n    if idx == -1:\n        color = (250,250,250)\n\n\n\nif \nname\n == ‘\nmain\n’:MaterialColorToObject()\n\n\n)\n\n\nAny advice on how to get it running through a rhino button would be greatly appreciated.\n\n\nCheers,\n\nMichael",
  "code_blocks": [
    {
      "code": "import rhinoscriptsyntax as rs\n\ndef MaterialColorToObject():\nids = rs.GetObjects(“Select objects”,preselect=True)\nif not ids:return\n\nfor id in ids:\n    idx = rs.ObjectMaterialIndex(id)\n    if idx == -1:\n        color = (250,250,250)\n\nMaterialColorToObject()",
      "language": "python",
      "author": "michaelvollrath",
      "post_number": 2,
      "is_solution": false
    },
    {
      "code": "import rhinoscriptsyntax as rs\n\ndef MaterialColorToObject():\n\tids = rs.GetObjects(“Select objects”,preselect=True)\n\tif not ids:\n\t\treturn\n\n\tfor id in ids:\n\t\tidx = rs.ObjectMaterialIndex(id)\n\t\tif idx == -1:\n\t\t\tcolor = (250,250,250)\n\nMaterialColorToObject()",
      "language": "python",
      "author": "michaelvollrath",
      "post_number": 4,
      "is_solution": true
    },
    {
      "code": "for id in ids:\n    idx = rs.ObjectMaterialIndex(id)\n    if idx == -1:\n        color = (250,250,250)",
      "language": "python",
      "author": "m.wilson",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "file-io",
    "materials",
    "python",
    "rhinoscriptsyntax",
    "selection"
  ],
  "has_accepted_answer": true,
  "category_id": 147,
  "posts_count": 6,
  "views": 117
}