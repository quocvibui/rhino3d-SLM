{
  "source_url": "https://discourse.mcneel.com/t/rhino-python-scripting-help-for-nurbs-modeling/27727",
  "topic_id": 27727,
  "title": "Rhino python scripting help for NURBS modeling",
  "question": "I wish to draw a NURBS curve of degree 7 and with 8 control points. Iâ€™ve written the following code but this is not working somehow .Could anyone please help me out with this.Thanks.\n\n\nimport Rhino\n\nimport scriptcontext\n\ndef TestNurbsCurve():\n\ndegree = 7\n\ncv_count = 8\n\nknot_count = cv_count + degree - 1\n\norder = degree + 1\n\ncvs = []\n\ncvs.append(Rhino.Geometry.Point3d(0.0, 0.0, 0.0))\n\ncvs.append(Rhino.Geometry.Point3d(458.0, 0.0, 0.0))\n\ncvs.append(Rhino.Geometry.Point3d(458.0, 229.0, 0.0))\n\ncvs.append(Rhino.Geometry.Point3d(458.0, 458.0, 0.0))\n\ncvs.append(Rhino.Geometry.Point3d(0.0, 458.0, 0.0))\n\ncvs.append(Rhino.Geometry.Point3d(458.0, 686.0, 0.0))\n\ncvs.append(Rhino.Geometry.Point3d(0.0, 915.0, 0.0))\n\ncvs.append(Rhino.Geometry.Point3d(458.0, 915.0, 0.0))\n\nknots = []\n\nknots.append(0.0)\n\nknots.append(0.0)\n\nknots.append(0.0)\n\nknots.append(1.0)\n\nknots.append(2.0)\n\nknots.append(3.0)\n\nknots.append(3.0)\n\nknots.append(3.0)\n\nknots.append(5.0)\n\nknots.append(5.0)\n\nknots.append(5.0)\n\nknots.append(6.0)\n\nknots.append(6.0)\n\nknots.append(6.0)\n\ncurve = Rhino.Geometry.NurbsCurve(degree, False, order, cv_count)\n\nfor i in xrange(cv_count):\n\ncurve.Points.SetPoint(i, cvs[i])\n\nfor i in xrange(knot_count):\n\ncurve.Knots[i] = knots[i]\n\nif curve.IsValid:\n\nscriptcontext.doc.Objects.AddCurve(curve)\n\nscriptcontext.doc.Views.Redraw()\n\nTestNurbsCurve()",
  "code_blocks": [
    {
      "code": "filename = name\nfolder = \"D:/Sachin/\"\npath = os.path.abspath(folder + filename)\ncmd = \"_-SaveAs \" + chr(34) + path + chr(34)\nrs.Command(cmd, True)",
      "language": "python",
      "author": "Sachin_Saxena1",
      "post_number": 5,
      "is_solution": false
    }
  ],
  "tags": [
    "file-io",
    "geometry",
    "nurbs",
    "python",
    "rhinocommon"
  ],
  "has_accepted_answer": false,
  "category_id": 11,
  "posts_count": 5,
  "views": 1536
}