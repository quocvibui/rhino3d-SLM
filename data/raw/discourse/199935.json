{
  "source_url": "https://discourse.mcneel.com/t/cancel-and-ok-buttons-in-eto-form/199935",
  "topic_id": 199935,
  "title": "Cancel and Ok buttons in Eto form",
  "question": "Hi All,\n\n\nI have been working on a  python 3 script with multiple drop down boxes, I have been assisted by Callum and Curtis and now I have the drop downs working with my dictionary.\n\n\nAs this is not written in my usual format which my poor head can follow I find myself struggling to get a Cancel and Ok button on the form and upon clicking “OK” I want to return each of the four drop down list items selected  a= dd1, b=dd2, etc.\n\n\nI have inserted the script as I cannot download a PY3 file, all help appreciated\n\n\n#! python3\n\n# Imports\nimport scriptcontext as sc\nimport rhinoscriptsyntax as rs \nimport Rhino\nfrom Rhino.UI import RhinoEtoApp, EtoExtensions\n \nfrom Eto.Drawing import Padding, Size\nfrom Eto.Forms import Dialog, DropDown, DynamicLayout\nimport Eto.Forms as forms\nfrom System.Collections.ObjectModel import ObservableCollection\n\nitems1 = []\n\n#Geo Pipework dialog class\nclass GeoPipeworkDialog(forms.Dialog[bool]):\n    \n    # Dialog box Class initializer\n    def __init__(dialog):\n\n        # call base class initializer\n        super().__init__()\n \n        dialog = Dialog()\n        dialog.Title = \"Geo Pipework\"\n        dialog.Width = 800\n        dialog.Padding = Padding(10)\n\n        # One data source for simplicity. Dictionaries are always good.\n        data = {\n            \"ASME B 16.5\": ['ASME B 16.5 45 Long Radius Elbows', 'ASME B 16.5 90 Long Radius Elbows', 'ASME B 16.5 90 Short Radius Elbows', 'ASME B 16.5 As Built Elbows', 'ASME B 16.5 Blind Flanges', 'ASME B 16.5 Flush Face Weld Neck Flanges', 'ASME B 16.5 Pipe', 'ASME B 16.5 Pulled Bends', 'ASME B 16.5 Raised Face Weld Neck Flanges', 'ASME B 16.5 SS Concentric Reducers', 'ASME B 16.5 SS Eccentric Reducers', 'ASME B 16.5 Slip On Flanges', 'ASME B 16.5 Socket Flanges', 'ASME B 16.5 Weld Neck Raised Face Ring Type Joints'],\n\n            'ASME B 16.5 45 Long Radius Elbows': ['1 1/2 D Elbow', '1 D Elbow', '2 D Elbow', '3 D Elbow', '4 D Elbow', '5 D Elbow', '6 D Elbow'],\n            'ASME B 16.5 90 Long Radius Elbo...",
  "code_blocks": [
    {
      "code": "# Imports\nimport Rhino\nimport Rhino.UI\nimport scriptcontext\nimport System\nimport Eto.Drawing as drawing\nimport Eto.Forms as forms\n\nimport rhinoscriptsyntax as rs\nfrom System.Drawing import Color\nimport codecs\nimport csv\nimport datetime\n\nimport re\n\n# ImportExportPoints dialog class\nclass ImportExportPointsDialog(forms.Dialog[bool]):\n    \n\n    # Dialog box Class initializer\n    def __init__(self):\n        # call base class initializer\n        super().__init__()\n\n        self.Title = \"Import Export Points\"\n        self.Padding = drawing.Padding(10)\n        self.Resizable = False\n        \n        # Create controls for the dialog\n        self.m_import_checkbox = forms.CheckBox()\n        self.m_import_checkbox.Text = \"Select if import points\"\n        self.m_import_checkbox.Tag = \"Import\"\n\n        #(Text = 'Select if import points', Tag=\"Import\")\n        \n        #self.m_import_checkbox.Checked = True\n        self.m_import_checkbox.CheckedChanged += self.OnCCheckedChanged\n        \n        #self.m_import_checkbox.Checked = True\n        \n        self.m_export_checkbox = forms.CheckBox()\n        self.m_export_checkbox.Text = \"Select if export points\"\n        self.m_export_checkbox.Tag = \"Export\"\n        \n        #self.m_export_checkbox.Checked = False\n        self.m_export_checkbox.CheckedChanged += self.OnCCheckedChanged\n        \n        #self.m_export_checkbox.Checked = False\n        \n        self.m_combobox = forms.ComboBox()\n        self.m_combobox.DataStore = ['SC4W.crd', 'Tritop.txt', 'Excel.csv','Faro.txt']\n        self.m_combobox.SelectedIndex = 0\n        \n        self.m_label = forms.Label()\n        self.m_label.Text =  \"Select Format:\"\n        \n        # Create the default button\n        self.DefaultButton = forms.Button()\n        self.DefaultButton.Text = \"OK\"\n\n        self.DefaultButton.Click += self.OnOKButtonClick\n        \n        # Create the abort button\n        self.AbortButton = forms.Button()\n        self.AbortButton.Text = \"Cancel\"\n        \n        self.AbortButton.Click += self.OnCloseButtonClick\n        \n        # Create a table layout and add all the controls\n        layout = forms.DynamicLayout()\n        layout.Spacing = drawing.Size(5, 5)\n        layout.AddRow(self.m_import_checkbox)\n        layout.AddRow(self.m_export_checkbox)\n        layout.AddRow(self.m_label, self.m_combobox)\n        layout.AddRow(None) # spacer\n        layout.AddRow(self.DefaultButton, self.AbortButton)\n        \n        # Set the dialog content\n        self.Content = layout\n        \n    def OnCCheckedChanged(self, sender, e):\n        \n        # if this event is not fired from a CheckBox, exit the event\n        if not isinstance(sender, forms.CheckBox): return\n        \n        # handles enable and disable state depending on check state\n        if sender.Tag == \"Import\":\n            print (\"Event Call from Import Checkbox\")\n            if sender.Checked:\n                # disable and uncheck the export checkbox\n                self.m_export_checkbox.Checked = False\n                self.m_export_checkbox.Enabled = False\n            else:\n                # enable the export checkbox\n                self.m_export_checkbox.Enabled = True\n            \n        elif sender.Tag == \"Export\":\n            print (\"Event call from Export Checkbox\")\n            if sender.Checked:\n                # disable and uncheck the import checkbox\n                self.m_import_checkbox.Checked = False\n                self.m_import_checkbox.Enabled = False\n            else:\n                # enable the export checkbox\n                self.m_import_checkbox.Enabled = True\n        \n    \n    # Start of the class functions\n    \n    # Get/set the value of the first checkbox\n    def GetImport(self):\n        return self.m_import_checkbox.Checked\n    def SetImport(self, set):\n        self.m_import_checkbox.Checked = not set\n    \n    # Get/set the value of the second checkbox\n    def GetExport(self):\n        return self.m_export_checkbox.Checked\n    def SetExport(self, set):\n        self.m_export_checkbox.Checked = not set\n        \n    # Get/set the value of the combobox\n    def GetFormatOption(self):\n      return self.m_combobox.SelectedIndex\n    def SetFormatOption(self, index):\n      self.m_combobox.SelectedIndex = Rhino.RhinoMath.Clamp(index, 0, 2)\n    \n    # Close button click handler\n    def OnCloseButtonClick(self, sender, e):\n        self.Close(False)\n    \n    # OK button click handler\n    def OnOKButtonClick(self, sender, e):\n        self.Close(True)\n    ## End of Dialog Class ##\n    \n    # Utility function to show the dialog box\n\ndef ShowImportExportPointsDialog(setImport = False, setExport = False, setFormat = 0):\n\n    # initialize the dialog\n    dialog = ImportExportPointsDialog()\n    \n    # set the format option\n    dialog.SetFormatOption(setFormat)\n    \n    rc = dialog.ShowModal(Rhino.UI.RhinoEtoApp.MainWindow)\n    \n    # print what the dialog returns it is either True (OK) or False (Cancel)\n    print ( \"rc ={}\".format(rc))\n    \n    # exit if the user clicked cancel\n    if rc == False: return\n    \n    # build some result variable from the settings in the dialog\n    result = dialog.GetImport(), dialog.GetExport(), dialog.GetFormatOption()\n    \n    #print out the settings\n    print ( \"result =\", result)\n    # handle what has been chosen\n    \n    if result == (True,False,0):\n        #var1 = rc0\n        # Import points from SC4W files        \n        #\n        #prompt the user for a file to import\n        filenames = rs.OpenFileNames(\"Select SC4W Points Files\", \"SC4W Files (*.crd)|*.crd|All Files (*.*)|*.*||\")\n        \n        # always exit if the user did not open a file\n        if not filenames: return\n        \n        for filename in filenames: #print filename\n            file_namea = filename.split(\"\\\\\")[-1]\n            file_nameb = file_namea.split(\".\")[0]\n            #print file_nameb\n            ##with open(file_path,\"r\") as pointfile:\n            with open(filename,\"r\") as pointfile:\n                #\n                #print file=pointfile\n                lines = pointfile.readlines()[1:]\n                # Stop printing for time being\n                #print (lines)\n                rs.AddLayer(file_nameb, Color.Red)\n                rs.CurrentLayer(file_nameb)\n                #\n                # Stop printing for time being\n                #print (line)\n                for line in lines:\n                    row = line.split(\",\")\n                    n = row[0]\n                    c = row[1]\n                    x = float(row[2])\n                    y = float(row[3])\n                    z = float(row[4])\n                    \n                    x=x*1000\n                    y=y*1000\n                    z=z*1000\n                    \n                    #print n, c, x, y, z\n                    \n                    rs.AddLayer(c, Color.Red, parent = file_nameb)\n                    rs.CurrentLayer(c)\n                \n                    #line.split(\",\")\n                    id = rs.AddPoint(x,y,z)\n                    rs.ObjectName(id, n)\n                    \n                    #Close the file after writing!\n                    pointfile.close()\n        \n    elif result == (True,False,1):\n        # Import points from Tritop files        \n        \n        #prompt the user for a file to import\n        filenames = rs.OpenFileNames(\"Select Tritop Points Files\", \"Tritop Files (*.txt)|*.txt|All Files (*.*)|*.*||\")\n        \n        # always exit if the user did not open a file\n        if not filenames: return\n        \n        for filename in filenames: #print filename\n            file_namea = filename.split(\"\\\\\")[-1]\n            file_nameb = file_namea.split(\".\")[0]\n            #print file_nameb\n            with open(filename,\"r\") as pointfile:\n                #print file=pointfile\n                lines = pointfile.readlines()\n                 # Stop printing for time being\n                 # print (lines)\n                rs.AddLayer(file_nameb, Color.Red)\n                rs.CurrentLayer(file_nameb)\n    \n            for line in lines:\n                # Stop printing for time being\n                # print (line)\n                \n                \n                n,x,y,z = line.split(\" \")\n                #n,x,y,z = line\n                \n                id = rs.AddPoint(float(x),float(y),float(z))\n                rs.ObjectName(id, n)\n                \n                #Close the file after writing!\n                pointfile.close()\n        \n    elif result == (True,False,2):\n        #var3 = rc0\n\n        #prompt the user for a file to import\n        ##filter = \"CSV file (*.csv)|*.csv|All Files (*.*)|*.*||\"\n        ##file_path = rs.OpenFileName(\"Select Excel CSV Points File\", filter)\n        \n        filenames = rs.OpenFileNames(\"Select Excel CSV Points Files\", \"Excel CSV Files (*.csv)|*.csv|All Files (*.*)|*.*||\")\n        \n        # always exit if the user did not open a file\n        if not filenames: return\n        \n        for filename in filenames:#print filename\n            file_namea = filename.split(\"\\\\\")[-1]\n            file_nameb = file_namea.split(\".\")[0]\n            with open(filename, 'r') as infile:\n                reader = csv.reader(codecs.EncodedFile(infile, 'utf8', 'utf_8_sig'), delimiter=\",\")\n                # This skips the first row of the CSV file.\n                next(reader)\n                # This skips the second row of the CSV file.\n                next(reader)\n                \n                rs.AddLayer(file_nameb, Color.Red)\n                rs.CurrentLayer(file_nameb)\n                \n                for row in reader:\n                    n = row[0]\n                    x = float(row[1])\n                    y = float(row[2])\n                    z = float(row[3])\n                    #print n, x, y, z\n                    \n                    id = rs.AddPoint(x,y,z)\n                    rs.ObjectName(id, n)\n                    \n                #Close the file after writing!\n                infile.close()\n                \n    elif result == (True,False,3):\n        var7 = rc0\n        #print (\"var7 = \") + str(var7)\n        \n\n        \n\n    elif result == (False,True,0):\n         \n        #Select our points\n        pts = rs.GetObjects(\"Select Points for SC4W Export\", 1)\n        \n        # handle if the user did not select some points\n        if not pts: return\n        \n        x = datetime.datetime.now()\n        \n        day = x.day\n        month = x.month\n        year = x.year\n        \n        Date = str(day) + \"/\" + str(month) + \"/\" + str(year)\n        #print Date\n        \n        hour = x.hour\n        minute = x.minute\n        second = x.second\n        \n        Time = str(hour) + \"/\" + str(minute) + \"/\" + str(second)\n        #print Time\n        \n        \n         \n        #create a filename variable\n        filename = rs.SaveFileName(\"Save SC4W file\",\"*.crd||\", None, \"ptExport\", \"crd\")\n        \n        # handle if the user did not choose a file \n        if not filename: return\n        \n        #open the file for writing\n        file = open(filename, 'w')\n         \n        #create and write a headerline for our CRD\n        headerline = \"Name,Code,X,Y,Z\\n\"\n        file.write(headerline)\n        #print headerline\n        #space = \" \\n\"\n        #file.write(space)\n         \n        #print pts\n        for pt in pts:\n            ptCoord = rs.PointCoordinates(pt)\n            x = ptCoord[0]\n            y = ptCoord[1]\n            z = ptCoord[2]\n            \n            x=x*0.001\n            y=y*0.001\n            z=z*0.001\n            \n            \n            n = rs.ObjectName(pt)\n            #print n\n            layer = rs.ObjectLayer(pt)\n            #print layer\n            \n            \n            \n            # using string find() method\n            #print(layer.find('::'))\n            \n            if (layer.find('::')) != -1:\n                la = layer.split(\"::\")[1]\n                d = layer.split(\"::\")[0]\n                    \n            elif (layer.find('::')) == -1:\n                la = layer\n                d = layer\n            \n            #line = \"%s ,%s,%.8f,%.8f,%.8f,,,%s \\n\" %(n,layer,x,y,z,d)\n            line = \"%s ,%s,%.8f,%.8f,%.8f,,,%s \\n\" %(n,la,x,y,z,d)\n            file.write(line)\n                \n        #Close the file after writing!\n        file.close()\n        \n        \n        \n    elif result == (False,True,1):\n        #var5 = rc0\n        #print \"var5 = \" + str(var5)\n        \n        #Export Points to TXT\n \n        #Select our points\n        pts = rs.GetObjects(\"Select Points for TXT Export\", 1)\n        if not pts: return\n         \n        #create a filename variable\n        filename = rs.SaveFileName(\"Save Tritop file\",\"*.txt||\", None, \"ptExport\", \"txt\")\n        if not filename: return\n        \n        # always exit if the user did not open a file\n        if not filename: return\n        \n        #open the file for writing\n        file = open(filename, 'w')\n         \n        #create and write a headerline for our TXT\n        headerline = \"Name,X,Y,Z\\n\"\n        file.write(headerline)\n        space = \",,,,\\n\"\n        file.write(space)\n         \n        #print pts\n        for pt in pts:\n            ptCoord = rs.PointCoordinates(pt)\n            x = ptCoord[0]\n            y = ptCoord[1]\n            z = ptCoord[2]\n            n = rs.ObjectName(pt)\n            #print n\n            line = \"%s ,%.8f,%.8f,%.8f \\n\" %(n,x,y,z)\n            file.write(line)\n            \n        #Close the file after writing!\n        file.close()\n        \n    elif result == (False,True,2):\n        #var6 = rc0\n        #print \"var6 = \" + str(var6)\n        \n        #Export Points to CSV\n \n        #Select our points\n        pts = rs.GetObjects(\"Select Points for CSV Export\", 1)\n        if not pts: return\n        \n        #create a filename variable\n        filename = rs.SaveFileName(\"Save Excel CSV file\",\"*.csv||\", None, \"ptExport\", \"csv\")\n        if not filename: return\n        \n        #open the file for writing\n        file = open(filename, 'w')\n         \n        #create and write a headerline for our CSV\n        headerline = \"Name,X,Y,Z\\n\"\n        file.write(headerline)\n        space = \",,,,\\n\"\n        file.write(space)\n         \n        #print pts\n        for pt in pts:\n            ptCoord = rs.PointCoordinates(pt)\n            x = ptCoord[0]\n            y = ptCoord[1]\n            z = ptCoord[2]\n            n = rs.ObjectName(pt)\n            #print n\n            line = \"%s ,%.8f,%.8f,%.8f \\n\" %(n,x,y,z)\n            file.write (line)\n        #Close the file after writing!\n        file.close()\n\nif __name__ == \"__main__\":\n    ShowImportExportPointsDialog()",
      "language": "python",
      "author": "RogerD",
      "post_number": 6,
      "is_solution": false
    },
    {
      "code": "#! python3\n\n# Imports\nimport scriptcontext as sc\nimport rhinoscriptsyntax as rs \nimport Rhino\nfrom Rhino.UI import RhinoEtoApp, EtoExtensions\nimport Eto.Drawing as drawing\nfrom Eto.Drawing import Padding, Size\nfrom Eto.Forms import Dialog, DropDown, DynamicLayout\nimport Eto.Forms as forms\nfrom System.Collections.ObjectModel import ObservableCollection\n\nitems1 = []\n\n#Geo Pipework dialog class\nclass GeoPipeworkDialog(forms.Dialog[bool]):\n    \n    # Dialog box Class initializer\n    def __init__(dialog):\n\n        # call base class initializer\n        super().__init__()\n \n        dialog = Dialog()\n        dialog.Title = \"Geo Pipework\"\n        dialog.Width = 800\n        dialog.Padding = Padding(10)\n\n        # One data source for simplicity. Dictionaries are always good.\n        data = {\n            \"ASME B 16.5\": ['ASME B 16.5 45 Long Radius Elbows', 'ASME B 16.5 90 Long Radius Elbows', 'ASME B 16.5 90 Short Radius Elbows', 'ASME B 16.5 As Built Elbows', 'ASME B 16.5 Blind Flanges', 'ASME B 16.5 Flush Face Weld Neck Flanges', 'ASME B 16.5 Pipe', 'ASME B 16.5 Pulled Bends', 'ASME B 16.5 Raised Face Weld Neck Flanges', 'ASME B 16.5 SS Concentric Reducers', 'ASME B 16.5 SS Eccentric Reducers', 'ASME B 16.5 Slip On Flanges', 'ASME B 16.5 Socket Flanges', 'ASME B 16.5 Weld Neck Raised Face Ring Type Joints'],\n\n            'ASME B 16.5 45 Long Radius Elbows': ['1 1/2 D Elbow', '1 D Elbow', '2 D Elbow', '3 D Elbow', '4 D Elbow', '5 D Elbow', '6 D Elbow'],\n            'ASME B 16.5 90 Long Radius Elbows': ['1 1/2 D Elbow', '1 D Elbow', '2 D Elbow', '3 D Elbow', '4 D Elbow', '5 D Elbow', '6 D Elbow'],\n            'ASME B 16.5 90 Short Radius Elbows': ['1 1/2 D Elbow', '1 D Elbow', '2 D Elbow', '3 D Elbow', '4 D Elbow', '5 D Elbow', '6 D Elbow'],\n            'ASME B 16.5 As Built Elbows': ['1 1/2 D Elbow', '1 D Elbow', '2 D Elbow', '3 D Elbow', '4 D Elbow', '5 D Elbow', '6 D Elbow'],\n            'ASME B 16.5 Blind Flanges': ['150 lb Rating', '300 lb Rating', '400 lb Rating', '600 lb Rating', '900 lb Rating', '1500 lb Rating', '2500 lb Rating'],\n            'ASME B 16.5 Flush Face Weld Neck Flanges': ['150 lb Rating', '300 lb Rating', '400 lb Rating', '600 lb Rating', '900 lb Rating', '1500 lb Rating', '2500 lb Rating'],\n            'ASME B 16.5 Pipe': ['150 lb Rating', '300 lb Rating', '400 lb Rating', '600 lb Rating', '900 lb Rating', '1500 lb Rating', '2500 lb Rating'],\n            'ASME B 16.5 Pulled Bends': ['1 1/2 D Elbow', '1 D Elbow', '2 D Elbow', '3 D Elbow', '4 D Elbow', '5 D Elbow', '6 D Elbow'],\n            'ASME B 16.5 Raised Face Weld Neck Flanges': ['150 lb Rating', '300 lb Rating', '400 lb Rating', '600 lb Rating', '900 lb Rating', '1500 lb Rating', '2500 lb Rating'],\n            'ASME B 16.5 SS Concentric Reducers': ['3/4 x 1/2 inch', '3/4 x 3/8 inch', '1 x 3/4 inch', '1 x 1/2 inch', '1 x 3/8 inch', '1 1/4 x 1 inch', '1 1/4 x 3/4  inch', '1 1/4 x 1/2  inch', '1 1/2 x 1 1/4  inch', '1 1/2 x 1 inch', '1 1/2 x 3/4 inch', '1 1/2 x 1/2 inch', '2 x 1 1/2 inch', '2 x 1 1/4 inch', '2 x 1  inch', '2 x 3/4 inch', '2 1/2 x 2 inch', '2 1/2 x 1 1/2 inch', '2 1/2 x 1 1/4 inch', '2 1/2 x 1 inch', '3 x 2 1/2 inch', '3 x 2 inch', '3 x 1 1/2 inch', '3 x 1 1/4 inch', '3 1/2 x 3  inch', '3 1/2 x 2 1/2 inch', '3 1/2 x 2  inch', '3 1/2 x 1 1/2 inch', '3 1/2 x 1 1/4 inch', '4 x 3 1/4 inch', '4 x 3  inch', '4 x 2 1/2 inch', '4 x 2 inch', '4 x 1 1/2 inch', '5 x 4 inch', '5 x 3 1/2 inch', '5 x 3 inch', '5 x 2 1/2  inch', '5 x 2 inch', '6 x 5 inch', '6 x 4 inch', '6 x 3 1/2 inch', '6 x 3 inch', '6 x 2 1/2 inch', '8 x 6 inch', '8 x 5 inch', '8 x 4 inch', '8 x 3 1/2 inch', '10 x 8 inch', '10 x 6 inch', '10 x 5 inch', '10 x 4  inch', '12 x 10 inch', '12 x 8 inch', '12 x 6 inch', '12 x 5 inch', '14 x 12 inch', '14 x 10 inch', '14 x 8 inch', '14 x 6 inch', '16 x 14 inch', '16 x 12 inch', '16 x 10 inch', '16 x 8 inch', '18 x 16 inch', '18 x 14 inch', '18 x 12 inch', '18 x 10 inch', '20 x 18 inch', '20 x 16 inch', '20 x 14 inch', '20 x 12 inch', '22 x 20 inch', '22 x 18 inch', '22 x 16 inch', '22 x 14 inch', '24 x 22 inch', '24 x 20 inch', '24 x 18 inch', '24 x 16 inch'],\n            'ASME B 16.5 SS Eccentric Reducers': ['3/4 x 1/2 inch', '3/4 x 3/8 inch', '1 x 3/4 inch', '1 x 1/2 inch', '1 x 3/8 inch', '1 1/4 x 1 inch', '1 1/4 x 3/4  inch', '1 1/4 x 1/2  inch', '1 1/2 x 1 1/4  inch', '1 1/2 x 1 inch', '1 1/2 x 3/4 inch', '1 1/2 x 1/2 inch', '2 x 1 1/2 inch', '2 x 1 1/4 inch', '2 x 1  inch', '2 x 3/4 inch', '2 1/2 x 2 inch', '2 1/2 x 1 1/2 inch', '2 1/2 x 1 1/4 inch', '2 1/2 x 1 inch', '3 x 2 1/2 inch', '3 x 2 inch', '3 x 1 1/2 inch', '3 x 1 1/4 inch', '3 1/2 x 3  inch', '3 1/2 x 2 1/2 inch', '3 1/2 x 2  inch', '3 1/2 x 1 1/2 inch', '3 1/2 x 1 1/4 inch', '4 x 3 1/4 inch', '4 x 3  inch', '4 x 2 1/2 inch', '4 x 2 inch', '4 x 1 1/2 inch', '5 x 4 inch', '5 x 3 1/2 inch', '5 x 3 inch', '5 x 2 1/2  inch', '5 x 2 inch', '6 x 5 inch', '6 x 4 inch', '6 x 3 1/2 inch', '6 x 3 inch', '6 x 2 1/2 inch', '8 x 6 inch', '8 x 5 inch', '8 x 4 inch', '8 x 3 1/2 inch', '10 x 8 inch', '10 x 6 inch', '10 x 5 inch', '10 x 4  inch', '12 x 10 inch', '12 x 8 inch', '12 x 6 inch', '12 x 5 inch', '14 x 12 inch', '14 x 10 inch', '14 x 8 inch', '14 x 6 inch', '16 x 14 inch', '16 x 12 inch', '16 x 10 inch', '16 x 8 inch', '18 x 16 inch', '18 x 14 inch', '18 x 12 inch', '18 x 10 inch', '20 x 18 inch', '20 x 16 inch', '20 x 14 inch', '20 x 12 inch', '22 x 20 inch', '22 x 18 inch', '22 x 16 inch', '22 x 14 inch', '24 x 22 inch', '24 x 20 inch', '24 x 18 inch', '24 x 16 inch'],\n            'ASME B 16.5 Slip On Flanges': ['150 lb Rating', '300 lb Rating', '400 lb Rating', '600 lb Rating', '900 lb Rating', '1500 lb Rating', '2500 lb Rating'],\n            'ASME B 16.5 Socket Flanges': ['150 lb Rating', '300 lb Rating', '400 lb Rating', '600 lb Rating', '900 lb Rating', '1500 lb Rating', '2500 lb Rating'],\n            'ASME B 16.5 Weld Neck Raised Face Ring Type Joints': ['150 lb Rating', '300 lb Rating', '400 lb Rating', '600 lb Rating', '900 lb Rating', '1500 lb Rating', '2500 lb Rating'],\n\n\n\n            \"ASME B 16.47\": ['ASME B 16.47 Raised Face Weld Neck Flanges'],\n\n            'ASME B 16.47 Raised Face Weld Neck Flanges': ['150 lb Rating', '300 lb Rating', '400 lb Rating', '600 lb Rating', '900 lb Rating', '1500 lb Rating', '2500 lb Rating'],\n            #220: [221, 222, 223],\n            #230: [231, 232, 233],\n\n            300: ['1 1/2 D Elbow', '1 D Elbow', '2 D Elbow', '3 D Elbow', '4 D Elbow', '5 D Elbow', '6 D Elbow'],\n\n            '1 1/2 D Elbow': ['1/4 inch', '3/8 inch', '1/2 inch', '3/4 inch', '1 inch', '1 1/4 inch', '1 1/2 inch', '2 inch', '2 1/2 inch', '3 inch', '3 1/2 inch', '4 inch', '5 inch', '6 inch', '8 inch', '10 inch', '12 inch', '14 inch', '16 inch', '18 inch', '20 inch', '22 inch', '24 inch'],\n            '1 D Elbow': ['1/4 inch', '3/8 inch', '1/2 inch', '3/4 inch', '1 inch', '1 1/4 inch', '1 1/2 inch', '2 inch', '2 1/2 inch', '3 inch', '3 1/2 inch', '4 inch', '5 inch', '6 inch', '8 inch', '10 inch', '12 inch', '14 inch', '16 inch', '18 inch', '20 inch', '22 inch', '24 inch'],\n            '2 D Elbow': ['1/4 inch', '3/8 inch', '1/2 inch', '3/4 inch', '1 inch', '1 1/4 inch', '1 1/2 inch', '2 inch', '2 1/2 inch', '3 inch', '3 1/2 inch', '4 inch', '5 inch', '6 inch', '8 inch', '10 inch', '12 inch', '14 inch', '16 inch', '18 inch', '20 inch', '22 inch', '24 inch'],\n            '3 D Elbow': ['1/4 inch', '3/8 inch', '1/2 inch', '3/4 inch', '1 inch', '1 1/4 inch', '1 1/2 inch', '2 inch', '2 1/2 inch', '3 inch', '3 1/2 inch', '4 inch', '5 inch', '6 inch', '8 inch', '10 inch', '12 inch', '14 inch', '16 inch', '18 inch', '20 inch', '22 inch', '24 inch'],\n            '4 D Elbow': ['1/4 inch', '3/8 inch', '1/2 inch', '3/4 inch', '1 inch', '1 1/4 inch', '1 1/2 inch', '2 inch', '2 1/2 inch', '3 inch', '3 1/2 inch', '4 inch', '5 inch', '6 inch', '8 inch', '10 inch', '12 inch', '14 inch', '16 inch', '18 inch', '20 inch', '22 inch', '24 inch'],\n            '5 D Elbow': ['1/4 inch', '3/8 inch', '1/2 inch', '3/4 inch', '1 inch', '1 1/4 inch', '1 1/2 inch', '2 inch', '2 1/2 inch', '3 inch', '3 1/2 inch', '4 inch', '5 inch', '6 inch', '8 inch', '10 inch', '12 inch', '14 inch', '16 inch', '18 inch', '20 inch', '22 inch', '24 inch'],\n            '6 D Elbow': ['1/4 inch', '3/8 inch', '1/2 inch', '3/4 inch', '1 inch', '1 1/4 inch', '1 1/2 inch', '2 inch', '2 1/2 inch', '3 inch', '3 1/2 inch', '4 inch', '5 inch', '6 inch', '8 inch', '10 inch', '12 inch', '14 inch', '16 inch', '18 inch', '20 inch', '22 inch', '24 inch'],\n\n            400: ['1/4 inch', '3/8 inch', '1/2 inch', '3/4 inch', '1 inch', '1 1/4 inch', '1 1/2 inch', '2 inch', '2 1/2 inch', '3 inch', '3 1/2 inch', '4 inch', '5 inch', '6 inch', '8 inch', '10 inch', '12 inch', '14 inch', '16 inch', '18 inch', '20 inch', '22 inch', '24 inch'],\n\n            '150 lb Rating': ['1/4 inch', '3/8 inch', '1/2 inch', '3/4 inch', '1 inch', '1 1/4 inch', '1 1/2 inch', '2 inch', '2 1/2 inch', '3 inch', '3 1/2 inch', '4 inch', '5 inch', '6 inch', '8 inch', '10 inch', '12 inch', '14 inch', '16 inch', '18 inch', '20 inch', '22 inch', '24 inch'],\n            '300 lb Rating': ['1/4 inch', '3/8 inch', '1/2 inch', '3/4 inch', '1 inch', '1 1/4 inch', '1 1/2 inch', '2 inch', '2 1/2 inch', '3 inch', '3 1/2 inch', '4 inch', '5 inch', '6 inch', '8 inch', '10 inch', '12 inch', '14 inch', '16 inch', '18 inch', '20 inch', '22 inch', '24 inch'],\n            '400 lb Rating': ['1/4 inch', '3/8 inch', '1/2 inch', '3/4 inch', '1 inch', '1 1/4 inch', '1 1/2 inch', '2 inch', '2 1/2 inch', '3 inch', '3 1/2 inch', '4 inch', '5 inch', '6 inch', '8 inch', '10 inch', '12 inch', '14 inch', '16 inch', '18 inch', '20 inch', '22 inch', '24 inch'],\n            '600 lb Rating': ['1/4 inch', '3/8 inch', '1/2 inch', '3/4 inch', '1 inch', '1 1/4 inch', '1 1/2 inch', '2 inch', '2 1/2 inch', '3 inch', '3 1/2 inch', '4 inch', '5 inch', '6 inch', '8 inch', '10 inch', '12 inch', '14 inch', '16 inch', '18 inch', '20 inch', '22 inch', '24 inch'],\n            '900 lb Rating': ['1/4 inch', '3/8 inch', '1/2 inch', '3/4 inch', '1 inch', '1 1/4 inch', '1 1/2 inch', '2 inch', '2 1/2 inch', '3 inch', '3 1/2 inch', '4 inch', '5 inch', '6 inch', '8 inch', '10 inch', '12 inch', '14 inch', '16 inch', '18 inch', '20 inch', '22 inch', '24 inch'],\n            '1500 lb Rating': ['1/4 inch', '3/8 inch', '1/2 inch', '3/4 inch', '1 inch', '1 1/4 inch', '1 1/2 inch', '2 inch', '2 1/2 inch', '3 inch', '3 1/2 inch', '4 inch', '5 inch', '6 inch', '8 inch', '10 inch', '12 inch', '14 inch', '16 inch', '18 inch', '20 inch', '22 inch', '24 inch'],\n            '2500 lb Rating': ['1/4 inch', '3/8 inch', '1/2 inch', '3/4 inch', '1 inch', '1 1/4 inch', '1 1/2 inch', '2 inch', '2 1/2 inch', '3 inch', '3 1/2 inch', '4 inch', '5 inch', '6 inch', '8 inch', '10 inch', '12 inch', '14 inch', '16 inch', '18 inch', '20 inch', '22 inch', '24 inch'],\n\n            500: ['3/4 x 1/2 inch', '3/4 x 3/8 inch', '1 x 3/4 inch', '1 x 1/2 inch', '1 x 3/8 inch', '1 1/4 x 1 inch', '1 1/4 x 3/4  inch', '1 1/4 x 1/2  inch', '1 1/2 x 1 1/4  inch', '1 1/2 x 1 inch', '1 1/2 x 3/4 inch', '1 1/2 x 1/2 inch', '2 x 1 1/2 inch', '2 x 1 1/4 inch', '2 x 1  inch', '2 x 3/4 inch', '2 1/2 x 2 inch', '2 1/2 x 1 1/2 inch', '2 1/2 x 1 1/4 inch', '2 1/2 x 1 inch', '3 x 2 1/2 inch', '3 x 2 inch', '3 x 1 1/2 inch', '3 x 1 1/4 inch', '3 1/2 x 3  inch', '3 1/2 x 2 1/2 inch', '3 1/2 x 2  inch', '3 1/2 x 1 1/2 inch', '3 1/2 x 1 1/4 inch', '4 x 3 1/4 inch', '4 x 3  inch', '4 x 2 1/2 inch', '4 x 2 inch', '4 x 1 1/2 inch', '5 x 4 inch', '5 x 3 1/2 inch', '5 x 3 inch', '5 x 2 1/2  inch', '5 x 2 inch', '6 x 5 inch', '6 x 4 inch', '6 x 3 1/2 inch', '6 x 3 inch', '6 x 2 1/2 inch', '8 x 6 inch', '8 x 5 inch', '8 x 4 inch', '8 x 3 1/2 inch', '10 x 8 inch', '10 x 6 inch', '10 x 5 inch', '10 x 4  inch', '12 x 10 inch', '12 x 8 inch', '12 x 6 inch', '12 x 5 inch', '14 x 12 inch', '14 x 10 inch', '14 x 8 inch', '14 x 6 inch', '16 x 14 inch', '16 x 12 inch', '16 x 10 inch', '16 x 8 inch', '18 x 16 inch', '18 x 14 inch', '18 x 12 inch', '18 x 10 inch', '20 x 18 inch', '20 x 16 inch', '20 x 14 inch', '20 x 12 inch', '22 x 20 inch', '22 x 18 inch', '22 x 16 inch', '22 x 14 inch', '24 x 22 inch', '24 x 20 inch', '24 x 18 inch', '24 x 16 inch'],\n\n            '3/4 x 1/2 inch': ['N\\A'],\n            '3/4 x 3/8 inch': ['N\\A'],\n            '1 x 3/4 inch': ['N\\A'],\n            '1 x 1/2 inch': ['N\\A'],\n            '1 x 3/8 inch': ['N\\A'],\n            '1 1/4 x 1 inch' : ['N\\A'],\n            '1 1/4 x 3/4  inch' : ['N\\A'],\n            '1 1/4 x 1/2  inch' : ['N\\A'],\n            '1 1/2 x 1 1/4  inch' : ['N\\A'],\n            '1 1/2 x 1 1/4  inch': ['N\\A'],\n            '1 1/2 x 1 inch': ['N\\A'],\n            '1 1/2 x 3/4 inch': ['N\\A'],\n            '1 1/2 x 1/2 inch': ['N\\A'],\n            '2 x 1 1/2 inch': ['N\\A'],\n            '2 x 1 1/4 inch': ['N\\A'],\n            '2 x 1  inch': ['N\\A'],\n            '2 x 3/4 inch': ['N\\A'],\n            '2 1/2 x 2 inch': ['N\\A'],\n            '2 1/2 x 1 1/2 inch': ['N\\A'],\n            '2 1/2 x 1 1/4 inch': ['N\\A'],\n            '2 1/2 x 1 inch': ['N\\A'],\n            '3 x 2 1/2 inch': ['N\\A'],\n            '3 x 2 inch': ['N\\A'],\n            '3 x 1 1/2 inch': ['N\\A'],\n            '3 x 1 1/4 inch': ['N\\A'],\n            '3 1/2 x 3  inch': ['N\\A'],\n            '3 1/2 x 2 1/2 inch': ['N\\A'],\n            '3 1/2 x 2  inch': ['N\\A'],\n            '3 1/2 x 1 1/2 inch': ['N\\A'],\n            '3 1/2 x 1 1/4 inch': ['N\\A'],\n            '4 x 3 1/4 inch': ['N\\A'],\n            '4 x 3  inch': ['N\\A'],\n            '4 x 2 1/2 inch': ['N\\A'],\n            '4 x 2 inch': ['N\\A'],\n            '4 x 1 1/2 inch': ['N\\A'],\n            '5 x 4 inch': ['N\\A'],\n            '5 x 3 1/2 inch': ['N\\A'],\n            '5 x 3 inch': ['N\\A'],\n            '5 x 2 1/2  inch': ['N\\A'],\n            '5 x 2 inch': ['N\\A'],\n            '6 x 5 inch': ['N\\A'],\n            '6 x 4 inch': ['N\\A'],\n            '6 x 3 1/2 inch': ['N\\A'],\n            '6 x 3 inch': ['N\\A'],\n            '6 x 2 1/2 inch': ['N\\A'],\n            '8 x 6 inch': ['N\\A'],\n            '8 x 5 inch': ['N\\A'],\n            '8 x 4 inch': ['N\\A'],\n            '8 x 3 1/2 inch': ['N\\A'],\n            '10 x 8 inch': ['N\\A'],\n            '10 x 6 inch': ['N\\A'],\n            '10 x 5 inch': ['N\\A'],\n            '10 x 4  inch': ['N\\A'],\n            '12 x 10 inch': ['N\\A'],\n            '12 x 8 inch': ['N\\A'],\n            '12 x 6 inch': ['N\\A'],\n            '12 x 5 inch': ['N\\A'],\n            '14 x 12 inch': ['N\\A'],\n            '14 x 10 inch': ['N\\A'],\n            '14 x 8 inch': ['N\\A'],\n            '14 x 6 inch': ['N\\A'],\n            '16 x 14 inch': ['N\\A'],\n            '16 x 12 inch': ['N\\A'],\n            '16 x 10 inch': ['N\\A'],\n            '16 x 8 inch': ['N\\A'],\n            '18 x 16 inch': ['N\\A'],\n            '18 x 14 inch': ['N\\A'],\n            '18 x 12 inch': ['N\\A'],\n            '18 x 10 inch': ['N\\A'],\n            '20 x 18 inch': ['N\\A'],\n            '20 x 16 inch': ['N\\A'],\n            '20 x 14 inch': ['N\\A'],\n            '20 x 12 inch': ['N\\A'],\n            '22 x 20 inch': ['N\\A'],\n            '22 x 18 inch': ['N\\A'],\n            '22 x 16 inch': ['N\\A'],\n            '22 x 14 inch': ['N\\A'],\n            '24 x 22 inch': ['N\\A'],\n            '24 x 20 inch': ['N\\A'],\n            '24 x 18 inch': ['N\\A'],\n            '24 x 16 inch': ['N\\A'],\n\n        }\n\n        # ObservableCollection will notify the UI of changes for us\n        dd1_data = ObservableCollection[object]()\n        dd1_data.Add(\"ASME B 16.5\")\n        dd1_data.Add(\"ASME B 16.47\")\n        #dd1_data.Add(300)\n        #dd1_data.Add(400)\n        dd2_data = ObservableCollection[object]()\n        dd3_data = ObservableCollection[object]()\n        dd4_data = ObservableCollection[object]()\n\n        dd1 = DropDown()\n        dd1.DataStore = dd1_data\n\n        dd2 = DropDown()\n        dd2.DataStore = dd2_data\n\n        dd3 = DropDown()\n        dd3.DataStore = dd3_data\n\n        dd4 = DropDown()\n        dd4.DataStore = dd4_data\n\n        # Cache indexes to avoid unnecessary state updates which can be a bit crashy\n        dialog.dd1_index = -1\n        dialog.dd2_index = -1\n        dialog.dd3_index = -1 #RD\n        dialog.dd4_index = -1 #RD\n\n        dialog.busy = False\n        def update_state(sender, args):\n            # Super safe busy check, prevents recursion!\n            if (dialog.busy):\n                return\n            \n            dialog.busy = True\n            \n            # Prevents crashing if there is no data, we should do this more, but I'm lazy\n            if dd1.SelectedIndex == -1:\n                return\n\n            if (dd1.SelectedIndex != dialog.dd1_index):\n\n                items1 = data[dd1.SelectedValue]\n                \n                # Note we don't set a NEW value, we use the same collection\n                dd2_data.Clear()\n                for i in items1:\n                    dd2_data.Add(i)\n                dd2.SelectedIndex = 0\n                dd3.SelectedIndex = 0\n                dd4.SelectedIndex = 0\n                dialog.dd2_index = 0\n\n            # This should run on 1 or 2 changing index\n            if (dd2.SelectedIndex != dialog.dd2_index or\n                dd1.SelectedIndex != dialog.dd1_index):\n                items2 = data[dd2.SelectedValue]\n                \n\n            \n\n                # Note we don't set a NEW value, we use the same collection\n                dd3_data.Clear()\n                for i in items2:\n                    dd3_data.Add(i)\n                dd3.SelectedIndex = 0\n\n            if (dd3.SelectedIndex != dialog.dd3_index or\n                dd2.SelectedIndex != dialog.dd2_index or\n                dd1.SelectedIndex != dialog.dd1_index):\n\n                dd4_data.Clear()\n                if dd3.SelectedValue in data.keys():\n                    items3 = data[dd3.SelectedValue]\n\n                    # Note we don't set a NEW value, we use the same collection\n                    for i in items3:\n                        dd4_data.Add(i)\n                    dd4.SelectedIndex = 0\n\n            dialog.dd3_index = dd3.SelectedIndex\n            dialog.dd2_index = dd2.SelectedIndex\n            dialog.dd1_index = dd1.SelectedIndex\n\n            \n\n            \n            # We are no longer busy!\n            dialog.busy = False\n\n        dd1.SelectedIndexChanged += update_state\n        dd2.SelectedIndexChanged += update_state\n        dd3.SelectedIndexChanged += update_state\n        dd1.SelectedIndex = 0\n\n\n        # Create the default button\n        dialog.DefaultButton = forms.Button()\n        dialog.DefaultButton.Text ='OK'\n        #dialog.DefaultButton.Click += dialog.OnOKButtonClick\n\n    \n \n        # Create the abort button\n        dialog.AbortButton = forms.Button()\n        dialog.AbortButton.Text ='Cancel'\n        dialog.AbortButton.Click += dialog.OnCloseButtonClick\n\n\n        # Create a table layout and add all the controls\n        #layout = forms.DynamicLayout()\n        #layout.Spacing = drawing.Size(5, 5)\n\n        \n        # Nice way to set up a UI with equal spacing\n        dynamic = forms.DynamicLayout()\n        dynamic.Spacing = drawing.Size(4, 4) # Bit cramped otherwise\n        dynamic.BeginHorizontal()\n        dynamic.Add(dd1, True)\n        dynamic.Add(dd2, True)\n        dynamic.Add(dd3, True)\n        dynamic.Add(dd4, True)\n        dynamic.EndHorizontal()\n        dynamic.AddRow(None) # spacer\n        dynamic.AddRow(dialog.DefaultButton, dialog.AbortButton)\n\n        # Set the dialog content\n        #dialog.Content = dynamic\n        #dialog.Load += dialog.OnFormLoad\n        #dialog.Closing += dialog.OnFormClosing\n\n        dialog.Content = dynamic\n\n        parent = RhinoEtoApp.MainWindowForDocument(sc.doc)\n        ##EtoExtensions.ShowSemiModal(dialog, sc.doc, parent)\n        dialog.ShowModal(parent)\n\n        # Close button click handler\n        def OnCloseButtonClick(dialog, sender, e):\n            dialog.Close(False)\n    \n        # OK button click handler\n        def OnOKButtonClick(dialog, sender, e):\n            dialog.Close(True)\n\n\n\n\n\n# The script that will be using the dialog.\ndef Pipework():\n    #rs.CurrentDimStyle(\"Default\")\n    \n    #Utility function to show the dialog box\n    dialog = GeoPipeworkDialog();\n    \n    #Open the dialogue\n\n    #rc = dialog.ShowModal(Rhino.UI.RhinoEtoApp.MainWindow)\n    #if not rc: return\n\n\n\n\n    \n    print (\"End of Geo Pipework\")\n# Check to see if this file is being executed as the \"main\" python\n# script instead of being used as a module by some other python script\n# This allows us to use the module which ever way we want.\nif __name__ == \"__main__\":\n    rc = Pipework()type or paste code here",
      "language": "python",
      "author": "RogerD",
      "post_number": 7,
      "is_solution": false
    },
    {
      "code": "#! python3\n\n# Imports\nimport scriptcontext as sc\nimport rhinoscriptsyntax as rs \nimport Rhino\nfrom Rhino.UI import RhinoEtoApp, EtoExtensions\n \nfrom Eto.Drawing import Padding, Size\nfrom Eto.Forms import Dialog, DropDown, DynamicLayout\nimport Eto.Forms as forms\nfrom System.Collections.ObjectModel import ObservableCollection\n\nitems1 = []\n\n#Geo Pipework dialog class\nclass GeoPipeworkDialog(forms.Dialog[bool]):\n    \n    # Dialog box Class initializer\n    def __init__(dialog):\n\n        # call base class initializer\n        super().__init__()\n \n        dialog = Dialog()\n        dialog.Title = \"Geo Pipework\"\n        dialog.Width = 800\n        dialog.Padding = Padding(10)\n\n        # One data source for simplicity. Dictionaries are always good.\n        data = {\n            \"ASME B 16.5\": ['ASME B 16.5 45 Long Radius Elbows', 'ASME B 16.5 90 Long Radius Elbows', 'ASME B 16.5 90 Short Radius Elbows', 'ASME B 16.5 As Built Elbows', 'ASME B 16.5 Blind Flanges', 'ASME B 16.5 Flush Face Weld Neck Flanges', 'ASME B 16.5 Pipe', 'ASME B 16.5 Pulled Bends', 'ASME B 16.5 Raised Face Weld Neck Flanges', 'ASME B 16.5 SS Concentric Reducers', 'ASME B 16.5 SS Eccentric Reducers', 'ASME B 16.5 Slip On Flanges', 'ASME B 16.5 Socket Flanges', 'ASME B 16.5 Weld Neck Raised Face Ring Type Joints'],\n\n            'ASME B 16.5 45 Long Radius Elbows': ['1 1/2 D Elbow', '1 D Elbow', '2 D Elbow', '3 D Elbow', '4 D Elbow', '5 D Elbow', '6 D Elbow'],\n            'ASME B 16.5 90 Long Radius Elbows': ['1 1/2 D Elbow', '1 D Elbow', '2 D Elbow', '3 D Elbow', '4 D Elbow', '5 D Elbow', '6 D Elbow'],\n            'ASME B 16.5 90 Short Radius Elbows': ['1 1/2 D Elbow', '1 D Elbow', '2 D Elbow', '3 D Elbow', '4 D Elbow', '5 D Elbow', '6 D Elbow'],\n            'ASME B 16.5 As Built Elbows': ['1 1/2 D Elbow', '1 D Elbow', '2 D Elbow', '3 D Elbow', '4 D Elbow', '5 D Elbow', '6 D Elbow'],\n            'ASME B 16.5 Blind Flanges': ['150 lb Rating', '300 lb Rating', '400 lb Rating', '600 lb Rating', '900 lb Rating', '1500 lb Rating', '2500 lb Rating'],\n            'ASME B 16.5 Flush Face Weld Neck Flanges': ['150 lb Rating', '300 lb Rating', '400 lb Rating', '600 lb Rating', '900 lb Rating', '1500 lb Rating', '2500 lb Rating'],\n            'ASME B 16.5 Pipe': ['150 lb Rating', '300 lb Rating', '400 lb Rating', '600 lb Rating', '900 lb Rating', '1500 lb Rating', '2500 lb Rating'],\n            'ASME B 16.5 Pulled Bends': ['1 1/2 D Elbow', '1 D Elbow', '2 D Elbow', '3 D Elbow', '4 D Elbow', '5 D Elbow', '6 D Elbow'],\n            'ASME B 16.5 Raised Face Weld Neck Flanges': ['150 lb Rating', '300 lb Rating', '400 lb Rating', '600 lb Rating', '900 lb Rating', '1500 lb Rating', '2500 lb Rating'],\n            'ASME B 16.5 SS Concentric Reducers': ['3/4 x 1/2 inch', '3/4 x 3/8 inch', '1 x 3/4 inch', '1 x 1/2 inch', '1 x 3/8 inch', '1 1/4 x 1 inch', '1 1/4 x 3/4  inch', '1 1/4 x 1/2  inch', '1 1/2 x 1 1/4  inch', '1 1/2 x 1 inch', '1 1/2 x 3/4 inch', '1 1/2 x 1/2 inch', '2 x 1 1/2 inch', '2 x 1 1/4 inch', '2 x 1  inch', '2 x 3/4 inch', '2 1/2 x 2 inch', '2 1/2 x 1 1/2 inch', '2 1/2 x 1 1/4 inch', '2 1/2 x 1 inch', '3 x 2 1/2 inch', '3 x 2 inch', '3 x 1 1/2 inch', '3 x 1 1/4 inch', '3 1/2 x 3  inch', '3 1/2 x 2 1/2 inch', '3 1/2 x 2  inch', '3 1/2 x 1 1/2 inch', '3 1/2 x 1 1/4 inch', '4 x 3 1/4 inch', '4 x 3  inch', '4 x 2 1/2 inch', '4 x 2 inch', '4 x 1 1/2 inch', '5 x 4 inch', '5 x 3 1/2 inch', '5 x 3 inch', '5 x 2 1/2  inch', '5 x 2 inch', '6 x 5 inch', '6 x 4 inch', '6 x 3 1/2 inch', '6 x 3 inch', '6 x 2 1/2 inch', '8 x 6 inch', '8 x 5 inch', '8 x 4 inch', '8 x 3 1/2 inch', '10 x 8 inch', '10 x 6 inch', '10 x 5 inch', '10 x 4  inch', '12 x 10 inch', '12 x 8 inch', '12 x 6 inch', '12 x 5 inch', '14 x 12 inch', '14 x 10 inch', '14 x 8 inch', '14 x 6 inch', '16 x 14 inch', '16 x 12 inch', '16 x 10 inch', '16 x 8 inch', '18 x 16 inch', '18 x 14 inch', '18 x 12 inch', '18 x 10 inch', '20 x 18 inch', '20 x 16 inch', '20 x 14 inch', '20 x 12 inch', '22 x 20 inch', '22 x 18 inch', '22 x 16 inch', '22 x 14 inch', '24 x 22 inch', '24 x 20 inch', '24 x 18 inch', '24 x 16 inch'],\n            'ASME B 16.5 SS Eccentric Reducers': ['3/4 x 1/2 inch', '3/4 x 3/8 inch', '1 x 3/4 inch', '1 x 1/2 inch', '1 x 3/8 inch', '1 1/4 x 1 inch', '1 1/4 x 3/4  inch', '1 1/4 x 1/2  inch', '1 1/2 x 1 1/4  inch', '1 1/2 x 1 inch', '1 1/2 x 3/4 inch', '1 1/2 x 1/2 inch', '2 x 1 1/2 inch', '2 x 1 1/4 inch', '2 x 1  inch', '2 x 3/4 inch', '2 1/2 x 2 inch', '2 1/2 x 1 1/2 inch', '2 1/2 x 1 1/4 inch', '2 1/2 x 1 inch', '3 x 2 1/2 inch', '3 x 2 inch', '3 x 1 1/2 inch', '3 x 1 1/4 inch', '3 1/2 x 3  inch', '3 1/2 x 2 1/2 inch', '3 1/2 x 2  inch', '3 1/2 x 1 1/2 inch', '3 1/2 x 1 1/4 inch', '4 x 3 1/4 inch', '4 x 3  inch', '4 x 2 1/2 inch', '4 x 2 inch', '4 x 1 1/2 inch', '5 x 4 inch', '5 x 3 1/2 inch', '5 x 3 inch', '5 x 2 1/2  inch', '5 x 2 inch', '6 x 5 inch', '6 x 4 inch', '6 x 3 1/2 inch', '6 x 3 inch', '6 x 2 1/2 inch', '8 x 6 inch', '8 x 5 inch', '8 x 4 inch', '8 x 3 1/2 inch', '10 x 8 inch', '10 x 6 inch', '10 x 5 inch', '10 x 4  inch', '12 x 10 inch', '12 x 8 inch', '12 x 6 inch', '12 x 5 inch', '14 x 12 inch', '14 x 10 inch', '14 x 8 inch', '14 x 6 inch', '16 x 14 inch', '16 x 12 inch', '16 x 10 inch', '16 x 8 inch', '18 x 16 inch', '18 x 14 inch', '18 x 12 inch', '18 x 10 inch', '20 x 18 inch', '20 x 16 inch', '20 x 14 inch', '20 x 12 inch', '22 x 20 inch', '22 x 18 inch', '22 x 16 inch', '22 x 14 inch', '24 x 22 inch', '24 x 20 inch', '24 x 18 inch', '24 x 16 inch'],\n            'ASME B 16.5 Slip On Flanges': ['150 lb Rating', '300 lb Rating', '400 lb Rating', '600 lb Rating', '900 lb Rating', '1500 lb Rating', '2500 lb Rating'],\n            'ASME B 16.5 Socket Flanges': ['150 lb Rating', '300 lb Rating', '400 lb Rating', '600 lb Rating', '900 lb Rating', '1500 lb Rating', '2500 lb Rating'],\n            'ASME B 16.5 Weld Neck Raised Face Ring Type Joints': ['150 lb Rating', '300 lb Rating', '400 lb Rating', '600 lb Rating', '900 lb Rating', '1500 lb Rating', '2500 lb Rating'],\n\n\n\n            \"ASME B 16.47\": ['ASME B 16.47 Raised Face Weld Neck Flanges'],\n\n            'ASME B 16.47 Raised Face Weld Neck Flanges': ['150 lb Rating', '300 lb Rating', '400 lb Rating', '600 lb Rating', '900 lb Rating', '1500 lb Rating', '2500 lb Rating'],\n            #220: [221, 222, 223],\n            #230: [231, 232, 233],\n\n            300: ['1 1/2 D Elbow', '1 D Elbow', '2 D Elbow', '3 D Elbow', '4 D Elbow', '5 D Elbow', '6 D Elbow'],\n\n            '1 1/2 D Elbow': ['1/4 inch', '3/8 inch', '1/2 inch', '3/4 inch', '1 inch', '1 1/4 inch', '1 1/2 inch', '2 inch', '2 1/2 inch', '3 inch', '3 1/2 inch', '4 inch', '5 inch', '6 inch', '8 inch', '10 inch', '12 inch', '14 inch', '16 inch', '18 inch', '20 inch', '22 inch', '24 inch'],\n            '1 D Elbow': ['1/4 inch', '3/8 inch', '1/2 inch', '3/4 inch', '1 inch', '1 1/4 inch', '1 1/2 inch', '2 inch', '2 1/2 inch', '3 inch', '3 1/2 inch', '4 inch', '5 inch', '6 inch', '8 inch', '10 inch', '12 inch', '14 inch', '16 inch', '18 inch', '20 inch', '22 inch', '24 inch'],\n            '2 D Elbow': ['1/4 inch', '3/8 inch', '1/2 inch', '3/4 inch', '1 inch', '1 1/4 inch', '1 1/2 inch', '2 inch', '2 1/2 inch', '3 inch', '3 1/2 inch', '4 inch', '5 inch', '6 inch', '8 inch', '10 inch', '12 inch', '14 inch', '16 inch', '18 inch', '20 inch', '22 inch', '24 inch'],\n            '3 D Elbow': ['1/4 inch', '3/8 inch', '1/2 inch', '3/4 inch', '1 inch', '1 1/4 inch', '1 1/2 inch', '2 inch', '2 1/2 inch', '3 inch', '3 1/2 inch', '4 inch', '5 inch', '6 inch', '8 inch', '10 inch', '12 inch', '14 inch', '16 inch', '18 inch', '20 inch', '22 inch', '24 inch'],\n            '4 D Elbow': ['1/4 inch', '3/8 inch', '1/2 inch', '3/4 inch', '1 inch', '1 1/4 inch', '1 1/2 inch', '2 inch', '2 1/2 inch', '3 inch', '3 1/2 inch', '4 inch', '5 inch', '6 inch', '8 inch', '10 inch', '12 inch', '14 inch', '16 inch', '18 inch', '20 inch', '22 inch', '24 inch'],\n            '5 D Elbow': ['1/4 inch', '3/8 inch', '1/2 inch', '3/4 inch', '1 inch', '1 1/4 inch', '1 1/2 inch', '2 inch', '2 1/2 inch', '3 inch', '3 1/2 inch', '4 inch', '5 inch', '6 inch', '8 inch', '10 inch', '12 inch', '14 inch', '16 inch', '18 inch', '20 inch', '22 inch', '24 inch'],\n            '6 D Elbow': ['1/4 inch', '3/8 inch', '1/2 inch', '3/4 inch', '1 inch', '1 1/4 inch', '1 1/2 inch', '2 inch', '2 1/2 inch', '3 inch', '3 1/2 inch', '4 inch', '5 inch', '6 inch', '8 inch', '10 inch', '12 inch', '14 inch', '16 inch', '18 inch', '20 inch', '22 inch', '24 inch'],\n\n            400: ['1/4 inch', '3/8 inch', '1/2 inch', '3/4 inch', '1 inch', '1 1/4 inch', '1 1/2 inch', '2 inch', '2 1/2 inch', '3 inch', '3 1/2 inch', '4 inch', '5 inch', '6 inch', '8 inch', '10 inch', '12 inch', '14 inch', '16 inch', '18 inch', '20 inch', '22 inch', '24 inch'],\n\n            '150 lb Rating': ['1/4 inch', '3/8 inch', '1/2 inch', '3/4 inch', '1 inch', '1 1/4 inch', '1 1/2 inch', '2 inch', '2 1/2 inch', '3 inch', '3 1/2 inch', '4 inch', '5 inch', '6 inch', '8 inch', '10 inch', '12 inch', '14 inch', '16 inch', '18 inch', '20 inch', '22 inch', '24 inch'],\n            '300 lb Rating': ['1/4 inch', '3/8 inch', '1/2 inch', '3/4 inch', '1 inch', '1 1/4 inch', '1 1/2 inch', '2 inch', '2 1/2 inch', '3 inch', '3 1/2 inch', '4 inch', '5 inch', '6 inch', '8 inch', '10 inch', '12 inch', '14 inch', '16 inch', '18 inch', '20 inch', '22 inch', '24 inch'],\n            '400 lb Rating': ['1/4 inch', '3/8 inch', '1/2 inch', '3/4 inch', '1 inch', '1 1/4 inch', '1 1/2 inch', '2 inch', '2 1/2 inch', '3 inch', '3 1/2 inch', '4 inch', '5 inch', '6 inch', '8 inch', '10 inch', '12 inch', '14 inch', '16 inch', '18 inch', '20 inch', '22 inch', '24 inch'],\n            '600 lb Rating': ['1/4 inch', '3/8 inch', '1/2 inch', '3/4 inch', '1 inch', '1 1/4 inch', '1 1/2 inch', '2 inch', '2 1/2 inch', '3 inch', '3 1/2 inch', '4 inch', '5 inch', '6 inch', '8 inch', '10 inch', '12 inch', '14 inch', '16 inch', '18 inch', '20 inch', '22 inch', '24 inch'],\n            '900 lb Rating': ['1/4 inch', '3/8 inch', '1/2 inch', '3/4 inch', '1 inch', '1 1/4 inch', '1 1/2 inch', '2 inch', '2 1/2 inch', '3 inch', '3 1/2 inch', '4 inch', '5 inch', '6 inch', '8 inch', '10 inch', '12 inch', '14 inch', '16 inch', '18 inch', '20 inch', '22 inch', '24 inch'],\n            '1500 lb Rating': ['1/4 inch', '3/8 inch', '1/2 inch', '3/4 inch', '1 inch', '1 1/4 inch', '1 1/2 inch', '2 inch', '2 1/2 inch', '3 inch', '3 1/2 inch', '4 inch', '5 inch', '6 inch', '8 inch', '10 inch', '12 inch', '14 inch', '16 inch', '18 inch', '20 inch', '22 inch', '24 inch'],\n            '2500 lb Rating': ['1/4 inch', '3/8 inch', '1/2 inch', '3/4 inch', '1 inch', '1 1/4 inch', '1 1/2 inch', '2 inch', '2 1/2 inch', '3 inch', '3 1/2 inch', '4 inch', '5 inch', '6 inch', '8 inch', '10 inch', '12 inch', '14 inch', '16 inch', '18 inch', '20 inch', '22 inch', '24 inch'],\n\n            500: ['3/4 x 1/2 inch', '3/4 x 3/8 inch', '1 x 3/4 inch', '1 x 1/2 inch', '1 x 3/8 inch', '1 1/4 x 1 inch', '1 1/4 x 3/4  inch', '1 1/4 x 1/2  inch', '1 1/2 x 1 1/4  inch', '1 1/2 x 1 inch', '1 1/2 x 3/4 inch', '1 1/2 x 1/2 inch', '2 x 1 1/2 inch', '2 x 1 1/4 inch', '2 x 1  inch', '2 x 3/4 inch', '2 1/2 x 2 inch', '2 1/2 x 1 1/2 inch', '2 1/2 x 1 1/4 inch', '2 1/2 x 1 inch', '3 x 2 1/2 inch', '3 x 2 inch', '3 x 1 1/2 inch', '3 x 1 1/4 inch', '3 1/2 x 3  inch', '3 1/2 x 2 1/2 inch', '3 1/2 x 2  inch', '3 1/2 x 1 1/2 inch', '3 1/2 x 1 1/4 inch', '4 x 3 1/4 inch', '4 x 3  inch', '4 x 2 1/2 inch', '4 x 2 inch', '4 x 1 1/2 inch', '5 x 4 inch', '5 x 3 1/2 inch', '5 x 3 inch', '5 x 2 1/2  inch', '5 x 2 inch', '6 x 5 inch', '6 x 4 inch', '6 x 3 1/2 inch', '6 x 3 inch', '6 x 2 1/2 inch', '8 x 6 inch', '8 x 5 inch', '8 x 4 inch', '8 x 3 1/2 inch', '10 x 8 inch', '10 x 6 inch', '10 x 5 inch', '10 x 4  inch', '12 x 10 inch', '12 x 8 inch', '12 x 6 inch', '12 x 5 inch', '14 x 12 inch', '14 x 10 inch', '14 x 8 inch', '14 x 6 inch', '16 x 14 inch', '16 x 12 inch', '16 x 10 inch', '16 x 8 inch', '18 x 16 inch', '18 x 14 inch', '18 x 12 inch', '18 x 10 inch', '20 x 18 inch', '20 x 16 inch', '20 x 14 inch', '20 x 12 inch', '22 x 20 inch', '22 x 18 inch', '22 x 16 inch', '22 x 14 inch', '24 x 22 inch', '24 x 20 inch', '24 x 18 inch', '24 x 16 inch'],\n\n            '3/4 x 1/2 inch': ['N\\A'],\n            '3/4 x 3/8 inch': ['N\\A'],\n            '1 x 3/4 inch': ['N\\A'],\n            '1 x 1/2 inch': ['N\\A'],\n            '1 x 3/8 inch': ['N\\A'],\n            '1 1/4 x 1 inch' : ['N\\A'],\n            '1 1/4 x 3/4  inch' : ['N\\A'],\n            '1 1/4 x 1/2  inch' : ['N\\A'],\n            '1 1/2 x 1 1/4  inch' : ['N\\A'],\n            '1 1/2 x 1 1/4  inch': ['N\\A'],\n            '1 1/2 x 1 inch': ['N\\A'],\n            '1 1/2 x 3/4 inch': ['N\\A'],\n            '1 1/2 x 1/2 inch': ['N\\A'],\n            '2 x 1 1/2 inch': ['N\\A'],\n            '2 x 1 1/4 inch': ['N\\A'],\n            '2 x 1  inch': ['N\\A'],\n            '2 x 3/4 inch': ['N\\A'],\n            '2 1/2 x 2 inch': ['N\\A'],\n            '2 1/2 x 1 1/2 inch': ['N\\A'],\n            '2 1/2 x 1 1/4 inch': ['N\\A'],\n            '2 1/2 x 1 inch': ['N\\A'],\n            '3 x 2 1/2 inch': ['N\\A'],\n            '3 x 2 inch': ['N\\A'],\n            '3 x 1 1/2 inch': ['N\\A'],\n            '3 x 1 1/4 inch': ['N\\A'],\n            '3 1/2 x 3  inch': ['N\\A'],\n            '3 1/2 x 2 1/2 inch': ['N\\A'],\n            '3 1/2 x 2  inch': ['N\\A'],\n            '3 1/2 x 1 1/2 inch': ['N\\A'],\n            '3 1/2 x 1 1/4 inch': ['N\\A'],\n            '4 x 3 1/4 inch': ['N\\A'],\n            '4 x 3  inch': ['N\\A'],\n            '4 x 2 1/2 inch': ['N\\A'],\n            '4 x 2 inch': ['N\\A'],\n            '4 x 1 1/2 inch': ['N\\A'],\n            '5 x 4 inch': ['N\\A'],\n            '5 x 3 1/2 inch': ['N\\A'],\n            '5 x 3 inch': ['N\\A'],\n            '5 x 2 1/2  inch': ['N\\A'],\n            '5 x 2 inch': ['N\\A'],\n            '6 x 5 inch': ['N\\A'],\n            '6 x 4 inch': ['N\\A'],\n            '6 x 3 1/2 inch': ['N\\A'],\n            '6 x 3 inch': ['N\\A'],\n            '6 x 2 1/2 inch': ['N\\A'],\n            '8 x 6 inch': ['N\\A'],\n            '8 x 5 inch': ['N\\A'],\n            '8 x 4 inch': ['N\\A'],\n            '8 x 3 1/2 inch': ['N\\A'],\n            '10 x 8 inch': ['N\\A'],\n            '10 x 6 inch': ['N\\A'],\n            '10 x 5 inch': ['N\\A'],\n            '10 x 4  inch': ['N\\A'],\n            '12 x 10 inch': ['N\\A'],\n            '12 x 8 inch': ['N\\A'],\n            '12 x 6 inch': ['N\\A'],\n            '12 x 5 inch': ['N\\A'],\n            '14 x 12 inch': ['N\\A'],\n            '14 x 10 inch': ['N\\A'],\n            '14 x 8 inch': ['N\\A'],\n            '14 x 6 inch': ['N\\A'],\n            '16 x 14 inch': ['N\\A'],\n            '16 x 12 inch': ['N\\A'],\n            '16 x 10 inch': ['N\\A'],\n            '16 x 8 inch': ['N\\A'],\n            '18 x 16 inch': ['N\\A'],\n            '18 x 14 inch': ['N\\A'],\n            '18 x 12 inch': ['N\\A'],\n            '18 x 10 inch': ['N\\A'],\n            '20 x 18 inch': ['N\\A'],\n            '20 x 16 inch': ['N\\A'],\n            '20 x 14 inch': ['N\\A'],\n            '20 x 12 inch': ['N\\A'],\n            '22 x 20 inch': ['N\\A'],\n            '22 x 18 inch': ['N\\A'],\n            '22 x 16 inch': ['N\\A'],\n            '22 x 14 inch': ['N\\A'],\n            '24 x 22 inch': ['N\\A'],\n            '24 x 20 inch': ['N\\A'],\n            '24 x 18 inch': ['N\\A'],\n            '24 x 16 inch': ['N\\A'],\n\n        }\n\n        # ObservableCollection will notify the UI of changes for us\n        dd1_data = ObservableCollection[object]()\n        dd1_data.Add(\"ASME B 16.5\")\n        dd1_data.Add(\"ASME B 16.47\")\n        #dd1_data.Add(300)\n        #dd1_data.Add(400)\n        dd2_data = ObservableCollection[object]()\n        dd3_data = ObservableCollection[object]()\n        dd4_data = ObservableCollection[object]()\n\n        dd1 = DropDown()\n        dd1.DataStore = dd1_data\n\n        dd2 = DropDown()\n        dd2.DataStore = dd2_data\n\n        dd3 = DropDown()\n        dd3.DataStore = dd3_data\n\n        dd4 = DropDown()\n        dd4.DataStore = dd4_data\n\n        # Cache indexes to avoid unnecessary state updates which can be a bit crashy\n        dialog.dd1_index = -1\n        dialog.dd2_index = -1\n        dialog.dd3_index = -1 #RD\n        dialog.dd4_index = -1 #RD\n\n        dialog.busy = False\n        def update_state(sender, args):\n            # Super safe busy check, prevents recursion!\n            if (dialog.busy):\n                return\n            \n            dialog.busy = True\n            \n            # Prevents crashing if there is no data, we should do this more, but I'm lazy\n            if dd1.SelectedIndex == -1:\n                return\n\n            if (dd1.SelectedIndex != dialog.dd1_index):\n\n                items1 = data[dd1.SelectedValue]\n                \n                # Note we don't set a NEW value, we use the same collection\n                dd2_data.Clear()\n                for i in items1:\n                    dd2_data.Add(i)\n                dd2.SelectedIndex = 0\n                dd3.SelectedIndex = 0\n                dd4.SelectedIndex = 0\n                dialog.dd2_index = 0\n\n            # This should run on 1 or 2 changing index\n            if (dd2.SelectedIndex != dialog.dd2_index or\n                dd1.SelectedIndex != dialog.dd1_index):\n                items2 = data[dd2.SelectedValue]\n                \n\n            \n\n                # Note we don't set a NEW value, we use the same collection\n                dd3_data.Clear()\n                for i in items2:\n                    dd3_data.Add(i)\n                dd3.SelectedIndex = 0\n\n            if (dd3.SelectedIndex != dialog.dd3_index or\n                dd2.SelectedIndex != dialog.dd2_index or\n                dd1.SelectedIndex != dialog.dd1_index):\n\n                dd4_data.Clear()\n                if dd3.SelectedValue in data.keys():\n                    items3 = data[dd3.SelectedValue]\n\n                    # Note we don't set a NEW value, we use the same collection\n                    for i in items3:\n                        dd4_data.Add(i)\n                    dd4.SelectedIndex = 0\n\n            dialog.dd3_index = dd3.SelectedIndex\n            dialog.dd2_index = dd2.SelectedIndex\n            dialog.dd1_index = dd1.SelectedIndex\n\n            \n\n            \n            # We are no longer busy!\n            dialog.busy = False\n\n        dd1.SelectedIndexChanged += update_state\n        dd2.SelectedIndexChanged += update_state\n        dd3.SelectedIndexChanged += update_state\n        dd1.SelectedIndex = 0\n\n\n        \n        # Nice way to set up a UI with equal spacing\n        dynamic = DynamicLayout()\n        dynamic.Spacing = Size(4, 4) # Bit cramped otherwise\n        dynamic.BeginHorizontal()\n        dynamic.Add(dd1, True)\n        dynamic.Add(dd2, True)\n        dynamic.Add(dd3, True)\n        dynamic.Add(dd4, True)\n        dynamic.EndHorizontal()\n\n \n\n        dialog.Content = dynamic\n\n        parent = RhinoEtoApp.MainWindowForDocument(sc.doc)\n        dialog.ShowModal(parent)\n\n# The script that will be using the dialog.\ndef Pipework():\n    #rs.CurrentDimStyle(\"Default\")\n    \n    #Utility function to show the dialog box\n    dialog = GeoPipeworkDialog();\n    \n    #Open the dialogue\n\n    rc = dialog.ShowModal(Rhino.UI.RhinoEtoApp.MainWindow)\n    if not rc: return\n\n\n\n\n    \n    print (\"End of Geo Pipework\")\n# Check to see if this file is being executed as the \"main\" python\n# script instead of being used as a module by some other python script\n# This allows us to use the module which ever way we want.\nif __name__ == \"__main__\":\n    rc = Pipework()",
      "language": "python",
      "author": "RogerD",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "file-io",
    "geometry",
    "layers",
    "python",
    "rhinoscriptsyntax",
    "selection"
  ],
  "has_accepted_answer": true,
  "category_id": 3,
  "posts_count": 7,
  "views": 138
}