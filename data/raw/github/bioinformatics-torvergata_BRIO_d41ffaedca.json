{
  "source_url": "https://github.com/bioinformatics-torvergata/BRIO/blob/283c8b24d0215db6d46b4cacdaddf766c9a60232/scripts/status_loading_page.py",
  "repo": "bioinformatics-torvergata/BRIO",
  "repo_stars": 4,
  "repo_description": "BRIO: a web server for RNA sequence and structure motif scan (https://doi.org/10.1093/nar/gkab400)",
  "license": "unknown",
  "filepath": "scripts/status_loading_page.py",
  "instruction": "import rhinoscriptsyntax as rs",
  "code": "#import rhinoscriptsyntax as rs\nimport json\nimport sys\nimport functions\nimport os\nimport subprocess\nfrom pathlib import Path\n\n\n\ncode=sys.argv[1]\nname_out=sys.argv[2]\nbool_bg=sys.argv[3]\n\nwith open('users/'+code+'/var_POST.json', 'r') as f:\n\tpost = json.load(f)\n\n\n#controllo ricerca\ndef check_perc(bool_bg, post):\n\n\t##############################tot contiene il totale dei files su cui fare la ricerca (viene moltiplicato per 3 perche \n\t#per ogni file su cui fare la ricerca viene generato un file con l'output del search BEAM (in out_search_nuc/str) e un secondo file (in summary_nuc/str) con il summary della ricerca (da far vedere all'utente) e gli istogrammi\n\t\n\tif 'selected_RBP' in post.keys():\n\t\tif post['selected_RBP'][0]=='Select_all':\n\t\t\t####all motifs###\n\t\t\tprint('prova1')\n\t\t\tif 'type-motifs' in post.keys():\n\t\t\t\tif post['type-motifs']=='only-seq':\n\t\t\t\t\ttot=len(os.listdir('motifs_nuc/'))*3\n\t\t\t\telif post['type-motifs']=='only-str':\n\t\t\t\t\ttot=len(os.listdir('motifs_str/'))*3\n\t\t\t\telse:\n\t\t\t\t\ttot=(len(os.listdir('motifs_nuc/'))+len(os.listdir('motifs_str/')))*3\n\t\telse:\n\t\t\t####BBP####\n\t\t\tif post['selected_RBP']!='':\n\t\t\t\tlist_rbps=post['selected_RBP']\n\t\t\t\tif 'type-motifs' in post.keys():\n\t\t\t\t\tif post['type-motifs']=='only-seq':\n\t\t\t\t\t\tlist_files=functions.create_list_of_makeSearch(list_rbps, 'dict/dict_RBP_searchMotifs_nuc.txt')\n\t\t\t\t\t\ttot=len(list_files)*3\n\t\t\t\t\telif post['type-motifs']=='only-str':\n\t\t\t\t\t\tlist_files=functions.create_list_of_makeSearch(list_rbps, 'dict/dict_RBP_searchMotifs_str.txt')\n\t\t\t\t\t\ttot=len(list_files)*3\n\t\t\t\t\telse:\n\t\t\t\t\t\tlist_files=functions.create_list_of_makeSearch(list_rbps, 'dict/dict_RBP_searchMotifs_nuc.txt')\n\t\t\t\t\t\tlist_files=functions.create_list_of_makeSearch(list_rbps, 'dict/dict_RBP_searchMotifs_str.txt')\n\t\t\t\t\t\ttot=(len(list_files)+len(list_files))*3\n\t\t\n\t\n\t\n\telse:\n\t\t###domini###\n\t\tif 'selected_domains' in post.keys() and post['selected_domains']!='' and 'selected_RBP' not in post.keys():\n\t\t\tlist_dom=post['selected_domains']\n\t\t\tif 'type-motifs' in post.keys():\n\t\t\t\tif post['type-motifs']=='only-seq':\n\t\t\t\t\tlist_files=functions.create_list_of_makeSearch(list_dom, 'dict/dict_dom_searchMotifs_nuc.txt')\n\t\t\t\t\ttot=len(list_files)*3\n\t\t\t\telif post['type-motifs']=='only-str':\n\t\t\t\t\tlist_files=functions.create_list_of_makeSearch(list_dom, 'dict/dict_dom_searchMotifs_str.txt')\n\t\t\t\t\ttot=len(list_files)*3\n\t\t\t\t\t\n\t\t\t\telse: #se l'utente non ha scelto il tipo di motivi, faccio la ricerca su entrambi\n\t\t\t\t\tlist_files_nuc=functions.create_list_of_makeSearch(list_dom, 'dict/dict_dom_searchMotifs_nuc.txt')\n\t\t\t\t\tlist_files_str=functions.create_list_of_makeSearch(list_dom, 'dict/dict_dom_searchMotifs_str.txt')\n\t\t\t\t\ttot=(len(list_files_nuc)+len(list_files_str))*3\n\t\t\n\n\t\t\t\t\n\t#print(tot)\n\t\n\t#####################################################\n\t###############################se ho il bg\n\tdone=0\n\tperc=0\n\t\n\t#se e presente bg, allora considero solo cartelle out_search_str e/o _nuc e non i summary.\n\tif bool_bg=='T':\n\t\ttot=tot+(tot/3)\n\t\n\t\n\t\n\t\n\twhile done<tot:\n\t\tif bool_bg=='T':\n\t\t\tif 'type-motifs' in post.keys():\n\t\t\t\tif post['type-motifs']=='only-seq':\n\t\t\t\t\tdone=(len(os.listdir('users/'+code+'/out_search_nuc/'))+len(os.listdir('users/'+code+'/bg/out_search_nuc/')))+(len(os.listdir('users/'+code+'/summary_nuc/')))+len(os.listdir('users/'+code+'/hist_nuc/'))\n\t\t\t\tif post['type-motifs']=='only-str':\n\t\t\t\t\tdone=(len(os.listdir('users/'+code+'/out_search_str/'))+len(os.listdir('users/'+code+'/bg/out_search_str/')))+(len(os.listdir('users/'+code+'/summary_str/')))+len(os.listdir('users/'+code+'/hist_str/'))\n\t\t\t\telse:\n\t\t\t\t\tdone1=(len(os.listdir('users/'+code+'/out_search_nuc/'))+len(os.listdir('users/'+code+'/out_search_str/'))+len(os.listdir('users/'+code+'/bg/out_search_nuc/'))+len(os.listdir('users/'+code+'/bg/out_search_str/')))+len(os.listdir('users/'+code+'/hist_nuc/'))+len(os.listdir('users/'+code+'/hist_str/'))\n\t\t\t\t\tdone2=(len(os.listdir('users/'+code+'/summary_nuc/'))+len(os.listdir('users/'+code+'/summary_str/')))\n\t\t\t\t\tdone=done1+done2\n\t\n\t\t\n\t\t#################controllo i file gia fatti\n\t\telse:\n\t\t\tif 'type-motifs' in post.keys():\n\t\t\t\tif post['type-motifs']=='only-seq':\n\t\t\t\t\tdone=len(os.listdir('users/'+code+'/out_search_nuc/'))+len(os.listdir('users/'+code+'/summary_nuc/'))+len(os.listdir('users/'+code+'/hist_nuc/'))\n\t\t\t\tif post['type-motifs']=='only-str':\n\t\t\t\t\tdone=len(os.listdir('users/'+code+'/out_search_str/'))+len(os.listdir('users/'+code+'/summary_str/'))+len(os.listdir('users/'+code+'/hist_str/'))\n\t\t\t\telse:\n\t\t\t\t\tdone=(len(os.listdir('users/'+code+'/out_search_nuc/'))+len(os.listdir('users/'+code+'/out_search_str/')))+len(os.listdir('users/'+code+'/summary_nuc/'))+len(os.listdir('users/'+code+'/summary_str/'))+len(os.listdir('users/'+code+'/hist_nuc/'))+len(os.listdir('users/'+code+'/hist_str/'))\n\n\t\t\n\t\tperc=int((float(done)/tot*100))\n\t\t\n\t\t#print(done)\n\t\t#print (tot)\n\t\t#print ('\\n')\t\t\n\t\t\n\t\tif perc >=50 and perc<100:\n\t\t\tos.system('echo \"'+str(perc)+'%, Output elaboration... Please Wait! \"> '+ name_out)\n\t\telif perc >=100:\n\t\t\n\t\t\tperc=100\n\t\t\tos.system('echo \"'+str(perc)+'\"> '+ name_out)\n\t\t\t\n\t\telse:\n\t\t\tos.system('echo \"'+str(perc)+'%, Data elaboration \" > '+ name_out)\n\n\n\n\ncheck_perc(bool_bg, post)\n\n\n",
  "language": "python",
  "imports": [
    "rhinoscriptsyntax"
  ],
  "has_docstring": true
}