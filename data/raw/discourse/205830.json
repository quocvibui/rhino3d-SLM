{
  "source_url": "https://discourse.mcneel.com/t/saveas-dxf-alters-geometry/205830",
  "topic_id": 205830,
  "title": "SaveAs dxf alters geometry",
  "question": "Hello everyone,\n\n\nThis code to save a dxf file…\n\n\n    filt = \"{} Files (*.{})|*.{}||\".format(ft,ft.lower(),ft.lower())\n    if not filename:\n        if filename==None: return\n\n    e_file_name = '\"{}\" '.format(filename)\n    e_file_name = e_file_name + \" Scheme \"+ chr(34) + strScheme + chr(34) + \" _Enter\" \n \n    rs.Command(\"-_SaveAs \"+e_file_name+\" _Enter\", False)\n\n\n\nChanges this file…\n\n\nimage\n1807×429 35.8 KB\n\n\n…into this file…\n\n\nimage\n1808×417 9.41 KB\n\n\n…and I have no idea why.\n\n\nThis is part of a batch process script to open a folder of dxf files, modify each one, then save it and continue onto the next dxf file. It was basically working until now.\n\n\nDoes anyone have any clues? It was exporting fine a few iterations ago. Only thing I’ve changed is creating a new empty file without a template. There are no projection commands at all in the entirety of the script. A debugging breakpoint just before this section shows the geometry as expected. The geometry modification method when run alone does not distort the geometry in this way, so it must be something to do with the export, which makes no sense to me. Removing the dxf scheme doesn’t change the result.\n\n\nI am stumped.\n\n\nregards,\n\nNick",
  "code_blocks": [
    {
      "code": "filt = \"{} Files (*.{})|*.{}||\".format(ft,ft.lower(),ft.lower())\n    if not filename:\n        if filename==None: return\n\n    e_file_name = '\"{}\" '.format(filename)\n    e_file_name = e_file_name + \" Scheme \"+ chr(34) + strScheme + chr(34) + \" _Enter\" \n \n    rs.Command(\"-_SaveAs \"+e_file_name+\" _Enter\", False)",
      "language": "python",
      "author": "NickB",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "file-io",
    "geometry",
    "python"
  ],
  "has_accepted_answer": true,
  "category_id": 11,
  "posts_count": 3,
  "views": 100
}