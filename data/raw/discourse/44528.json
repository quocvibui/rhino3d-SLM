{
  "source_url": "https://discourse.mcneel.com/t/gamecontroller-component-for-grasshopper-kangaroo/44528",
  "topic_id": 44528,
  "title": "GameController Component for GrassHopper/Kangaroo",
  "question": "OK, so who’s going to make a component that gives GameControllers access to Rhino objects, probably via GrassHopper / Kangaroo components?\n\n\nWith the option to “Record” whatever signals that were sent, so as to be able to repeat the manually controlled sequence.\n\n\nOr does it already exist? Anything in this direction exist?\n\n\n// Rolf",
  "code_blocks": [
    {
      "code": "Imports System.Collections.Generic\n\nImports Grasshopper.Kernel\nImports Rhino.Geometry\nImports SharpDX.XInput\n\nPublic Class XBoxOneControlComponent\n    Inherits GH_Component\n\n    Public Const GC_Output_Debug = 0\n    Public Const GC_Output_Running = 1\n    Public Const GC_Output_RightThumbX = 2\n    Public Const GC_Output_RightThumbY = 3\n\n    Public M_DEBUG_DA As IGH_DataAccess\n\n    '// --------------------------------------------------------\n    Public Sub New()\n        '| Abbreviation (Name)\n        '| Description\n        '| Category              ; Main TAB\n        '| SubCategory           ; Group within TAB\n        MyBase.New(\"XBox One Game Control\", \"XBoxOne\",\n                \"Reads input from XBox One Game Controller.\",\n                \"UI\", \"Game\")\n    End Sub\n\n\n    '// --------------------------------------------------------\n    ''' <summary>\n    ''' INPUT - parameters for this component.\n    ''' </summary>\n    Protected Overrides Sub RegisterInputParams(ByVal pManager As GH_Component.GH_InputParamManager)\n        pManager.AddBooleanParameter(\"Scan\", \"S\", \"Scans the XBox Controller for signals\", 0)\n    End Sub\n\n\n    '// --------------------------------------------------------\n    ''' <summary>\n    ''' OUTPUT - parameters for this component.\n    ''' </summary>\n    Protected Overrides Sub RegisterOutputParams(ByVal pManager As GH_Component.GH_OutputParamManager)\n        pManager.AddTextParameter(\"Debug\", \"Debug\", \"Debug channel for development only.\", GH_ParamAccess.item)\n        pManager.AddBooleanParameter(\"Running\", \"R\", \"The XBox Controller Is scanned for input\", GH_ParamAccess.item)\n        pManager.AddNumberParameter(\"RightThumbX\", \"RTX\", \"Right Thumb X\", GH_ParamAccess.item)\n        pManager.AddNumberParameter(\"RightThumbY\", \"RTY\", \"Right Thumb Y\", GH_ParamAccess.item)\n    End Sub\n\n\n    '// --------------------------------------------------------\n    ''' <summary>\n    ''' USed only during development to log code progress/success in the Debug output of the component\n    ''' </summary>\n    Protected Sub DebugMsg(msg As String)\n        M_DEBUG_DA.SetData(GC_Output_Debug, New String(msg))\n    End Sub\n\n    '// --------------------------------------------------------\n    Protected Overrides Sub SolveInstance(DA As IGH_DataAccess)\n        '// --------------------------------------------------------\n        '// Example of Dead zones sensitivity\n        '// --------------------------------------------------------\n\n        'Dim LStick_DeadZone As Integer = 7849\n        'Dim RStick_DeadZone As Integer = 8689\n        'Dim LTrigger_Threshold As Integer = 30\n        'Dim RTrigger_Threshold As Integer = 30\n\n        '// --------------------------------------------------------\n        '// Enable the Sub DebugMsg to use DA parameter for output\n        '// --------------------------------------------------------\n\n        M_DEBUG_DA = DA\n\n        '// Variable activating this GH component to read the XBox Controller (once).\n        '// \n        '// TODO: Loop to read values. What about GH's Timer component?\n        '// \n\n        Dim DoScan As Boolean = False\n\n        '// --------------------------------------------------------\n        '// Use the DA object to retrieve the data inside the first input parameter.\n        '// If the retieval fails (for example if there is no data) we need to abort.\n        '// --------------------------------------------------------\n\n        If (Not DA.GetData(0, DoScan)) Then Return\n\n        '// --------------------------------------------------------\n        '// Set Chained Output\n        '// --------------------------------------------------------\n\n        DA.SetData(GC_Output_Running, DoScan)\n\n        '// --------------------------------------------------------\n        '// GAME CONTROLLER \n        '// --------------------------------------------------------\n        If Not DoScan Then\n            DA.SetData(GC_Output_RightThumbX, 0)\n            DA.SetData(GC_Output_RightThumbY, 0)\n            DebugMsg(\"No DoScan\")\n        Else\n            DebugMsg(\"OK, Scanning...\")\n\n            '//------------------------------------------------------\n            '// Type: SharpDX.XInput.Controller\n            '//------------------------------------------------------\n\n            Dim controllers As New List(Of Controller)\n            Dim gc As Controller = Nothing\n            gc = New Controller(UserIndex.One)\n            controllers.Add(gc)\n\n            '// Disabled (for now) the other three controllers that can potentially \n            '// be active simultaneously            \n\n            'controllers.Add(New Controller(UserIndex.Two))\n            'controllers.Add(New Controller(UserIndex.Three))\n            'controllers.Add(New Controller(UserIndex.Four))\n\n            '//------------------------------------------------------\n            '// Pick (first) Game Controller (gc)\n            '//------------------------------------------------------\n            For Each selectController In controllers\n                If selectController.IsConnected Then\n                    gc = selectController\n                    DebugMsg(\"One Controller found.\")\n                    Exit For\n                End If\n                DebugMsg(\"No Controller found! :( \")\n            Next\n\n\n            '//------------------------------------------------------\n            '// OUTPUT GamePad values, if connected\n            '//------------------------------------------------------\n            If gc IsNot Nothing AndAlso gc.IsConnected Then\n                Dim g_state = gc.GetState()\n                DA.SetData(GC_Output_RightThumbX, g_state.Gamepad.RightThumbX)\n                DA.SetData(GC_Output_RightThumbY, g_state.Gamepad.RightThumbY)\n                    '// ...\n                    '// aso\n                    '// ...\n            Else\n                DA.SetData(GC_Output_RightThumbX, 0)\n                DA.SetData(GC_Output_RightThumbY, 0)\n                    '// ...\n                    '// aso\n                    '// ...\n            End If\n\n        End If\n\n    End Sub '// SolveInstance\n\n\n    '// --------------------------------------------------------\n    Protected Overrides ReadOnly Property Icon() As System.Drawing.Bitmap\n        Get\n            Return Nothing\n        End Get\n    End Property\n\n\n    '// --------------------------------------------------------\n    Public Overrides ReadOnly Property ComponentGuid() As Guid\n        Get\n            Return New Guid(\" .... your guid ... \")\n        End Get\n    End Property\nEnd Class",
      "language": "unknown",
      "author": "RIL",
      "post_number": 4,
      "is_solution": false
    }
  ],
  "tags": [
    "boolean",
    "geometry",
    "grasshopper",
    "python",
    "rhinocommon"
  ],
  "has_accepted_answer": false,
  "category_id": 2,
  "posts_count": 3,
  "views": 1489
}