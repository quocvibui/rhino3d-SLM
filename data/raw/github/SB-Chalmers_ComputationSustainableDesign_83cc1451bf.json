{
  "source_url": "https://github.com/SB-Chalmers/ComputationSustainableDesign/blob/7f61d112e0d60667bbef3e6fc4fc7236bcf6bbba/Grasshopper%20Scripts/HBConstruction%20_from_CSV/makeHBConstruction.py",
  "repo": "SB-Chalmers/ComputationSustainableDesign",
  "repo_stars": 2,
  "repo_description": null,
  "license": "NOASSERTION",
  "filepath": "Grasshopper Scripts/HBConstruction _from_CSV/makeHBConstruction.py",
  "instruction": "Provides a scripting component.\n    Inputs:\n        _solutions: The x script variable\n    Output:\n        HB_Constructions: The a output variable",
  "code": "\"\"\"Provides a scripting component.\n    Inputs:\n        _solutions: The x script variable\n    Output:\n        HB_Constructions: The a output variable\"\"\"\n\n__author__ = \"ssanjay\"\n__version__ = \"2022.10.21\"\ntry:  # import the core honeybee dependencies\n    from honeybee.typing import clean_and_id_ep_string, clean_ep_string\nexcept ImportError as e:\n    raise ImportError('\\nFailed to import honeybee:\\n\\t{}'.format(e))\n\ntry:  # import the honeybee-energy dependencies\n    from honeybee_energy.material.opaque import EnergyMaterial\nexcept ImportError as e:\n    raise ImportError('\\nFailed to import honeybee_energy:\\n\\t{}'.format(e))\n\ntry:  # import the honeybee-energy dependencies\n    from honeybee_energy.construction.opaque import OpaqueConstruction\n    from honeybee_energy.lib.materials import opaque_material_by_identifier\nexcept ImportError as e:\n    raise ImportError('\\nFailed to import honeybee_energy:\\n\\t{}'.format(e))\n\ntry:  # import ladybug_rhino dependencies\n    from ladybug_rhino.grasshopper import all_required_inputs\nexcept ImportError as e:\n    raise ImportError('\\nFailed to import ladybug_rhino:\\n\\t{}'.format(e))\nimport rhinoscriptsyntax as rs\nimport ghpythonlib.treehelpers as th\n_solution = th.tree_to_list(_solution)\n\n\n\nHB_Constructions = []\n\nfor sol in _solution:\n    _materials = []\n    _name_ = []\n    for layer in sol:\n        prop = layer.split(';')\n        identifier = prop[0]\n        _name = clean_ep_string(prop[1])\n        _thickness = prop[2]\n        _conductivity = prop[3]\n        cost = prop[4]\n        embodied_Carbon = prop[5]\n        _density = prop[6]\n        u_value = prop[7]\n        # Adding default assumptions\n        _roughness_ = 'MediumRough'\n        _therm_absp_ = 0.9\n        _sol_absp_ = 0.7\n        _vis_absp_ = 0.9\n        # https://www.mrsphysics.co.uk/bge/wp-content/uploads/2016/07/thermal-properties-of-building-materials.pdf\n        _spec_heat = 950\n        # Creating the EnergyMaterial\n        mat = EnergyMaterial(\n        _name,\n        _thickness,\n        _conductivity,\n        _density,\n        _spec_heat,\n        _roughness_,\n        _therm_absp_,\n        _sol_absp_,\n        _vis_absp_)\n        # Add EnergyMaterial to _materials\n        _materials.append(mat)\n        _name_.append(_name[0:3])\n    # create the construction\n    material_objs = []\n    for material in _materials:\n        if isinstance(material, str):\n            material = opaque_material_by_identifier(material)\n        material_objs.append(material)\n    name = '_'.join(_name_)\n    constr = OpaqueConstruction(name, material_objs)\n    HB_Constructions.append(constr)",
  "language": "python",
  "imports": [
    "ghpythonlib",
    "rhinoscriptsyntax"
  ],
  "has_docstring": true
}