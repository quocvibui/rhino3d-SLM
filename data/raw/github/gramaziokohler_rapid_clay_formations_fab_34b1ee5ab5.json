{
  "source_url": "https://github.com/gramaziokohler/rapid_clay_formations_fab/blob/9c884fe34a9e27ca0c8a4ed883a99197b209badd/src/rapid_clay_formations_fab/rhino/compas_to_rhino.py",
  "repo": "gramaziokohler/rapid_clay_formations_fab",
  "repo_stars": 1,
  "repo_description": "python module for MAS DFAB Rapid Clay Formations",
  "license": "MIT",
  "filepath": "src/rapid_clay_formations_fab/rhino/compas_to_rhino.py",
  "instruction": "Most of these are in compas >=0.15 but compas_fab is not there yet.",
  "code": "\"\"\"Most of these are in compas >=0.15 but compas_fab is not there yet.\"\"\"\nfrom __future__ import absolute_import\nfrom __future__ import division\nfrom __future__ import print_function\n\nimport compas\nimport compas.geometry as cg\nfrom compas_ghpython.artists import MeshArtist\n\ntry:\n    import Rhino\n    import Rhino.Geometry as rg\nexcept ImportError:\n    compas.raise_if_ironpython()\n\n\ndef cgpoint_to_rgpoint(pt):  # type: (compas.geometry.Point) -> Rhino.Geometry.Point3d\n    \"\"\"Convert :class:`compas.geometry.Point` to :class:`Rhino.Geometry.Point3d`.\n\n    Parameters\n    ----------\n    pt : :class:`compas.geometry.Point`\n        Point object to convert.\n\n    Returns\n    -------\n    :class:`Rhino.Geometry.Point3d`\n        Resulting Point3d object.\n    \"\"\"\n    return rg.Point3d(*pt.data)\n\n\ndef cgvector_to_rgvector(\n    v,\n):  # type: (compas.geometry.Vector) -> Rhino.Geometry.Vector3d\n    \"\"\"Convert :class:`compas.geometry.Vector` to :class:`Rhino.Geometry.Vector3d`.\n\n    Parameters\n    ----------\n    v : :class:`compas.geometry.Vector`\n        Vector object to convert.\n\n    Returns\n    -------\n    :class:`Rhino.Geometry.Vector3d`\n        Resulting Vector3d object.\n    \"\"\"\n    return rg.Vector3d(*v.data)\n\n\ndef cgline_to_rgline(line):  # type: (compas.geometry.Line) -> Rhino.Geometry.Line\n    \"\"\"Convert :class:`compas.geometry.Line` to :class:`Rhino.Geometry.Line`.\n\n    Parameters\n    ----------\n    line : :class:`compas.geometry.Line`\n        Point object to convert.\n\n    Returns\n    -------\n    :class:`Rhino.Geometry.Line`\n        Resulting Line object.\n    \"\"\"\n    return rg.Line(cgpoint_to_rgpoint(line.start), cgpoint_to_rgpoint(line.end))\n\n\ndef cgplane_to_rgplane(\n    cgplane,\n):  # type: (compas.geometry.Plane) -> Rhino.Geometry.Plane\n    \"\"\"Convert :class:`compas.geometry.Plane` to :class:`Rhino.Geometry.Plane`.\n\n    Parameters\n    ----------\n    cgplane : :class:`compas.geometry.Plane`\n        Plane to convert.\n\n    Returns\n    -------\n    :class:`Rhino.Geometry.Plane`\n        Resulting plane.\n    \"\"\"\n    return rg.Plane(\n        cgpoint_to_rgpoint(cgplane.point), cgvector_to_rgvector(cgplane.normal)\n    )\n\n\ndef cgframe_to_rgplane(frame):  # type: (compas.geometry.Frame) -> Rhino.Geometry.Plane\n    \"\"\"Convert :class:`compas.geometry.Frame` to :class:`Rhino.Geometry.Plane`.\n\n    Parameters\n    ----------\n    frame : :class:`compas.geometry.Frame`\n        Frame to convert.\n\n    Returns\n    -------\n    :class:`Rhino.Geometry.Plane`\n        Resulting plane.\n    \"\"\"\n    o = cgpoint_to_rgpoint(frame.point)\n    x = cgvector_to_rgvector(frame.xaxis)\n    y = cgvector_to_rgvector(frame.yaxis)\n    return rg.Plane(o, x, y)\n\n\ndef matrix_to_rgtransform(M):\n    \"\"\"Create :class:`Rhino.Geometry.Transform` from a transformation matrix.\n\n    Parameters\n    ----------\n    M : :class:`list` of :class:`list` of :class:`float`\n        Transformation matrix.\n\n    Returns\n    -------\n    :class:`Rhino.Geometry.Transform`\n    \"\"\"\n    rgM = rg.Transform()\n    for i, row in enumerate(M):\n        for j, val in enumerate(row):\n            rgM[i, j] = val\n    return rgM\n\n\ndef cgmesh_to_rgmesh(mesh):\n    artist = MeshArtist(mesh)\n\n    return artist.draw_mesh()\n\n\ndef _test_functions():\n    # test cgpoint_to_rgpoint\n    point = cgpoint_to_rgpoint(cg.Point(1, 2, 3))\n    if point.Z != 3.0:\n        raise Exception(\"cgpoint_to_rgpoint failed.\")\n\n    # test cgvector_to_rgvector\n    vector = cgvector_to_rgvector(cg.Vector(5, 1, 9))\n    if not vector.Unitize():\n        raise Exception(\"cgvector_to_rgvector failed\")\n\n    # test cgline_to_rgline\n    line = cgline_to_rgline(cg.Line([1, 2, 3], [3, 2, 1]))\n    if line.Direction != rg.Vector3d(2, 0, -2):\n        raise Exception(\"cgline_to_rgline failed\")\n\n    # test frame_to_plane\n    plane = cgframe_to_rgplane(cg.Frame([1, 3, -1], [1, 1, 2], [0, 1, 1]))\n    if not isinstance(plane.Normal, rg.Vector3d):\n        raise Exception(\"cgframe_to_rgplane failed\")\n\n    # matrix_to_rgtransform\n    R = cg.Rotation.from_basis_vectors([1, 2, 0], [2, 1, 3])\n    if not isinstance(matrix_to_rgtransform(R), rg.Transform):\n        raise Exception(\"matrix_to_rgtransform failed\")\n\n\nif __name__ == \"__main__\":\n    _test_functions()\n",
  "language": "python",
  "imports": [
    "Rhino",
    "Rhino.Geometry"
  ],
  "has_docstring": true
}