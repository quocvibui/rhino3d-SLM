{
  "source_url": "https://github.com/jackhymowitz/main/blob/7325131db23094f1a28bd184b6a68f864f41a729/01_GH_Components/py/BT_SetPHPPSetup.py",
  "repo": "jackhymowitz/main",
  "repo_stars": 0,
  "repo_description": "IDF2PH is a free open source toolkit for working with E+ and PHPP Energy Models",
  "license": "GPL-3.0",
  "filepath": "01_GH_Components/py/BT_SetPHPPSetup.py",
  "instruction": "Inputs for 'Verification', 'Climate' and 'Ventilation | Airtightness' worksheet items\r\r\n-\r\r\nEM August 1, 2020\r\r\n    Args:\r\r\n        numResUnits_: <Optional, Default=1> Number of residential dwelling...",
  "code": "#\r\r\n# IDF2PHPP: A Plugin for exporting an EnergyPlus IDF file to the Passive House Planning Package (PHPP). Created by blgdtyp, llc\r\r\n# \r\r\n# This component is part of IDF2PHPP.\r\r\n# \r\r\n# Copyright (c) 2020, bldgtyp, llc <info@bldgtyp.com> \r\r\n# IDF2PHPP is free software; you can redistribute it and/or modify \r\r\n# it under the terms of the GNU General Public License as published \r\r\n# by the Free Software Foundation; either version 3 of the License, \r\r\n# or (at your option) any later version. \r\r\n# \r\r\n# IDF2PHPP is distributed in the hope that it will be useful,\r\r\n# but WITHOUT ANY WARRANTY; without even the implied warranty of \r\r\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the \r\r\n# GNU General Public License for more details.\r\r\n# \r\r\n# For a copy of the GNU General Public License\r\r\n# see <http://www.gnu.org/licenses/>.\r\r\n# \r\r\n# @license GPL-3.0+ <http://spdx.org/licenses/GPL-3.0+>\r\r\n#\r\r\n\"\"\"\r\r\nInputs for 'Verification', 'Climate' and 'Ventilation | Airtightness' worksheet items\r\r\n-\r\r\nEM August 1, 2020\r\r\n    Args:\r\r\n        numResUnits_: <Optional, Default=1> Number of residential dwelling units in the building. For any non-residential, set to '1'\r\r\n        mechCooling_: <Optional, Default='No'> Use mechanical cooling? 'x'=Yes, ' '=No\r\r\n        thermalMass_: <Optional, Default=60>  Average Specific Heat Capacity (Wh/k-m2 TFA) of the building. Lightweight=60, Mixed=132, Heavy=204\r\r\n        certification_: <Optional>\r\r\n        buildingType_: <Optional> Input either: \"1-Residential building\" or \"2-Non-residential building\"\r\r\n        ihgType_: <Optional> Internal Heat Gains Type. Input either: \"10-Dwelling\", \"11-Nursing home / students\", \"12-Other\", \"20-Office / Admin. building\", \"21-School\", or \"22-Other\"\r\r\n        ighValues_: <Optional> Internal Heat Gains Source. \r\r\n        For Residential, Input either: \"2-Standard\" or \"3-PHPP calculation ('IHG' worksheet)\"\r\r\n        For Non-Residential, input either: \"2-Standard\" or \"4-PHPP calculation ('IHG non-res' worksheet)\"\r\r\n        occupancy_: <Optional> Only input for Non-Residential buildings or in special circumstances.\r\r\n        epw_: <Optional, Default=None> The epw file path. Not used for anything yet.\r\r\n        climateDataSet_: <Optional, Default='DE-9999-PHPP-Standard'> The name of the PHPP climate data set to use. Just type in for now. Maybe a value-list someday...\r\r\n        altitude_: <Optional, Default='=J23'> Altitude adjustment factor (m) for the climate dataset. Default links to the weather station altidue loaded in the PHPP.\r\r\n        exposure_E_: <Optional, Default=0.07> Wind Exposure Coefficient 'F'\r\r\n        exposure_F_: <Optional, Default=15> Wind Exposure Coefficient 'F'\r\r\n        ach50_: <Optional, Default=0.6ACH@50> A value (number) representing the tested ACH@50 envelope airtightness value. Passive House new construction max 0.6ACH@50, EnerPHit max 1.0ACH@50. Only input here if you want to overwrite the values input from the 'Airtightness' component or the values used by the Honeybee model.\r\r\n        vn50_: <Optional, Default= Vv x 130%> Either input a list of values (numbers) or a list of geometry (Breps) representing the net-interior clear volume of the space (finish-to-finish). Only input here if you want to overwrite the values input from the 'Create PHPP Rooms' component(s) or the values used by the Honeybee model.\r\r\n    Returns:\r\r\n        verification_: Connect to the 'verification_' input on the 'Create Excel Obj - Setup' Component\r\r\n        climate_: Connect to the 'climate_' input on the 'Create Excel Obj - Setup' Component\r\r\n        airtightness_: Connect to the 'airtightness_' input on the 'Create Excel Obj - Setup' Component.\r\r\nNOTE: only connect this if you want to overwrite the values automatically determined from the Honeybee / PHPP-Rooms values input earlier. Otherwise, leave unconnected.\r\r\n\"\"\"\r\r\n\r\r\nghenv.Component.Name = \"BT_SetPHPPSetup\"\r\r\nghenv.Component.NickName = \"PHPP Setup\"\r\r\nghenv.Component.Message = 'AUG_01_2020'\r\r\nghenv.Component.IconDisplayMode = ghenv.Component.IconDisplayMode.application\r\r\nghenv.Component.Category = \"BT\"\r\r\nghenv.Component.SubCategory = \"02 | IDF2PHPP\"\r\r\n\r\r\nfrom datetime import datetime\r\r\nimport rhinoscriptsyntax as rs\r\r\nimport ghpythonlib.components as gh\r\r\nimport scriptcontext as sc\r\r\nimport Grasshopper.Kernel as ghK\r\r\n\r\r\n# Classes and Defs\r\r\npreview = sc.sticky['Preview']\r\r\nPHPP_ClimateDataSet = sc.sticky['PHPP_ClimateDataSet']\r\r\n\r\r\nclass Verification:\r\r\n    def __init__(self, _numResUnits, _cooling, _specCapacity, _bldgName, _bldgCountry, _cert, _bldgType, _ihgType, _ihgVals, _occupancy):\r\r\n        self.NumResUnits = _numResUnits\r\r\n        self.MechCooling = _cooling\r\r\n        self.SpecCapacity = _specCapacity\r\r\n        self.BldgName = _bldgName\r\r\n        self.BldgCountry = _bldgCountry\r\r\n        self.Certification = _cert\r\r\n        self.BuildingType = _bldgType\r\r\n        self.IHG_Type = _ihgType\r\r\n        self.IHG_Values = _ihgVals\r\r\n        self.Occupancy = _occupancy\r\r\n    \r\r\n        if self.Occupancy:\r\r\n            self.OccupancyMethod = '2-User determined'\r\r\n            self.NumResUnits = 1\r\r\n        else:\r\r\n            self.OccupancyMethod = '1-Standard (only for residential buildings)'\r\r\n        \r\r\n        self.checkNonRes()\r\r\n    \r\r\n    def checkNonRes(self):\r\r\n        if 'Non' in self.BuildingType and '1' in self.OccupancyMethod:\r\r\n            warning = \"For Non-Residential buildings, please be sure to input\\n\"\\\r\r\n            \"the occupancy for the building.\"\r\r\n            ghenv.Component.AddRuntimeMessage(ghK.GH_RuntimeMessageLevel.Warning, warning)\r\r\n        \r\r\n        if 'Non' in self.BuildingType and '10' in self.IHG_Type:\r\r\n            warning = \"For Non-Residential buildings, please select a valid\\n\"\\\r\r\n            \"Utilization Pattern: '20-Office / Admin. buildin', '21-School', or '22-Other'\"\r\r\n            ghenv.Component.AddRuntimeMessage(ghK.GH_RuntimeMessageLevel.Warning, warning)\r\r\n    \r\r\n        if 'Non' not in self.BuildingType and self.Occupancy:\r\r\n            warning = \"For Residential buildings, please leave the occupancy blank.\\n\"\\\r\r\n            \"Occupancy will be determined by the PHPP automatically. Only input an occupancy if\\n\"\\\r\r\n            \"you are certain and that the Certifier will allow it.\"\r\r\n            ghenv.Component.AddRuntimeMessage(ghK.GH_RuntimeMessageLevel.Warning, warning)\r\r\n    \r\r\n    \r\r\n    def __repr__(self):\r\r\n        str = (\"A Verification Worksheet Parameters Object with:\",\r\r\n                ' > Building Name: {}'.format(self.BldgName),\r\r\n                ' > Builing Country: {}'.format(self.BldgCountry),\r\r\n                ' > Num Res Units: {}'.format(self.NumResUnits),\r\r\n                ' > Cooling: {}'.format(self.MechCooling),\r\r\n                ' > Spec Capacity: {} Wh/k-m2-TFA'.format(self.SpecCapacity)\r\r\n                )\r\r\n        \r\r\n        return '\\n'.join(str)\r\r\n\r\r\nclass Climate:\r\r\n    def __init__(self, _dataSet, _alt):\r\r\n        self.DataSet = _dataSet\r\r\n        self.Altitude = _alt\r\r\n    \r\r\n    def __repr__(self):\r\r\n        str = (\"A Climate Parameters Object with:\",\r\r\n            ' > Climate Data: {}'.format(self.DataSet),\r\r\n            ' > Altitude: {}'.format(self.Altitude)\r\r\n            )\r\r\n        return '\\n'.join(str)\r\r\n\r\r\nclass Airtightness:\r\r\n    def __init__(self, _e, _f, _n50, _vn50):\r\r\n        self.ACH50 = _n50\r\r\n        self.Coef_E = _e\r\r\n        self.Coef_F = _f\r\r\n        self.VN50 = _vn50\r\r\n    \r\r\n    def __repr__(self):\r\r\n        str = (\"An Airtightness Parameters Object with:\",\r\r\n            ' > n50: {} ACH@50'.format(self.ACH50),\r\r\n            ' > Coeff E: {}'.format(self.Coef_E),\r\r\n            ' > Coeff F: {}'.format(self.Coef_F),\r\r\n            ' > Vn50: {} m3'.format(self.VN50)\r\r\n            )\r\r\n            \r\r\n        return '\\n'.join(str)\r\r\n\r\r\n# Building Name from datetime\r\r\nprefix = 'Bldg Data from Grasshopper'\r\r\nsuffix = datetime.now().strftime(\"%Y-%b-%d\")\r\r\nbldgName = '{} {}'.format(prefix, suffix)\r\r\n\r\r\n### Verification Worksheet Items\r\r\nverification_ = Verification(\r\r\n    numResUnits_ if numResUnits_ else 1, # Number of Resi Units\r\r\n    mechCooling_ if mechCooling_ else 'No', # Use Mechanical Cooling?\r\r\n    thermalMass_ if thermalMass_ else 60, # Specific Heat Capacity (avg)\r\r\n    bldgName,\r\r\n    country_ if country_ else 'US-United States of America',\r\r\n    certification_ if certification_ else None,\r\r\n    buildingType_ if buildingType_ else '1-Residential building',\r\r\n    ihgType_ if ihgType_ else '10-Dwelling',\r\r\n    ighValues_ if ighValues_ else '2-Standard',\r\r\n    occupancy_ if occupancy_ else '')\r\r\n\r\r\n### Climate Worksheet Items\r\r\nclimate_ = PHPP_ClimateDataSet(\r\r\n        climateDataSet_ if climateDataSet_ else 'DE-9999-PHPP-Standard',\r\r\n        altitude_ if altitude_ else '=J23') # Creat the Class Objcet\r\r\n\r\r\nif epw_:\r\r\n    # Figure out how to get monthly data from the EPW\r\r\n    # Temps are easy.... radiation is not...\r\r\n    pass\r\r\n\r\r\n## Airtightness (Ventilation) Worksheet Items\r\r\n# Find vN50. Takes in either a list of numbers, or a list of Breps\r\r\nvN50_Total = [0]\r\r\nif vn50_:\r\r\n    for each in vn50_:\r\r\n        try:\r\r\n            vN50_Total.append(float(each))\r\r\n        except:\r\r\n            try:\r\r\n                vol =  gh.Volume(rs.coercebrep(each))[0]\r\r\n                vN50_Total.append(float(vol))\r\r\n            except:\r\r\n                pass\r\r\n\r\r\nairtightness_ = Airtightness(\r\r\n        exposure_E_ if exposure_E_ else 0.07, # Wind Protection 'E'\r\r\n        exposure_F_ if exposure_F_ else 15, # Wind Protection 'F'\r\r\n        ach50_ if ach50_ else 0.6,  # Overall ACH @50 value\r\r\n        sum(vN50_Total) if vn50_ else '=N9*1.2') # Default Vn50= 120% if the Vv (Ventilation Volume)\r\r\n\r\r\n#Preview\r\r\nprint('----\\nVerification:')\r\r\npreview(verification_)\r\r\nprint('----\\nClimate:')\r\r\npreview(climate_)\r\r\nprint('----\\nAirtightness:')\r\r\npreview(airtightness_)\r\r\n\r\r\n\r\r\n\r\n",
  "language": "python",
  "imports": [
    "ghpythonlib",
    "rhinoscriptsyntax",
    "scriptcontext"
  ],
  "has_docstring": true
}