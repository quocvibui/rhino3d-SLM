{
  "source_url": "https://discourse.mcneel.com/t/user-text-is-lost-when-using-rs-command-export/152835",
  "topic_id": 152835,
  "title": "User Text is lost when using rs.Command(\"_Export\")",
  "question": "Hello,\n\n\nWhen I explode blocks and export manually the User Text is maintained on the geometry.\n\n\nBut when I use the script below all the User Text is deleted from the geometry contained within the block.  Why is this?\n\n\nimport rhinoscriptsyntax as rs\nimport scriptcontext as sc\nimport Rhino.DocObjects as rd\nimport Rhino.Geometry as rg\nimport Rhino\n\n\nobjs = rs.GetObjects(\"Select blocks to explode and export\",4096)\n\ngeometries = []\n\ncopies = rs.CopyObjects(objs,None)\n\nfor i in copies:\n    geo = rs.ExplodeBlockInstance(str(i))\n    geometries.append(geo)\n\nfor i in geometries:\n    rs.SelectObjects(i)\n\nrs.Command(\"_Export\")\nrs.Command(\"_Delete\")\n\n\n\nThanks,\n\n\nDan",
  "code_blocks": [
    {
      "code": "import rhinoscriptsyntax as rs\nimport scriptcontext as sc\nimport Rhino.DocObjects as rd\nimport Rhino.Geometry as rg\nimport Rhino\n\n\nobjs = rs.GetObjects(\"Select blocks to explode and export\",4096)\n\ngeometries = []\n\ncopies = rs.CopyObjects(objs,None)\n\nfor i in copies:\n    geo = rs.ExplodeBlockInstance(str(i))\n    geometries.append(geo)\n\nfor i in geometries:\n    rs.SelectObjects(i)\n\nrs.Command(\"_Export\")\nrs.Command(\"_Delete\")",
      "language": "python",
      "author": "lignindes",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "file-io",
    "python",
    "rhinocommon",
    "rhinoscriptsyntax",
    "selection"
  ],
  "has_accepted_answer": false,
  "category_id": 11,
  "posts_count": 5,
  "views": 467
}