{
  "source_url": "https://discourse.mcneel.com/t/rhino-6-wip-vs-5-4x-slower-on-4k-display/41063",
  "topic_id": 41063,
  "title": "Rhino 6 WIP vs 5: 4X slower on 4K display",
  "question": "I have a short Python script that creates a cavity part from Boolean subtraction of 2 slabs.  In Rhino 5 on a 4K display at the full screen size this takes less than a second but in the latest Rhino 6 WIP it requires over 4 sec.  If the Rhino 6 window is shrunk to about 0.3 in size (both in X and Y), then the timing is similar.  On a 4K screen Rhino 5 uses a 1536 x 864 resolution (the 4K display still runs at its native 3840 x 2160 resolution) which means there are 0.4X as many addressable pixels in X and Y compared to Rhino 6.  Thus shrinking the Rhino 6 window to 0.3 of its full screen size makes it look more like Rhino 5 in terms of the number of pixels that have to be drawn.  So supporting the 4K display appears to be slowing down Rhino 6 by over 4X compared to V5.  Below is the Python script used to generate the timing data.\n\n\nimport rhinoscriptsyntax as rs\nimport Rhino.Geometry\nimport time\nfrom time import time\nP3d = Rhino.Geometry.Point3d\nprintTimes = True\n\ndef round_Rectangle(t, w, l, z, r):\n    if printTimes: startime = time()\n    C = r*(1 - 1/1.41421356)\n    l1 = rs.AddLine(P3d(t+r,t,z),       P3d(t+w-r,t,z))   # Bottom line\n    if printTimes: addline1time = time(); print '    AddLine 1 time = {:.3f}'.format(addline1time - startime)\n    l2 = rs.AddLine(P3d(t+w,t+r,z),     P3d(t+w,t+l-r,z)) # right line\n    if printTimes: addline2time = time(); print '    AddLine 2 time = {:.3f}'.format(addline2time - addline1time)\n    l3 = rs.AddLine(P3d(t+w-r,t+l,z),   P3d(t+r,t+l,z))   # Top line\n    if printTimes: addline3time = time(); print '    AddLine 3 time = {:.3f}'.format(addline3time - addline2time)\n    l4 = rs.AddLine(P3d(t,t+l-r,z),     P3d(t,t+r,z))     # Left line\n    if printTimes: addline4time = time(); print '    AddLine 4 time = {:.3f}'.format(addline4time - addline3time)\n    if r > 0.:\n        a1 = rs.AddArc3Pt(P3d(t,t+r,z),     P3d(t+r,t,z),     P3d(t+C,t+C,z))     # Bottom Left corner arc\n        if printTimes: addarc1time = time(); print '    AddArc ...",
  "code_blocks": [
    {
      "code": "if Rhino6:\n        # Zoom out so code speeds up in Rhino6 --> Bandaid to partially fix slowness in Rhino6 on 4K display.\n        m = 0.19\n        rs.ZoomBoundingBox([P3d(0,0,0), P3d(w/m,0,0), P3d(w/m,l/m,0), P3d(0,l/m,0), P3d(0,0,h/m), P3d(w/m,0,0), P3d(w/m,l/m,h/m), P3d(0,l/m,h/m)], None, True)\n    else:\n        #Zoom using bounding box of cavity to nicely show its generation.\n        rs.ZoomBoundingBox([P3d(0,0,0), P3d(w,0,0), P3d(w,l,0), P3d(0,l,0), P3d(0,0,h), P3d(w,0,0), P3d(w,l,h), P3d(0,l,h)], None, True)",
      "language": "unknown",
      "author": "Terry_Chappell",
      "post_number": 5,
      "is_solution": false
    },
    {
      "code": "import rhinoscriptsyntax as rs\nimport Rhino.Geometry\nimport time\nfrom time import time\nP3d = Rhino.Geometry.Point3d\nprintTimes = True\n\ndef round_Rectangle(t, w, l, z, r):\n    if printTimes: startime = time()\n    C = r*(1 - 1/1.41421356)\n    l1 = rs.AddLine(P3d(t+r,t,z),       P3d(t+w-r,t,z))   # Bottom line\n    if printTimes: addline1time = time(); print '    AddLine 1 time = {:.3f}'.format(addline1time - startime)\n    l2 = rs.AddLine(P3d(t+w,t+r,z),     P3d(t+w,t+l-r,z)) # right line\n    if printTimes: addline2time = time(); print '    AddLine 2 time = {:.3f}'.format(addline2time - addline1time)\n    l3 = rs.AddLine(P3d(t+w-r,t+l,z),   P3d(t+r,t+l,z))   # Top line\n    if printTimes: addline3time = time(); print '    AddLine 3 time = {:.3f}'.format(addline3time - addline2time)\n    l4 = rs.AddLine(P3d(t,t+l-r,z),     P3d(t,t+r,z))     # Left line\n    if printTimes: addline4time = time(); print '    AddLine 4 time = {:.3f}'.format(addline4time - addline3time)\n    if r > 0.:\n        a1 = rs.AddArc3Pt(P3d(t,t+r,z),     P3d(t+r,t,z),     P3d(t+C,t+C,z))     # Bottom Left corner arc\n        if printTimes: addarc1time = time(); print '    AddArc 1 time = {:.3f}'.format(addarc1time - addline4time)\n        a2 = rs.AddArc3Pt(P3d(t+w-r,t,z),   P3d(t+w,t+r,z),   P3d(t+w-C,t+C,z))   # Bottom Right corner arc\n        if printTimes: addarc2time = time(); print '    AddArc 2 time = {:.3f}'.format(addarc2time - addarc1time)\n        a3 = rs.AddArc3Pt(P3d(t+w,t+l-r,z), P3d(t+w-r,t+l,z), P3d(t+w-C,t+l-C,z)) # Top Right corner arc\n        if printTimes: addarc3time = time(); print '    AddArc 3 time = {:.3f}'.format(addarc3time - addarc2time)\n        a4 = rs.AddArc3Pt(P3d(t+r,t+l,z),   P3d(t,t+l-r,z),   P3d(t+C,t+l-C,z))   # Top Left corner arc\n        if printTimes: addarc4time = time(); print '    AddArc 4 time = {:.3f}'.format(addarc4time - addarc3time)\n        # Put the 8 curves in one list: 4 lines and 4 arcs\n        curves = [l1,l2,l3,l4,a1,a2,a3,a4]\n    else:\n        # Put the 4 lines in one list.\n        curves = [l1,l2,l3,l4]\n     # Join the curves and delete the 8 input pieces \n    crvs = rs.JoinCurves(curves, True, None) ; rs.DeleteObjects(curves)\n    if printTimes: joincurvestime = time(); print '    JoinCurves time = {:.3f}'.format(joincurvestime - addarc4time)\n    if printTimes: print '  round_Rectangle time = {:.3f}'.format(time() - startime)\n    return crvs\n    \ndef rounded_Slab(w, l, h, t, r):\n    if printTimes: startime = time()\n    crvs = round_Rectangle(t, w, l, t, r) # Arguments: Offset, w, l, z, Corner_Radius\n    if printTimes: roundrectangletime = time(); print '    round_Rectangle time = {:.3f}'.format(roundrectangletime - startime)\n    srfs = rs.AddPlanarSrf(crvs)\n    if printTimes: addplanarsrftime = time(); print '    AddPlanarSrf time = {:.3f}'.format(addplanarsrftime - roundrectangletime)\n    curve = rs.AddLine((t,t,t), (t,t,h)) # Create surface and curve for it to follow\n    if printTimes: addlinetime = time(); print '    AddLine time = {:.3f}'.format(addlinetime - addplanarsrftime)\n    slab = rs.ExtrudeSurface(srfs[0], curve)\n    if printTimes: extrudesurfacetime = time(); print '    ExtrudeSurface time = {:.3f}'.format(extrudesurfacetime - addlinetime)\n    rs.DeleteObjects(crvs) ; rs.DeleteObject(srfs) ; rs.DeleteObject(curve)\n    if printTimes: print 'rounded_Slab time = {:.3f}'.format(time() - startime)\n    return slab\n    \nstart_time = time()\nw,l,h,ro,ri,t = 100,150,25,2,8,5\nrs.ZoomBoundingBox([P3d(0,0,0), P3d(w,0,0), P3d(w,l,0), P3d(0,l,0), P3d(0,0,h), P3d(w,0,0), P3d(w,l,h), P3d(0,l,h)], None, True)\nrs.Command('NoEcho _Grid _ApplyTo=_AllViewport _Extents {} _EnterEnd'.format(max(w, l)*1.5))\nfor view in rs.ViewNames(): rs.ViewDisplayMode(view, 'Shaded')\nbase = rounded_Slab(w, l, h, 0, ro)\ninterior = rounded_Slab(w-2*t, l-2*t, h, t, ri) # interior is like base but shrunk by the thickness of the wall t.\nbases = rs.BooleanDifference(base, interior)\nprint 'Total time = {:.3f}'.format(time() - start_time)",
      "language": "python",
      "author": "Terry_Chappell",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "boolean",
    "file-io",
    "geometry",
    "python",
    "rhinocommon",
    "rhinoscriptsyntax"
  ],
  "has_accepted_answer": false,
  "category_id": 25,
  "posts_count": 10,
  "views": 2191
}