{
  "source_url": "https://github.com/jackhymowitz/main/blob/7325131db23094f1a28bd184b6a68f864f41a729/01_GH_Components/py/BT_ReadXLWorkbook.py",
  "repo": "jackhymowitz/main",
  "repo_stars": 0,
  "repo_description": "IDF2PH is a free open source toolkit for working with E+ and PHPP Energy Models",
  "license": "GPL-3.0",
  "filepath": "01_GH_Components/py/BT_ReadXLWorkbook.py",
  "instruction": "Read a list of fields from an Excel workbook.\r\r\nTo configure this module, provide three comma separated lists of the same length for the sheet name, cell name, and the label of the result....",
  "code": "#\r\r\n# IDF2PHPP: A Plugin for exporting an EnergyPlus IDF file to the Passive House Planning Package (PHPP). Created by blgdtyp, llc\r\r\n# \r\r\n# This component is part of IDF2PHPP.\r\r\n# \r\r\n# Copyright (c) 2020, bldgtyp, llc <info@bldgtyp.com> \r\r\n# IDF2PHPP is free software; you can redistribute it and/or modify \r\r\n# it under the terms of the GNU General Public License as published \r\r\n# by the Free Software Foundation; either version 3 of the License, \r\r\n# or (at your option) any later version. \r\r\n# \r\r\n# IDF2PHPP is distributed in the hope that it will be useful,\r\r\n# but WITHOUT ANY WARRANTY; without even the implied warranty of \r\r\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the \r\r\n# GNU General Public License for more details.\r\r\n# \r\r\n# For a copy of the GNU General Public License\r\r\n# see <http://www.gnu.org/licenses/>.\r\r\n# \r\r\n# @license GPL-3.0+ <http://spdx.org/licenses/GPL-3.0+>\r\r\n#\r\r\n\"\"\"\r\r\nRead a list of fields from an Excel workbook.\r\r\nTo configure this module, provide three comma separated lists of the same length for the sheet name, cell name, and the label of the result. Alternatively, use the form entry option.\r\r\n-\r\r\nComponent by Jack Hymowitz, July 31, 2020\r\r\n\r\r\n    Args:\r\r\n        excel: A running excel instance\r\r\n        sheets: A comma separated list of the worksheet to read from for each output.\r\r\n        fields: A comma separated list of the cells to read for each output\r\r\n        labels: A comma separated list of what to  label each read cell\r\r\n    Returns:\r\r\n        data: The values of the requested fields in a list of length-2 tuple (label, value)\r\r\n        text: The information from data written out to a string.\r\r\n\"\"\"\r\r\n\r\r\nghenv.Component.Name = \"BT_ReadXLWorkbook\"\r\r\nghenv.Component.NickName = \"Read XL Workbook\"\r\r\nghenv.Component.Message = 'JUL_31_2020'\r\r\nghenv.Component.IconDisplayMode = ghenv.Component.IconDisplayMode.application\r\r\nghenv.Component.Category = \"BT\"\r\r\nghenv.Component.SubCategory = \"02 | IDF2PHPP\"\r\r\n\r\r\nfrom ghpythonlib.componentbase import executingcomponent as component\r\r\nimport Grasshopper, GhPython\r\r\nimport System\r\r\nimport Rhino\r\r\nimport rhinoscriptsyntax as rs\r\r\nimport scriptcontext as sc\r\r\nimport Grasshopper.Kernel as ghK\r\r\nfrom math import floor,log10\r\r\n\r\r\nclass MyComponent(component):\r\r\n    def doRead(self, excel, sheets, fields, labels):\r\r\n        if sheets:\r\r\n            sheetsList=sheets.split(\",\")\r\r\n            fieldsList=fields.split(\",\")\r\r\n            labelsList=labels.split(\",\")\r\r\n            if len(sheetsList) != len(fieldsList) or len(sheetsList) != len(labelsList):\r\r\n                msg1 = \"Fields and Labels don't match!\"\r\r\n                ghenv.Component.AddRuntimeMessage(ghK.GH_RuntimeMessageLevel.Error, msg1)\r\r\n                return (None,None)\r\r\n            labelList=[]\r\r\n            for i in range(len(sheetsList)):\r\r\n                labelList.append([labelsList[i],sheetsList[i],fieldsList[i]])\r\r\n        else:\r\r\n            if not \"displayFields\" in sc.sticky:\r\r\n                #msg1 = \"No Fields Found!\"\r\r\n                #ghenv.Component.AddRuntimeMessage(ghK.GH_RuntimeMessageLevel.Error, msg1)\r\r\n                #return (None,None)\r\r\n                #Default, verification page\r\r\n                labelList=[\r\r\n                    [\"TFA\",\"Verification\",\"I34\"],\r\r\n                    [\"Heating Demand\",\"Verification\",\"I35\"],\r\r\n                    [\"Heating Load\",\"Verification\",\"I36\"],\r\r\n                    [\"Cooling + Dehum Demand\",\"Verification\",\"I38\"],\r\r\n                    [\"Cooling Load\",\"Verification\",\"I39\"],\r\r\n                    [\"Frequency of Overheating\",\"Verification\",\"I40\"],\r\r\n                    [\"Frequency of excessively high humidity\",\"Verification\",\"I41\"],\r\r\n                    [\"Pressurization test result\",\"Verification\",\"I43\"],\r\r\n                    [\"Non-Renewable PE\",\"Verification\",\"I53\"],\r\r\n                    [\"PER Demand\",\"Verification\",\"I55\"],\r\r\n                    [\"PER\",\"Verification\",\"I56\"],\r\r\n                    [\"Heating Total\",\"Heating\",\"O27\"],\r\r\n                    [\"Cooling Total\",\"Cooling\",\"O28\"]\r\r\n                    ]\r\r\n            else:\r\r\n                labelList=sc.sticky[\"displayFields\"]\r\r\n        data=[]\r\r\n        text=\"\"\r\r\n        for cell in labelList:\r\r\n            label=cell[0].strip()\r\r\n            sheet=cell[1].strip()\r\r\n            field=cell[2].strip()\r\r\n            if sheet in excel.sheetsDict:\r\r\n                val=excel.sheetsDict[sheet].Range[field].Value2\r\r\n                if(type(val).__name__==\"float\" and val!=0): #Round to 4 significant figures\r\r\n                    val=str(round(val,3-int(floor(log10(abs(val))))))\r\r\n                data.append((label,val))\r\r\n                text+=str(label)+\": \"+str(val)+\"\\n\"\r\r\n        return (data,text)\r\r\n    def RunScript(self, excel, sheets, fields, labels):\r\r\n        if excel and excel.activeWorkbook and excel.sheetsDict:\r\r\n            return self.doRead(excel,sheets,fields,labels)\r\r\n        msg1 = \"No Excel Instance!\"\r\r\n        ghenv.Component.AddRuntimeMessage(ghK.GH_RuntimeMessageLevel.Warning, msg1)\r\r\n        return (None,None)\r\r\n\r\n",
  "language": "python",
  "imports": [
    "Rhino",
    "ghpythonlib",
    "rhinoscriptsyntax",
    "scriptcontext"
  ],
  "has_docstring": true
}