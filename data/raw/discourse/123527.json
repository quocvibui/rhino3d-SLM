{
  "source_url": "https://discourse.mcneel.com/t/rhino-plot-styles-a-proposal-to-handle-plot-styles-in-rhino/123527",
  "topic_id": 123527,
  "title": "Rhino Plot Styles - A proposal to handle plot styles in Rhino",
  "question": "Hello,\n\n\nWe are two french architects, and we are trying to use Rhino as the (nearly) only tool for our practice \n\n\nIn order to do that, we created a serie of python scripts aiming at easing the plot styles and layout in Rhino. Even if we want to use Rhino only, we are trying to keep a good level of interoperability (with Adobe Illustrator and AutoCAD).\n\n\nWe would be happy to receive some feedback and critics.\n\n\n1. The Excel file that contains everything\n\n\npresentation\n1189×840 324 KB\n\n\nAs you probably expect, we are taking the CTB function from AutoCAD as an example of managing plot styles.\n\nHere, instead of a CTB file, the data is stored in an Excel file.\n\n\nIn red are the global informations:\n\n1 - Layer hierarchy\n\n2 - Full layer names\n\n3 - Layer color\n\n4 - Layer print color\n\n5 - Layer linetype\n\n\nIn blue are the informations specific to each scale (1:1000 ; 1:500 ; 1:200 ; 1:100 ; 1:50)\n\n6 - Line thickness (in pt)\n\n7 - Line thickness (in mm)\n\n8 - Pattern (for Illustrator only)\n\n\n9a - Then we created a worksheet (createLayers) that recaps the full layer names and their rgb colors (will be used for step 3)\n\n9a - And finally we created a worksheet for each scale, that recaps only the information of the specific scale (will be used for step 2) :\n\n\npresentation2\n1189×840 189 KB\n\n\n2. The python script that generates all the .csv and .js files from the Excel file\n\n\nThis script generates three kinds of outputs that will be used in the next steps:\n\n\n\n\nWill be used for step 3 : \nlayers.csv\n (according to the createLayers worksheet in Excel)\n\n\nWill be used for step 4 : \n1000.csv\n ; \n500.csv\n ; \n200.csv\n ; \n100.csv\n ; \n50.csv\n (plot styles for each scale)\n\n\nWill be used for step 5 : \n1000.js\n ; \n500.js\n ; \n200.js\n ; \n100.js\n ; \n50.js\n (plot styles for each scale). These files are created to be used in Illustrator.\n\n\n\n\nimport pandas as pd # import pandas library : used to read xls and xlsx files (pandas library needs also xlrd and openyxl)\nimport csv # import csv library to han...",
  "code_blocks": [
    {
      "code": "import pandas as pd # import pandas library : used to read xls and xlsx files (pandas library needs also xlrd and openyxl)\nimport csv # import csv library to handle csv reading and writing\n\nscales = ['1000', '500', '200', '100', '50'] # set the scales in an array\n\ndef XLStoCSV(scales): # first function of the script : export each excel sheet into a CSV file\n\tx = 2 # initialize the sheet index\n\n\tfor scale in scales: # loop through the scales\n\t\t\tfile = pd.read_excel(\"MLAVPlotStyles.xlsx\", sheet_name=x) # open the excel file at the sheet specified by x\n\t\t\tfile.to_csv(scale + \".csv\", index = None, header=True) # create the corresponding csv file\n\t\t\tx += 1 # indent the sheet index\n\n\tfile = pd.read_excel(\"MLAVPlotStyles.xlsx\", sheet_name=1) # open the excel file at the sheet that specifies the layer list and its rgb values\n\tfile.to_csv(\"layers.csv\", index = None, header=True) # create the corresponding csv file\n\ndef CSVtoJS(scales): # second function of the script : get infos from CSV to generate JS files, ready to use for Adobe Illustrator\n\tfor scale in scales: # loop through each scale\n\t\tf = open(scale + \".js\", \"w\") # create the corresponding .js file\n\t\tf.write(\"var doc = app.activeDocument;\\r\\nfunction makeColor(r,g,b){\\r\\n  var c = new RGBColor();\\r\\n  c.red = r;\\r\\n  c.green = g;\\r\\n  c.blue = b;\\r\\n  return c;\\r\\n};\\r\\n\") # write the first part of the constant code in JS\n\t\tf.write(\"const continuous = [];\\r\\nconst dots = new Array(0, 1);\\r\\nconst dashed = new Array(2, 3);\\r\\nconst dashdot = new Array(2, 2, 0, 2);\\r\\nvar lines;\\r\\n\") # write the first part of the constant code in JS\n\t\t\n\t\twith open(scale + \".csv\") as csvfile: # open the csv file corresponding to the current scale\n\t\t\t\treader = csv.reader(csvfile) \n\t\t\t\tnext(reader) # jump to next line (first line is data headers)\n\t\t\t\tfor row in reader: # iterate through each row\n\t\t\t\t\tlayer_name = row[0] # put the values from the columns in variables \n\t\t\t\t\tr = row[1]\n\t\t\t\t\tg = row[2]\n\t\t\t\t\tb = row[3]\n\t\t\t\t\tlinetype = row[4]\n\t\t\t\t\tthickness = row[5]\n\t\t\t\t\tpattern = row[7]\n\t\t\t\t\tf.write(\"\\r\\ntry {\\r\\n  lines = doc.layers['\" + layer_name + \"'].pathItems;\\r\\n\\r\\n  for (i = 0; i < lines.length; i++) {\\r\\n    pathArt = lines[i];\\r\\n    pathArt.strokeDashes = \" + linetype + \";\\r\\n    pathArt.strokeColor = makeColor(\" + r + \",\" + g + \",\" + b + \");\\r\\n    pathArt.strokeWidth = \" + thickness + \";\\r\\n\") # write the corresponding code in js for illustrator\n\t\t\t\t\tif pattern != '[Sans]': # if the layer contains a pattern the following line is added to handle it in illustrator\n\t\t\t\t\t\tf.write(\"    pathArt.filled = true;\\r\\n    pathArt.fillColor = doc.swatches['\"+ pattern + \"'].color;\")\n\t\t\t\t\tf.write(\"  }\\r\\n  } catch (e) {\\r\\n}\") # end of the js code for one layer\n\n\t\tf.close() # close the js file\n\nif( __name__ == \"__main__\" ): # perform function\n\tXLStoCSV(scales)\n\tCSVtoJS(scales)",
      "language": "python",
      "author": "antoine3",
      "post_number": 1,
      "is_solution": false
    },
    {
      "code": "import csv # import csv library to handle csv reading and writing\nimport rhinoscriptsyntax as rs # import rhinoscriptsyntax to handle rhino actions\n\ndef OpenCSV(): # first function of the script : open the csv file \n\twith open(\"layers.csv\") as csvfile:\n\t\t\treader = csv.reader(csvfile)\n\t\t\tnext(reader) # jump to next line (first line is data headers)\n\t\t\tfor row in reader: # iterate through each row\n\t\t\t\tfull_layer_name = row[0] # put the values from the columns in variables \n\t\t\t\tcolor = rs.CreateColor(row[1], row[2], row[3])\n\t\t\t\tCreateLayer(full_layer_name, color) # send variables to the next function\n\ndef CreateLayer(full_layer_name, color): # second function of the script : create the layer in Rhino\n\tlayer_names = rs.LayerNames() # create array of existing layers in Rhino\n\tfor layer_name in layer_names: # iterate through each layer\n\t\tif layer_name == full_layer_name: # if layer already exists update its color\n\t\t\trs.LayerColor(layer_name, color)\n\t\telse: # if it doesn't exist create the layer\n\t\t\trs.AddLayer(full_layer_name, color)\n\nif( __name__ == \"__main__\" ): # perform function\n\tOpenCSV()",
      "language": "python",
      "author": "antoine3",
      "post_number": 1,
      "is_solution": false
    },
    {
      "code": "import csv # import csv library to handle csv reading and writing\nimport rhinoscriptsyntax as rs # import rhinoscriptsyntax to handle rhino actions\n\ndef SetPrintInfo(): # first function : options in a popup in Rhino\n\toptions = ('50e', '100e', '200e', '500e', '1000e')\n\tif options:\n\t\tresult = rs.ListBox(options, \"Pick an option\")\n\t\tif result == \"50e\": # get the option from the user\n\t\t\tfilename = \"50.csv\" # fetch the right csv, corresponding to the user's choice\n\t\telif result == \"100e\":\n\t\t\tfilename = \"100.csv\"\n\t\telif result == \"200e\":\n\t\t\tfilename = \"200.csv\"\n\t\telif result == \"500e\":\n\t\t\tfilename = \"500.csv\"\n\t\telif result == \"1000e\":\n\t\t\tfilename = \"1000.csv\"\n\t\telse:\n\t\t\texit()\n\t\tOpenCSV(filename)\n\ndef OpenCSV(filename): # second function : open the csv file containing the plot styles infos\t\n\twith open(filename) as csvfile:\n\t\treader = csv.reader(csvfile)\n\t\tnext(reader) # jump to next line (first line is data headers)\n\t\tfor row in reader: # iterate through each row\n\t\t\tfull_layer_name = row[0] # put the values from the columns in variables\n\t\t\tprint_color = rs.CreateColor(row[1], row[2], row[3])\n\t\t\tlinetype = row[4]\n\t\t\tthickness = row[6]\n\t\t\tSetLayerPrintValues(full_layer_name, print_color, linetype, thickness) # send variables to the next function\n\ndef SetLayerPrintValues(full_layer_name, print_color, linetype, thickness): # third function : assign the values from the csv to the Rhino layers\n\tlayer_names = rs.LayerNames() # create array of existing layers in Rhino\n\tfor layer_name in layer_names:# iterate through each layer\n\t\tif layer_name == full_layer_name: # select the layer\n\t\t\trs.LayerPrintColor(layer_name, print_color) # assign print color\n\t\t\trs.LayerLinetype(layer_name, linetype) # assign linetype\n\t\t\trs.LayerPrintWidth(layer_name, float(thickness)) # assign line thickness\n\nif( __name__ == \"__main__\" ): # perform function\n\tSetPrintInfo()",
      "language": "python",
      "author": "antoine3",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "file-io",
    "geometry",
    "layers",
    "python",
    "rhinoscriptsyntax",
    "transformation",
    "ui"
  ],
  "has_accepted_answer": false,
  "category_id": 11,
  "posts_count": 3,
  "views": 2596
}