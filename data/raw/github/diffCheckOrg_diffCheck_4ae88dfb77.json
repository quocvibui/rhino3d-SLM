{
  "source_url": "https://github.com/diffCheckOrg/diffCheck/blob/8f668b1f273e8d81a282c6115ba3eae07eef9235/src/gh/components/DF_visualization_settings/code.py",
  "repo": "diffCheckOrg/diffCheck",
  "repo_stars": 15,
  "repo_description": "diffCheck is a CAD-integrated tool for evaluating digital timber fabrication processes.",
  "license": "GPL-3.0",
  "filepath": "src/gh/components/DF_visualization_settings/code.py",
  "instruction": null,
  "code": "#! python3\n\nimport System\nimport typing\nimport Rhino\nfrom ghpythonlib.componentbase import executingcomponent as component\nimport Grasshopper as gh\nfrom Grasshopper import Instances\nfrom Grasshopper.Kernel import GH_RuntimeMessageLevel as RML\n\nfrom diffCheck import df_visualization\n\n\ndef add_str_valuelist(self,\n    values_list: typing.List[str],\n    nickname: str,\n    indx: int,\n    X_param_coord: float,\n    Y_param_coord: float,\n    X_offset: int=87\n    ) -> None:\n    \"\"\"\n        Adds a value list of string values to the component input\n\n        :param values_list: a list of string values to add to the value list\n        :param nickname: the nickname of the value list\n        :param indx: the index of the input parameter\n        :param X_param_coord: the x coordinate of the input parameter\n        :param Y_param_coord: the y coordinate of the input parameter\n        :param X_offset: the offset of the value list from the input parameter\n    \"\"\"\n    param = ghenv.Component.Params.Input[indx]  # noqa: F821\n    if param.SourceCount == 0:\n        valuelist = gh.Kernel.Special.GH_ValueList()\n        valuelist.NickName = nickname\n        valuelist.Description = \"Select the value to use with DFVizSettings\"\n        selected = valuelist.FirstSelectedItem\n        valuelist.ListItems.Clear()\n        for v in values_list:\n            vli = gh.Kernel.Special.GH_ValueListItem(str(v),str('\"' + v + '\"'))\n            valuelist.ListItems.Add(vli)\n        if selected in values_list:\n            valuelist.SelectItem(values_list.index(selected))\n        valuelist.CreateAttributes()\n        valuelist.Attributes.Pivot = System.Drawing.PointF(\n            X_param_coord - (valuelist.Attributes.Bounds.Width) - X_offset,\n            Y_param_coord - (valuelist.Attributes.Bounds.Height / 2 + 0.1)\n            )\n        valuelist.Attributes.ExpireLayout()\n        gh.Instances.ActiveCanvas.Document.AddObject(valuelist, False)\n        ghenv.Component.Params.Input[indx].AddSource(valuelist)  # noqa: F821\n\ndef add_slider(self,\n    nickname: str,\n    indx: int,\n    lower_bound: float,\n    upper_bound: float,\n    default_value: float,\n    X_param_coord: float,\n    Y_param_coord: float,\n    X_offset: int=100\n    ) -> None:\n    \"\"\"\n        Adds a slider to the component input\n\n        :param nickname: the nickname of the slider\n        :param indx: the index of the input parameter\n        :param X_param_coord: the x coordinate of the input parameter\n        :param Y_param_coord: the y coordinate of the input parameter\n        :param X_offset: the offset of the slider from the input parameter\n    \"\"\"\n    param = ghenv.Component.Params.Input[indx]  # noqa: F821\n    if param.SourceCount == 0:\n        slider = gh.Kernel.Special.GH_NumberSlider()\n        slider.NickName = nickname\n        slider.Description = \"Set the value for the threshold\"\n        slider.Slider.Minimum = System.Decimal(lower_bound)\n        slider.Slider.Maximum = System.Decimal(upper_bound)\n        slider.Slider.DecimalPlaces = 3\n        slider.Slider.SmallChange = System.Decimal(0.001)\n        slider.Slider.LargeChange = System.Decimal(0.01)\n        slider.Slider.Value = System.Decimal(default_value)\n        slider.CreateAttributes()\n        slider.Attributes.Pivot = System.Drawing.PointF(\n            X_param_coord - (slider.Attributes.Bounds.Width) - X_offset,\n            Y_param_coord - (slider.Attributes.Bounds.Height / 2 - 0.1)\n            )\n        slider.Attributes.ExpireLayout()\n        gh.Instances.ActiveCanvas.Document.AddObject(slider, False)\n        ghenv.Component.Params.Input[indx].AddSource(slider)  # noqa: F821\n\ndef add_plane_object(self,\n    nickname: str,\n    indx: int,\n    X_param_coord: float,\n    Y_param_coord: float,\n    X_offset: int=75\n    ) -> None:\n    \"\"\"\n        Adds a plane object to the component input\n\n        :param nickname: the nickname of the plane object\n        :param indx: the index of the input parameter\n        :param X_param_coord: the x coordinate of the input parameter\n        :param Y_param_coord: the y coordinate of the input parameter\n        :param X_offset: the offset of the plane object from the input parameter\n    \"\"\"\n    param = ghenv.Component.Params.Input[indx]  # noqa: F821\n    if param.SourceCount == 0:\n        doc = Instances.ActiveCanvas.Document\n        if doc:\n            plane = gh.Kernel.Parameters.Param_Plane()\n            plane.NickName = nickname\n            plane.CreateAttributes()\n            plane.Attributes.Pivot = System.Drawing.PointF(\n                X_param_coord - (plane.Attributes.Bounds.Width) - X_offset,\n                Y_param_coord\n                )\n            plane.Attributes.ExpireLayout()\n            doc.AddObject(plane, False)\n            ghenv.Component.Params.Input[indx].AddSource(plane)  # noqa: F821\n\n\nclass DFVisualizationSettings(component):\n    def __init__(self):\n        self.poss_value_types = [\"Dist\", \"MEAN\", \"RMSE\", \"MAX\", \"MIN\", \"STD\"]\n        self.poss_palettes = [\"Jet\", \"Rainbow\", \"RdPu\", \"Viridis\"]\n\n        ghenv.Component.ExpireSolution(True)  # noqa: F821\n        ghenv.Component.Attributes.PerformLayout()  # noqa: F821\n        params = getattr(ghenv.Component.Params, \"Input\")  # noqa: F821\n        for j in range(len(params)):\n            Y_cord = params[j].Attributes.InputGrip.Y\n            X_cord = params[j].Attributes.Pivot.X\n            input_indx = j\n            if \"i_value_type\" == params[j].NickName:\n                add_str_valuelist(\n                    ghenv.Component,  # noqa: F821\n                    self.poss_value_types,\n                    \"DF_value_t\",\n                    input_indx, X_cord, Y_cord)\n            if \"i_palette\" == params[j].NickName:\n                add_str_valuelist(\n                    ghenv.Component,  # noqa: F821\n                    self.poss_palettes,\n                    \"DF_palette\",\n                    input_indx, X_cord, Y_cord)\n            if \"i_legend_height\" == params[j].NickName:\n                add_slider(\n                    ghenv.Component,  # noqa: F821\n                    \"DF_legend_height\",\n                    input_indx,\n                    0.000, 20.000, 10.000,\n                    X_cord, Y_cord)\n            if \"i_legend_width\" == params[j].NickName:\n                add_slider(\n                    ghenv.Component,  # noqa: F821\n                    \"DF_legend_width\",\n                    input_indx,\n                    0.000, 2.000, 0.500,\n                    X_cord, Y_cord)\n            if \"i_legend_plane\" == params[j].NickName:\n                add_plane_object(\n                    ghenv.Component,  # noqa: F821\n                    \"DF_legend_plane\",\n                    input_indx, X_cord, Y_cord)\n            if \"i_histogram_scale_factor\" == params[j].NickName:\n                add_slider(\n                    ghenv.Component,  # noqa: F821\n                    \"DF_histogram_scale_factor\",\n                    input_indx,\n                    0.000, 1.000, 0.01,\n                    X_cord, Y_cord)\n\n    def RunScript(self,\n        i_value_type: str,\n        i_palette: str,\n        i_upper_threshold: float,\n        i_lower_threshold: float,\n        i_legend_height: float,\n        i_legend_width: float,\n        i_legend_plane: Rhino.Geometry.Plane,\n        i_histogram_scale_factor: float,\n        i_one_histogram_per_item: bool):\n\n        \"\"\"\n        Compiles all the visualization settings to feed to the visualization component\n\n        :param i_value_type: selected type indicates Which values to display. Possible values: \"dist\", \"RMSE\", \"MAX\", \"MIN\", \"STD\"\n        :param i_palette: Select a color palette to map the values to. Possible values: \"Jet\", \"Rainbow\", \"RdPu\", \"Viridis\"\n        :param i_upper_threshold: Thresholds the values with a maximum value\n        :param i_lower_threshold: Thresholds the values with a minimum value\n        :param i_legend_height: the total height of the legend\n        :param i_legend_width: the total width of the legend\n        :param i_legend_plane: the construction plane of the legend\n        :param i_histogram_scale_factor: Scales the height of the histogram with a factor\n\n        :returns o_viz_settings: the results of the comparison all in one object\n        \"\"\"\n        # set default values\n        if i_value_type is not None:\n            if i_value_type not in self.poss_value_types:\n                ghenv.Component.AddRuntimeMessage(RML.Warning, \"Possible values for i_value_type are: dist, MEAN, RMSE, MAX, MIN, STD\")  # noqa: F821\n                return None\n        else:\n            i_value_type = \"Dist\"\n        if i_palette is not None:\n            if i_palette not in self.poss_palettes:\n                ghenv.Component.AddRuntimeMessage(RML.Warning, \"Possible values for i_palette are: Jet, Rainbow, RdPu, Viridis\")  # noqa: F821\n                return None\n        else:\n            i_palette = \"Jet\"\n        if i_legend_height is None:\n            i_legend_height = 10\n        if i_legend_width is None:\n            i_legend_width = 0.5\n        if i_legend_plane is None:\n            i_legend_plane = Rhino.Geometry.Plane.WorldXY\n        if i_histogram_scale_factor is None:\n            i_histogram_scale_factor = 0.01\n        if i_one_histogram_per_item is None:\n            i_one_histogram_per_item = False\n\n        # pack settings\n        o_viz_settings = df_visualization.DFVizSettings(i_value_type,\n                                                        i_palette,\n                                                        i_upper_threshold,\n                                                        i_lower_threshold,\n                                                        i_legend_height,\n                                                        i_legend_width,\n                                                        i_legend_plane,\n                                                        i_histogram_scale_factor,\n                                                        i_one_histogram_per_item)\n\n        return o_viz_settings\n",
  "language": "python",
  "imports": [
    "Rhino",
    "Rhino.Geometry",
    "ghpythonlib"
  ],
  "has_docstring": false
}