{
  "source_url": "https://github.com/ESteelEx/gcode2cutsim/blob/95aa5678ec3848954cd855838198d3c5a8802a51/RhinoInterface/controlLayer.py",
  "repo": "ESteelEx/gcode2cutsim",
  "repo_stars": 2,
  "repo_description": "- gcode 2 cutsim code for 3D Simulation with Verifier Engine",
  "license": "unknown",
  "filepath": "RhinoInterface/controlLayer.py",
  "instruction": "This is what has to be deposited in button instance in Rhino (SKIRT switch example)",
  "code": "\"\"\"\nThis is what has to be deposited in button instance in Rhino (SKIRT switch example)\n\n-_RunPythonScript (\nimport sys\nimport MW_printer_global_parameter\nimport rhinoscriptsyntax as rs\nreload(MW_printer_global_parameter)\nMWP = MW_printer_global_parameter.MW_printer_paths()\nsys.path.append(MWP._ABS_FOLDER_SCRIPTS)\nimport control1stLayer\nreload(control1stLayer)\nCS = control1stLayer.control1stLayer('SKIRT', MWP._ABS_FOLDER_PLUGIN, MWP._ABS_FOLDER_CORE)\nCS.switch()\n)\n\n\n-_RunPythonScript (\nimport sys\nimport MW_printer_global_parameter\nimport rhinoscriptsyntax as rs\nreload(MW_printer_global_parameter)\nMWP = MW_printer_global_parameter.MW_printer_paths()\nsys.path.append(MWP._ABS_FOLDER_SCRIPTS)\nimport control1stLayer\nreload(control1stLayer)\nCS = control1stLayer.control1stLayer('INFILL', MWP._ABS_FOLDER_PLUGIN, MWP._ABS_FOLDER_CORE)\nCS.set_infill(pattern='parallel')\n)\n\n\"\"\"\n\nimport sys\nimport rhinoscriptsyntax as rs\n\n\nclass controlLayer:\n    def __init__(self, feature, pluginPath, corePath):\n        self.feature = feature  # string defines what to control on 1st Layer. Use as specified in INI file\n        self.pluginPath = pluginPath\n        self.corePath = corePath\n        self.INI_CONFIG = self.corePath + r'\\Mesh.ini'\n\n    # ------------------------------------------------------------------------------------------------------------------\n    def switch(self):\n        sys.path.append(self.pluginPath)\n        from Utilities import ini_worker\n        reload(ini_worker)\n\n        section_params = ini_worker.get_section_from_ini(self.INI_CONFIG, self.feature)\n\n        for key, value in section_params.iteritems():\n            if key == 'create':\n                if int(value) == 0:\n                    print self.feature + ' SWITCHED TO ON'\n                    ini_worker.write_to_section(self.INI_CONFIG,  self.feature, 'create', 1)\n                else:\n                    print  self.feature + ' SWITCHED TO OFF'\n                    ini_worker.write_to_section(self.INI_CONFIG,  self.feature, 'create', 0)\n\n    # ------------------------------------------------------------------------------------------------------------------\n    def set_num(self):\n        sys.path.append(self.pluginPath)\n        from Utilities import ini_worker\n        reload(ini_worker)\n\n        num = raw_input('Define the number of perimeter: ')\n        try:\n            num = int(num)\n        except:\n            print 'This is not a valid number'\n            return\n\n        try:\n            ini_worker.write_to_section(self.INI_CONFIG, self.feature, 'perimeterCount', num)\n        except:\n            raise\n\n    # ------------------------------------------------------------------------------------------------------------------\n    def set_path_width(self):\n        sys.path.append(self.pluginPath)\n        from Utilities import ini_worker\n        reload(ini_worker)\n\n        num = raw_input('Define path width: ')\n        try:\n            num = float(num)\n        except:\n            print 'This is not a valid number'\n            return\n\n        try:\n            ini_worker.write_to_section(self.INI_CONFIG, self.feature, 'pathWidth', num)\n        except:\n            raise\n\n    # ------------------------------------------------------------------------------------------------------------------\n    def set_path_distance(self):\n        sys.path.append(self.pluginPath)\n        from Utilities import ini_worker\n        reload(ini_worker)\n\n        num = raw_input('Define path distance [mm]: ')\n        try:\n            num = float(num)\n        except:\n            print 'This is not a valid number'\n            return\n\n        try:\n            ini_worker.write_to_section(self.INI_CONFIG, self.feature, 'pathDistance', num)\n        except:\n            raise\n\n    # ------------------------------------------------------------------------------------------------------------------\n    def set_distance(self):\n        sys.path.append(self.pluginPath)\n        from Utilities import ini_worker\n        reload(ini_worker)\n\n        num = raw_input('Define the distance to object: ')\n        try:\n            num = int(num)\n        except:\n            print 'This is not a valid number'\n            return\n\n        try:\n            ini_worker.write_to_section(self.INI_CONFIG, self.feature, 'distance', num)\n        except:\n            raise\n\n    # ------------------------------------------------------------------------------------------------------------------\n    def set_support_overhang_angle(self):\n        sys.path.append(self.pluginPath)\n        from Utilities import ini_worker\n        reload(ini_worker)\n\n        num = raw_input('Define overhang angle [deg]: ')\n        try:\n            num = float(num)\n        except:\n            print 'This is not a valid number'\n            return\n\n        try:\n            ini_worker.write_to_section(self.INI_CONFIG, self.feature, 'overhangAngleThreshold', num)\n        except:\n            raise\n\n    # ------------------------------------------------------------------------------------------------------------------\n    def set_infill_pattern(self, pattern='cross'):\n        sys.path.append(self.pluginPath)\n        from Utilities import ini_worker\n        reload(ini_worker)\n\n        if pattern == 'parallel':\n            print 'Infill pattern set to parallel'\n            try:\n                ini_worker.write_to_section(self.INI_CONFIG, self.feature, 'cross', 0)\n            except:\n                raise\n        elif pattern == 'cross':\n            print 'Infill pattern set to cross'\n            try:\n                ini_worker.write_to_section(self.INI_CONFIG, self.feature, 'cross', 1)\n            except:\n                raise\n\n    # ------------------------------------------------------------------------------------------------------------------\n    def set_slicer_height(self):\n        sys.path.append(self.pluginPath)\n        from Utilities import ini_worker\n        reload(ini_worker)\n\n        num = raw_input('Define layer height [mm]: ')\n        try:\n            num = float(num)\n        except:\n            print 'This is not a valid number'\n            return\n\n        try:\n            ini_worker.write_to_section(self.INI_CONFIG, self.feature, 'layerHeight', num)\n        except:\n            raise\n\n    # ------------------------------------------------------------------------------------------------------------------\n    def set_first_layer_slicer_height(self):\n        sys.path.append(self.pluginPath)\n        from Utilities import ini_worker\n        reload(ini_worker)\n\n        num = raw_input('Define first layer height [mm]: ')\n        try:\n            num = float(num)\n        except:\n            print 'This is not a valid number'\n            return\n\n        try:\n            ini_worker.write_to_section(self.INI_CONFIG, self.feature, 'firstLayerHeight', num)\n        except:\n            raise\n\n    # ------------------------------------------------------------------------------------------------------------------\n    def set_rotation_angle(self):\n        sys.path.append(self.pluginPath)\n        from Utilities import ini_worker\n        reload(ini_worker)\n\n        num = raw_input('Define rotation angle of pattern [deg]: ')\n        try:\n            num = float(num)\n        except:\n            print 'This is not a valid number'\n            return\n\n        try:\n            ini_worker.write_to_section(self.INI_CONFIG, self.feature, 'angle', num)\n        except:\n            raise\n\n    # ------------------------------------------------------------------------------------------------------------------\n    def set_connection_angle(self):\n        sys.path.append(self.pluginPath)\n        from Utilities import ini_worker\n        reload(ini_worker)\n\n        num = raw_input('Define connection angle of pattern [deg]. Set to zero to disable connections: ')\n        try:\n            num = float(num)\n        except:\n            print 'This is not a valid number'\n            return\n\n        try:\n            ini_worker.write_to_section(self.INI_CONFIG, self.feature, 'maxConnectionAngle', num)\n        except:\n            raise\n\n    # ------------------------------------------------------------------------------------------------------------------\n    def set_support_head_height(self, num=None):\n        sys.path.append(self.pluginPath)\n        from Utilities import ini_worker\n        reload(ini_worker)\n\n        if num is None:\n            num = raw_input('Define head height of support tower [mm]: ')\n        try:\n            num = float(num)\n        except:\n            print 'This is not a valid number'\n            return\n\n        try:\n            ini_worker.write_to_section(self.INI_CONFIG, self.feature, 'headHeight', num)\n        except:\n            raise\n\n        return num\n\n    # ------------------------------------------------------------------------------------------------------------------\n    def set_support_foot_height(self, num=None):\n        sys.path.append(self.pluginPath)\n        from Utilities import ini_worker\n        reload(ini_worker)\n\n        if num is None:\n            num = raw_input('Define foot height of support tower [mm]: ')\n        try:\n            num = float(num)\n        except:\n            print 'This is not a valid number'\n            return\n\n        try:\n            ini_worker.write_to_section(self.INI_CONFIG, self.feature, 'footHeight', num)\n        except:\n            raise\n\n        return num\n\n    # ------------------------------------------------------------------------------------------------------------------\n    def set_support_head_area(self, num=None):\n        sys.path.append(self.pluginPath)\n        from Utilities import ini_worker\n        reload(ini_worker)\n\n        if num is None:\n            num = raw_input('Define head connection area of support tower (define one side here) [mm]: ')\n        try:\n            num = float(num)\n        except:\n            print 'This is not a valid number'\n            return\n\n        try:\n            ini_worker.write_to_section(self.INI_CONFIG, self.feature, 'headWidth', num)\n        except:\n            raise\n\n        return num\n\n    # ------------------------------------------------------------------------------------------------------------------\n    def set_support_foot_area(self, num=None):\n        sys.path.append(self.pluginPath)\n        from Utilities import ini_worker\n        reload(ini_worker)\n\n        if num is None:\n            num = raw_input('Define foot connection area of support tower (define one side here) [mm]: ')\n        try:\n            num = float(num)\n        except:\n            print 'This is not a valid number'\n            return\n\n        try:\n            ini_worker.write_to_section(self.INI_CONFIG, self.feature, 'footWidth', num)\n        except:\n            raise\n\n        return num\n\n    # ------------------------------------------------------------------------------------------------------------------\n    def set_support_grid(self, num=None):\n        sys.path.append(self.pluginPath)\n        from Utilities import ini_worker\n        reload(ini_worker)\n\n        if num is None:\n            num = raw_input('Define grid square area of support tower (define one side here) [mm]: ')\n        try:\n            num = float(num)\n        except:\n            print 'This is not a valid number'\n            return\n\n        try:\n            ini_worker.write_to_section(self.INI_CONFIG, self.feature, 'fieldWidth', num)\n        except:\n            raise\n\n        return num\n\n\n    # ------------------------------------------------------------------------------------------------------------------\n    def set_feed_rate(self, num=None):\n        sys.path.append(self.pluginPath)\n        from Utilities import ini_worker\n        reload(ini_worker)\n\n        if num is None:\n            num = raw_input('Define feed rate [mm\\min] > ' + self.feature)\n        try:\n            num = float(num)\n        except:\n            print 'This is not a valid number'\n            return\n\n        try:\n            ini_worker.write_to_section(self.INI_CONFIG, self.feature, 'feedrate', num)\n        except:\n            raise\n\n        return num\n\n    # ------------------------------------------------------------------------------------------------------------------\n    def set_roof_layers(self):\n        sys.path.append(self.pluginPath)\n        from Utilities import ini_worker\n        reload(ini_worker)\n\n        num = raw_input('Define number of solid roof layer: ')\n        try:\n            num = float(num)\n        except:\n            print 'This is not a valid number'\n            return\n\n        try:\n            ini_worker.write_to_section(self.INI_CONFIG, self.feature, 'solidRoofLayers', num)\n        except:\n            raise\n\n\n    # ------------------------------------------------------------------------------------------------------------------\n    def set_floor_layers(self):\n        sys.path.append(self.pluginPath)\n        from Utilities import ini_worker\n        reload(ini_worker)\n\n        num = raw_input('Define number of solid floor layer: ')\n        try:\n            num = float(num)\n        except:\n            print 'This is not a valid number'\n            return\n\n        try:\n            ini_worker.write_to_section(self.INI_CONFIG, self.feature, 'solidFloorLayers', num)\n        except:\n            raise\n\n    # ------------------------------------------------------------------------------------------------------------------\n    def set_outer_path_width(self):\n        sys.path.append(self.pluginPath)\n        from Utilities import ini_worker\n        reload(ini_worker)\n\n        num = raw_input('Define outer path width: ')\n        try:\n            num = float(num)\n        except:\n            print 'This is not a valid number'\n            return\n\n        try:\n            ini_worker.write_to_section(self.INI_CONFIG, self.feature, 'outerPathWidth', num)\n        except:\n            raise\n\n    # ------------------------------------------------------------------------------------------------------------------\n    def set_inner_path_width(self):\n        sys.path.append(self.pluginPath)\n        from Utilities import ini_worker\n        reload(ini_worker)\n\n        num = raw_input('Define inner path width: ')\n        try:\n            num = float(num)\n        except:\n            print 'This is not a valid number'\n            return\n\n        try:\n            ini_worker.write_to_section(self.INI_CONFIG, self.feature, 'pathWidth', num)\n        except:\n            raise\n\n    # ------------------------------------------------------------------------------------------------------------------\n    def set_global_path_width(self):\n        sys.path.append(self.pluginPath)\n        from Utilities import ini_worker\n        reload(ini_worker)\n\n        num = raw_input('Define global path width: ')\n        try:\n            num = float(num)\n        except:\n            print 'This is not a valid number'\n            return\n\n        try:\n            ini_worker.write_to_section(self.INI_CONFIG, self.feature, 'pathWidth', num)\n        except:\n            raise\n\n    # ------------------------------------------------------------------------------------------------------------------\n    def set_min_segment_length(self):\n        sys.path.append(self.pluginPath)\n        from Utilities import ini_worker\n        reload(ini_worker)\n\n        num = raw_input('Define min segment length: ')\n        try:\n            num = float(num)\n        except:\n            print 'This is not a valid number'\n            return\n\n        try:\n            ini_worker.write_to_section(self.INI_CONFIG, self.feature, 'minLength', num)\n            print 'DONE'\n        except:\n            raise\n\n    # ------------------------------------------------------------------------------------------------------------------\n    def set_filter_tolerance(self):\n        sys.path.append(self.pluginPath)\n        from Utilities import ini_worker\n        reload(ini_worker)\n\n        num = raw_input('Define filter tolerance: ')\n        try:\n            num = float(num)\n        except:\n            print 'This is not a valid number'\n            return\n\n        try:\n            ini_worker.write_to_section(self.INI_CONFIG, self.feature, 'filterTolerance', num)\n            print 'DONE'\n        except:\n            raise\n\n    # ------------------------------------------------------------------------------------------------------------------\n    def set_minimum_sparse_ratio(self):\n        sys.path.append(self.pluginPath)\n        from Utilities import ini_worker\n        reload(ini_worker)\n\n        num = raw_input('Define ratio of sparse to solid: ')\n        try:\n            num = float(num)\n        except:\n            print 'This is not a valid number'\n            return\n\n        try:\n            ini_worker.write_to_section(self.INI_CONFIG, self.feature, 'minimumSparseRatio', num)\n            print 'DONE'\n        except:\n            raise\n\n    # ------------------------------------------------------------------------------------------------------------------\n    def set_connection_sparse_onoff(self):\n        sys.path.append(self.pluginPath)\n        from Utilities import ini_worker\n        reload(ini_worker)\n\n        num = raw_input('Switch connections to on or off: ')\n        try:\n            num = float(num)\n        except:\n            print 'This is not a valid number'\n            return\n\n        try:\n            ini_worker.write_to_section(self.INI_CONFIG, self.feature, 'connectSparse', num)\n            print 'DONE'\n        except:\n            raise\n",
  "language": "python",
  "imports": [
    "rhinoscriptsyntax"
  ],
  "has_docstring": true
}