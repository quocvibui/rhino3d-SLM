{
  "source_url": "https://discourse.mcneel.com/t/simple-rhino-macro-run-through-ghpython-disables-grasshopper-control/190084",
  "topic_id": 190084,
  "title": "Simple Rhino macro run through ghpython disables grasshopper control",
  "question": "Hi I have a ghpython script that I’m trying to create to import pdf into Rhino using Rhino macro but after running the script my grasshopper panning gets disabled and the only way to get it back is by pressing the button connected to the python component with the solver locked (it’s expiring the solution of the python component?) If anyone has a insight into why this might be happening any help is appreciated. Thank you!\n\nbelow is the code I have\n\n\nimport Rhino\nimport rhinoscriptsyntax as rs\ndef get_document_units():\n    units = Rhino.RhinoDoc.ActiveDoc.ModelUnitSystem\n    return str(units)\n\nunits = get_document_units()\nprint(units)\n\nif Import:\n    if units == \"Inches\":\n        Rhino.RhinoDoc.ActiveDoc.ModelUnitSystem = Rhino.UnitSystem.Millimeters\n    rs.Command(\"!.\")\n    rs.Command(\"Import\")\n    rs.Command(\"Group\")\n    ghenv.Component.ExpireSolution(True)\n    if units == \"Millimeters\":\n        Rhino.RhinoDoc.ActiveDoc.ModelUnitSystem = Rhino.UnitSystem.Inches\n\n\n\nImport PDF.gh\n (2.8 KB)",
  "code_blocks": [
    {
      "code": "import Rhino\nimport rhinoscriptsyntax as rs\ndef get_document_units():\n    units = Rhino.RhinoDoc.ActiveDoc.ModelUnitSystem\n    return str(units)\n\nunits = get_document_units()\nprint(units)\n\nif Import:\n    if units == \"Inches\":\n        Rhino.RhinoDoc.ActiveDoc.ModelUnitSystem = Rhino.UnitSystem.Millimeters\n    rs.Command(\"!.\")\n    rs.Command(\"Import\")\n    rs.Command(\"Group\")\n    ghenv.Component.ExpireSolution(True)\n    if units == \"Millimeters\":\n        Rhino.RhinoDoc.ActiveDoc.ModelUnitSystem = Rhino.UnitSystem.Inches",
      "language": "python",
      "author": "User_aaa",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "csharp",
    "file-io",
    "grasshopper",
    "python",
    "rhinoscriptsyntax"
  ],
  "has_accepted_answer": false,
  "category_id": 11,
  "posts_count": 2,
  "views": 59
}