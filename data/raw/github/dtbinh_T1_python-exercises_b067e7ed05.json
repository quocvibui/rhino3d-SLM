{
  "source_url": "https://github.com/dtbinh/T1_python-exercises/blob/f4710c3dc2ba8ddb3e3e9069ab8d65df674463ab/07_ur_online/offline/robotic_drawing.py",
  "repo": "dtbinh/T1_python-exercises",
  "repo_stars": 0,
  "repo_description": null,
  "license": "unknown",
  "filepath": "07_ur_online/offline/robotic_drawing.py",
  "instruction": "MAS ROBOTIC DRAWING\n04.10.2017",
  "code": "\"\"\"\nMAS ROBOTIC DRAWING\n04.10.2017\n\nAuthor: David Jenny\n\"\"\"\n\n\nimport simple_ur_script as ur\nimport simple_comm as c\n\nimport math as m\nimport random as r\n\nimport rhinoscriptsyntax as rs\nimport Rhino.Geometry as rg\n\nROBOT_IP = '.xxx.xx.xx'\n\n\n#how to move the robot to a vertical position\ndef move_robot_vertical(move_to):\n    script = \"\"\n    script += ur.set_tcp_by_angles(0.0,0.0,0.0,m.radians(0.0),m.radians(180.0),m.radians(0))\n\n    velocity = 0.05\n    acceleration = 0.02\n    robot_ip = ROBOT_IP\n\n    plane = rg.Plane(move_to,rg.Vector3d.ZAxis)\n    script += ur.move_l(plane,acceleration,velocity)\n\n    script = c.concatenate_script(script)\n    c.send_script(script,robot_ip)\n    print script\n\n#how to get the robot's position\ndef get_robot_position():\n    robot_ip = ROBOT_IP\n    data = c.listen_to_robot(robot_ip)\n\n#how to set a base plane\ndef set_robot_base_plane():\n    robot_ip = ROBOT_IP\n    #robot_ip = \"192.168.10.43\"\n\n    rs.MessageBox(\"move robot to base plane origin, press OK when there\",0)\n    data = c.listen_to_robot(robot_ip)\n    pose = data['pose']\n    pt_1 = rg.Point3d(pose[0]*1000,pose[1]*1000,pose[2]*1000)\n    print pt_1\n    rs.MessageBox(\"move robot to base plane positive x direction, press OK when there\",0)\n    data = c.listen_to_robot(robot_ip)\n    pose = data['pose']\n    pt_2 = rg.Point3d(pose[0]*1000,pose[1]*1000,pose[2]*1000)\n    print pt_2\n    rs.MessageBox(\"move robot to base plane positive y direction, press OK when there\",0)\n    data = c.listen_to_robot(robot_ip)\n    pose = data['pose']\n    pt_3 = rg.Point3d(pose[0]*1000,pose[1]*1000,pose[2]*1000)\n    print pt_3\n\n    robot_base = rg.Plane(pt_1,pt_2-pt_1,pt_3-pt_1)\n    text_file = open(\"robot_base.txt\", \"w\")\n    text_file.write(str(robot_base.Origin)+\",\"+str(robot_base.XAxis)+\",\"+str(robot_base.YAxis))\n    text_file.close()\n\n#how to load a base plane\ndef load_robot_base_plane():\n    text_file = open(\"robot_base.txt\", \"r\")\n    string = text_file.read()\n    values = string.split(\",\")\n    values = [float(value) for value in values]\n\n    base_origin = rg.Point3d(values[0],values[1],values[2])\n    base_x_axis = rg.Vector3d(values[3],values[4],values[5])\n    base_y_axis = rg.Vector3d(values[6],values[7],values[8])\n\n    base_plane = rg.Plane(base_origin,base_x_axis,base_y_axis)\n    return base_plane\n\n#how to transform rhino to robot base coordinates\ndef rhino_to_robot_space(_plane,_robot_base):\n    _r_matrix = rg.Transform.PlaneToPlane(rg.Plane.WorldXY,_robot_base)\n    _plane.Transform(_r_matrix)\n    return _plane\n\n#how to randomly draw\ndef random_walk_draw(_robot_base,pen_height,_no_pts,vel,accel):\n    way_pts = []\n    for i in range(_no_pts):\n        x_r = r.randint(50,247)\n        y_r = r.randint(50,370)\n        r_pt = rg.Point3d(50+5*i,y_r,pen_height)\n        way_pts.append(r_pt)\n\n    #way_pts.append(way_pts[-1]+rg.Point3d(0,0,150))\n    #way_pts.insert(0,way_pts[0]+rg.Point3d(0,0,150))\n\n    for i,pt in enumerate(way_pts):\n        if i>0:\n            rs.AddLine(way_pts[i-1],pt)\n\n    way_planes = [rg.Plane(pt,rg.Vector3d.ZAxis) for pt in way_pts]\n    way_planes = [rhino_to_robot_space(plane,_robot_base) for plane in way_planes]\n\n    velocity = vel\n    acceleration = accel\n    robot_ip = ROBOT_IP\n\n    script = \"\"\n    script += ur.set_tcp_by_angles(0.0,0.0,pen_height,m.radians(0.0),m.radians(180.0),m.radians(0))\n\n    for plane in way_planes:\n        script += ur. move_l(plane,acceleration,velocity)\n\n    script = c.concatenate_script(script)\n    c.send_script(script,robot_ip)\n    print script\n\n#how to nicely draw\ndef nice_walk(_robot_base,pen_height,_no_pts,vel,accel):\n    way_pts = []\n    step_x = 150/_no_pts\n    step_y = 237/_no_pts\n    for i in range(_no_pts):\n        if i%2 == 0:\n            x_r = 30+step_x*i\n            y_r = 30+step_y*i\n            r_pt = rg.Point3d(x_r,y_r,pen_height)\n            way_pts.append(r_pt)\n        else:\n            x_r = 30+step_x*i\n            y_r = 150+60*m.sin(i)*-1\n            r_pt = rg.Point3d(x_r,y_r,pen_height)\n            way_pts.append(r_pt)\n\n    #way_pts.append(way_pts[-1]+rg.Point3d(0,0,150))\n    #way_pts.insert(0,way_pts[0]+rg.Point3d(0,0,150))\n\n    for i,pt in enumerate(way_pts):\n        if i>0:\n            rs.AddLine(way_pts[i-1],pt)\n\n    way_planes = [rg.Plane(pt,rg.Vector3d.ZAxis) for pt in way_pts]\n    way_planes = [rhino_to_robot_space(plane,_robot_base) for plane in way_planes]\n\n    velocity = vel\n    acceleration = accel\n    robot_ip = ROBOT_IP\n\n    script = \"\"\n    script += ur.set_tcp_by_angles(0.0,0.0,pen_height,m.radians(0.0),m.radians(180.0),m.radians(0))\n\n    for plane in way_planes:\n        script += ur. move_l(plane,acceleration,velocity)\n\n    script = c.concatenate_script(script)\n    c.send_script(script,robot_ip)\n    print script\n\n\nif __name__ == \"__main__\":\n    #set_robot_base_plane()\n    #robot_base = load_robot_base_plane()\n    #print robot_base\n\n    #random_walk_draw(robot_base,5.0,50,0.3,0.3)\n\n    \"\"\"\n    robot_ip = ROBOT_IP\n    script = ur.popup(\"tada\",\"tada\")\n    script = c.concatenate_script(script)\n    print script\n    c.send_script(script,robot_ip)\n    \"\"\"\n\n    #robot_base = load_robot_base_plane()\n    #move_along_crv(robot_base,0.2,0.2)\n    #nice_walk(robot_base,150,300,1.5,1.8)\n    #random_circles(robot_base,150,20,2.5,1.5)\n",
  "language": "python",
  "imports": [
    "Rhino",
    "Rhino.Geometry",
    "rhinoscriptsyntax"
  ],
  "has_docstring": true
}