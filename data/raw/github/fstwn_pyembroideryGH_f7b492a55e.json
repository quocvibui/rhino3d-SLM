{
  "source_url": "https://github.com/fstwn/pyembroideryGH/blob/ee7fd47316b364962a69976b4168ce9fef2702cf/usrobj_src/pyembroideryGH_StringToCommand.py",
  "repo": "fstwn/pyembroideryGH",
  "repo_stars": 11,
  "repo_description": "Set of UserObjects enabling Grasshopper to directly read, write and manipulate various kinds of embroidery formats. It is based on an IronPython-compatible fork of the original pyembroidery library.",
  "license": "MIT",
  "filepath": "usrobj_src/pyembroideryGH_StringToCommand.py",
  "instruction": "Converts any valid embroidery command from string into\nits integer representation.\n    Inputs:\n        CmdStr: The embroidery command as string.\n                {tree, str}\n    Output:\n        Cmd:...",
  "code": "\"\"\"\nConverts any valid embroidery command from string into\nits integer representation.\n    Inputs:\n        CmdStr: The embroidery command as string.\n                {tree, str}\n    Output:\n        Cmd: The converted embroidery command as integer if the input string\n             is valid, otherwise Null.\n             {tree, int}\n    Remarks:\n        Author: Max Eschenbach\n        License: MIT License\n        Version: 201030\n\"\"\"\n\n# PYTHON STANDARD LIBRARY IMPORTS\nfrom __future__ import division\n\n# GHPYTHON SDK IMPORTS\nfrom ghpythonlib.componentbase import executingcomponent as component\nimport Grasshopper, GhPython\nimport System\nimport Rhino\nimport rhinoscriptsyntax as rs\n\n# GHENV COMPONENT SETTINGS \nghenv.Component.Name = \"StringToCommand\"\nghenv.Component.NickName = \"STC\"\nghenv.Component.Category = \"pyembroideryGH\"\nghenv.Component.SubCategory = \"0 Commands\"\n\n# LOCAL MODULE IMPORTS\ntry:\n    import pyembroidery\nexcept ImportError:\n    errMsg = (\"The pyembroidery python module seems to be not correctly \" +\n              \"installed! Please make sure the module is in you search \" +\n              \"path, see README for instructions!.\")\n    raise ImportError(errMsg)\n\nclass StringToCommand(component):\n\n    def RunScript(self, CmdStrTree):\n        # initialize output as GH tree\n        Cmd = Grasshopper.DataTree[object]()\n        \n        # retrieve command dictionary for translation\n        command_dict = pyembroidery.get_command_dictionary()\n        \n        # only do sth if there is valid input to begin with\n        if CmdStrTree != None and CmdStrTree.DataCount:\n            # loop through all branches of the tree\n            for i, branch in enumerate(CmdStrTree.Branches):\n                branch_path = CmdStrTree.Path(i)\n                # loop through all items in the current branch\n                for j, command in enumerate(branch):\n                    # look up the command in the dict and add the result to\n                    # the output tree\n                    try:\n                        Cmd.Add(command_dict[command], branch_path)\n                    except KeyError:\n                        rml = self.RuntimeMessageLevel.Warning\n                        errMsg = (\"Command '{}' at branch {}, index {} \" +\n                                  \"is not a known embroidery command string!\" +\n                                  \" A Null item will be inserted into the \" +\n                                  \"output tree!\")\n                        errMsg = errMsg.format(command, i, j)\n                        self.AddRuntimeMessage(rml, errMsg)\n                        Cmd.Add(None, branch_path)\n        else:\n            rml = self.RuntimeMessageLevel.Warning\n            errMsg = \"Input CmdStr failed to collect data!\"\n            self.AddRuntimeMessage(rml, errMsg)\n        \n        # return outputs if you have them; here I try it for you:\n        return Cmd\n",
  "language": "python",
  "imports": [
    "Rhino",
    "ghpythonlib",
    "rhinoscriptsyntax"
  ],
  "has_docstring": true
}