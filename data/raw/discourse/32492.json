{
  "source_url": "https://discourse.mcneel.com/t/export-file-from-python-command/32492",
  "topic_id": 32492,
  "title": "Export file from Python command",
  "question": "Hi!!\n\n\nI’m writing my first Rhino command! I’d like to be able to run a command, select some objects, and have them open directly in Sketch for Mac. I’ve got every aspect of this figured out and most of the code written, but I can’t for the life of me figure out how to script the file export! I’d like to export the selected objects (I scripted selecting them) as an Adobe Illustrator file, which I’ll then convert to SVG for import into Sketch. How do I write a one-line export command, one that I can put in the line that reads \nrs.Command(\"! _-Export\")\n so that the selected objects will be exported as a .ai file with no pause to input parameters each time? Or is calling \nrs.Command\n the wrong way to go about this?\n\n\nAny help would be much appreciated!!\n\n\nimport rhinoscriptsyntax as rs\nimport scriptcontext as sc\nimport Rhino\n\n__commandname__ = \"Diagram\"\n\ndef RunCommand( is_interactive ):\n    obj = rs.GetObjects(filter=4)\n    if obj:\n        rs.SelectObjects(obj)\n        print \"Exporting...\"\n        rs.Command(\"! _-Export\")\n    else:\n        print \"Error: no objects selected\"\n\n\n\n\nThanks so much,\n\nSam",
  "code_blocks": [
    {
      "code": "import rhinoscriptsyntax as rs\nimport scriptcontext as sc\nimport Rhino\n\n__commandname__ = \"Diagram\"\n\ndef RunCommand( is_interactive ):\n    obj = rs.GetObjects(filter=4)\n    if obj:\n        rs.SelectObjects(obj)\n        print \"Exporting...\"\n        rs.Command(\"! _-Export\")\n    else:\n        print \"Error: no objects selected\"",
      "language": "python",
      "author": "sdaitzman",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "file-io",
    "geometry",
    "python",
    "rhinoscriptsyntax",
    "selection"
  ],
  "has_accepted_answer": false,
  "category_id": 11,
  "posts_count": 4,
  "views": 4130
}