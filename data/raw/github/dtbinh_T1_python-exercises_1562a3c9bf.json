{
  "source_url": "https://github.com/dtbinh/T1_python-exercises/blob/f4710c3dc2ba8ddb3e3e9069ab8d65df674463ab/07_ur_online/shifted_frames_setup/compas/src/compas_rhino/artists/meshartist.py",
  "repo": "dtbinh/T1_python-exercises",
  "repo_stars": 0,
  "repo_description": null,
  "license": "unknown",
  "filepath": "07_ur_online/shifted_frames_setup/compas/src/compas_rhino/artists/meshartist.py",
  "instruction": "Meshartist",
  "code": "\"\"\"\"\"\"\n\nfrom compas.utilities import to_valuedict\n\nimport compas_rhino\n\ntry:\n    import rhinoscriptsyntax as rs\nexcept ImportError:\n    import platform\n    if platform.python_implementation() == 'IronPython':\n        raise\n\n\n__author__    = ['Tom Van Mele', ]\n__copyright__ = 'Copyright 2016 - Block Research Group, ETH Zurich'\n__license__   = 'MIT License'\n__email__     = 'vanmelet@ethz.ch'\n\n\n__all__ = []\n\n\nclass MeshArtist(object):\n    \"\"\"\"\"\"\n\n    def __init__(self, mesh, layer=None):\n        self.mesh = mesh\n        self.layer = layer\n        self.defaults = {\n            'vertex.color' : (255, 0, 0),\n            'face.color'   : (255, 255, 255),\n            'edge.color'   : (0, 0, 0),\n        }\n\n    def redraw(self):\n        \"\"\"Redraw the Rhino view.\"\"\"\n        rs.EnableRedraw(True)\n        rs.Redraw()\n\n    def clear_layer(self):\n        \"\"\"Clear the main layer of the artist.\"\"\"\n        if self.layer:\n            compas_rhino.clear_layer(self.layer)\n\n    def clear(self):\n        self.clear_vertices()\n        self.clear_faces()\n        self.clear_edges()\n\n    def clear_vertices(self, keys=None):\n        if not keys:\n            name = '{}.vertex.*'.format(self.mesh.attributes['name'])\n            guids = compas_rhino.get_objects(name=name)\n        else:\n            guids = []\n            for key in keys:\n                name = '{}.vertex.{}'.format(self.attributes['name'], key)\n                guid = compas_rhino.get_object(name=name)\n                guids.append(guid)\n        compas_rhino.delete_objects(guids)\n\n    def clear_faces(self, keys=None):\n        if not keys:\n            name = '{}.face.*'.format(self.mesh.attributes['name'])\n            guids = compas_rhino.get_objects(name=name)\n        else:\n            guids = []\n            for key in keys:\n                name = '{}.face.{}'.format(self.attributes['name'], key)\n                guid = compas_rhino.get_object(name=name)\n                guids.append(guid)\n        compas_rhino.delete_objects(guids)\n\n    def clear_edges(self, keys=None):\n        if not keys:\n            name = '{}.edge.*'.format(self.mesh.attributes['name'])\n            guids = compas_rhino.get_objects(name=name)\n        else:\n            guids = []\n            for u, v in keys:\n                name = '{}.edge.{}-{}'.format(self.attributes['name'], u, v)\n                guid = compas_rhino.get_object(name=name)\n                guids.append(guid)\n        compas_rhino.delete_objects(guids)\n\n    def draw_vertices(self, keys=None, color=None):\n        \"\"\"Draw a selection of vertices of the mesh.\n\n        Parameters\n        ----------\n        keys : list\n            A list of vertex keys identifying which vertices to draw.\n            Default is ``None``, in which case all vertices are drawn.\n        color : str, tuple, dict\n            The color specififcation for the vertices.\n            Colors should be specified in the form of a string (hex colors) or\n            as a tuple of RGB components.\n            To apply the same color to all vertices, provide a single color\n            specification. Individual colors can be assigned using a dictionary\n            of key-color pairs. Missing keys will be assigned the default vertex\n            color (``self.defaults['vertex.color']``).\n            The default is ``None``, in which case all vertices are assigned the\n            default vertex color.\n\n        Notes\n        -----\n        The vertices are named using the following template:\n        ``\"{}.vertex.{}\".format(self.mesh.attributes['name'], key)``.\n        This name is used afterwards to identify vertices of the meshin the Rhino model.\n\n        Examples\n        --------\n        >>>\n\n        \"\"\"\n        keys = keys or list(self.mesh.vertices())\n        colordict = to_valuedict(keys, color, self.defaults['vertex.color'])\n        points = []\n        for key in keys:\n            points.append({\n                'pos'  : self.mesh.vertex_coordinates(key),\n                'name' : self.mesh.vertex_name(key),\n                'color': colordict[key]\n            })\n        return compas_rhino.xdraw_points(points, layer=self.layer, clear=False, redraw=False)\n\n    def draw_faces(self, fkeys=None, color=None):\n        \"\"\"Draw a selection of faces of the mesh.\n\n        Parameters\n        ----------\n        fkeys : list\n            A list of face keys identifying which faces to draw.\n            The default is ``None``, in which case all faces are drawn.\n        color : str, tuple, dict\n            The color specififcation for the faces.\n            Colors should be specified in the form of a string (hex colors) or\n            as a tuple of RGB components.\n            To apply the same color to all faces, provide a single color\n            specification. Individual colors can be assigned using a dictionary\n            of key-color pairs. Missing keys will be assigned the default face\n            color (``self.defaults['face.color']``).\n            The default is ``None``, in which case all faces are assigned the\n            default vertex color.\n\n        Notes\n        -----\n        The faces are named using the following template:\n        ``\"{}.face.{}\".format(self.mesh.attributes['name'], key)``.\n        This name is used afterwards to identify faces of the mesh in the Rhino model.\n\n        Examples\n        --------\n        >>>\n\n        \"\"\"\n        fkeys = fkeys or list(self.mesh.faces())\n        colordict = to_valuedict(fkeys, color, self.defaults['face.color'])\n        faces = []\n        for fkey in fkeys:\n            faces.append({\n                'points': self.mesh.face_coordinates(fkey),\n                'name'  : \"{}.face.{}\".format(self.mesh.attributes['name'], fkey),\n                'color' : colordict[fkey],\n            })\n        return compas_rhino.xdraw_faces(faces, layer=self.layer, clear=False, redraw=False)\n\n    def draw_edges(self, keys=None, color=None):\n        \"\"\"Draw a selection of edges of the mesh.\n\n        Parameters\n        ----------\n        keys : list\n            A list of edge keys (as uv pairs) identifying which edges to draw.\n            The default is ``None``, in which case all edges are drawn.\n        color : str, tuple, dict\n            The color specififcation for the edges.\n            Colors should be specified in the form of a string (hex colors) or\n            as a tuple of RGB components.\n            To apply the same color to all faces, provide a single color\n            specification. Individual colors can be assigned using a dictionary\n            of key-color pairs. Missing keys will be assigned the default face\n            color (``self.defaults['face.color']``).\n            The default is ``None``, in which case all faces are assigned the\n            default vertex color.\n\n        Notes\n        -----\n        All edges are named using the following template:\n        ``\"{}.edge.{}-{}\".fromat(self.mesh.attributes['name'], u, v)``.\n        This name is used afterwards to identify edges of the mesh in the Rhino model.\n\n        Examples\n        --------\n        >>> artist.draw_edges()\n        >>> artist.draw_edges(color='#ff0000')\n        >>> artist.draw_edges(color=(255, 0, 0))\n        >>> artist.draw_edges(keys=self.mesh.edges_on_boundary())\n        >>> artist.draw_edges(color={(u, v): '#00ff00' for u, v in self.mesh.edges_on_boundary()})\n\n        \"\"\"\n        keys = keys or list(self.mesh.edges())\n        colordict = to_valuedict(keys, color, self.defaults['edge.color'])\n        lines = []\n        for u, v in keys:\n            lines.append({\n                'start': self.mesh.vertex_coordinates(u),\n                'end'  : self.mesh.vertex_coordinates(v),\n                'color': colordict[(u, v)],\n                'name' : self.mesh.edge_name(u, v)\n            })\n        return compas_rhino.xdraw_lines(lines, layer=self.layer, clear=False, redraw=False)\n\n    def draw_vertexlabels(self, text=None, color=None):\n        \"\"\"Draw labels for selected vertices of the mesh.\n\n        Parameters\n        ----------\n        text : dict\n            A dictionary of vertex labels as key-text pairs.\n            The default value is ``None``, in which case every vertex of the mesh\n            will be labelled with its key.\n        color : str, tuple, dict\n            The color sepcification of the labels.\n            String values are interpreted as hex colors (e.g. ``'#ff0000'`` for red).\n            Tuples are interpreted as RGB component specifications (e.g. ``(255, 0, 0) for red``.\n            If a dictionary of specififcations is provided, the keys of the\n            should refer to vertex keys in the mesh and the values should be color\n            specifications in the form of strings or tuples.\n            The default value is ``None``, in which case the labels are assigned\n            the default vertex color (``self.defaults['vertex.color']``).\n\n        Notes\n        -----\n        All labels are assigned a name using the folling template:\n        ``\"{}.vertex.{}\".format(self.mesh.attributes['name'], key)``.\n\n        Examples\n        --------\n        >>>\n\n        \"\"\"\n        if text is None:\n            textdict = {key: str(key) for key in self.mesh.vertices()}\n        elif isinstance(text, dict):\n            textdict = text\n        else:\n            raise NotImplementedError\n        colordict = to_valuedict(list(textdict.keys()), color, self.defaults['vertex.color'])\n        labels = []\n        for key, text in iter(textdict.items()):\n            labels.append({\n                'pos'  : self.mesh.vertex_coordinates(key),\n                'name' : self.mesh.vertex_name(key),\n                'color': colordict[key],\n                'text' : textdict[key],\n            })\n        return compas_rhino.xdraw_labels(labels, layer=self.layer, clear=False, redraw=False)\n\n    def draw_facelabels(self, text=None, color=None):\n        \"\"\"Draw labels for selected faces of the mesh.\n\n        Parameters\n        ----------\n\n        Notes\n        -----\n\n        Examples\n        --------\n\n        \"\"\"\n        if text is None:\n            textdict = {key: str(key) for key in self.mesh.faces()}\n        elif isinstance(text, dict):\n            textdict = text\n        else:\n            raise NotImplementedError\n        colordict = to_valuedict(list(textdict.keys()), color, self.defaults['face.color'])\n        labels = []\n        for key, text in iter(textdict.items()):\n            labels.append({\n                'pos'  : self.mesh.face_center(key),\n                'name' : self.mesh.face_name(key),\n                'color': colordict[key],\n                'text' : textdict[key],\n            })\n        return compas_rhino.xdraw_labels(labels, layer=self.layer, clear=False, redraw=False)\n\n    def draw_edgelabels(self, text=None, color=None):\n        \"\"\"Draw labels for selected edges of the mesh.\n\n        Parameters\n        ----------\n\n        Notes\n        -----\n\n        Examples\n        --------\n\n        \"\"\"\n        if text is None:\n            textdict = {(u, v): \"{}-{}\".format(u, v) for u, v in self.mesh.edges()}\n        elif isinstance(text, dict):\n            textdict = text\n        else:\n            raise NotImplementedError\n        colordict = to_valuedict(list(textdict.keys()), color, self.defaults['edge.color'])\n        labels = []\n        for (u, v), text in iter(textdict.items()):\n            labels.append({\n                'pos'  : self.mesh.edge_midpoint(u, v),\n                'name' : self.mesh.edge_name(u, v),\n                'color': colordict[(u, v)],\n                'text' : textdict[(u, v)],\n            })\n        return compas_rhino.xdraw_labels(labels, layer=self.layer, clear=False, redraw=False)\n\n\n# ==============================================================================\n# Debugging\n# ==============================================================================\n\nif __name__ == \"__main__\":\n\n    import time\n\n    from compas.datastructures.mesh import Mesh\n    from compas.geometry.elements import Polyhedron\n\n    from compas_rhino.artists.meshartist import MeshArtist\n\n    poly = Polyhedron.generate(12)\n\n    mesh = Mesh.from_vertices_and_faces(poly.vertices, poly.faces)\n\n    artist = MeshArtist(mesh, layer='MeshArtist')\n\n    artist.clear_layer()\n\n    artist.draw_vertices()\n    artist.redraw()\n    time.sleep(2.0)\n\n    artist.draw_faces()\n    artist.redraw()\n    time.sleep(2.0)\n\n    artist.draw_edges()\n    artist.redraw()\n    time.sleep(2.0)\n\n    artist.draw_vertexlabels()\n    artist.draw_facelabels()\n    artist.draw_edgelabels()\n\n    # artist.redraw()\n",
  "language": "python",
  "imports": [
    "rhinoscriptsyntax"
  ],
  "has_docstring": false
}