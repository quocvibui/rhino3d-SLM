{
  "source_url": "https://github.com/adammenges/fresh-eyes/blob/d458eb0199488355ccf9d5e77afc1429f77d5908/utility%20scripts/rhinoscripts/view_capture.py",
  "repo": "adammenges/fresh-eyes",
  "repo_stars": 0,
  "repo_description": "AI + Architecture",
  "license": "GPL-3.0",
  "filepath": "utility scripts/rhinoscripts/view_capture.py",
  "instruction": "View capture",
  "code": "import rhinoscriptsyntax as rs\nimport Rhino\nimport scriptcontext\nimport System.Drawing\nimport os\n\ndef main():\n    set_active_view(\"Perspective\")\n    view = rs.CurrentView()\n    set_disp_mode(\"Arctic\")\n    \n    rs.ViewProjection(view,2)\n    rs.ViewCameraTarget(view,(-1,-1,0.5),(0,0,0))\n    \n    rs.ViewCameraLens(view,25)\n    rs.ZoomExtents(view)\n    #rs.ViewCameraLens(view,25)\n    \n    #basepath = \"C:\\\\Users\\\\ksteinfe\\\\Desktop\\\\TEMP\"\n    basepath = \"G:\\\\TEMP\"\n    #capture_view_antialias(os.path.join(basepath,\"anti 1.png\"), (200,200) )\n    capture_view_antialias(os.path.join(basepath,\"anti 2.png\"), (200,200), 4.0 )\n    #capture_view(os.path.join(basepath,\"reg.png\"), (200,200) )\n\n#def fetch(\n#    obj = rs.GetObject(\"Pick any object\")\n\n#def patch(curve)\n\ndef set_active_view(viewportName):\n    RhinoDocument = Rhino.RhinoDoc.ActiveDoc\n    view = RhinoDocument.Views.Find(viewportName, False)\n    if view is None: return\n    RhinoDocument.Views.ActiveView = view\n    return view # returns RhinoCommon view. for Rhinoscript, use rs.CurrentView()\n\ndef capture_view_antialias(filePath, save_size=1.0, scale_fac = 2.0 ): # scale_fac is capture to save size ratio\n    RhinoDocument = Rhino.RhinoDoc.ActiveDoc\n    view = RhinoDocument.Views.ActiveView    \n    vp = view.ActiveViewport\n    \n    try:\n        capture_size = System.Drawing.Size(save_size[0]*scale_fac,save_size[1]*scale_fac)\n    except:\n        save_size = vp.Size.Width*save_size,vp.Size.Height*save_size\n        capture_size = System.Drawing.Size(save_size[0]*scale_fac,save_size[1]*scale_fac)\n\n    capture = view.CaptureToBitmap( capture_size )\n    capture = resize_bitmap(capture,save_size)\n    capture.Save(filePath);\n\ndef capture_view(filePath, save_size=1.0):\n    RhinoDocument = Rhino.RhinoDoc.ActiveDoc\n    view = RhinoDocument.Views.ActiveView    \n    vp = view.ActiveViewport\n    \n    try:\n        capture_size = System.Drawing.Size(save_size[0],save_size[1])\n    except:\n        save_size = vp.Size.Width*save_size,vp.Size.Height*save_size\n        capture_size = System.Drawing.Size(save_size[0],save_size[1])\n    \n    capture = view.CaptureToBitmap( capture_size )\n    capture.Save(filePath);\n\n\ndef resize_bitmap(src_img,size):\n    dest_rect = System.Drawing.Rectangle(0,0,size[0],size[1])\n    dest_img = System.Drawing.Bitmap(size[0],size[1])\n    dest_img.SetResolution(src_img.HorizontalResolution, src_img.VerticalResolution)\n    \n    with System.Drawing.Graphics.FromImage(dest_img) as g:\n        g.CompositingMode = System.Drawing.Drawing2D.CompositingMode.SourceCopy\n        g.CompositingQuality = System.Drawing.Drawing2D.CompositingQuality.HighQuality\n        g.InterpolationMode = System.Drawing.Drawing2D.InterpolationMode.HighQualityBicubic\n        g.SmoothingMode = System.Drawing.Drawing2D.SmoothingMode.HighQuality\n        g.PixelOffsetMode = System.Drawing.Drawing2D.PixelOffsetMode.HighQuality\n        \n        with System.Drawing.Imaging.ImageAttributes() as wrap_mode:\n            wrap_mode.SetWrapMode(System.Drawing.Drawing2D.WrapMode.TileFlipXY)\n            g.DrawImage(src_img, dest_rect, 0,0, src_img.Width, src_img.Height, System.Drawing.GraphicsUnit.Pixel, wrap_mode)\n    return dest_img\n\n\ndef set_disp_mode(modename):\n    desc = Rhino.Display.DisplayModeDescription.FindByName(modename)\n    if desc: \n        scriptcontext.doc.Views.ActiveView.ActiveViewport.DisplayMode = desc\n        #scriptcontext.doc.Views.Redraw()\n\nif __name__ == \"__main__\":\n    # execute only if run as a script\n    main()",
  "language": "python",
  "imports": [
    "Rhino",
    "RhinoCommon",
    "rhinoscriptsyntax",
    "scriptcontext"
  ],
  "has_docstring": false
}