{
  "source_url": "https://github.com/matthewnewberg/nnurbs/blob/8d4b379a96cf9b230430693806446a6b5f59743b/rhinocommon/c/build_native.py",
  "repo": "matthewnewberg/nnurbs",
  "repo_stars": 3,
  "repo_description": "Net Nurbs - Pure C Sharp classes of OpenNurbs",
  "license": "MIT",
  "filepath": "rhinocommon/c/build_native.py",
  "instruction": "Build native",
  "code": "#!/usr/bin/env python\nimport subprocess\nimport sys\nimport getopt\nimport os\nimport glob\nimport logging\nimport distutils.dir_util\nimport shutil\nfrom sys import platform as _platform\nfrom os import listdir\nfrom os.path import isfile, isdir, join\n\nverbose = False\noverwrite = False\nhas_built_ios = False\nhas_built_android = False\nhas_built_osx = False\nwindows = False\nosx = False\nlinux = False\n\n#openNURBS globals\nhas_openNURBS = False\n\n#iOS globals\nhas_xcodeProj = False\nhas_xcodeTools = False\nhas_lipo = False\nis_ready_for_ios_build = False\ndid_build_ios_successfully = False\n\n#Android globals\nhas_jni = False\nhas_ndk = False\nhas_android_makefile = False\nhas_application_makefile = False\nis_ready_for_android_build = False\nandroid_ndk_path = ''\ndid_build_android_successfully = False\n\n#OS X globals\nis_ready_for_osx_build = False\ndid_build_for_osx_successfully = False\n\n\ndef check_android():\n    print \"\"\n    print \"Android Pre-build check-----------------------------------------\"\n    check_opennurbs()\n    check_jni()\n    check_ndk()\n    check_has_built_for_android()\n\n    global is_ready_for_android_build\n\n    if has_jni and has_ndk:\n        is_ready_for_android_build = True\n        print \"STATUS: Ready to build libopennurbs.so for Android\"\n    else:\n        is_ready_for_android_build = False\n\n    if not is_ready_for_android_build:\n        print \"STATUS: NOT ready for Android build.  Please address the following:\"\n        if not has_jni:\n            print \" ---ERROR: Missing jni folder-------------------------------------------\"\n            print \"  The jni folder is missing from this copy of openNURBS.  This may be\"\n            print \"  because this is an older copy of openNURBS or the files have moved.\"\n            print \"  Go to http://www.rhino3d.com/opennurbs to download and reinstall.\"\n            print \"  NOTE: the jni folder must contain the Android.mk and Application.mk\"\n            print \"  makefiles that ndk uses to build libopennurbs.so\"\n\n        if not has_ndk:\n            print \" ---ERROR: NDK not found------------------------------------------------\"\n            print \"  Building an android native library requires Google's ndk tools.\"\n            print \"  Xamarin.Android comes with a copy of the Android NDK.  Normally,\"\n            if osx:\n                print \"  this is in /Users/you/Library/Developer/Xamarin/android-ndk/\"\n            if windows:\n                print \"  this is in C:\\\\Program Files\\\\Android\\\\ndk\\\\ but using this script\"\n                print \"  requires that the ndk be placed in C:\\\\Android\\\\ndk\\\\\"\n            print \"  If you are missing the NKD, you can download a new copy here:\"\n            print \"  http://developer.android.com/tools/sdk/ndk/index.html\"\n            print \"  Once installed, you will need to add the path to the NDK toolkit\"\n            print \"  to your shell profile so that ndk-build can be called from anywhere.\"\n    return\n\n\ndef check_osx():\n    print \"\"\n    print \"OS X Pre-build check-----------------------------------------\"\n    check_opennurbs()\n    check_xcodeproj()\n    check_xcode_tools()\n    check_has_built_for_osx()\n\n    global is_ready_for_osx_build\n\n    if has_xcodeProj and has_openNURBS and has_xcodeTools:\n        is_ready_for_osx_build = True\n        print \"STATUS: Ready to build libopennurbs.dylib for OS X\"\n    else:\n        is_ready_for_osx_build = False\n\n    if not is_ready_for_osx_build:\n        print \"STATUS: NOT ready for OSX build.  Please address the following:\"\n        if not has_openNURBS:\n            print \" ---ERROR: opennurbs is missing or incomplete---------------------------\"\n            print \"  Building this library requires openNURBS. Please place a complete\"\n            print \"  copy of openNURBS in the opennurbs folder before continuing.\"\n            print \"  Go to http://www.rhino3d.com/opennurbs and download the C++\"\n            print \"  openNURBS SDK and place it in the opennurbs folder contained in\"\n            print \"  rhinocommon/c/ folder.\"\n\n        if not has_xcodeProj:\n            print \" ---ERROR: Script in wrong location or xcodeproj missing----------------\"\n            print \"  This script must be placed in the c folder of rhinocommon. This folder\"\n            print \"  should contain the rhcommon_opennurbs.xcodeproj file that is used in \"\n            print \"  the command line build.  If this script is in the c folder,\"\n            print \"  and you are getting this error message, then you are likely missing\"\n            print \"  the XCode project.  Go to http://github.com/mcneel/rhinocommon\"\n            print \"  to download and reinstall rhinocommon.\"\n\n        if not has_xcodeTools:\n            print \" ---ERROR: XCode Command Line Tools Missing-----------------------------\"\n            print \"  Building the universal binary requires xcodebuild.  This utility\"\n            print \"  is included with Apple's XCode Command Line Tools.  As of XCode 4.3,\"\n            print \"  Command Line Tools are optional.  To install Command Line tools, open\"\n            print \"  XCode > Preferences > Downloads Tab > Components > Command Line Tools.\"\n            print \"  Download and install.  Be sure to close/restart your terminal session\"\n            print \"  before running this command again.\"\n        return\n\n\ndef check_ios():\n    print \"\"\n    print \"iOS Pre-build check---------------------------------------------\"\n    check_opennurbs()\n    check_xcodeproj()\n    check_xcode_tools()\n    check_lipo()\n    check_has_built_for_ios()\n\n    global is_ready_for_ios_build\n\n    if has_xcodeProj and has_openNURBS and has_xcodeTools and has_lipo:\n        is_ready_for_ios_build = True\n        print \"STATUS: Ready to build libopennurbs.a for iOS\"\n    else:\n        is_ready_for_ios_build = False\n\n    if not is_ready_for_ios_build:\n        print \"STATUS: NOT ready for iOS build.  Please address the following:\"\n        if not has_openNURBS:\n            print \" ---ERROR: opennurbs is missing or incomplete---------------------------\"\n            print \"  Building this library requires openNURBS. Please place a complete\"\n            print \"  copy of openNURBS in the opennurbs folder before continuing.\"\n            print \"  Go to http://www.rhino3d.com/opennurbs and download the C++\"\n            print \"  openNURBS SDK and place it in the opennurbs folder contained in\"\n            print \"  rhinocommon/c/ folder.\"\n\n        if not has_xcodeProj:\n            print \" ---ERROR: Script in wrong location or xcodeproj missing----------------\"\n            print \"  This script must be placed in the c folder of rhinocommon. This folder\"\n            print \"  should contain the rhcommon_opennurbs.xcodeproj file that is used in \"\n            print \"  the command line build.  If this script is in the c folder,\"\n            print \"  and you are getting this error message, then you are likely missing\"\n            print \"  the XCode project.  Go to http://github.com/mcneel/rhinocommon\"\n            print \"  to download and reinstall rhinocommon.\"\n\n        if not has_xcodeTools:\n            print \" ---ERROR: XCode Command Line Tools Missing-----------------------------\"\n            print \"  Building the universal binary requires xcodebuild.  This utility\"\n            print \"  is included with Apple's XCode Command Line Tools.  As of XCode 4.3,\"\n            print \"  Command Line Tools are optional.  To install Command Line tools, open\"\n            print \"  XCode > Preferences > Downloads Tab > Components > Command Line Tools.\"\n            print \"  Download and install.  Be sure to close/restart your terminal session\"\n            print \"  before running this command again.\"\n\n        if not has_lipo:\n            print \" ---ERROR: Lipo missing or not in PATH----------------------------------\"\n            print \"  Building the universal binary requires lipo.  If you are seeing this\"\n            print \"  error, it is likely that lipo is not in your path.  Verify that lipo\"\n            print \"  is in the /usr/bin folder and that this folder is in your PATH.\"\n    return\n\n\ndef check_jni():\n    sys.stdout.write(\" Checking for jni                      \")\n    global has_jni\n    global has_android_makefile\n    global has_application_makefile\n    if not os.path.exists(\"jni\"):\n        sys.stdout.write(\"...jni folder NOT FOUND.\\n\")\n        has_jni = False\n\n    if os.path.exists(\"jni\"):\n        if os.path.exists(\"jni/Android.mk\"):\n            has_android_makefile = True\n        if os.path.exists(\"jni/Application.mk\"):\n            has_application_makefile = True\n        if has_android_makefile and has_application_makefile:\n            sys.stdout.write(\"...Found\\n\")\n            has_jni = True\n        else:\n            sys.stdout.write(\"...missing Android.mk or Application.mk\\n\")\n            has_jni = False\n\n\ndef check_ndk():\n    sys.stdout.write(\" Checking for NDK                      \")\n\n    global has_ndk\n\n    #check if ndk-build is already in the path.\n    is_executable = which(\"ndk-build\")\n\n    if is_executable is None:\n        has_ndk = False\n    else:\n        has_ndk = True\n\n    if has_ndk:\n        sys.stdout.write(\"...Found\\n\")\n        has_ndk = True\n        return\n\n    global android_ndk_path\n\n    #check to see if the ndk-build tool is in a typical path and store that in a variable\n    if osx:\n        home = os.path.expanduser(\"~\")\n        if os.path.exists(home + '/Library/Developer/Xamarin/android-ndk'):\n            if glob.glob(home + '/Library/Developer/Xamarin/android-ndk/android-ndk-r??/ndk-build'):\n                has_ndk = True\n                path_to_search = home + '/Library/Developer/Xamarin/android-ndk/'\n\n                only_folders = [d for d in listdir(path_to_search) if isdir(join(path_to_search, d))]\n                most_recent_ndk = only_folders[-1]\n\n                android_ndk_path = home + '/Library/Developer/Xamarin/android-ndk/' + most_recent_ndk + '/'\n            else:\n                has_ndk = False\n\n    if windows:\n        progfiles = os.environ[\"ProgramW6432\"]\n        if os.path.exists(progfiles + '/Android/ndk/'):\n            if glob.glob(progfiles + '/Android/ndk/android-ndk-r??/ndk-build'):\n                has_ndk = True\n                path_to_search = progfiles + '/Android/ndk/'\n\n                only_folders = [d for d in listdir(path_to_search) if isdir(join(path_to_search, d))]\n                most_recent_ndk = only_folders[-1]\n\n                android_ndk_path = progfiles + '/Android/ndk/' + most_recent_ndk + '/'\n\n                #the ndk does not allow spaces in its path on windows, so we need to copy the ndk to the\n                #root folder so that we can run it from there.\n\n                #check to see if the ndk has been copied already\n                drive_prefix = os.path.splitdrive(sys.executable)[0]\n                android_on_root_path = drive_prefix + '\\\\' + 'Android\\\\' + 'ndk\\\\' + most_recent_ndk + '\\\\'\n\n                if os.path.exists(android_on_root_path):\n                    android_ndk_path = android_on_root_path\n                else:\n                    sys.stdout.write(\"...Copying\")\n                    distutils.dir_util.copy_tree(android_ndk_path, android_on_root_path, True, True)\n                    android_ndk_path = android_on_root_path\n\n            else:\n                has_ndk = False\n\n    if has_ndk:\n        sys.stdout.write(\"...Found\\n\")\n    else:\n        sys.stdout.write(\"...ndk NOT FOUND\\n\")\n\n\ndef check_opennurbs():\n    sys.stdout.write(\" Checking for opennurbs                \")\n    global has_openNURBS\n    if os.path.exists(\"opennurbs/opennurbs.xcodeproj\"):\n        sys.stdout.write(\"...Found\\n\")\n        has_openNURBS = True\n    else:\n        sys.stdout.write(\"...opennurbs NOT FOUND\\n\")\n        has_openNURBS = False\n\n\ndef check_xcodeproj():\n    sys.stdout.write(\" Checking for xcodeproj                \")\n    global has_xcodeProj\n    if os.path.exists(\"rhcommon_opennurbs.xcodeproj\"):\n        sys.stdout.write(\"...Found\\n\")\n        has_xcodeProj = True\n    else:\n        sys.stdout.write(\"...rhcommon_opennurbs.xcodeproj NOT FOUND\\n\")\n        has_xcodeProj = False\n\n\ndef check_xcode_tools():\n    sys.stdout.write(\" Checking for XCode command line tools \")\n    global has_xcodeTools\n\n    if which(\"xcodebuild\") is None:\n        sys.stdout.write(\"...xcodebuild NOT FOUND\\n\")\n        has_xcodeTools = False\n    else:\n        sys.stdout.write(\"...Found\\n\")\n        has_xcodeTools = True\n\n\ndef check_lipo():\n    sys.stdout.write(\" Checking for lipo                     \")\n    global has_lipo\n\n    if which(\"lipo\") is None:\n        sys.stdout.write(\"...lipo NOT FOUND\\n\")\n        has_lipo = False\n    else:\n        sys.stdout.write(\"...Found\\n\")\n        has_lipo = True\n\n\ndef check_has_built_for_android():\n    sys.stdout.write(\" Checking for existing builds          \")\n    global has_built_android\n    if os.path.exists(\"build/Release-android/libs/armeabi/libopennurbs.so\") and os.path.exists(\"build/Release-android/libs/armeabi-v7a/libopennurbs.so\") and os.path.exists(\"build/Release-android/libs/x86/libopennurbs.so\"):\n        sys.stdout.write(\"...Found\\n\")\n        has_built_android = True\n    else:\n        sys.stdout.write(\"...Not Found\\n\")\n        has_built_android = False\n\n\ndef check_has_built_for_ios():\n    sys.stdout.write(\" Checking for existing builds          \")\n    global has_built_ios\n    if os.path.exists(\"build/Release-ios/libopennurbs.a\"):\n        sys.stdout.write(\"...Found\\n\")\n        has_built_ios = True\n    else:\n        sys.stdout.write(\"...Not Found\\n\")\n        has_built_ios = False\n\n\ndef check_has_built_for_osx():\n    sys.stdout.write(\" Checking for existing builds          \")\n    global has_built_osx\n    if os.path.exists(\"build/Release-osx/libopennurbs.dylib\"):\n        sys.stdout.write(\"...Found\\n\")\n        has_built_osx = True\n    else:\n        sys.stdout.write(\"...Not Found\\n\")\n        has_built_osx = False\n\n\ndef create_build_folders_for_ios():\n    if not os.path.exists(\"build\"):\n        os.mkdir(\"build\")\n\n    #check to make sure the folder was created successfully\n    if not os.path.exists(\"build\"):\n        print \"ERROR: Unable to create build folders.  Please make sure you have admin privileges and try again.\"\n        sys.exit()\n\n    if not os.path.exists(\"build/Release-ios\"):\n        os.mkdir(\"build/Release-ios\")\n\n    #check to make sure the folder was created successfully\n    if not os.path.exists(\"build/Release-ios\"):\n        print \"ERROR: Unable to create build folders.  Please make sure you have admin privileges and try again.\"\n        sys.exit()\n\n\ndef create_build_folders_for_android():\n    if not os.path.exists(\"build\"):\n        os.mkdir(\"build\")\n\n    #check to make sure the folder was created successfully\n    if not os.path.exists(\"build\"):\n        print \"ERROR: Unable to create build folders.  Please make sure you have admin privileges and try again.\"\n        sys.exit()\n\n    if not os.path.exists(\"build/Release-android\"):\n        os.mkdir(\"build/Release-android\")\n\n    #check to make sure the folder was created successfully\n    if not os.path.exists(\"build/Release-android\"):\n        print \"ERROR: Unable to create build folders.  Please make sure you have admin privileges and try again.\"\n        sys.exit()\n\n\ndef create_build_folders_for_osx():\n    if not os.path.exists(\"build\"):\n        os.mkdir(\"build\")\n\n    #check to make sure the folder was created successfully\n    if not os.path.exists(\"build\"):\n        print \"ERROR: Unable to create build folders.  Please make sure you have admin privileges and try again.\"\n        sys.exit()\n\n    if not os.path.exists(\"build/Release-osx\"):\n        os.mkdir(\"build/Release-osx\")\n\n    #check to make sure the folder was created successfully\n    if not os.path.exists(\"build/Release-osx\"):\n        print \"ERROR: Unable to create build folders.  Please make sure you have admin privileges and try again.\"\n        sys.exit()\n\n\ndef build_for_android():\n    print \"\"\n    print \"Android Build---------------------------------------------------\"\n    print \"WARNING: go get coffee, this can take 20 minutes.\"\n    print \"Making libopennurbs.so for Android...\"\n    if osx:\n        ndk_command = \"ndk-build\"\n    if windows:\n        ndk_command = \"ndk-build.cmd\"\n\n    ndk_build = android_ndk_path + ndk_command\n\n    if verbose:\n        subprocess.call(ndk_build)\n    else:\n        devnull = open(os.devnull, 'w')\n        subprocess.call(ndk_build, stdout=devnull, stderr=devnull)\n\n    #cleanup any old builds...\n    if os.path.exists(\"build/Release-android/libs\"):\n        shutil.rmtree(\"build/Release-android/libs\")\n\n    #move the new build into the proper location...\n    if os.path.exists(\"libs\"):\n        shutil.move(\"libs\", \"build/Release-android\")\n\n    #cleanup objects...\n    if os.path.exists(\"obj\"):\n        shutil.rmtree(\"obj\")\n\n    global did_build_android_successfully\n    did_build_android_successfully = True\n\n\ndef build_for_ios():\n    print \"\"\n    print \"iOS Build-------------------------------------------------------\"\n    print \"Making static libopennurbs.a for iOS...\"\n\n    sys.stdout.write(\" Compiling i386 version                \")\n    if verbose:\n        subprocess.call([\"xcodeBuild\", \"-project\", \"rhcommon_opennurbs.xcodeproj\", \"-target\", \"rhcommon_opennurbs_ios\", \"-sdk\", \"iphonesimulator\", \"-configuration\", \"Release\", \"clean\", \"build\"])\n    else:\n        devnull = open(os.devnull, 'w')\n        subprocess.call([\"xcodeBuild\", \"-project\", \"rhcommon_opennurbs.xcodeproj\", \"-target\", \"rhcommon_opennurbs_ios\", \"-sdk\", \"iphonesimulator\", \"-configuration\", \"Release\", \"clean\", \"build\"], stdout=devnull, stderr=devnull)\n\n    if os.path.exists(\"build/Release-iphonesimulator/librhcommon_opennurbs_ios.a\"):\n        shutil.move(\"build/Release-iphonesimulator/librhcommon_opennurbs_ios.a\", \"build/Release-ios/libopennurbs-i386.a\")\n        sys.stdout.write(\"...Done\\n\")\n    else:\n        sys.stdout.write(\"...FAILED\\n\")\n        sys.exit()\n\n    sys.stdout.write(\" Compiling armv7 version               \")\n    if verbose:\n        subprocess.call([\"xcodeBuild\", \"-project\", \"rhcommon_opennurbs.xcodeproj\", \"-target\", \"rhcommon_opennurbs_ios\", \"-sdk\", \"iphoneos\", \"-arch\", \"armv7\", \"-configuration\", \"Release\", \"clean\", \"build\"])\n    else:\n        devnull = open(os.devnull, 'w')\n        subprocess.call([\"xcodeBuild\", \"-project\", \"rhcommon_opennurbs.xcodeproj\", \"-target\", \"rhcommon_opennurbs_ios\", \"-sdk\", \"iphoneos\", \"-arch\", \"armv7\", \"-configuration\", \"Release\", \"clean\", \"build\"], stdout=devnull, stderr=devnull)\n\n    if os.path.exists(\"build/Release-iphoneos/librhcommon_opennurbs_ios.a\"):\n        shutil.move(\"build/Release-iphoneos/librhcommon_opennurbs_ios.a\", \"build/Release-ios/libopennurbs-armv7.a\")\n        sys.stdout.write(\"...Done\\n\")\n    else:\n        sys.stdout.write(\"...FAILED\\n\")\n        sys.exit()\n\n    sys.stdout.write(\" Compiling armv7s version              \")\n    if verbose:\n        subprocess.call([\"xcodeBuild\", \"-project\", \"rhcommon_opennurbs.xcodeproj\", \"-target\", \"rhcommon_opennurbs_ios\", \"-sdk\", \"iphoneos\", \"-arch\", \"armv7s\", \"-configuration\", \"Release\", \"clean\", \"build\"])\n    else:\n        devnull = open(os.devnull, 'w')\n        subprocess.call([\"xcodeBuild\", \"-project\", \"rhcommon_opennurbs.xcodeproj\", \"-target\", \"rhcommon_opennurbs_ios\", \"-sdk\", \"iphoneos\", \"-arch\", \"armv7s\", \"-configuration\", \"Release\", \"clean\", \"build\"], stdout=devnull, stderr=devnull)\n\n    if os.path.exists(\"build/Release-iphoneos/librhcommon_opennurbs_ios.a\"):\n        shutil.move(\"build/Release-iphoneos/librhcommon_opennurbs_ios.a\", \"build/Release-ios/libopennurbs-armv7s.a\")\n        sys.stdout.write(\"...Done\\n\")\n    else:\n        sys.stdout.write(\"...FAILED\\n\")\n        sys.exit()\n\n    sys.stdout.write(\" Compiling arm64 version               \")\n    if verbose:\n        subprocess.call([\"xcodeBuild\", \"-project\", \"rhcommon_opennurbs.xcodeproj\", \"-target\", \"rhcommon_opennurbs_ios\", \"-sdk\", \"iphoneos\", \"-arch\", \"arm64\", \"-configuration\", \"Release\", \"clean\", \"build\"])\n    else:\n        devnull = open(os.devnull, 'w')\n        subprocess.call([\"xcodeBuild\", \"-project\", \"rhcommon_opennurbs.xcodeproj\", \"-target\", \"rhcommon_opennurbs_ios\", \"-sdk\", \"iphoneos\", \"-arch\", \"arm64\", \"-configuration\", \"Release\", \"clean\", \"build\"], stdout=devnull, stderr=devnull)\n\n    if os.path.exists(\"build/Release-iphoneos/librhcommon_opennurbs_ios.a\"):\n        shutil.move(\"build/Release-iphoneos/librhcommon_opennurbs_ios.a\", \"build/Release-ios/libopennurbs-arm64.a\")\n        sys.stdout.write(\"...Done\\n\")\n    else:\n        sys.stdout.write(\"...FAILED\\n\")\n        sys.exit()\n\n    sys.stdout.write(\" Creating Universal Binary             \")\n    if verbose:\n        subprocess.call([\"lipo\", \"-create\", \"-output\", \"build/Release-ios/libopennurbs.a\", \"build/Release-ios/libopennurbs-i386.a\", \"build/Release-ios/libopennurbs-armv7.a\", \"build/Release-ios/libopennurbs-armv7s.a\", \"build/Release-ios/libopennurbs-arm64.a\"])\n    else:\n        devnull = open(os.devnull, 'w')\n        subprocess.call([\"lipo\", \"-create\", \"-output\", \"build/Release-ios/libopennurbs.a\", \"build/Release-ios/libopennurbs-i386.a\", \"build/Release-ios/libopennurbs-armv7.a\", \"build/Release-ios/libopennurbs-armv7s.a\", \"build/Release-ios/libopennurbs-arm64.a\"], stdout=devnull, stderr=devnull)\n\n    sys.stdout.write(\"...Done\\n\")\n\n    global did_build_ios_successfully\n    did_build_ios_successfully = True\n\n\ndef build_for_osx():\n    print \"\"\n    print \"OSX Build-------------------------------------------------------\"\n    print \"Making dynamic libopennurbs.dylib for OSX...\"\n\n    sys.stdout.write(\" Compiling Universal version           \")\n    if verbose:\n        subprocess.call([\"xcodeBuild\", \"-project\", \"rhcommon_opennurbs.xcodeproj\", \"-target\", \"rhcommon_opennurbs_monomac\", \"-configuration\", \"Release\", \"clean\", \"build\"])\n    else:\n        devnull = open(os.devnull, 'w')\n        subprocess.call([\"xcodeBuild\", \"-project\", \"rhcommon_opennurbs.xcodeproj\", \"-target\", \"rhcommon_opennurbs_monomac\", \"-configuration\", \"Release\", \"clean\", \"build\"], stdout=devnull, stderr=devnull)\n\n    if os.path.exists(\"build/Release/librhcommon_opennurbs_monomac.dylib\"):\n        shutil.move(\"build/Release/librhcommon_opennurbs_monomac.dylib\", \"build/Release-osx/libopennurbs.dylib\")\n        sys.stdout.write(\"...Done\\n\")\n    else:\n        sys.stdout.write(\"...FAILED\\n\")\n        sys.exit()\n\n    sys.stdout.write(\"...Done\\n\")\n\n    global did_build_for_osx_successfully\n    did_build_for_osx_successfully = True\n\n\ndef write_android_finished_message():\n    print \"STATUS: Android Build Complete.  Libraries are in build/Release-android/libs\"\n\n\ndef write_ios_finished_message():\n    print \"STATUS: iOS Build Complete.  Libraries are in build/Release-ios\"\n\n\ndef write_osx_finished_message():\n    print \"STATUS: OS X Build Complete.  Libraries are in build/Release-osx\"\n\n\ndef which(program):\n    def is_exe(fpath):\n        return os.path.isfile(fpath) and os.access(fpath, os.X_OK)\n\n    fpath, fname = os.path.split(program)\n    if fpath:\n        if is_exe(program):\n            return program\n    else:\n        for path in os.environ[\"PATH\"].split(os.pathsep):\n            path = path.strip('\"')\n            exe_file = os.path.join(path, program)\n            if is_exe(exe_file):\n                return exe_file\n\n    return None\n\n\ndef usage():\n    print \"\"\n    print(\"build_native.py - script for building native openNURBS library\")\n    print \"usage: ./build_native.py -p [argument] --check --help --verbose\"\n    print \"\"\n    print \" option:            arguments:    description:\"\n    print \" ---------------    ----------    ---------------------------------------\"\n    print \" -p   --platform    all           build libopennurbs for all platforms\"\n    print \"                    android       build libopennurbs.so for Android\"\n    if osx:\n        print \"                    ios           build libopennurbs.so for iOS\"\n        print \"                    osx           build libopennurbs.dylib for OS X\"\n    print \" -c   --check       all           pre-requisites check for all platforms\"\n    print \"                    android       pre-requisites check for Android\"\n    if osx:\n        print \"                    ios           pre-requisites check for iOS\"\n        print \"                    osx           pre-requisites check for OS X\"\n    print \" -h   --help                      display this screen\"\n    print \" -v   --verbose                   show verbose build messages\"\n    print \" -o   --overwrite                 overwrite existing builds\"\n    print \"\"\n    print \"Examples:\"\n    if windows:\n        print \"build_native.py -c android     (check pre-requisites for Android)\"\n        print \"build_native.py -p android -o  (build for android overwriting existing)\"\n    if osx:\n        print \"./build_native.py -p all         (build for all platforms)\"\n        print \"./build_native.py -p ios -v      (build iOS with verbose messages)\"\n        print \"./build_native.py -c android     (check pre-requisites for Android)\"\n        print \"./build_native.py -p android -o  (build for android overwriting existing)\"\n    print \"\"\n    print \"NOTE: Builds are stored in the build/Release-[platform]/ folder.\"\n    print \"\"\n    return\n\n\ndef main():\n    try:\n        opts, args = getopt.getopt(sys.argv[1:], \"hvoc:p:\", [\"help\", \"verbose\", \"overwrite\", \"check=\", \"platform=\"])\n    except getopt.GetoptError as err:\n        # print help information and exit:\n        usage()\n        sys.exit(2)\n    platform = None\n    check = None\n\n    #check os\n    global linux\n    global osx\n    global windows\n\n    if _platform == \"linux\" or _platform == \"linux2\":\n        linux = True\n    elif _platform == \"darwin\":\n        osx = True\n    elif _platform == \"win32\" or _platform == \"cygwin\":\n        windows = True\n\n    for o, a in opts:\n        if o == \"-v\" or o == \"--verbose\":\n            global verbose\n            verbose = True\n        elif o == \"-o\" or o == \"--overwrite\":\n            global overwrite\n            overwrite = True\n        elif o in (\"-h\", \"--help\"):\n            usage()\n            sys.exit()\n        elif o in (\"-p\", \"--platform\"):\n            platform = a\n        elif o in (\"-c\", \"--check\"):\n            check = a\n        else:\n            assert False, \"unhandled option\"\n\n    #user has not entered any arguments...\n    if platform is None and check is None:\n        usage()\n        sys.exit()\n\n    #check prerequisites\n    if check == \"all\":\n        check_android()\n        if osx:\n            check_ios()\n            check_osx()\n    elif check == \"android\":\n        check_android()\n    elif check == \"ios\":\n        if osx:\n            check_ios()\n        else:\n            print (\"ERROR: Targeting iOS or OS X requires running this script on Mac OSX 10.9.2 +\")\n    elif check == \"osx\":\n        if osx:\n            check_osx()\n        else:\n            print (\"ERROR: Targeting iOS or OS X requires running this script on Mac OSX 10.9.2 +\")\n\n    #platform compiles\n    if platform == \"all\":\n        check_android()\n        if osx:\n            check_ios()\n            check_osx()\n\n        if overwrite or not has_built_android:\n            create_build_folders_for_android()\n        elif has_built_android and not overwrite:\n            print (\"STATUS: Existing Android build found.  NOT BUILDING.  (Use -o argument to overwrite existing.)\")\n\n        if osx:\n            if overwrite or not has_built_ios:\n                create_build_folders_for_ios()\n            elif has_built_ios and not overwrite:\n                print (\"STATUS: Existing iOS build found.  NOT BUILDING.  (Use -o argument to overwrite existing.)\")\n\n            if overwrite or not has_built_osx:\n                create_build_folders_for_osx()\n            elif has_built_osx and not overwrite:\n                print (\"STATUS: Existing OS X build found.  NOT BUILDING.  (Use -o argument to overwrite existing.)\")\n\n        if overwrite and is_ready_for_android_build:\n            build_for_android()\n        elif not has_built_android and is_ready_for_android_build:\n            build_for_android()\n\n        if osx:\n            if overwrite and is_ready_for_ios_build:\n                build_for_ios()\n            elif not has_built_ios and is_ready_for_ios_build:\n                build_for_ios()\n\n            if overwrite and is_ready_for_osx_build:\n                build_for_osx()\n            elif not has_built_osx and is_ready_for_osx_build:\n                build_for_osx()\n\n        if did_build_android_successfully:\n            write_android_finished_message()\n\n        if osx:\n            if did_build_ios_successfully:\n                write_ios_finished_message()\n            if did_build_for_osx_successfully:\n                write_osx_finished_message()\n\n    elif platform == \"android\":\n        check_android()\n\n        if has_built_android and not overwrite:\n            print (\"STATUS: Existing build found.  NOT BUILDING.  Use -o argument to overwrite the existing builds\")\n            sys.exit()\n\n        if overwrite or not has_built_android:\n            create_build_folders_for_android()\n\n            if is_ready_for_android_build:\n                build_for_android()\n            else:\n                sys.exit()\n\n            if did_build_android_successfully:\n                write_android_finished_message()\n\n    elif platform == \"ios\":\n        if osx:\n            check_ios()\n        else:\n            print (\"ERROR: Targeting iOS or OS X requires running this script on Mac OSX 10.9.2 +\")\n            sys.exit()\n\n        if has_built_ios and not overwrite:\n            print (\"STATUS: Existing build found.  NOT BUILDING.  Use -o argument to overwrite the existing builds\")\n            sys.exit()\n\n        if overwrite or not has_built_ios:\n            create_build_folders_for_ios()\n\n            if is_ready_for_ios_build:\n                build_for_ios()\n            else:\n                sys.exit()\n\n            if did_build_ios_successfully:\n                write_ios_finished_message()\n\n    elif platform == \"osx\":\n        if osx:\n            check_osx()\n        else:\n            print (\"ERROR: Targeting iOS or OS X requires running this script on Mac OSX 10.9.2 +\")\n            sys.exit()\n\n        if has_built_osx and not overwrite:\n            print (\"STATUS: Existing build found.  NOT BUILDING.  Use -o argument to overwrite the existing builds\")\n            sys.exit()\n\n        if overwrite or not has_built_osx:\n            create_build_folders_for_osx()\n\n            if is_ready_for_osx_build:\n                build_for_osx()\n            else:\n                sys.exit()\n\n            if did_build_for_osx_successfully:\n                write_osx_finished_message()\n\n\nif __name__ == \"__main__\":\n    main()\n",
  "language": "python",
  "imports": [],
  "has_docstring": false
}