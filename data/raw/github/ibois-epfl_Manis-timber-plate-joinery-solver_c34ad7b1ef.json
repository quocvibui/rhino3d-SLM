{
  "source_url": "https://github.com/ibois-epfl/Manis-timber-plate-joinery-solver/blob/9b0d22db181d4f55f01816440a5c0a31cda502bc/Gh%20compilation%20files/finger.py",
  "repo": "ibois-epfl/Manis-timber-plate-joinery-solver",
  "repo_stars": 12,
  "repo_description": "A grasshopper plugin to create joints between timber panels and export CNC toolpath and robot trajectories for fully automated workflow from design to fabrication to assembly.",
  "license": "MIT",
  "filepath": "Gh compilation files/finger.py",
  "instruction": "Create Finger Joints between plates with Side to Side connections",
  "code": "\"\"\"Create Finger Joints between plates with Side to Side connections\"\"\"\n\nfrom ghpythonlib.componentbase import dotnetcompiledcomponent as component\nimport Grasshopper, GhPython\nimport System\nimport copy\nfrom Grasshopper import DataTree\nfrom Grasshopper.Kernel.Data import GH_Path\n\n__author__ = \"Nicolas Rogeau\"\n__laboratory__ = \"IBOIS, Laboratory for Timber Construction\" \n__university__ = \"EPFL, Ecole Polytechnique Federale de Lausanne\"\n__funding__ = \"NCCR Digital Fabrication, ETH Zurich\"\n__version__ = \"2021.09\"\n\nclass MyComponent(component):\n    def __new__(cls):\n        instance = Grasshopper.Kernel.GH_Component.__new__(cls,\n            \"Add Finger Joint\", \"Finger\", \"\"\"Create Finger Joints between plates with Side to Side connections\"\"\", \"Manis\", \"Joints\")\n        return instance\n    \n    def get_ComponentGuid(self):\n        return System.Guid(\"191889c6-73a6-49ef-880c-055a74471e3f\")\n    \n    def SetUpParam(self, p, name, nickname, description):\n        p.Name = name\n        p.NickName = nickname\n        p.Description = description\n        p.Optional = True\n    \n    def RegisterInputParams(self, pManager):\n        p = Grasshopper.Kernel.Parameters.Param_GenericObject()\n        self.SetUpParam(p, \"model\", \"model\", \"Plate model.\")\n        p.Access = Grasshopper.Kernel.GH_ParamAccess.item\n        self.Params.Input.Add(p)\n        \n        p = Grasshopper.Kernel.Parameters.Param_String()\n        self.SetUpParam(p, \"plates_pairs\", \"plates_pairs\", \"(Optional) List of pair of plates (a,b) to only add joints between those plates.\")\n        p.Access = Grasshopper.Kernel.GH_ParamAccess.list\n        self.Params.Input.Add(p)\n        \n        p = Grasshopper.Kernel.Parameters.Param_Number()\n        self.SetUpParam(p, \"finger_number_1\", \"finger_number_1\", \"The number of fingers on the first side.\")\n        p.Access = Grasshopper.Kernel.GH_ParamAccess.item\n        self.Params.Input.Add(p)\n        \n        p = Grasshopper.Kernel.Parameters.Param_Number()\n        self.SetUpParam(p, \"finger_length_1\", \"finger_length_1\", \"(Optional) The length of the fingers on the first side. Default value will fit plate thickness.\")\n        p.Access = Grasshopper.Kernel.GH_ParamAccess.item\n        self.Params.Input.Add(p)\n        \n        p = Grasshopper.Kernel.Parameters.Param_Number()\n        self.SetUpParam(p, \"finger_width_1\", \"finger_width_1\", \"The width of the fingers on the first side.\")\n        p.Access = Grasshopper.Kernel.GH_ParamAccess.item\n        self.Params.Input.Add(p)\n        \n        p = Grasshopper.Kernel.Parameters.Param_Number()\n        self.SetUpParam(p, \"finger_number_2\", \"finger_number_2\", \"The number of fingers on the second side.\")\n        p.Access = Grasshopper.Kernel.GH_ParamAccess.item\n        self.Params.Input.Add(p)\n        \n        p = Grasshopper.Kernel.Parameters.Param_Number()\n        self.SetUpParam(p, \"finger_length_2\", \"finger_length_2\", \"(Optional) The length of the fingers on the second side. Default value will fit plate thickness.\")\n        p.Access = Grasshopper.Kernel.GH_ParamAccess.item\n        self.Params.Input.Add(p)\n        \n        p = Grasshopper.Kernel.Parameters.Param_Number()\n        self.SetUpParam(p, \"finger_width_2\", \"finger_width_2\", \"The width of the fingers on the second side.\")\n        p.Access = Grasshopper.Kernel.GH_ParamAccess.item\n        self.Params.Input.Add(p)\n        \n        p = Grasshopper.Kernel.Parameters.Param_Number()\n        self.SetUpParam(p, \"finger_spacing\", \"finger_spacing\", \"The space between two fingers.\")\n        p.Access = Grasshopper.Kernel.GH_ParamAccess.item\n        self.Params.Input.Add(p)\n        \n        p = Grasshopper.Kernel.Parameters.Param_Number()\n        self.SetUpParam(p, \"finger_shift\", \"finger_shift\", \"(Optional) Shift the fingers from their central position.\")\n        p.Access = Grasshopper.Kernel.GH_ParamAccess.item\n        self.Params.Input.Add(p)\n        \n        p = Grasshopper.Kernel.Parameters.Param_Boolean()\n        self.SetUpParam(p, \"mirror\", \"mirror\", \"Mirror the joint.\")\n        p.Access = Grasshopper.Kernel.GH_ParamAccess.item\n        self.Params.Input.Add(p)\n    \n    def RegisterOutputParams(self, pManager):\n        p = Grasshopper.Kernel.Parameters.Param_GenericObject()\n        self.SetUpParam(p, \"model\", \"model\", \"Updated plate model.\")\n        self.Params.Output.Add(p)\n\n        p = Grasshopper.Kernel.Parameters.Param_Brep()\n        self.SetUpParam(p, \"joints_positives\", \"joints_positives\", \"The joints to add to each plate.\")\n        self.Params.Output.Add(p)\n\n        p = Grasshopper.Kernel.Parameters.Param_Brep()\n        self.SetUpParam(p, \"joints_negatives\", \"joints_negatives\", \"The joints to subtract from each plate.\")\n        self.Params.Output.Add(p)\n\n        p = Grasshopper.Kernel.Parameters.Param_Brep()\n        self.SetUpParam(p, \"joints_keys\", \"joints_keys\", \"The keys to insert in each plate.\")\n        self.Params.Output.Add(p)\n    \n    def SolveInstance(self, DA):\n        p0 = self.marshal.GetInput(DA, 0)\n        p1 = self.marshal.GetInput(DA, 1)\n        p2 = self.marshal.GetInput(DA, 2)\n        p3 = self.marshal.GetInput(DA, 3)\n        p4 = self.marshal.GetInput(DA, 4)\n        p5 = self.marshal.GetInput(DA, 5)\n        p6 = self.marshal.GetInput(DA, 6)\n        p7 = self.marshal.GetInput(DA, 7)\n        p8 = self.marshal.GetInput(DA, 8)\n        p9 = self.marshal.GetInput(DA, 9)\n        p10 = self.marshal.GetInput(DA, 10)\n        result = self.RunScript(p0, p1, p2, p3, p4, p5, p6, p7, p8, p9, p10)\n\n        if result is not None:\n            if not hasattr(result, '__getitem__'):\n                self.marshal.SetOutput(result, DA, 0, True)\n            else:\n                self.marshal.SetOutput(result[0], DA, 0, True)\n                self.marshal.SetOutput(result[1], DA, 1, True)\n                self.marshal.SetOutput(result[2], DA, 2, True)\n                self.marshal.SetOutput(result[3], DA, 3, True)\n\n    def get_Internal_Icon_24x24(self):\n        o = \"iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAJOgAACToAYJjBRwAAABeSURBVEhL5dC7DQAgCEVRZnImZ3ImZ7LBlhhIeC8WforTEW5ASmuKEBEdvaZ9GohsCUTOCtizEVDAG2Y8HGCkA4yzAvZsBBTwhhkPBxjpAOOegH3JalvAWxS5PVB1AojCkAyI180bAAAAAElFTkSuQmCC\"\n        return System.Drawing.Bitmap(System.IO.MemoryStream(System.Convert.FromBase64String(o)))\n\n    \n    def RunScript(self, model, plates_pairs, finger_number_1, finger_length_1, finger_width_1, finger_number_2, finger_length_2, finger_width_2, finger_spacing, finger_shift, mirror):\n        \n        def list_to_datatree(raggedList):\n            rl = raggedList\n            result = DataTree[object]()\n            for i in range(len(rl)):\n                temp = []\n                for j in range(len(rl[i])):\n                    temp.append(rl[i][j])\n                path = GH_Path(i)\n                result.AddRange(temp, path)\n            return result\n\n        joints_positives = []\n        joints_negatives = []\n        joints_keys = []\n\n        if model:\n            model = copy.deepcopy(model)\n            model.add_fingers(plates_pairs,\n                    finger_number_1,\n                    finger_length_1,\n                    finger_width_1,\n                    finger_number_2,\n                    finger_length_2,\n                    finger_width_2,\n                    finger_spacing,\n                    finger_shift,\n                    mirror)\n\n            for plate in model.plates:\n                joints_positives.append(plate.joints_positives)\n                joints_negatives.append(plate.joints_negatives)\n                joints_keys.append(plate.joints_keys)\n            joints_positives = list_to_datatree(joints_positives)\n            joints_negatives = list_to_datatree(joints_negatives)\n            joints_keys = list_to_datatree(joints_keys)\n\n        else: \n            self.AddRuntimeMessage(Grasshopper.Kernel.GH_RuntimeMessageLevel.Warning, 'Waiting to get a model as input.')\n        return (model, joints_positives, joints_negatives, joints_keys)\n\nclass AssemblyInfo(GhPython.Assemblies.PythonAssemblyInfo):\n    def get_AssemblyName(self):\n        return \"Add Finger Joint\"\n    \n    def get_AssemblyDescription(self):\n        return \"\"\"\"\"\"\n\n    def get_AssemblyVersion(self):\n        return \"0.1\"\n\n    def get_AuthorName(self):\n        return \"Nicolas Rogeau\"\n    \n    def get_Id(self):\n        return System.Guid(\"0a987cae-f708-4a0f-93d2-f5efa56520fd\")",
  "language": "python",
  "imports": [
    "ghpythonlib"
  ],
  "has_docstring": true
}