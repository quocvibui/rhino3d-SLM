{
  "source_url": "https://github.com/ladybug-tools/ladybug-legacy/blob/d90db02f2776febbb38100dea26ec0c93e77aa53/src/Ladybug_Set%20Rhino%20Sun.py",
  "repo": "ladybug-tools/ladybug-legacy",
  "repo_stars": 202,
  "repo_description": ":beetle: Ladybug is an environmental plugin for Grasshopper.",
  "license": "NOASSERTION",
  "filepath": "src/Ladybug_Set Rhino Sun.py",
  "instruction": "Use this component to set the Rhino sun from grasshopper and coordinate your Rhino visualizations with the Ladybug weatherfile and other solar parameters.\n-\nProvided by Ladybug 0.0.69\n    Args:\n     ...",
  "code": "# Ladybug: A Plugin for Environmental Analysis (GPL) started by Mostapha Sadeghipour Roudsari\n#\n# This file is part of Ladybug.\n#\n# Copyright (c) 2013-2020, Byron Mardas <byronmardas@gmail.com>\n# Ladybug is free software; you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published\n# by the Free Software Foundation; either version 3 of the License,\n# or (at your option) any later version.\n#\n# Ladybug is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Ladybug; If not, see <http://www.gnu.org/licenses/>.\n#\n# @license GPL-3.0+ <http://spdx.org/licenses/GPL-3.0+>\n\n\n\"\"\"\nUse this component to set the Rhino sun from grasshopper and coordinate your Rhino visualizations with the Ladybug weatherfile and other solar parameters.\n-\nProvided by Ladybug 0.0.69\n    Args:\n        _location: get location from Ladybug_Import epw component. This will update rhino solar system to the correct coordinates and timezone\n        north_: North direction of the model. This can be either an number representing angle, or a vector. (by default North is set on the y axis)\n        _month_: A number that represents the month you want to visualize\n        _day_: A number that represents the Day you want to visualize\n        _hour_: A number that represents the Hour you want to visualize\n        _runIt: Set to True to run the component and position the Rhino Sun.\n    Returns:\n        readMe!: ...\n\"\"\"\n\nghenv.Component.Name = \"Ladybug_Set Rhino Sun\"\nghenv.Component.NickName = 'rhinoSun'\nghenv.Component.Message = 'VER 0.0.69\\nJUL_07_2020'\nghenv.Component.Category = \"LB-Legacy\"\nghenv.Component.SubCategory = \"3 | EnvironmentalAnalysis\"\n#compatibleLBVersion = VER 0.0.59\\nFEB_01_2015\n#compatibleHBVersion = VER 0.0.56\\nFEB_01_2015\ntry: ghenv.Component.AdditionalHelpFromDocStrings = \"2\"\nexcept: pass\n\nimport Grasshopper.Kernel as gh\nimport scriptcontext as sc\nimport Rhino\nimport Rhino.Render.Sun as sun\nimport ghpythonlib.components as ghp\nimport scriptcontext as sc\nimport math\n\ndef checkTheInputs():\n    if (_month_ <= 12 and _month_ >= 1) or _month_ == None:\n        pass\n    else:\n        ghenv.Component.AddRuntimeMessage(gh.GH_RuntimeMessageLevel.Warning, \"_month_ has to be a number between 1 and 12\")\n        return -1\n    \n    if (_day_ <= 31 and _day_ >= 1) or _day_ == None:\n        pass\n    else:\n        ghenv.Component.AddRuntimeMessage(gh.GH_RuntimeMessageLevel.Warning, \"_day_ has to be a number between 1 and 31\")\n        return -1\n    \n    if (_hour_ <= 24 and _hour_ >= 0) or _hour_ == None:\n        if _hour_ == 24:\n            hour = 0\n        else:\n            hour = _hour_\n    else:\n        ghenv.Component.AddRuntimeMessage(gh.GH_RuntimeMessageLevel.Warning, \"_hour_ has to be a number between 1 and 24\")\n        return -1\n    \n    return hour\n\n\ndef main(location, month, day, hour, north, lb_preparation):\n    # Set defaults\n    if month == None:\n        month = 12\n    if day == None:\n        day = 21\n    if hour == None:\n        hour = 12\n    \n    # From _location split and referense latitude, longitude and timezone\n    lat = (location.split(\"\\n\"))[2]\n    latitude = lat.split(\",\")[0]\n    long = (location.split(\"\\n\"))[3]\n    longitude = long.split(\",\")[0]\n    off = (location.split(\"\\n\"))[4]\n    offset = off.split(\",\")[0]\n    offset = int(math.ceil(float(offset)))\n    \n    h = int(math.modf(hour)[1])\n    m = int(60*(math.modf(hour)[0]))\n    date = ghp.ConstructDate(2017,month,day,h,m,0)\n    sunPosition = Rhino.RhinoDoc.ActiveDoc.Lights.Sun\n    sun.Enabled.SetValue(sunPosition,True)\n    sun.TimeZone.SetValue(sunPosition,offset)\n    sun.SetPosition(sunPosition, date, float(latitude), float(longitude)) #Adjust _location and Date of Rhino Sun\n    \n    print \"Sun position latitude / longitude set to: \" + str(latitude) + \" / \" + longitude\n    print \"Sun position date set to: \" + str(date)\n    \n    if sun.Altitude.Info.GetValue(sunPosition) > 0:\n        #set Orientation\n        if north == None:\n            sun.North.SetValue(sunPosition, 90)\n        else:\n            northAngle, northVector = lb_preparation.angle2north(north)\n            sun.North.SetValue(sunPosition, (90+math.degrees(northAngle)))\n            print \"North angle set to : \" + str(math.degrees(northAngle))\n\n\n#If Honeybee or Ladybug is not flying or is an older version, give a warning.\ninitCheck = True\nw = gh.GH_RuntimeMessageLevel.Warning\n#Ladybug check.\nif not sc.sticky.has_key('ladybug_release') == True:\n    initCheck = False\n    print \"You should first let Ladybug fly...\"\n    ghenv.Component.AddRuntimeMessage(w, \"You should first let Ladybug fly...\")\nelse:\n    try:\n        if not sc.sticky['ladybug_release'].isCompatible(ghenv.Component): initCheck = False\n        if sc.sticky['ladybug_release'].isInputMissing(ghenv.Component): initCheck = False\n        lb_preparation = sc.sticky[\"ladybug_Preparation\"]()\n    except:\n        initCheck = False\n        warning = \"You need a newer version of Ladybug to use this compoent.\" + \\\n        \"Use updateLadybug component to update userObjects.\\n\" + \\\n        \"If you have already updated userObjects drag Ladybug_Ladybug component \" + \\\n        \"into canvas and try again.\"\n        ghenv.Component.AddRuntimeMessage(w, warning)\n\n\n#If the intital check is good, run the component.\nif initCheck and _runIt == True:\n    hour = checkTheInputs()\n    if hour != -1:\n        main(_location, _month_, _day_, hour, north_, lb_preparation)\nelif _runIt == False or _runIt == None:\n    Rhino.RhinoDoc.ActiveDoc.Lights.Sun.Enabled = False\n",
  "language": "python",
  "imports": [
    "Rhino",
    "ghpythonlib",
    "scriptcontext"
  ],
  "has_docstring": true
}