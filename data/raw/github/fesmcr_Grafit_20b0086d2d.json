{
  "source_url": "https://github.com/fesmcr/Grafit/blob/0b80fd011af1d84bb50d5cafb684feb331ec3435/examples/rhino/Python%20F5%20Get%20Weight%20Matrix%20As%20Matrix.py",
  "repo": "fesmcr/Grafit",
  "repo_stars": 1,
  "repo_description": null,
  "license": "MIT",
  "filepath": "examples/rhino/Python F5 Get Weight Matrix As Matrix.py",
  "instruction": "Python f5 get weight matrix as matrix",
  "code": "ï»¿import rhinoscriptsyntax as rs\nimport Rhino.Geometry as rg\nimport sys\nimport clr\n\nclr.AddReference(\"System.Core\")\nclr.AddReference(\"System.IO\")\n\nfrom System import Environment\nfrom System.IO import *\n\nif CustomLibPath is not None: \n\t# Check if the assembly is loaded\n\tif \"Grafit\" not in sys.modules: \n\t\tsearchResult = Directory.GetFiles(CustomLibPath, \"Grafit.dll\", SearchOption.AllDirectories)\n\n\t\tif len(searchResult) == 0:\n\t\t\traise Exception(\"Grafit.dll is not found in folder.\")\n\t\t\t\n\t\tLibPathGrafit = searchResult[0] \n\t\tLibPathGrafitRhino = Path.GetDirectoryName(LibPathGrafit) + \"\\\\\"  + \"GrafitRhino.dll\"   \n\t\n\t\tclr.AddReferenceToFileAndPath(LibPathGrafit)\n\t\tclr.AddReferenceToFileAndPath(LibPathGrafitRhino) \nelse:\n\tclr.AddReference(\"Grafit\") \n\tclr.AddReference(\"GrafitRhino\")\n \nfrom System.Linq import *\nfrom Grafit import *\nfrom GrafitRhino import * \n\n#Get Weight Matrix As Rhino Matrix Object \ndm = Graph.GetWeightMatrixById(WeightMatrixIndex);\n\nresult = GrafitRhinoUtils.Get2DDoubleArrayAsMatrix(dm);\n\nn = Graph.NodesCount \n\nfc = range(len(From))\ntc = range(len(To))\n\nif(len(From) == 0): \n\tfc = range(n)\n\tFrom = list(fc)\n\t\nif(len(To) == 0):\n\ttc = range(n) \n\tTo = list(tc)\n\nFromN = len(From);\nToN = len(To);\n\nDistanceMatrix = rg.Matrix(FromN, ToN);\n\nfor i in range(FromN):\n    for j in range(ToN):\n        weight = result[From[i], To[j]]\n        DistanceMatrix[i, j] = weight   \n",
  "language": "python",
  "imports": [
    "Rhino",
    "Rhino.Geometry",
    "rhinoscriptsyntax"
  ],
  "has_docstring": false
}