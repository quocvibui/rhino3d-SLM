{
  "source_url": "https://github.com/jlopezbi/rhinoUnfolder/blob/37abb2c4d2a464e62dbdbb0bde72491dcbfd7343/Unwrap_cmd.py",
  "repo": "jlopezbi/rhinoUnfolder",
  "repo_stars": 8,
  "repo_description": "unwrap meshes in rhino!",
  "license": "GPL-3.0",
  "filepath": "Unwrap_cmd.py",
  "instruction": "Unwrap cmd",
  "code": "import rhino_unwrapper.unfold as unfold\nimport rhino_unwrapper.rhino_inputs as ri\nimport rhino_unwrapper.weight_functions as wf\nimport rhino_unwrapper.mesh as m\nimport rhino_unwrapper.Map as mapper\nimport inspect\n\nreload(unfold)\nreload(ri)\nreload(wf)\nreload(m)\nreload(mapper)\n\n\ndef all_weight_functions():\n    return dict([m for m in inspect.getmembers(wf, inspect.isfunction)])\n\n\n__commandname__ = \"Unwrap\"\n\ndef RunCommand():\n    holeRadius = 0.125/2.0\n    mesh = ri.getMesh(\"Select mesh to unwrap\")\n    if not mesh: return\n    print \"got a mesh: \",\n    print mesh\n    myMesh = m.Mesh(mesh)\n\n    userCuts = ri.getUserCuts(myMesh)\n    if userCuts == None: return\n\n    print all_weight_functions()\n    weightFunction = ri.getOptions_dict(all_weight_functions())\n    island_creator  = unfold.IslandCreator(mapper.Map(myMesh),fold_list,myMesh)\n\n    if mesh and weightFunction:\n        unfolder = unfold.UnFolder()\n        dataMap,net = unfolder.unfold(myMesh,userCuts,weightFunction,holeRadius)\n        net.findInitalSegments() \n        net.draw_edges() \n\n        while True:\n            flatEdge,idx = ri.get_new_cut(\"select new edge on net or mesh\",net,dataMap)\n            # TODO: figure out how to check type or isinstance of flatEdge -> cut\n            # or fold. Maybe avoid this completely by duck typing?\n            # would be something like flatEdge.process_selection.\n            # flatEdge.process_cut_selection. oof. or maybe that is something\n            # that the net should handle. that sounds better. temporary fix for\n            # now\n            if flatEdge.type() == 'FoldEdge':\n                basePoint = flatEdge.getMidPoint(net.flatVerts)\n                xForm,point = ri.getUserTranslate(\"Pick point to translate segment to\",basePoint)\n                if xForm and point:\n                    face = flatEdge.getFaceFromPoint(net.flatFaces,net.flatVerts,point)\n                    segment = net.findSegment(flatEdge,face)\n                    net.copyAndReasign(dataMap,flatEdge,idx,segment,face)\n                    translatedEdges = net.translateSegment(segment,xForm)\n                    net.redrawSegment(translatedEdges)\n            elif flatEdge.type() == 'CutEdge':\n                pass\n            elif flatEdge == None:\n                break\n\nif __name__==\"__main__\":\n    RunCommand()\n",
  "language": "python",
  "imports": [],
  "has_docstring": false
}