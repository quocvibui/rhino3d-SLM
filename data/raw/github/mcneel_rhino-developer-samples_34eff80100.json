{
  "source_url": "https://github.com/mcneel/rhino-developer-samples/blob/HEAD/rhinocommon/snippets/from_rhinocommon/py/ex_screencaptureview.py",
  "repo": "mcneel/rhino-developer-samples",
  "repo_stars": 743,
  "repo_description": "Rhino and Grasshopper developer sample code",
  "license": "NOASSERTION",
  "filepath": "rhinocommon/snippets/from_rhinocommon/py/ex_screencaptureview.py",
  "instruction": "Ex screencaptureview",
  "code": "from scriptcontext import doc\nfrom System.Windows.Forms import *\nimport Rhino.UI\nfrom System import Environment\n\ndef RunCommand():\n  file_name = \"\";\n\n  bitmap = doc.Views.ActiveView.CaptureToBitmap(True, True, True)\n\n  # copy bitmap to clipboard\n  Clipboard.SetImage(bitmap)\n\n\n  # save bitmap to file\n  save_file_dialog = Rhino.UI.SaveFileDialog()\n  save_file_dialog.Filter = \"*.bmp\"\n  save_file_dialog.InitialDirectory = \\\n    Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments)\n\n  if save_file_dialog.ShowDialog() == DialogResult.OK:\n    file_name = save_file_dialog.FileName\n\n  if file_name != \"\":\n    bitmap.Save(file_name)\n\n  return Rhino.Commands.Result.Success\n\nif __name__ == \"__main__\":\n  RunCommand()",
  "language": "python",
  "imports": [
    "Rhino",
    "scriptcontext"
  ],
  "has_docstring": false
}