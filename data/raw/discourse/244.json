{
  "source_url": "https://discourse.mcneel.com/t/pythonscript-for-draw-ball-bearing/244",
  "topic_id": 244,
  "title": "PythonScript for draw ball bearing",
  "question": "Hi All\n\nI condivide the below Python script  for draw  a ball bearing  :\n\n\n# -*- encoding: UTF-8 -*-\n\nimport rhinoscriptsyntax as rs\nimport math\nimport strpunto\ndef EliminaZeri(quota):\n    \"\"\"\n    Elimina gli zeri non significativi dopo il punto decimale\n    quota  > può essere un numero o una stringa\n    ritorna una stringa col numero senza zeri non significativi\n    \"\"\"\n    stringa=str(quota)\n    if \".\" in stringa: \n        k=0\n        while k==0:\n            a=stringa[-1]\n            if a==\"0\" or a==\".\":\n                stringa=stringa[:-1]  #elimina ultimo elemento della stringa\n                if a==\".\":break\n            else:\n                k=1    \n    return stringa\n\ndef orient_2_pt(objs,p1,p2): # funzione per orientare vite vecchia maniera\n    while True:        \n        newobjs=rs.CopyObjects(objs)        \n        ps=rs.GetPoint(\"primo punto applicazione   < Enter per terminare>\")\n        if ps==None:\n            rs.DeleteObjects(newobjs)\n            break\n        rs.EnableRedraw(False)\n        rs.SelectObjects(newobjs)\n        rs.Command(\"group\")\n        rs.EnableRedraw(True)\n        rs.Command(\"-Orient  copy=no  W\"+str(p1)+\" W\"+str(p2)+\" W\"+str(ps)+\"  \",False)\n        rs.UnselectAllObjects()\n\ndef cuscinetto():\n    de=rs.GetDocumentData(\"RMAcuscinettoSfere\",\"de\")\n    di=rs.GetDocumentData(\"RMAcuscinettoSfere\",\"di\")\n    la=rs.GetDocumentData(\"RMAcuscinettoSfere\",\"la\")\n    if de==None:de=\"42\"\n    if di==None: di=\"20\"\n    if la==None: la=\"9\"\n    arritems=[\"Diametro esterno\",\"Diametro interno\",\"Larghezza\"]\n    arrvalue=[de,di,la]\n    newplb=rs.PropertyListBox(arritems,arrvalue,\"Cuscinetto a sfere\",\"immetti i dati\")\n    if newplb!=None:\n        de=float(newplb[0])\n        di=float(newplb[1])\n        la=float(newplb[2])\n    else:return\n    rs.EnableRedraw(False)\n    #definizione variabili per disegnare profilo anello\n    spes=(de-di)/6\n    smi=spes/14       \t#*** SMUSSO INTERNO\n    sme=spes/7\t\t    #*** smusso esterno\n    re=de/2\t\t        #*** raggio esterno ane...",
  "code_blocks": [
    {
      "code": "# -*- encoding: UTF-8 -*-\n\nimport rhinoscriptsyntax as rs\nimport math\nimport strpunto\ndef EliminaZeri(quota):\n    \"\"\"\n    Elimina gli zeri non significativi dopo il punto decimale\n    quota  > può essere un numero o una stringa\n    ritorna una stringa col numero senza zeri non significativi\n    \"\"\"\n    stringa=str(quota)\n    if \".\" in stringa: \n        k=0\n        while k==0:\n            a=stringa[-1]\n            if a==\"0\" or a==\".\":\n                stringa=stringa[:-1]  #elimina ultimo elemento della stringa\n                if a==\".\":break\n            else:\n                k=1    \n    return stringa\n\ndef orient_2_pt(objs,p1,p2): # funzione per orientare vite vecchia maniera\n    while True:        \n        newobjs=rs.CopyObjects(objs)        \n        ps=rs.GetPoint(\"primo punto applicazione   < Enter per terminare>\")\n        if ps==None:\n            rs.DeleteObjects(newobjs)\n            break\n        rs.EnableRedraw(False)\n        rs.SelectObjects(newobjs)\n        rs.Command(\"group\")\n        rs.EnableRedraw(True)\n        rs.Command(\"-Orient  copy=no  W\"+str(p1)+\" W\"+str(p2)+\" W\"+str(ps)+\"  \",False)\n        rs.UnselectAllObjects()\n\ndef cuscinetto():\n    de=rs.GetDocumentData(\"RMAcuscinettoSfere\",\"de\")\n    di=rs.GetDocumentData(\"RMAcuscinettoSfere\",\"di\")\n    la=rs.GetDocumentData(\"RMAcuscinettoSfere\",\"la\")\n    if de==None:de=\"42\"\n    if di==None: di=\"20\"\n    if la==None: la=\"9\"\n    arritems=[\"Diametro esterno\",\"Diametro interno\",\"Larghezza\"]\n    arrvalue=[de,di,la]\n    newplb=rs.PropertyListBox(arritems,arrvalue,\"Cuscinetto a sfere\",\"immetti i dati\")\n    if newplb!=None:\n        de=float(newplb[0])\n        di=float(newplb[1])\n        la=float(newplb[2])\n    else:return\n    rs.EnableRedraw(False)\n    #definizione variabili per disegnare profilo anello\n    spes=(de-di)/6\n    smi=spes/14       \t#*** SMUSSO INTERNO\n    sme=spes/7\t\t    #*** smusso esterno\n    re=de/2\t\t        #*** raggio esterno anello esterno cuscinetto\n    ri=re-spes          #*** raggio interno anello esterno cuscinetto\n    rsfe=spes*1         #*** raggio sfera\n    csfey=(re+ri)/4     #*** centro sfera in Y\n    trc=(la/2)-math.sqrt(rsfe*rsfe-(rsfe/2)*(rsfe/2))\n    if spes*2>=la:\n        rs.MessageBox(\"Misure cuscinetto incongruenti : cambia misure\")\n        return\n    \n    p1=[0,ri,trc]\n    p2=[0,ri,smi]\n    p3=[0,ri+smi,0]\n    p4=[0,re-sme,0]\n    p5=[0,re,sme]\n    p6=[0,re,la-sme]\n    p7=[0,re-sme,la]\n    p8=[0,ri+smi,la]\n    p9=[0,ri,la-smi]\n    p10=[0,ri,la-trc]\n    arrplane=rs.ViewCPlane()\n    p1=rs.XformCPlaneToWorld(p1,arrplane)\n    p2=rs.XformCPlaneToWorld(p2,arrplane)\n    p3=rs.XformCPlaneToWorld(p3,arrplane)\n    p4=rs.XformCPlaneToWorld(p4,arrplane)\n    p5=rs.XformCPlaneToWorld(p5,arrplane)\n    p6=rs.XformCPlaneToWorld(p6,arrplane)\n    p7=rs.XformCPlaneToWorld(p7,arrplane)\n    p8=rs.XformCPlaneToWorld(p8,arrplane)\n    p9=rs.XformCPlaneToWorld(p9,arrplane)\n    p10=rs.XformCPlaneToWorld(p10,arrplane)\n    \n    arrpoints=[p1,p2,p3,p4,p5,p6,p7,p8,p9,p10]\n    idpl=rs.AddPolyline(arrpoints)    \n    \n    #******* arco sede sfera anello esterno  ******\n    pc=[0,re-spes/2,la/2]\n    pc=rs.XformCPlaneToWorld(pc,arrplane)\n    idarco=rs.AddArc3Pt(p10,p1,pc)\n    arrcurve=[idpl,idarco]\n    pistae=rs.JoinCurves(arrcurve,True)\n    #******* mirror profilo anello esterno anello interno ****\n    pa1=[10,(di+de)/4,la/2]  #primo punto  per asse di simmetria\n    pa2=[0,(di+de)/4,la/2]   # secondo punto per asse simmetria\n    pa1=rs.XformCPlaneToWorld(pa1,arrplane)\n    pa2=rs.XformCPlaneToWorld(pa2,arrplane)\n    \n    pistai=rs.MirrorObject(pistae[0],pa1,pa2,True)\n    #******* creazione anelli con revolve\n    prS=[0,0,0]        #***Start POint Asse Rotazione\n    prE=[0,0,10]       #***End Poinrt Asse Rotazione\n    prS=rs.XformCPlaneToWorld(prS,arrplane)  #trasforma i punti da CPlane a Wplane\n    prE=rs.XformCPlaneToWorld(prE,arrplane)\n    asse=[prS,prE]  #   asse rotazione per revolve\n    ane=rs.AddRevSrf(pistae[0],asse) # anello esterno\n    ani= rs.AddRevSrf(pistai,asse)   #anello interno\n    rs.ObjectColor(ane,[180,180,180])\n    rs.ObjectColor(ani,[180,180,180])\n    rs.DeleteObject(pistae[0])\n    rs.DeleteObject(pistai)\n    sfera=rs.AddSphere(pa2,rsfe)\n    import f_polararray   #funzione che fa il polar array e restituisce l'array delle sfere\n    n=int((re+ri)/rsfe*0.8)    \n    sfere=f_polararray.polararray(sfera,prS,n)\n    de=EliminaZeri(de)\n    di=EliminaZeri(di)\n    la=EliminaZeri(la)\n    rs.ObjectName(ane,\"Cuscinetto Sfere \"+de+\"x\"+di+\"x\"+la)\n    \n    objs=([ane]+[ani]+sfere)\n    rs.EnableRedraw(True)\n    orient_2_pt(objs,prS,prE) # orient ball bearing   \n    rs.DeleteObjects(objs)\n    de=rs.SetDocumentData(\"RMAcuscinettoSfere\",\"de\",str(de))\n    di=rs.SetDocumentData(\"RMAcuscinettoSfere\",\"di\",str(di))\n    la=rs.SetDocumentData(\"RMAcuscinettoSfere\",\"la\",str(la))\ncuscinetto()",
      "language": "python",
      "author": "vittorio",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "file-io",
    "geometry",
    "python",
    "rhinoscriptsyntax",
    "transformation",
    "ui"
  ],
  "has_accepted_answer": false,
  "category_id": 11,
  "posts_count": 7,
  "views": 1866
}