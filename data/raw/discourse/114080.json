{
  "source_url": "https://discourse.mcneel.com/t/getpageviews-or-get-rhinoview-from-file-in-the-rhinocommon-api/114080",
  "topic_id": 114080,
  "title": "GetPageViews or get RhinoView from file in the RhinoCommon API",
  "question": "Hello\n\n\nI´ve been trying to use the \nRhino.Display.ViewCapture.CaptureToBitmap()\n from the RhinoCommon API but it is returning None:\n\n\n\n\nimport Rhino\n\n\nrhino_file_viewtable = rhino_file_instance.Views\n\nviewportinfo = rhino_file_viewtable.FindName(“Top”)\n\n\nrhinoviewport = Rhino.Display.RhinoViewport(viewportinfo)\n\nviewcapturesettings = Rhino.Display.ViewCaptureSettings(rhinoviewport, 400, dpi)\n\nbmp = Rhino.Display.ViewCapture.CaptureToBitmap(viewcapturesettings)\n\nprint (bmp) # RETURNS None\n\n\n\n\nI suspect it is due to the rhinoviewport not being a RhinoView, which is returned by the GetPageViews () when using scriptcontext.\n\n\nAny ideias on how to use the GetPageViews in RhinoCommon API (returning a RhinoView?) or alternativelly, getting a RhinoView from an existing file?\n\n\nThanks",
  "code_blocks": [
    {
      "code": "import Rhino\nimport scriptcontext as sc\nimport System\n\ndef test_view_capture():\n    view = sc.doc.Views.ActiveView\n    if view:\n        view_capture = Rhino.Display.ViewCapture()\n        view_capture.Width = view.ActiveViewport.Size.Width\n        view_capture.Height = view.ActiveViewport.Size.Height\n        view_capture.ScaleScreenItems = False\n        view_capture.DrawAxes = False\n        view_capture.DrawGrid = False\n        view_capture.DrawGridAxes = False\n        view_capture.TransparentBackground = True\n        bitmap = view_capture.CaptureToBitmap(view)\n        if bitmap:\n            path = System.Environment.GetFolderPath(System.Environment.SpecialFolder.Desktop)\n            filename = System.IO.Path.Combine(path, \"test_view_capture.png\")\n            bitmap.Save(filename, System.Drawing.Imaging.ImageFormat.Png)\n\ntest_view_capture()",
      "language": "python",
      "author": "dale",
      "post_number": 4,
      "is_solution": false
    }
  ],
  "tags": [
    "csharp",
    "file-io",
    "python",
    "rhinocommon",
    "transformation"
  ],
  "has_accepted_answer": false,
  "category_id": 11,
  "posts_count": 12,
  "views": 1612
}