{
  "source_url": "https://github.com/dbt-ethz/Axolotl_Python/blob/0938046ecc5e50645d241a330b57734767958b07/code/lVoronoi.py",
  "repo": "dbt-ethz/Axolotl_Python",
  "repo_stars": 59,
  "repo_description": "Volumetric Modelling components for Rhino Grasshopper.",
  "license": "unknown",
  "filepath": "code/lVoronoi.py",
  "instruction": "Creates a voronoi tessellation of space.\n    Inputs:\n        p: list of cell center points\n        l: list of cell center lines\n        t: thickness of the cell walls\n        c: boolean toggle, True:...",
  "code": "\"\"\"Creates a voronoi tessellation of space.\n    Inputs:\n        p: list of cell center points\n        l: list of cell center lines\n        t: thickness of the cell walls\n        c: boolean toggle, True: closed surfaces between cells, False: edge truss only\n    Output:\n        d: the voronoi object (sdf)\"\"\"\n\n__author__     = ['Mathias Bernhard']\n__copyright__  = 'Copyright 2018 / Digital Building Technologies DBT'\n__license__    = 'MIT License'\n__email__      = ['<bernhard@arch.ethz.ch>']\n\nimport rhinoscriptsyntax as rs\nimport Rhino.Geometry as rg\nfrom math import sqrt\n\nclass Voronoi(object):\n    def __init__(self, points=None, lines=None, thickness=1.0):\n        self.points = points\n        self.lines = lines\n        print(len(self.lines))\n        self.thickness = thickness\n\n    def get_distance(self, x, y, z):\n        querypoint = rg.Point3d(x,y,z)\n        distances = []\n\n        # points\n        if self.points is not None:\n            pd = [p.DistanceTo(querypoint) for p in self.points]\n            distances.extend(pd)\n\n        # lines\n        if self.lines is not None:\n            ld = [segment_distance(l, querypoint) for l in self.lines]\n            distances.extend(ld)\n\n        distances.sort()\n        if c:\n            return abs(distances[0]-distances[1]) - self.thickness\n        else:\n            s = sum([abs(distances[i]-distances[(i+1)%3]) for i in range(2)])\n            return s - self.thickness\n\ndef segment_distance(line, point):\n    x1,y1,z1 = line.From\n    x2,y2,z2 = line.To\n    x3,y3,z3 = point\n\n    px = x2-x1\n    py = y2-y1\n    pz = z2-z1\n\n    norm = px*px + py*py + pz*pz\n\n    u = ((x3 - x1) * px + (y3 - y1) * py + (z3 - z1) * pz) / float(norm)\n\n    if u > 1:\n        u = 1\n    elif u < 0:\n        u = 0\n\n    x = x1 + u * px\n    y = y1 + u * py\n    z = z1 + u * pz\n\n    dx = x - x3\n    dy = y - y3\n    dz = z - z3\n\n    # Note: If the actual distance does not matter,\n    # if you only want to compare what this function\n    # returns to other results of this function, you\n    # can just return the squared distance instead\n    # (i.e. remove the sqrt) to gain a little performance\n\n    dist = sqrt(dx*dx + dy*dy + dz*dz)\n\n    return dist\n\n\nif __name__=='__main__':\n    d = Voronoi(points=p, lines=l, thickness=t)\n",
  "language": "python",
  "imports": [
    "Rhino",
    "Rhino.Geometry",
    "rhinoscriptsyntax"
  ],
  "has_docstring": true
}