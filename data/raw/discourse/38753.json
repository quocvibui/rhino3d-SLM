{
  "source_url": "https://discourse.mcneel.com/t/how-to-search-all-rhino-3dm-files-in-a-directory-for-specific-text/38753",
  "topic_id": 38753,
  "title": "How to search all Rhino .3dm files in a directory for specific text?",
  "question": "I know I’ve made a note in a drawing having the phrase “ball bearing” but I’m exasperated looking through all the files one-by-one and am wondering if there’s a better way than opening each file and searching for it.\n\nHuge thanks in advance. ~ David",
  "code_blocks": [
    {
      "code": "import Rhino\nimport System\n\ndef BatchReadNotes(dir):\n    files = System.IO.Directory.GetFiles(dir, '*.3dm', System.IO.SearchOption.AllDirectories)\n\n    for file in files:\n        notes = Rhino.FileIO.File3dm.ReadNotes(file)\n        print \"file: {0} - notes: {1}\".format(file,notes)\n\nif( __name__ == '__main__' ):\n    dir = 'D:\\\\YourDir\\\\Dir'\n    BatchReadNotes(dir)",
      "language": "python",
      "author": "Jess",
      "post_number": 2,
      "is_solution": false
    },
    {
      "code": "import Rhino\nimport System\ndef BatchReadNotes(dir):\nfiles = System.IO.Directory.GetFiles(dir, '*.3dm', System.IO.SearchOption.AllDirectories)\nfor file in files:\nnotes = Rhino.FileIO.File3dm.ReadNotes(file)\nprint \"file: {0} - notes: {1}\".format(file,notes)\nif( name == 'main' ):\ndir = 'D:\\YourDir\\Dir'\nBatchReadNotes(dir)",
      "language": "python",
      "author": "saucerdesigner",
      "post_number": 4,
      "is_solution": false
    },
    {
      "code": "import Rhino\nimport System\nimport rhinoscriptsyntax as rs\n\ndef BatchReadNotes(dir):\n    files = System.IO.Directory.GetFiles(dir, '*.3dm', System.IO.SearchOption.AllDirectories)\n\n    for file in files:\n        notes = Rhino.FileIO.File3dm.ReadNotes(file)\n        print \"file: {0} - notes: {1}\".format(file,notes)\n\nif( __name__ == '__main__' ):\n    dir = rs.BrowseForFolder()\n    if dir:\n        BatchReadNotes(dir)",
      "language": "python",
      "author": "Jess",
      "post_number": 11,
      "is_solution": false
    }
  ],
  "tags": [
    "file-io",
    "python",
    "rhinoscriptsyntax"
  ],
  "has_accepted_answer": false,
  "category_id": 11,
  "posts_count": 15,
  "views": 2941
}