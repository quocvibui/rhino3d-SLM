{
  "source_url": "https://github.com/ladybug-tools/dragonfly-grasshopper/blob/ce3a28392296bf852d4a2f2353f5ef9bc80719a6/dragonfly_grasshopper/src/DF%20ContextShade.py",
  "repo": "ladybug-tools/dragonfly-grasshopper",
  "repo_stars": 2,
  "repo_description": ":dragon: :green_book: Dragonfly plugin for Grasshopper.",
  "license": "AGPL-3.0",
  "filepath": "dragonfly_grasshopper/src/DF ContextShade.py",
  "instruction": "Create Dragonfly ContextShade.\n-",
  "code": "# Dragonfly: A Plugin for Environmental Analysis (GPL)\n# This file is part of Dragonfly.\n#\n# Copyright (c) 2025, Ladybug Tools.\n# You should have received a copy of the GNU Affero General Public License\n# along with Dragonfly; If not, see <http://www.gnu.org/licenses/>.\n# \n# @license AGPL-3.0-or-later <https://spdx.org/licenses/AGPL-3.0-or-later>\n\n\"\"\"\nCreate Dragonfly ContextShade.\n-\n\n    Args:\n        _geo: Rhino Brep geometry.\n        _name_: A name for the ContextShade. If the name is not provided a random\n            name will be assigned.\n        ep_constr_: Optional text for the ContextShade's energy construction to be looked\n            up in the construction library. This can also be a custom construction\n            object. If no energy construction is input here, a default will be\n            assigned.\n        ep_trans_sch_: Optional text for the ContextShade's energy transmittance\n            schedule to be looked up in the schedule library. This can also be a\n            custom schedule object. If no energy schedule is input here, the default\n            will be always opaque.\n        uwg_is_veg_: Boolean to note whether the shade represents a tree canopy within\n            simulations with the Urban Weather Generator (UWG), in which case,\n            it will be incorporated into the simulation as tree cover. NOTE that,\n            when using this option, only the tops and sides of the tree canopy\n            geometry should be modeled. Modeling the bottom of the tree canopy\n            will result in double-counting the horizontal area of the canopy and\n            will also create extra unnessary geometry in EnergyPlus or Radiance\n            calculations using the dragonfly model. (Default: False).\n\n    Returns:\n        report: Reports, errors, warnings, etc.\n        context: Dragonfly ContextShades.\n\"\"\"\n\nghenv.Component.Name = 'DF ContextShade'\nghenv.Component.NickName = 'Context'\nghenv.Component.Message = '1.9.0'\nghenv.Component.Category = 'Dragonfly'\nghenv.Component.SubCategory = '0 :: Create'\nghenv.Component.AdditionalHelpFromDocStrings = '7'\n\ntry:  # import the core honeybee dependencies\n    from honeybee.typing import clean_and_id_string\nexcept ImportError as e:\n    raise ImportError('\\nFailed to import honeybee:\\n\\t{}'.format(e))\n\ntry:  # import the core dragonfly dependencies\n    from dragonfly.context import ContextShade\nexcept ImportError as e:\n    raise ImportError('\\nFailed to import dragonfly:\\n\\t{}'.format(e))\n\ntry:  # import the ladybug_rhino dependencies\n    from ladybug_rhino.togeometry import to_face3d, to_mesh3d\n    from ladybug_rhino.grasshopper import all_required_inputs, longest_list, \\\n        document_counter\nexcept ImportError as e:\n    raise ImportError('\\nFailed to import ladybug_rhino:\\n\\t{}'.format(e))\n\ntry:  # import the honeybee-energy extension\n    from honeybee_energy.lib.constructions import shade_construction_by_identifier\n    from honeybee_energy.lib.schedules import schedule_by_identifier\nexcept ImportError as e:\n    if len(ep_constr_) != 0:\n        raise ValueError('ep_constr_ has been specified but honeybee-energy '\n                         'has failed to import.\\n{}'.format(e))\n    elif len(ep_trans_sch_) != 0:\n        raise ValueError('ep_trans_sch_ has been specified but honeybee-energy '\n                         'has failed to import.\\n{}'.format(e))\n\n# define special meshing parameters that are better for shades\ntry:  # use try/except so that the code is still usable without RhinoCommon\n    import Rhino.Geometry.Mesh as rhm\n    import Rhino.Geometry.MeshingParameters as mp\n    meshing_parameters = mp.FastRenderMesh\nexcept ImportError:\n    rhm, meshing_parameters = None, None\n\n\nif all_required_inputs(ghenv.Component):\n    context = []  # list of context shades that will be returned\n    for i, geo in enumerate(_geo):\n        # get the name for the ContextShade\n        if len(_name_) == 0:  # make a default name\n            display_name = 'Context_{}'.format(document_counter('context_count'))\n        else:\n            display_name = '{}_{}'.format(longest_list(_name_, i), i + 1) \\\n                if len(_name_) != len(_geo) else longest_list(_name_, i)\n        name = clean_and_id_string(display_name)\n\n        # create the ContextShade object\n        lb_geo = [to_mesh3d(geo)] if isinstance(geo, rhm) else \\\n            to_face3d(geo, meshing_parameters)\n        df_shd = ContextShade(name, lb_geo)\n        df_shd.display_name = display_name\n\n        # try to assign the energyplus construction\n        if len(ep_constr_) != 0:\n            ep_constr = longest_list(ep_constr_, i)\n            if isinstance(ep_constr, str):\n                ep_constr = shade_construction_by_identifier(ep_constr)\n            df_shd.properties.energy.construction = ep_constr\n\n        # try to assign the energyplus transmittance schedule\n        if len(ep_trans_sch_) != 0:\n            ep_trans_sch = longest_list(ep_trans_sch_, i)\n            if isinstance(ep_trans_sch, str):\n                ep_trans_sch = schedule_by_identifier(ep_trans_sch)\n            df_shd.properties.energy.transmittance_schedule = ep_trans_sch\n\n        # try to assign the uwg us_vegetation property\n        try:\n            df_shd.properties.uwg.is_vegetation = uwg_is_veg_\n        except AttributeError:\n            pass  # no dragonfly_uwg extension installed\n\n        context.append(df_shd)  # collect the final ContextShades",
  "language": "python",
  "imports": [
    "Rhino",
    "Rhino.Geometry",
    "RhinoCommon"
  ],
  "has_docstring": true
}