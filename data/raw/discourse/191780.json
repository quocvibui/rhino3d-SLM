{
  "source_url": "https://discourse.mcneel.com/t/script-grasshopper-and-eto/191780",
  "topic_id": 191780,
  "title": "Script Grasshopper and Eto",
  "question": "I’m starting to create scripts with grasshopper and Eto, but I’m having some problems, I need help, I have some problems with Eto and Rhino closes when I try to run the preview\n\n\nimport Rhino\nimport rhinoscriptsyntax as rs\nimport Rhino.UI\nimport Eto.Drawing as drawing\nimport Eto.Forms as forms\nimport ghpythonlib.components as ghcomp\nimport Rhino.Geometry as rg\n\nclass CirculosInterface(forms.Form):\n\n    def __init__(self):\n        super().__init__()\n        self.Title = \"Generate Circles\"\n        self.ClientSize = drawing.Size(300, 200)\n        \n        self.curva_input = None\n        self.preview_output = None\n        self.final_output = None\n\n        self.count_label = forms.Label(Text=\"Number of Points\")\n        self.count_box = forms.NumericUpDown(Value=10, MinValue=1, MaxValue=100)\n        \n        self.radius_label = forms.Label(Text=\"Radius of Circles:\")\n        self.radius_box = forms.NumericUpDown(Value=1, MinValue=0.1, MaxValue=10)\n\n        self.seed_label = forms.Label(Text=\"Seeds:\")\n        self.seed_box = forms.NumericUpDown(Value=1, MinValue=1, MaxValue=100)\n\n        self.preview_button = forms.Button(Text=\"Preview\")\n        self.preview_button.Click += self.on_preview_click\n\n        self.generate_button = forms.Button(Text=\"Generate\")\n        self.generate_button.Click += self.on_generate_click\n\n        layout = forms.DynamicLayout()\n        layout.Spacing = drawing.Size(5, 5)\n        layout.AddRow(self.count_label, self.count_box)\n        layout.AddRow(self.radius_label, self.radius_box)\n        layout.AddRow(self.seed_label, self.seed_box)\n        layout.AddRow(self.preview_button, self.generate_button)\n        \n        self.Content = layout\n\n    def on_preview_click(self, sender, e):\n        count = int(self.count_box.Value)\n        radius = float(self.radius_box.Value)\n        seed = int(self.seed_box.Value)\n\n        if self.curva_input is None:\n            self.curva_input = rs.GetObject(\"Select a curve\", rs.filter.curve)\n\n        if self.curva_in...",
  "code_blocks": [
    {
      "code": "preview_circles = []\n            for pt in points:\n                plane = rg.Plane(pt, rg.Vector3d.ZAxis)\n                circle = rg.Circle(plane, radius)\n                preview_circles.append(rs.AddCircle(plane, radius))  # This appears to work\n                # preview_circles.append(rs.AddCircle(circle))  # Results in Rhino crash",
      "language": "python",
      "author": "michaelvollrath",
      "post_number": 2,
      "is_solution": false
    },
    {
      "code": "#! python 2\n\nimport Rhino\nimport rhinoscriptsyntax as rs\nimport Rhino.UI\nimport Eto.Drawing as drawing\nimport Eto.Forms as forms\nimport ghpythonlib.components as ghcomp\nimport Rhino.Geometry as rg\n\n\nclass CirculosInterface(forms.Form):\n\n    def __init__(self):\n        # super().__init__()\n        self.Title = \"Generate Circles\"\n        #self.ClientSize = drawing.Size(300, 150)\n        self.Size = drawing.Size(280, 150)  # Changed to size for more direct control over form size\n        \n        self.curva_input = None\n        self.preview_output = None\n        self.final_output = None\n\n        self.count_label = forms.Label()\n        self.count_label.Text = \"Number of Points\"\n        self.count_box = forms.NumericUpDown(Value=10, MinValue=1, MaxValue=100)\n        \n        self.radius_label = forms.Label()\n        self.radius_label.Text = \"Radius of Circles:\"\n        self.radius_box = forms.NumericUpDown(Value=1, MinValue=0.1, MaxValue=10)\n\n        self.seed_label = forms.Label()\n        self.seed_label.Text = \"Seeds:\"\n        self.seed_box = forms.NumericUpDown(Value=1, MinValue=1, MaxValue=100)\n\n        self.preview_button = forms.Button()\n        self.preview_button.Text = \"Preview\"\n        self.preview_button.Click += self.on_preview_click\n\n        self.generate_button = forms.Button()\n        self.generate_button.Text = \"Generate\"\n        self.generate_button.Click += self.on_generate_click\n\n        layout = forms.DynamicLayout()\n        layout.Spacing = drawing.Size(5, 5)\n        layout.AddRow(None, self.count_label, self.count_box)\n        layout.AddRow(None, self.radius_label, self.radius_box)\n        layout.AddRow(None, self.seed_label, self.seed_box)\n        layout.AddRow(None)  # Add \"spacer\"\n        layout.AddRow(None, self.preview_button, self.generate_button, None)\n        layout.AddRow(None)  # Add \"spacer\"\n        \n        self.Content = layout\n\n    def on_preview_click(self, sender, e):\n        count = int(self.count_box.Value)\n        radius = float(self.radius_box.Value)\n        seed = int(self.seed_box.Value)\n\n        try:\n            if self.curva_input is None:\n                self.curva_input = rs.GetObject(\"Select a curve\", rs.filter.curve)\n\n            if self.curva_input:\n                curva = rs.coercecurve(self.curva_input)\n                points = ghcomp.PopulateGeometry(curva, count, seed)\n\n                if self.preview_output:\n                    rs.DeleteObjects(self.preview_output)\n\n                preview_circles = []\n                for pt in points:\n                    plane = rg.Plane(pt, rg.Vector3d.ZAxis)\n                    circle = rg.Circle(plane, radius)\n                    preview_circles.append(rs.AddCircle(plane, radius))\n                    # preview_circles.append(rs.AddCircle(circle))\n\n                self.preview_output = preview_circles\n\n        except Exception as ex:\n            Rhino.RhinoApp.WriteLine(\"on_preview_click exception: {}\".format(ex))\n\n\n    def on_generate_click(self, sender, e):\n        count = int(self.count_box.Value)\n        radius = float(self.radius_box.Value)\n        seed = int(self.seed_box.Value)\n\n        # Define the World XY plane\n        worldXY = rg.Plane.WorldXY\n\n        try:\n            if self.curva_input:\n                # curva = rs.coercecurve(self.curva_input)\n                points = ghcomp.PopulateGeometry(geometry=self.curva_input, count=count, seed=seed)\n            else:\n                Rhino.RhinoApp.WriteLine(\"curva failed\")\n\n                ghcomp.PopulateGeometry()\n\n                goals = []\n                if points:\n                    for pt in points:\n                        goal = ghcomp.Kangaroo2Component.SphereCollide(points=pt, radius=radius, strength=1)  # Updated arguments and method to inherit from Kangaroo2Component\n                        goals.append(goal)\n                else:\n                    print(\"no points for sphere collide\")\n\n\n                curve_goal = ghcomp.Kangaroo2Component.CurvePointCollide(points=points, plane=worldXY, curve=curva, interior=True, strength=1)  # Updated arguments and method to inherit from Kangaroo2Component\n                result_points = result[0]\n                goals.append(curve_goal)\n\n                # result = ghcomp.KangarooSolver(goals, True, 0.1, 10)\n                result = ghcomp.Kangaroo2Component.Solver(goalobjects=goals, reset=False, on=True, threshold=0.1, tolerance=10)  # Updated arguments and method to inherit from Kangaroo2Component\n                result_points = result[0]\n\n                if self.final_output:\n                    rs.DeleteObjects(self.final_output)\n\n                final_circles = []\n                for pt in result_points:\n                    plane = rg.Plane(pt, rg.Vector3d.ZAxis)\n                    circle = rg.Circle(plane, radius)\n                    final_circles.append(rs.AddCircle(circle))\n\n                self.final_output = final_circles\n            \n        except Exception as ex:\n            Rhino.RhinoApp.WriteLine(\"on_generate_click exception: {}\".format(ex))\n\n\nform = CirculosInterface()\nform.Owner = Rhino.UI.RhinoEtoApp.MainWindow\nform.Show()",
      "language": "python",
      "author": "michaelvollrath",
      "post_number": 2,
      "is_solution": false
    },
    {
      "code": "import Rhino\nimport rhinoscriptsyntax as rs\nimport Rhino.UI\nimport Eto.Drawing as drawing\nimport Eto.Forms as forms\nimport ghpythonlib.components as ghcomp\nimport Rhino.Geometry as rg\n\nclass CirculosInterface(forms.Form):\n\n    def __init__(self):\n        super().__init__()\n        self.Title = \"Generate Circles\"\n        self.ClientSize = drawing.Size(300, 200)\n        \n        self.curva_input = None\n        self.preview_output = None\n        self.final_output = None\n\n        self.count_label = forms.Label(Text=\"Number of Points\")\n        self.count_box = forms.NumericUpDown(Value=10, MinValue=1, MaxValue=100)\n        \n        self.radius_label = forms.Label(Text=\"Radius of Circles:\")\n        self.radius_box = forms.NumericUpDown(Value=1, MinValue=0.1, MaxValue=10)\n\n        self.seed_label = forms.Label(Text=\"Seeds:\")\n        self.seed_box = forms.NumericUpDown(Value=1, MinValue=1, MaxValue=100)\n\n        self.preview_button = forms.Button(Text=\"Preview\")\n        self.preview_button.Click += self.on_preview_click\n\n        self.generate_button = forms.Button(Text=\"Generate\")\n        self.generate_button.Click += self.on_generate_click\n\n        layout = forms.DynamicLayout()\n        layout.Spacing = drawing.Size(5, 5)\n        layout.AddRow(self.count_label, self.count_box)\n        layout.AddRow(self.radius_label, self.radius_box)\n        layout.AddRow(self.seed_label, self.seed_box)\n        layout.AddRow(self.preview_button, self.generate_button)\n        \n        self.Content = layout\n\n    def on_preview_click(self, sender, e):\n        count = int(self.count_box.Value)\n        radius = float(self.radius_box.Value)\n        seed = int(self.seed_box.Value)\n\n        if self.curva_input is None:\n            self.curva_input = rs.GetObject(\"Select a curve\", rs.filter.curve)\n\n        if self.curva_input:\n            curva = rs.coercecurve(self.curva_input)\n            points = ghcomp.PopulateGeometry(curva, count, seed)\n\n            if self.preview_output:\n                rs.DeleteObjects(self.preview_output)\n\n            preview_circles = []\n            for pt in points:\n                plane = rg.Plane(pt, rg.Vector3d.ZAxis)\n                circle = rg.Circle(plane, radius)\n                preview_circles.append(rs.AddCircle(circle))\n\n            self.preview_output = preview_circles\n\n    def on_generate_click(self, sender, e):\n        count = int(self.count_box.Value)\n        radius = float(self.radius_box.Value)\n        seed = int(self.seed_box.Value)\n\n        if self.curva_input:\n            curva = rs.coercecurve(self.curva_input)\n            points = ghcomp.PopulateGeometry(curva, count, seed)\n\n            goals = []\n            for pt in points:\n                goal = ghcomp.SphereCollide(pt, radius, 1)\n                goals.append(goal)\n\n            curve_goal = ghcomp.CurvePointCollide(points, curva, True, 1)\n            goals.append(curve_goal)\n\n            result = ghcomp.KangarooSolver(goals, True, 0.1, 10)\n            result_points = result[0]\n\n            if self.final_output:\n                rs.DeleteObjects(self.final_output)\n\n            final_circles = []\n            for pt in result_points:\n                plane = rg.Plane(pt, rg.Vector3d.ZAxis)\n                circle = rg.Circle(plane, radius)\n                final_circles.append(rs.AddCircle(circle))\n\n            self.final_output = final_circles\n\nform = CirculosInterface()\nform.Owner = Rhino.UI.RhinoEtoApp.MainWindow\nform.Show()",
      "language": "python",
      "author": "Roberto_da_Silva_Kum",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "file-io",
    "geometry",
    "grasshopper",
    "python",
    "rhinocommon",
    "rhinoscriptsyntax",
    "selection"
  ],
  "has_accepted_answer": false,
  "category_id": 11,
  "posts_count": 2,
  "views": 165
}