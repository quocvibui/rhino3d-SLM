{
  "source_url": "https://discourse.mcneel.com/t/getpointonsurface-dont-exit/72865",
  "topic_id": 72865,
  "title": "GetPointOnSurface don't exit",
  "question": "I make script get location of surface but don’t exit. How can fix them?\n\n\nimport rhinoscriptsyntax as rs\nimport scriptcontext as sc\nimport Rhino\n\n    class COT:\n        def __init__(self,loca, txt):\n            self.loca=loca\n            self.txt=txt\n        def getloca(self):\n            return loca\n        def gettxt(self):\n            return txt\n    LitextP=[]\n    def Getlocatxt():\n        while True:\n            msg=\"Select suface:\"\n            srf_filter=Rhino.DocObjects.ObjectType.Surface \n            rc,objref=Rhino.Input.RhinoGet.GetOneObject(msg,False,srf_filter)\n            if not objref:\n                break\n            #pt = rs.SurfaceAreaCentroid(objref)[0]\n            pt=rs.GetPointOnSurface(objref)\n            Loca = rs.coerce3dpoint(pt)\n            text=str(round(Loca[2]))\n            text=text.split('.')\n            text=text[0]\n            #Tao cot\n            IT=COT(Loca,text)\n            LitextP.append(IT)\n            #rs.AddTextDot(\"C\"+text,Loca)\n\n    if __name__==\"__main__\":\n        Getlocatxt()\n        for tp in LitextP:\n            print tp\n\n\n\n\n\nas6\n1539×649 99.1 KB",
  "code_blocks": [
    {
      "code": "import rhinoscriptsyntax as rs\nimport scriptcontext as sc\nimport Rhino\n\n    class COT:\n        def __init__(self,loca, txt):\n            self.loca=loca\n            self.txt=txt\n        def getloca(self):\n            return loca\n        def gettxt(self):\n            return txt\n    LitextP=[]\n    def Getlocatxt():\n        while True:\n            msg=\"Select suface:\"\n            srf_filter=Rhino.DocObjects.ObjectType.Surface \n            rc,objref=Rhino.Input.RhinoGet.GetOneObject(msg,False,srf_filter)\n            if not objref:\n                break\n            #pt = rs.SurfaceAreaCentroid(objref)[0]\n            pt=rs.GetPointOnSurface(objref)\n            Loca = rs.coerce3dpoint(pt)\n            text=str(round(Loca[2]))\n            text=text.split('.')\n            text=text[0]\n            #Tao cot\n            IT=COT(Loca,text)\n            LitextP.append(IT)\n            #rs.AddTextDot(\"C\"+text,Loca)\n\n    if __name__==\"__main__\":\n        Getlocatxt()\n        for tp in LitextP:\n            print tp",
      "language": "python",
      "author": "xiix.xoox",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "file-io",
    "geometry",
    "python",
    "rhinoscriptsyntax"
  ],
  "has_accepted_answer": false,
  "category_id": 11,
  "posts_count": 1,
  "views": 336
}