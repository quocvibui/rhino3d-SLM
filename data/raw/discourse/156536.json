{
  "source_url": "https://discourse.mcneel.com/t/modify-script-to-remove-trailing-zeros/156536",
  "topic_id": 156536,
  "title": "Modify script to remove trailing Zeros",
  "question": "I do have the following script that generates a cutting list and I need to modify so that the generated values to remove the trailing Zeros from the values. I do need 100.5 if it that is the result but the 100.0 to be rounded to 100\n\n\n# -*- coding: utf8 -*-\n\nimport Rhino\nimport Rhino.Geometry as g\nimport rhinoscriptsyntax as rs\nimport codecs\nimport sys\nimport System\nimport Rhino.UI\nimport Eto.Drawing as drawing\nimport Eto.Forms as forms\nimport Rhino.UI\nimport scriptcontext\nimport math\nfrom decimal import Decimal\nimport webbrowser\n\n__commandname__ = \"spec\"\n\nLayersEffect = 0\nDIR = {\"x\":(0,1,2),\n\"y\":(1,0,2),\n\"z\":(2,0,1)}\nAXES = {0:Rhino.Geometry.Vector3d.XAxis,\n1:Rhino.Geometry.Vector3d.YAxis,\n2:Rhino.Geometry.Vector3d.ZAxis\n}\n\ndef computeDims(obj):\n    objRef = Rhino.DocObjects.ObjRef(obj)\n    brep = objRef.Geometry()    \n    edges = list(brep.Edges)\n    edges.sort(key=lambda edge: edge.GetLength(), reverse=True)\n    edge = edges[0]\n    adFaces = list(edge.AdjacentFaces())\n    faces = list(brep.Faces)\n    adFaces = [faces[i] for i in adFaces]\n    adFaces.sort(key=lambda face:face.GetSurfaceSize()[1]*face.GetSurfaceSize()[2],reverse=True)\n    face = adFaces[0]\n    faceNor = face.NormalAt(0,0)\n    origin = edge.PointAtStart\n    xPoint = edge.PointAtEnd\n    xVec = Rhino.Geometry.Vector3d(xPoint-origin)\n    xVec.Unitize()\n    yVec = Rhino.Geometry.Vector3d.CrossProduct(faceNor, xVec)\n    yVec.Unitize()\n    plane = Rhino.Geometry.Plane(origin, xVec, yVec)\n    surf = Rhino.Geometry.PlaneSurface(plane, Rhino.Geometry.Interval(0,1),Rhino.Geometry.Interval(0,1))\n    #scriptcontext.doc.Objects.AddSurface(surf)#!!!!delete\n    verts = list(brep.Vertices)\n    worldPlane = g.Plane.WorldXY\n    tMatrix = g.Transform.ChangeBasis(worldPlane, plane)\n    map(lambda vert:vert.Transform(tMatrix),verts)\n    verts = list(map(lambda vert:vert.Location,verts))\n    verts.sort(key=lambda vert:vert.X)\n    length = (verts[len(verts)-1].X - verts[0].X)*1 # added ()*1\n    verts.sort(key=lambda vert:...",
  "code_blocks": [
    {
      "code": "def ExportObjBBData(data):\n    filter = \"CSV File (*.csv)|*.csv||\"\n    filename = rs.SaveFileName(\"Save data file as\", filter)\n    if not filename: return\n    file = codecs.open(filename, encoding='utf-8', mode='w+')\n    s = \"\"\n    for itm in data:\n        itm = [ i if isinstance(i, str) else str(i) for i in itm]\n######## ADDED CODE START\n        if itm.endswith( '.0' ):\n          itm = itm[ : -2 ]\n######## ADDED CODE END\n        s += \"|\".join(itm)\n        s += \"\\n\"\n    file.write(s)\n    file.close()",
      "language": "python",
      "author": "emilio",
      "post_number": 4,
      "is_solution": false
    },
    {
      "code": "def ExportObjBBData(data):\n    filter = \"CSV File (*.csv)|*.csv||\"\n    filename = rs.SaveFileName(\"Save data file as\", filter)\n    if not filename: return\n    file = codecs.open(filename, encoding='utf-8', mode='w+')\n    s = \"\"\n    for itm in data:\n        itm = [ i if isinstance(i, str) else str(i) for i in itm]\n######## ADDED CODE START\n        for ix in range( len( itm ) ):\n            if itm[ ix ].endswith( '.0' ):\n                itm[ ix ] = itm[ ix ][ : -2 ]\n######## ADDED CODE END\n        s += \"|\".join(itm)\n        s += \"\\n\"\n    file.write(s)\n    file.close()",
      "language": "python",
      "author": "emilio",
      "post_number": 7,
      "is_solution": false
    },
    {
      "code": "def ExportObjBBData(data):\n    filter = \"CSV File (*.csv)|*.csv||\"\n    filename = rs.SaveFileName(\"Save data file as\", filter)\n    if not filename: return\n    file = codecs.open(filename, encoding='utf-8', mode='w+')\n    s = \"\"\n    for itm in data:\n######### THE FOLLOWING LINE HAS BEEN EDITED\n        itm = [ i if isinstance(i, str) else ('%g' % i) for i in itm]\n        s += \"|\".join(itm)\n        s += \"\\n\"\n    file.write(s)\n    file.close()",
      "language": "python",
      "author": "emilio",
      "post_number": 9,
      "is_solution": false
    },
    {
      "code": "def ExportObjBBData(data):\n    filter = \"CSV File (*.csv)|*.csv||\"\n    filename = rs.SaveFileName(\"Save data file as\", filter)\n    if not filename: return\n    file = codecs.open(filename, encoding='utf-8', mode='w+')\n    s = \"\"\n    for itm in data:\n######### THE FOLLOWING LINE HAS BEEN EDITED\n        itm = [ i if isinstance(i, str) else ('%g' % i) for i in itm]\n######### ADDED CODE START\n        for ix in range( len( itm ) ):\n            if itm[ ix ].endswith( '.0' ):\n                itm[ ix ] = itm[ ix ][ : -2 ]\n######### ADDED CODE END        \n        s += \"|\".join(itm)\n        s += \"\\n\"\n    file.write(s)\n    file.close()",
      "language": "python",
      "author": "emilio",
      "post_number": 11,
      "is_solution": false
    },
    {
      "code": "# -*- coding: utf8 -*-\n\nimport Rhino\nimport Rhino.Geometry as g\nimport rhinoscriptsyntax as rs\nimport codecs\nimport sys\nimport System\nimport Rhino.UI\nimport Eto.Drawing as drawing\nimport Eto.Forms as forms\nimport Rhino.UI\nimport scriptcontext\nimport math\nfrom decimal import Decimal\nimport webbrowser\n\n__commandname__ = \"spec\"\n\nLayersEffect = 0\nDIR = {\"x\":(0,1,2),\n\"y\":(1,0,2),\n\"z\":(2,0,1)}\nAXES = {0:Rhino.Geometry.Vector3d.XAxis,\n1:Rhino.Geometry.Vector3d.YAxis,\n2:Rhino.Geometry.Vector3d.ZAxis\n}\n\ndef computeDims(obj):\n    objRef = Rhino.DocObjects.ObjRef(obj)\n    brep = objRef.Geometry()    \n    edges = list(brep.Edges)\n    edges.sort(key=lambda edge: edge.GetLength(), reverse=True)\n    edge = edges[0]\n    adFaces = list(edge.AdjacentFaces())\n    faces = list(brep.Faces)\n    adFaces = [faces[i] for i in adFaces]\n    adFaces.sort(key=lambda face:face.GetSurfaceSize()[1]*face.GetSurfaceSize()[2],reverse=True)\n    face = adFaces[0]\n    faceNor = face.NormalAt(0,0)\n    origin = edge.PointAtStart\n    xPoint = edge.PointAtEnd\n    xVec = Rhino.Geometry.Vector3d(xPoint-origin)\n    xVec.Unitize()\n    yVec = Rhino.Geometry.Vector3d.CrossProduct(faceNor, xVec)\n    yVec.Unitize()\n    plane = Rhino.Geometry.Plane(origin, xVec, yVec)\n    surf = Rhino.Geometry.PlaneSurface(plane, Rhino.Geometry.Interval(0,1),Rhino.Geometry.Interval(0,1))\n    #scriptcontext.doc.Objects.AddSurface(surf)#!!!!delete\n    verts = list(brep.Vertices)\n    worldPlane = g.Plane.WorldXY\n    tMatrix = g.Transform.ChangeBasis(worldPlane, plane)\n    map(lambda vert:vert.Transform(tMatrix),verts)\n    verts = list(map(lambda vert:vert.Location,verts))\n    verts.sort(key=lambda vert:vert.X)\n    length = (verts[len(verts)-1].X - verts[0].X)*1 # added ()*1\n    verts.sort(key=lambda vert:vert.Y)\n    width = (verts[len(verts)-1].Y - verts[0].Y)*1 # added ()*1\n    verts.sort(key=lambda vert:vert.Z)\n    thickness = (verts[len(verts)-1].Z - verts[0].Z)*1 # added ()*1\n    return [[(length)*1,(width)*1,(thickness)*1], [xVec,yVec,faceNor]] # added ()*1\n\nclass attr:\n    def __init__(self, name, isEditable, isOn, valType, exportPos):\n        self.name = name\n        self.isEditable = isEditable\n        self.isOn = isOn\n        self.valType = valType\n        self.exportPos = exportPos\n\nATTRS = (attr(\"N\",True,True,int,1),\nattr(\"Name\",True,True,str,0),\nattr(\"Length\",True,True,int,2),\nattr(\"Width\",True,True,int,3),\nattr(\"Thickness\",True,True,int,4),\nattr(\"Texture\",True,True,str,-1),\nattr(\"Edge_L_0.4\",True,True,str,6),\nattr(\"Edge_W_0.4\",True,True,str,7),\nattr(\"Edge_L\",True,True,str,8),\nattr(\"Edge_W\",True,True,str,9),\nattr(\"Layer\",True,True,str,10),\nattr(\"Comment\",True,True,str,11)\n)\n\nQUANT_FIELD = attr(\"Quantity\",True,True,int,5)\n\nQUANTITY_COLUMN_POS = 5\n\nMAX_DIM_LEN = 2780\nMAX_DIM_WIDTH = 2050\n\nDIM_PRECISION = rs.GetDocumentUserText (\"easy_cut_precision\")\nif DIM_PRECISION==None:\n    DIM_PRECISION = 0\nelse:\n    try:\n        DIM_PRECISION = int(DIM_PRECISION)\n    except:\n        DIM_PRECISION = 0\n\nclass Specification:\n    QUANTITY_COLUMN_POS = 5\n    def __init__(self, attrs, details):\n        self.details = [] #{}\n        idSet = set(range(len(details)))\n        self.table = []\n        while len(idSet)>0:\n            curId = idSet.pop()\n            curDet = details[curId]\n            curDetails = [curDet]\n            idLst = list(idSet)\n            for id in idLst:\n                if curDet == details[id]:\n                    curDetails.append(details[id])\n                    idSet.remove(id)\n            self.details.append(curDetails)\n        self.buildTable()\n    def buildTable(self):\n        self.table = []\n        for details in self.details:\n            specRow = list(details[0].getParams())\n            specRow.insert(self.QUANTITY_COLUMN_POS, len(details))\n            self.table.append(specRow)\n        self.table, self.details = (list(t) for t in zip(*sorted(zip(self.table, self.details), key=lambda x: (int(x[0][0]) if int(x[0][0])>0 else 9999, x[0][10], -float(x[0][4])))))\n    def autoNum(self):\n        i = 1\n        for tableItem in self.table:\n            for detail in self.details[i-1]:\n                detail.N = i\n                detail.refresh()\n            tableItem[0] = i\n            i += 1\n            \n\n\nclass SpecDialog(forms.Dialog[bool]):\n\n    def __init__(self):\n        self.Title = \"EasyCut\"\n        self.selected = []\n        self.edgeshighlightMode = -1\n        self.m_gridview = forms.GridView()\n        self.m_gridview.ShowHeader = True\n        self.Padding = drawing.Padding(10)\n        self.Resizable = True\n        num=0\n        for idx in range(len(ATTRS)):\n            if num == QUANTITY_COLUMN_POS:\n                attr = QUANT_FIELD\n                column = forms.GridColumn()\n                column.HeaderText = attr.name\n                column.Editable = attr.isEditable\n                column.DataCell = forms.TextBoxCell(num)\n                self.m_gridview.Columns.Add(column)\n                num+=1\n            attr = ATTRS[idx]\n            if attr.isOn:\n\n                column = forms.GridColumn()\n                column.HeaderText = attr.name\n                column.Editable = attr.isEditable\n                column.DataCell = forms.TextBoxCell(num)\n                self.m_gridview.Columns.Add(column)\n                num+=1\n                \n        self.precision_dropdownlist = forms.DropDown()\n        self.precision_dropdownlist.DataStore = ['1', '0.1', '0.01', '0.001', '0.0001', '0.00001']\n        self.precision_dropdownlist.SelectedIndex = DIM_PRECISION\n        self.precision_label = forms.Label(Text = \"Dimensions precision \" )\n        self.precision_dropdownlist.DropDownClosed += self.changePrecisionVal\n        \n        layout0 = forms.TableLayout()\n        cell = forms.TableCell(self.precision_label,scaleWidth=False)\n        cell.ScaleWidth = False\n        cell2 = forms.TableCell(self.precision_dropdownlist,scaleWidth=False)\n        cell2.ScaleWidth = False\n        row = forms.TableRow(None, cell, cell2)\n        row.ScaleHeight = False\n        layout0.Rows.Add(row)\n        \n        \n        self.m_gridview.CellClick += self.gridClick\n        self.m_gridview.SelectionChanged += self.gridSelChanged\n        self.m_gridview.CellEdited += self.gridEdited\n        self.m_gridview.CellFormatting += self.OnCellFormatting\n        self.buttonAutoNum = forms.Button(self.buttonAutoNumClick)\n        self.buttonAutoNum.Text = \"Auto number\"\n        self.button = forms.Button(self.buttonClick)\n        self.button.Text = \"Export\"\n        layout = forms.TableLayout()\n        layout.Spacing = drawing.Size(5, 5)\n        cell = forms.TableCell(self.m_gridview)\n        row = forms.TableRow(cell)\n        row.ScaleHeight = True\n        layout.Rows.Add(layout0)\n        layout.Rows.Add(row)\n        \n        layout2 = forms.TableLayout()\n        layout2.Spacing = drawing.Size(5, 5)\n        \n        cell = forms.TableCell(self.button,True)\n        cell2 = forms.TableCell(self.buttonAutoNum,True)\n        row = forms.TableRow([cell,cell2])\n        \n        layout2.Rows.Add(row)\n        layout.Rows.Add(layout2)\n        layout2 = forms.TableLayout()\n        layout2.Spacing = drawing.Size(5, 5)\n        self.m_linkbutton = forms.LinkButton(Text = 'Easycut')\n        self.m_linkbutton.Click += self.OnLinkButtonClick\n        self.m_donatebutton = forms.LinkButton(Text = 'Donate',Style = \"right-align\")\n        self.m_donatebutton.Click += self.OnDonateButtonClick\n        cell = forms.TableCell(self.m_linkbutton,True)\n        cell2 = forms.TableCell(None,False)\n        cell3 = forms.TableCell(self.m_donatebutton,False)\n        row = forms.TableRow([cell,cell2,cell3])\n        layout2.Rows.Add(row)\n        \n        layout.Rows.Add(layout2)\n        \n        self.Content = layout\n        \n    def changePrecisionVal(self, sender, e):\n        global DIM_PRECISION\n        DIM_PRECISION = sender.SelectedIndex\n        rs.SetDocumentUserText (\"easy_cut_precision\", str(DIM_PRECISION))\n        specification = self.spec.details\n        for row in specification:\n            for det in row:\n                det.setDims()\n\n        \n        self.rebuild()\n\n    \n    def OnCellFormatting(self, sender, e):\n        if float(self.spec.table[e.Row][2]) > MAX_DIM_LEN:\n            e.BackgroundColor = drawing.Colors.Red \n    def setData(self, spec):\n        self.spec = spec\n        self.m_gridview.DataStore = spec.table\n\n    def rebuild(self):\n        self.spec.buildTable()\n        #print self.spec.table\n        self.m_gridview.DataStore = self.spec.table\n    def setObjs(self, dic):\n        self.objs = dic\n    def unselectAll(self):\n        for det in self.selected:\n            det.unselect()\n        self.selected = []\n    def gridClick(self,sender,e):\n        row = e.Row\n        col = e.Column\n        dets = self.spec.details[row]\n        self.edgeshighlightMode = -1\n        if col >= 7 and col <= 10:\n            self.edgeshighlightMode = (col - 7)%2\n        self.unselectAll()\n        if self.edgeshighlightMode>=0:\n            for det in dets:\n                det.getEdges(det.lcs[self.edgeshighlightMode])\n        else:\n            for det in dets:\n                det.select()\n            self.selected += dets\n        scriptcontext.doc.Views.Redraw()\n        \n    def gridSelChanged(self,sender,e):\n        self.unselectAll()\n        dets = []\n        for row in sender.SelectedRows:\n            dets += self.spec.details[row]\n        for detLst in self.spec.details:\n            for det in detLst:\n                det.unhighlighAll()\n        scriptcontext.doc.Views.Redraw()\n        if self.edgeshighlightMode >=0:\n            for det in dets:\n                det.getEdges(det.lcs[self.edgeshighlightMode])\n        else:\n           for det in dets:\n               det.select()\n           self.selected += dets\n        scriptcontext.doc.Views.Redraw()\n\n\n    def gridEdited(self, sender, e):\n        row = e.Row\n        col = e.Column\n        dets = self.spec.details[row]\n        cols = self.m_gridview.Columns\n        attr = cols[col].HeaderText\n        val = self.m_gridview.DataStore[row][col]\n        if attr == \"N\":\n            try:\n                int(val)\n            except:\n                val=dets[0].N\n                self.m_gridview.DataStore[row][col] = dets[0].N\n                rs.MessageBox(\"number can be only an integer\")\n        for det in dets:\n            setattr(det, attr, val)\n            det.refresh()\n        self.rebuild()\n    def buttonClick(self, sender, e):\n        data = []\n        nameRow = []\n        cols = [i.HeaderText for i in self.m_gridview.Columns]\n        i = 0\n        num=0\n        curRow = []\n        while i < (len(cols)):\n            if i == QUANT_FIELD.exportPos:\n                exportPos = QUANT_FIELD.exportPos\n                if exportPos>0:\n                    nameRow.append((exportPos,cols[i]))\n                i += 1\n            else:\n                exportPos = ATTRS[num].exportPos\n                if exportPos>=0:\n                    nameRow.append((exportPos,cols[i]))\n                num+=1\n                i += 1\n        nameRow = [i[1] for i in list(sorted(nameRow, key = lambda x: x[0]))]\n        data.append(nameRow)\n                \n        for dataRow in self.m_gridview.DataStore:\n            i = 0\n            num=0\n            curRow = []\n            while i < (len(dataRow)):\n                if i == QUANT_FIELD.exportPos:\n                    exportPos = QUANT_FIELD.exportPos\n                    if exportPos>0:\n                        curRow.append((exportPos,dataRow[i]))\n                    i += 1\n                else:\n                    exportPos = ATTRS[num].exportPos\n                    if exportPos>=0:\n                        curRow.append((exportPos,dataRow[i]))\n                    num+=1\n                    i += 1\n\n            curRow = [i[1] for i in list(sorted(curRow, key = lambda x: x[0]))]\n            data.append(curRow)\n\n        ExportObjBBData(data)\n\n    def buttonAutoNumClick(self, sender, e):\n        self.spec.autoNum()\n        self.rebuild()\n\n    def OnLinkButtonClick(self, sender, e):\n        webbrowser.open(\"https://easycut3d.online\")\n        \n    def OnDonateButtonClick(self, sender, e):\n        webbrowser.open(\"http://easycut3d.online/donate.html\")\n\nclass Detail:\n    def __init__(self, obj):\n        self.obj = obj\n        self.selected = 0\n        self.id = obj\n        attrs = rs.GetUserText (obj)\n        attrs = [i.name for i in ATTRS if i.isEditable]\n        for attr in attrs:\n            setattr(self, attr, rs.GetUserText (str(obj), attr))\n        self.setDims()\n        objRef = Rhino.DocObjects.ObjRef(self.id)\n        obj = objRef.Object()\n        index = obj.Attributes.LayerIndex\n        self.Layer = scriptcontext.doc.Layers[index].Name\n    def setDims(self):        \n#        bb=rs.BoundingBox(self.obj)\n#        if bb:\n#            x=round((bb[1].X-bb[0].X,DIM_PRECISION))*1 # added ()*1\n#            y=round(bb[3].Y-bb[0].Y,DIM_PRECISION)\n#            z=round(bb[4].Z-bb[0].Z,DIM_PRECISION)            \n#        else:\n#            x=0 ; y=0 ; z=0\n#        self.dims = [x,y,z]\n        self.dims, self.lcs = computeDims(self.obj)\n#        texture = self.Texture\n#        if texture in DIR:\n#           dir = DIR[texture]\n#           self.Texture = texture\n#           self.lcs = dir\n#        else:\n#            dir = [0,1,2]\n#            self.lcs = [i[0] for i in sorted(list(enumerate(self.dims)), key = lambda x:x[1])]\n#            self.lcs.reverse()\n#            self.dims.sort()\n#            self.dims.reverse()\n#            alert = \"texture missing\"\n#        x,y,z = self.dims[dir[0]],self.dims[dir[1]],self.dims[dir[2]]\n#        if z>y:\n#            self.dims = [x,z,y]\n#            self.lcs = [self.lcs[0],self.lcs[2],self.lcs[1]]\n#        else:\n#            self.dims = [x,y,z]\n#        x = self.dims[0]\n#        y = self.dims[1]\n#        z = self.dims[2]\n        self.Length = format(self.dims[0],'.' + str(DIM_PRECISION) + 'f')\n#        self.Width = format(self.dims[1],'.' + str(Decimal(DIM_PRECISION).normalize()) + 'f') # added (Decimal(DIM_PRECISION).normalize())\n        self.Width = format(self.dims[1],'.' + str(DIM_PRECISION) + 'f') # added (Decimal(DIM_PRECISION).normalize())\n#        string = str(self.dims[1])\n#        w_zeros = self.string.rstrip('0').rstrip('.') if '.' in string else string\n#        self.Width = format(w_zeros,'.' + str(Decimal(DIM_PRECISION).normalize()) + 'f') # added (Decimal(DIM_PRECISION).normalize())\n        self.Thickness = format(self.dims[2],'.' + str(DIM_PRECISION) + 'f')\n    def select(self):\n        self.selected = 1\n        rs.SelectObject(self.id)\n    def unselect(self):\n        if self.selected:\n            rs.UnselectObject(self.id)\n    def getParams(self):\n        params = []\n        for attr in ATTRS:\n            name = attr.name\n            params.append(getattr(self, name))\n        return params\n    def highlightEdges(self, dir):\n        pass\n    def refresh(self):\n        for attr in ATTRS:\n            name = attr.name\n            rs.SetUserText (str(self.id), name, getattr(self, name))\n        self.setDims()\n        for attr in ATTRS:\n            name = attr.name\n            rs.SetUserText (str(self.id), name, getattr(self, name))\n\n    def getEdges(self, dirVec):\n        id = self.id\n        nor = self.lcs[2]\n        objRef = Rhino.DocObjects.ObjRef(id)\n        brep = objRef.Geometry()\n        obj = objRef.Object()\n        faces = brep.Faces#doesn't work for extrusions\n        edges = []\n        for face in faces:\n            obj.HighlightSubObject(face.ComponentIndex(), False)\n            faceNor = face.NormalAt(0,0)\n            cond1 = (round(faceNor*nor)==0) #perpendicular\n            cond2 = (round(faceNor*dirVec)==0) #perpendicular\n            if cond1 and cond2:               \n               obj.HighlightSubObject(face.ComponentIndex(), True)\n               scriptcontext.doc.Views.Redraw()\n    def unhighlighAll(self):\n        id = self.id\n        objRef = Rhino.DocObjects.ObjRef(id)\n        brep = objRef.Geometry()\n        obj = objRef.Object()\n        faces = brep.Faces#doesn't work for extrusions\n        for face in faces:\n            obj.HighlightSubObject(face.ComponentIndex(), False)\n    def __eq__(self, obj):\n        return (self.getParams() == obj.getParams())\n\n        \ndef makeDetail(keys, objs):\n    if not objs: return\n    for obj in objs:\n        for key in keys:\n            cur_keys = rs.GetUserText (obj)\n            if key not in cur_keys:\n                rs.SetUserText (obj, key, \"0\", False)\n            else:\n                val = rs.GetUserText (obj, key)\n                if len(val)<1 or val==\" \":\n                    rs.SetUserText (obj, key, \"0\", False)\ndef main():\n    msg=\"Select polysurface objects to export data\"\n    objs = rs.GetObjects(msg,16,preselect=True)\n    if not objs: return\n    extrusions = []\n    rs.UnselectAllObjects()\n    for obj in objs:\n        if rs.ObjectType(obj)==1073741824:\n            extrusions.append(obj)\n    if len(extrusions)>0:\n        rs.SelectObjects(extrusions)\n        resp = rs.MessageBox (\"Selected objects will be converted to polysurfaces.\\n Press OK to continue, Cancel to abort\",1)\n        if resp == 1:\n            rs.Command(\"ConvertExtrusion _Enter\")\n            rs.UnselectAllObjects()\n        else:\n            return\n    keys = [i.name for i in ATTRS if i.isEditable]\n    makeDetail(keys, objs)\n    details = []\n    spec = dict([])\n    ids = dict([])\n    for obj in objs:\n        detail = Detail(obj)\n        details.append(detail)\n    spec = Specification([], details)\n    dialog = SpecDialog()\n    dialog.setData(spec)\n    rs.UnselectAllObjects()\n    Rhino.UI.EtoExtensions.ShowSemiModal(dialog, Rhino.RhinoDoc.ActiveDoc, Rhino.UI.RhinoEtoApp.MainWindow)\n\ndef ExportObjBBData(data):\n    filter = \"CSV File (*.csv)|*.csv||\"\n    filename = rs.SaveFileName(\"Save data file as\", filter)\n    if not filename: return\n    file = codecs.open(filename, encoding='utf-8', mode='w+')\n    s = \"\"\n    for itm in data:\n        itm = [ i if isinstance(i, str) else str(i) for i in itm]\n        s += \"|\".join(itm)\n        s += \"\\n\"\n    file.write(s)\n    file.close()\n\n\ndef RunCommand( is_interactive ):\n    main()\n    return 0\n\nRunCommand(True)",
      "language": "python",
      "author": "Macuso",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "file-io",
    "geometry",
    "layers",
    "materials",
    "python",
    "rhinocommon",
    "rhinoscriptsyntax",
    "selection",
    "transformation",
    "ui"
  ],
  "has_accepted_answer": false,
  "category_id": 11,
  "posts_count": 14,
  "views": 1329
}