{
  "source_url": "https://discourse.mcneel.com/t/why-does-rhino-geometry-plane-flip-return-nonetype/72336",
  "topic_id": 72336,
  "title": "Why does Rhino.Geometry.Plane.Flip() return NoneType?",
  "question": "import Rhino\nimport scriptcontext\nimport System.Guid\n\ndef AddClippingPlane():\n    # Define the corners of the clipping plane\n    rc, corners = Rhino.Input.RhinoGet.GetRectangle()\n    if rc!=Rhino.Commands.Result.Success: return rc\n\n    # Get the active view\n    view = scriptcontext.doc.Views.ActiveView\n    if view is None: return Rhino.Commands.Result.Failure\n\n    p0, p1, p2, p3 = corners\n    # Create a plane from the corner points\n    plane = Rhino.Geometry.Plane(p0, p1, p3)\n    plane = plane.Flip()\n    # Add a clipping plane object to the document\n    id = scriptcontext.doc.Objects.AddClippingPlane(plane, p0.DistanceTo(p1), p0.DistanceTo(p3), view.ActiveViewportID)\n    if id!=System.Guid.Empty:\n        scriptcontext.doc.Views.Redraw()\n        return Rhino.Commands.Result.Success\n    return Rhino.Commands.Result.Failure\n\nif __name__==\"__main__\":\n    AddClippingPlane()",
  "code_blocks": [
    {
      "code": "import Rhino\nimport scriptcontext\nimport System.Guid\n\ndef AddClippingPlane():\n    # Define the corners of the clipping plane\n    rc, corners = Rhino.Input.RhinoGet.GetRectangle()\n    if rc!=Rhino.Commands.Result.Success: return rc\n\n    # Get the active view\n    view = scriptcontext.doc.Views.ActiveView\n    if view is None: return Rhino.Commands.Result.Failure\n\n    p0, p1, p2, p3 = corners\n    # Create a plane from the corner points\n    plane = Rhino.Geometry.Plane(p0, p1, p3)\n    plane = plane.Flip()\n    # Add a clipping plane object to the document\n    id = scriptcontext.doc.Objects.AddClippingPlane(plane, p0.DistanceTo(p1), p0.DistanceTo(p3), view.ActiveViewportID)\n    if id!=System.Guid.Empty:\n        scriptcontext.doc.Views.Redraw()\n        return Rhino.Commands.Result.Success\n    return Rhino.Commands.Result.Failure\n\nif __name__==\"__main__\":\n    AddClippingPlane()",
      "language": "python",
      "author": "ivelin.peychev",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "file-io",
    "geometry",
    "python",
    "rhinocommon"
  ],
  "has_accepted_answer": true,
  "category_id": 11,
  "posts_count": 9,
  "views": 814
}