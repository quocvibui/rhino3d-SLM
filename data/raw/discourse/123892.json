{
  "source_url": "https://discourse.mcneel.com/t/bug-in-object-attributes-in-rhinocommon/123892",
  "topic_id": 123892,
  "title": "Bug in object attributes in RhinoCommon",
  "question": "When I use the script it Ungroups the grouped objects and deletes all Usertexts? Is this a bug?\n\n\ndef ChangeMaterial(matIndex, ObjectID):\n    attr = Rhino.DocObjects.ObjectAttributes()\n    attr.MaterialIndex = matIndex\n    attr.MaterialSource = Rhino.DocObjects.ObjectMaterialSource.MaterialFromObject\n    attrChange = scriptcontext.doc.Objects.ModifyAttributes(ObjectID, attr, True)\n    scriptcontext.doc.Views.Redraw();",
  "code_blocks": [
    {
      "code": "def ChangeMaterial(materialIndex, objectTo):\n    rhino_object = rs.coercerhinoobject(objectTo, True, True)\n    attr = rhino_object.Attributes\n    attr.MaterialIndex = materialIndex\n    attr.MaterialSource = Rhino.DocObjects.ObjectMaterialSource.MaterialFromObject\n    attrChange = scriptcontext.doc.Objects.ModifyAttributes(objectTo, attr, True)",
      "language": "python",
      "author": "onrender",
      "post_number": 3,
      "is_solution": false
    },
    {
      "code": "def ChangeMaterial(matIndex, ObjectID):\n    attr = Rhino.DocObjects.ObjectAttributes()\n    attr.MaterialIndex = matIndex\n    attr.MaterialSource = Rhino.DocObjects.ObjectMaterialSource.MaterialFromObject\n    attrChange = scriptcontext.doc.Objects.ModifyAttributes(ObjectID, attr, True)",
      "language": "python",
      "author": "onrender",
      "post_number": 3,
      "is_solution": false
    },
    {
      "code": "def ChangeMaterial(matIndex, ObjectID):\n    attr = Rhino.DocObjects.ObjectAttributes()\n    attr.MaterialIndex = matIndex\n    attr.MaterialSource = Rhino.DocObjects.ObjectMaterialSource.MaterialFromObject\n    attrChange = scriptcontext.doc.Objects.ModifyAttributes(ObjectID, attr, True)\n    scriptcontext.doc.Views.Redraw();",
      "language": "python",
      "author": "onrender",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "csharp",
    "materials",
    "python",
    "rhinocommon"
  ],
  "has_accepted_answer": false,
  "category_id": 11,
  "posts_count": 6,
  "views": 718
}