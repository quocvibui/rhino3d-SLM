{
  "source_url": "https://github.com/ESteelEx/gcode2cutsim/blob/95aa5678ec3848954cd855838198d3c5a8802a51/RhinoInterface/testchecker.py",
  "repo": "ESteelEx/gcode2cutsim",
  "repo_stars": 2,
  "repo_description": "- gcode 2 cutsim code for 3D Simulation with Verifier Engine",
  "license": "unknown",
  "filepath": "RhinoInterface/testchecker.py",
  "instruction": "Testchecker",
  "code": "try:\n    import rhinoscriptsyntax as rs\n    import Rhino, scriptcontext\n    import System.Drawing, System.Guid\n\n    from System.Drawing import *\n    from Rhino import *\n    from Rhino.DocObjects import *\n    from Rhino.DocObjects.Tables import *\n    from Rhino.Geometry import *\n    from Rhino.Input import *\n    from Rhino.Commands import *\n    from Rhino.UI.Dialogs import ShowColorDialog\n    from scriptcontext import doc\n\nexcept:\n    pass\n\n\ndef get_num_layer():\n    count = 0\n    objID = []\n    while 1:\n        count += 1\n        zero_str = '000000'\n        objName = 'Layer: ' + zero_str[:-len(str(count))] + str(count) + ' Wall1'\n        objID.append(rs.ObjectsByName(objName))\n        if objID[-1] == []:\n            # rs.HideObjects(objID[:])\n            return count - 1\n\n_NUM_LAYER = get_num_layer()\n\n\ndef FindObjectsByName(name):\n    settings = Rhino.DocObjects.ObjectEnumeratorSettings()\n    settings.NameFilter = name\n    ids = [rhobj.Id for rhobj in scriptcontext.doc.Objects.GetObjectList(settings)]\n    if not ids:\n        print \"No objects with the name\", name\n        return Rhino.Commands.Result.Failure\n    else:\n        print \"Found\", len(ids), \"objects\"\n\n    return Rhino.Commands.Result.Success\n\n\ndef GetPointDynamicDrawFuncHide(sender, args):\n\n    obj_all = rs.VisibleObjects()\n    rs.HideObjects(obj_all)\n\n    cursPos = rs.GetCursorPos()\n    viewSize = rs.ViewSize()\n    stepSize = int(viewSize[1] / _NUM_LAYER)\n\n    obj_Layer1 = 'Layer: 000001 Wall1'\n    obj_Layer2 = 'Layer: 000002 Wall1'\n    settings = Rhino.DocObjects.ObjectEnumeratorSettings()\n    settings.HiddenObjects = True\n\n    settings.NameFilter = obj_Layer1\n    ids_L1 = [rhobj.Id for rhobj in scriptcontext.doc.Objects.GetObjectList(settings)]\n\n    settings.NameFilter = obj_Layer2\n    ids_L2 = [rhobj.Id for rhobj in scriptcontext.doc.Objects.GetObjectList(settings)]\n\n    z_L1 = rs.BoundingBox(ids_L1[0])[0][2]\n    z_L2 = rs.BoundingBox(ids_L2[0])[0][2]\n\n    zVal = viewSize[1] - cursPos[3][1]\n\n    z_level = int(zVal / stepSize)\n\n    segmentList = ['Wall',\n                   'DenseInfill',\n                   'SparseInfill',\n                   'Brim',\n                   'Skirt',\n                   'Support']\n\n    zero_str = '000000'\n\n    settings = ObjectEnumeratorSettings()\n    settings.HiddenObjects = True\n\n    for segment in segmentList:\n        i = 0\n        while 1:\n            i += 1\n            obj_LayerZ = str('Layer: ' + zero_str[:-len(str(z_level))] + str(z_level) + ' ' + segment + str(i))\n            try:\n                settings.NameFilter = obj_LayerZ\n                ids_LZ = [rhobj.Id for rhobj in scriptcontext.doc.Objects.GetObjectList(settings)]\n                if len(ids_LZ) == 0:\n                    break\n                # rs.SelectObject(ids_LZ)\n                rs.ShowObject(ids_LZ)\n\n            except:\n                print 'not found'\n\n    args.Display.DrawDot(args.CurrentPoint, 'Layer ' + str(z_level) + ' - Distance ' + str(z_L2 - z_L1) + ' mm')\n    Rhino.Display.RhinoView.Redraw(scriptcontext.doc.Views.ActiveView)\n    Rhino.RhinoApp.Wait()\n\n\ndef GetPointDynamicDrawFuncSelect(sender, args):\n    # pt1 = Rhino.Geometry.Point3d(0,0,0)\n    # pt2 = Rhino.Geometry.Point3d(10,10,0)\n    # args.Display.DrawLine(pt1, args.CurrentPoint, System.Drawing.Color.Red, 2)\n    # args.Display.DrawLine(pt2, args.CurrentPoint, System.Drawing.Color.Blue, 2)\n\n    rs.UnselectAllObjects()\n\n    cursPos = rs.GetCursorPos()\n    viewSize = rs.ViewSize()\n    stepSize = int(viewSize[1] / _NUM_LAYER)\n\n    obj_Layer1 = 'Layer: 000001 Wall1'\n    obj_Layer2 = 'Layer: 000002 Wall1'\n    settings = Rhino.DocObjects.ObjectEnumeratorSettings()\n\n    settings.NameFilter = obj_Layer1\n    ids_L1 = [rhobj.Id for rhobj in scriptcontext.doc.Objects.GetObjectList(settings)]\n\n    settings.NameFilter = obj_Layer2\n    ids_L2 = [rhobj.Id for rhobj in scriptcontext.doc.Objects.GetObjectList(settings)]\n\n    z_L1 = rs.BoundingBox(ids_L1[0])[0][2]\n    z_L2 = rs.BoundingBox(ids_L2[0])[0][2]\n\n    zVal = viewSize[1] - cursPos[3][1]\n\n    z_level = int(zVal / stepSize)\n\n    segmentList = ['Wall',\n                   'DenseInfill',\n                   'SparseInfill',\n                   'Brim',\n                   'Skirt',\n                   'Support']\n\n    zero_str = '000000'\n\n    settings = ObjectEnumeratorSettings()\n\n    for segment in segmentList:\n        i = 0\n        while 1:\n            i += 1\n            obj_LayerZ = str('Layer: ' + zero_str[:-len(str(z_level))] + str(z_level) + ' ' + segment + str(i))\n            try:\n                settings.NameFilter = obj_LayerZ\n                ids_LZ = [rhobj.Id for rhobj in scriptcontext.doc.Objects.GetObjectList(settings)]\n                if len(ids_LZ) == 0:\n                    break\n                rs.SelectObject(ids_LZ)\n\n            except:\n                print 'not found'\n\n    args.Display.DrawDot(args.CurrentPoint, 'Layer ' + str(z_level) + ' - Distance ' + str(z_L2 - z_L1) + ' mm')\n    Rhino.Display.RhinoView.Redraw(scriptcontext.doc.Views.ActiveView)\n    Rhino.RhinoApp.Wait()\n\n\nclass testchecker():\n    def __init__(self):\n        pass\n\n    def draw_line_select(self):\n        # Create an instance of a GetPoint class and add a delegate for the DynamicDraw event\n        gp = Rhino.Input.Custom.GetPoint()\n        # gp = Rhino.Input.Custom.PickContext()\n        gp.DynamicDraw += GetPointDynamicDrawFuncSelect\n        gp.Get()\n\n        obj_all = rs.HiddenObjects()\n        rs.ShowObjects(obj_all)\n\n        # print gp.Point()\n\n    def draw_line_hide(self):\n        obj_all = rs.VisibleObjects()\n        rs.HideObjects(obj_all)\n        # Create an instance of a GetPoint class and add a delegate for the DynamicDraw event\n        gp = Rhino.Input.Custom.GetPoint()\n        # gp = Rhino.Input.Custom.PickContext()\n        gp.DynamicDraw += GetPointDynamicDrawFuncHide\n        gp.Get()\n\n        obj_all = rs.HiddenObjects()\n        rs.ShowObjects(obj_all)\n",
  "language": "python",
  "imports": [
    "Rhino",
    "Rhino.Geometry",
    "rhinoscriptsyntax",
    "scriptcontext"
  ],
  "has_docstring": false
}