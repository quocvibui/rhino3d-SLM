{
  "source_url": "https://discourse.mcneel.com/t/rhino-8-i-cant-import-pandas-in-rhinos-scripteditor/168547",
  "topic_id": 168547,
  "title": "Rhino 8 - I can't import pandas in rhino's ScriptEditor",
  "question": "I have successfully installed numpy and pandas in the Rhino Python path using pip install (CMD). I am able to import and use numpy in the Rhino script editor without any issues. However, when I attempt to import pandas, it seems to be causing some problems.\n\nThe code error is as follows:\n\n[0 1 2 3 4 5 6 7 8 9]\n\nTraceback (most recent call last):\n\nFile “file:///G:/%E5%90%8C%E6%AD%A5%E8%B5%84%E6%96%99/OneDrive%20-%20lyrics5816/%E8%AE%BE%E8%AE%A1%E7%B4%A0%E6%9D%90/GH/%E4%B8%AA%E4%BA%BA%E7%A0%94%E7%A9%B6/python/pandas%20test.py”, line 5, in \n\nFile “C:\\Users\\97471.rhinocode\\py39-rh8\\lib\\site-packages\\pandas_\ninit\n_.py”, line 73, in \n\nfrom pandas.core.api import (\n\nFile “C:\\Users\\97471.rhinocode\\py39-rh8\\lib\\site-packages\\pandas\\core\\api.py”, line 1, in \n\nfrom pandas.\nlibs import (\n\nFile \"C:\\Users\\97471.rhinocode\\py39-rh8\\lib\\site-packages\\pandas_libs_\ninit\n.py\", line 18, in \n\nfrom pandas._libs.interval import Interval\n\nFile “interval.pyx”, line 1, in init pandas._libs.interval\n\nFile “hashtable.pyx”, line 1, in init pandas._libs.hashtable\n\nFile “missing.pyx”, line 42, in init pandas._libs.missing\n\nAttributeError: partially initialized module ‘pandas’ has no attribute ‘_pandas_datetime_CAPI’ (most likely due to a circular import)\n\n\nimage\n1294×1104 55.1 KB\n\n\nimage\n1294×1104 52.3 KB\n\n\nDoes anyone know how to solve this problem? Thank you all.",
  "code_blocks": [
    {
      "code": "#! python3\n#r: psycopg2,pandas,openpyxl\n\n\nimport rhinoscriptsyntax as rs\nimport scriptcontext as sc\nimport openpyxl\nimport System\nimport System.Collections.Generic\nimport Rhino\nimport psycopg2\n# import locale\n# locale.setlocale(locale.LC_ALL, 'en_US')\n\nimport pandas as pd",
      "language": "python",
      "author": "onlyforpeace",
      "post_number": 15,
      "is_solution": false
    },
    {
      "code": "#! python3\n\n# r: pandas\n\nimport rhinoscriptsyntax as rs\nimport scriptcontext as sc\nimport math\n\nimport System\nimport System.Collections.Generic\nimport Rhino\n\nimport locale\nlocale.setlocale(locale.LC_ALL, 'en_US.UTF-8')\n\nimport rhinoscriptsyntax as rs\nimport json\nimport pandas as pd\n \n#prompt the user for a file to import\nfilter = \"JSON file (*.json)|*.json|All Files (*.*)|*.*||\"\nfilename = rs.OpenFileName(\"Open JSON File\", filter)\n \n#Read JSON data into the datastore variable\nif filename:\n    with open(filename, 'r') as f:\n        datastore = json.load(f)\n \ndf = pd.DataFrame(datastore)\n\ncsv_file = df.to_csv()\n\nprint(csv_file)",
      "language": "python",
      "author": "scottd",
      "post_number": 18,
      "is_solution": false
    },
    {
      "code": "#! python3\n#r: pandas, openpyxl, psycopg2\n\n\nimport rhinoscriptsyntax as rs\nimport scriptcontext as sc\n\nimport System\nimport System.Collections.Generic\nimport Rhino\n\nimport locale\nlocale.setlocale(locale.LC_ALL, 'en_US')\nimport openpyxl\nimport psycopg2\n\nimport pandas as pd\nprint(pd.__version__)",
      "language": "python",
      "author": "scottd",
      "post_number": 20,
      "is_solution": false
    }
  ],
  "tags": [
    "file-io",
    "geometry",
    "python",
    "rhinoscriptsyntax"
  ],
  "has_accepted_answer": false,
  "category_id": 115,
  "posts_count": 31,
  "views": 3993
}