{
  "source_url": "https://discourse.mcneel.com/t/running-importlayout-deleting-custom-display-modes-c/215969",
  "topic_id": 215969,
  "title": "Running ImportLayout deleting custom display modes (C#)",
  "question": "Hi,\n\nI’m writing a command which imports a page and display mode, but I’m finding the custom display modes are getting deleted by \nImportLayout\n. If I import the display mode and then close and reopen Rhino or open the Options window before running \nImportLayout\n, the display modes don’t get deleted.\n\n\nHere is some code to recreate the issue:\n\n\n\n\nprotected override Result RunCommand(RhinoDoc doc, RunMode mode)\n\n{\n\nvar displayModeId = DisplayModeDescription.AddDisplayMode(“TestDisplayMode”);\n\nvar displayMode = DisplayModeDescription.GetDisplayMode(displayModeId);\n\nRhinoApp.WriteLine($“{displayMode.LocalName} has been created.”);\n\n\n// RhinoApp.RunScript($\"Options\", true); // Uncomment to prevent the display mode from getting deleted\n\nRhinoApp.RunScript(\"ImportLayout\", true);\nreturn Result.Success;\n\n\n\n}",
  "code_blocks": [
    {
      "code": "#! python 3\nimport Rhino\n\n# Adds a new display mode.\ndm_id = Rhino.Display.DisplayModeDescription.AddDisplayMode(\"TestDisplayMode\")\n\n# Get the new display mode\ndm = Rhino.Display.DisplayModeDescription.GetDisplayMode(dm_id)\n\n# TODO: make any changes here\n\n# Update it and save it to Rhino's settings\nRhino.Display.DisplayModeDescription.UpdateDisplayMode(dm)",
      "language": "python",
      "author": "dale",
      "post_number": 3,
      "is_solution": true
    },
    {
      "code": "// RhinoApp.RunScript($\"Options\", true); // Uncomment to prevent the display mode from getting deleted\n\nRhinoApp.RunScript(\"ImportLayout\", true);\nreturn Result.Success;",
      "language": "csharp",
      "author": "Stephen15",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "csharp",
    "file-io",
    "geometry",
    "python"
  ],
  "has_accepted_answer": true,
  "category_id": 3,
  "posts_count": 4,
  "views": 44
}