{
  "source_url": "https://discourse.mcneel.com/t/collecting-elements-after-a-permutation-operations/27081",
  "topic_id": 27081,
  "title": "Collecting Elements after a Permutation Operations",
  "question": "Hi All,\n\nI am working on a script for a college and seem to be stuck at a point. I am performing a set of operations on a permutation of lines and need to collect the resulting objects (curvebooleancombined)  into a list for further operations. All my operations are buried in a class, and I canâ€™t seem to figure out why it is not appending to the list. To collect all the resulting geometry at the end.\n\n\nI am pasting the code below. Any help will be appreciated.\n\n\n#Permutation Script\nimport rhinoscriptsyntax as rs\nimport math\n\n#Permutation Function, input n and k and returns PermKeys - a nest listed of genes \ndef PermutationKey(n,k):\n    PermKeys = []\n    if n>4 or k>12:\n        print \"Too LARGE!!!\"\n        return None\n\n    for i in rs.frange(0,math.pow(k,n)-1,1):\n       \n        key = []\n        \n        for j in range(0,n):\n            key.append(int((i/(math.pow(k,n-j-1)))%k))\n        PermKeys.append(key)\n        \n    return PermKeys\n\nclass MyColumns:\n    #A class that creates permutations of columns from a set of curves\n    def __init__(self):\n        self.allprofiles=[]\n        self.combined=[]\n    def makeColumn(self, gene, curves):\n        #assign variables\n        \n        self.gene  = gene\n        self.curves = curves\n        self.line1 = self.gene[0]\n        self.line2 = self.gene[1]\n        intersect=rs.CurveCurveIntersection(self.curves[self.line1],self.curves[self.line2])\n        if intersect == None:\n            return\n        else:\n            self.Offset()\n            if self.allprofiles != []:\n                return self.allprofiles\n            \n    def Offset(self):\n        intersect=rs.CurveCurveIntersection(self.curves[self.line1],self.curves[self.line2])\n        if intersect[0][0]==2:\n            return\n        else:\n            \n            #print len(self.allprofiles)\n            t= intersect[0][6]\n            #print t\n            offset1=rs.OffsetCurve(self.curves[self.line1],(0,0,0),1, style=1)\n            offset2=rs.OffsetCurve(self.curves[se...",
  "code_blocks": [
    {
      "code": "#Permutation Script\nimport rhinoscriptsyntax as rs\nimport math\n\n#Permutation Function, input n and k and returns PermKeys - a nest listed of genes \ndef PermutationKey(n,k):\n    PermKeys = []\n    if n>4 or k>12:\n        print \"Too LARGE!!!\"\n        return None\n\n    for i in rs.frange(0,math.pow(k,n)-1,1):\n       \n        key = []\n        \n        for j in range(0,n):\n            key.append(int((i/(math.pow(k,n-j-1)))%k))\n        PermKeys.append(key)\n        \n    return PermKeys\n\nclass MyColumns:\n    #A class that creates permutations of columns from a set of curves\n    def __init__(self):\n        self.allprofiles=[]\n        self.combined=[]\n    def makeColumn(self, gene, curves):\n        #assign variables\n        \n        self.gene  = gene\n        self.curves = curves\n        self.line1 = self.gene[0]\n        self.line2 = self.gene[1]\n        intersect=rs.CurveCurveIntersection(self.curves[self.line1],self.curves[self.line2])\n        if intersect == None:\n            return\n        else:\n            self.Offset()\n            if self.allprofiles != []:\n                return self.allprofiles\n            \n    def Offset(self):\n        intersect=rs.CurveCurveIntersection(self.curves[self.line1],self.curves[self.line2])\n        if intersect[0][0]==2:\n            return\n        else:\n            \n            #print len(self.allprofiles)\n            t= intersect[0][6]\n            #print t\n            offset1=rs.OffsetCurve(self.curves[self.line1],(0,0,0),1, style=1)\n            offset2=rs.OffsetCurve(self.curves[self.line1],(0,0,0),-1, style=1)\n            offset3=rs.OffsetCurve(self.curves[self.line1],(0,0,0),4, style=1)\n            offset4=rs.OffsetCurve(self.curves[self.line1],(0,0,0),-4, style=1)\n            offsetpt1=rs.EvaluateCurve(offset3,t)\n            pts1=rs.AddPoint(offsetpt1)\n            offsetpt2=rs.EvaluateCurve(offset4,t)\n            pts2=rs.AddPoint(offsetpt2)\n            edgept1=rs.CurveStartPoint(offset1)\n            edgept2=rs.CurveEndPoint(offset1)\n            edgept3=rs.CurveStartPoint(offset2)\n            edgept4=rs.CurveEndPoint(offset2)\n            loop1=rs.AddPolyline((edgept1,offsetpt1,edgept2,edgept4,offsetpt2,edgept3,edgept1))\n            rs.DeleteObjects((offset1,offset2,offset3,offset4))\n            \n            t2= intersect[0][7]\n            \n            offset1=rs.OffsetCurve(self.curves[self.line2],(0,0,0),1.5, style=1)\n            offset2=rs.OffsetCurve(self.curves[self.line2],(0,0,0),-1.5, style=1)\n            offset3=rs.OffsetCurve(self.curves[self.line2],(0,0,0),3, style=1)\n            offset4=rs.OffsetCurve(self.curves[self.line2],(0,0,0),-3, style=1)\n            offsetpt1=rs.EvaluateCurve(offset3,t2)\n            pts1=rs.AddPoint(offsetpt1)\n            offsetpt2=rs.EvaluateCurve(offset4,t2)\n            pts2=rs.AddPoint(offsetpt2)\n            edgept1=rs.CurveStartPoint(offset1)\n            edgept2=rs.CurveEndPoint(offset1)\n            edgept3=rs.CurveStartPoint(offset2)\n            edgept4=rs.CurveEndPoint(offset2)\n            loop2=rs.AddPolyline((edgept1,offsetpt1,edgept2,edgept4,offsetpt2,edgept3,edgept1))\n            rs.DeleteObjects((offset1,offset2,offset3,offset4))\n            \n           \n            \n            diff=rs.CurveBooleanIntersection(loop1,loop2)\n            self.combined=rs.CurveBooleanUnion((loop1,loop2))\n            return self.combined\n            self.allprofiles.append(combined)#All these need to be collected into a list\n            rs.DeleteObjects((loop1,loop2))\n            \n    def MasterBooleen(self):\n        self.allprofiles.append(self.combined)\n        print len(self.allprofiles)\n    \n\n\ndef  main():\n    \n    #collect profiles from user\n    profiles = rs.GetObjects('Select Profile Curves for Input',rs.filter.curve)\n    #print profiles \n    #call PermutationKey function - arrange sets of 2 from number of input profiles\n    PermKeys = PermutationKey(2,len(profiles))\n    #loop to create all permutations\n    for i in range(0,len(PermKeys)):\n        #collect individual gene (list of two values) from PermKeys (list of al values)\n        gene = PermKeys[i]\n        \n        #call instance of class, inputting origin point\n        columns = MyColumns() \n        #call .makeColumn method, providing gene, profiles and height\n        columns.makeColumn(gene, profiles)\n        columns.MasterBooleen()\n        #print allprofiles.columns.MyColumns()\n        #print columns.allprofiles\n\nmain()",
      "language": "python",
      "author": "vvgala",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "boolean",
    "file-io",
    "geometry",
    "python",
    "rhinoscriptsyntax",
    "selection"
  ],
  "has_accepted_answer": false,
  "category_id": 11,
  "posts_count": 1,
  "views": 633
}