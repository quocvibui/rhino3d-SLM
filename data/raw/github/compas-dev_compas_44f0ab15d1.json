{
  "source_url": "https://github.com/compas-dev/compas/blob/HEAD/src/compas_rhino/conversions/shapes.py",
  "repo": "compas-dev/compas",
  "repo_stars": 352,
  "repo_description": "Main library of the COMPAS framework and CAD integrations for Rhino/GH and Blender.",
  "license": "MIT",
  "filepath": "src/compas_rhino/conversions/shapes.py",
  "instruction": "Shapes",
  "code": "from __future__ import absolute_import\nfrom __future__ import division\nfrom __future__ import print_function\n\nimport Rhino  # type: ignore\nimport scriptcontext as sc  # type: ignore\n\nfrom compas.geometry import Box\nfrom compas.geometry import Cone\nfrom compas.geometry import Cylinder\nfrom compas.geometry import Frame\nfrom compas.geometry import Sphere\nfrom compas.geometry import Torus\n\nfrom .curves import circle_to_rhino\nfrom .curves import line_to_rhino_curve\n\n# from .geometry import plane_to_rhino\nfrom .geometry import frame_to_rhino\nfrom .geometry import plane_to_compas_frame\nfrom .geometry import point_to_compas\nfrom .geometry import point_to_rhino\n\n# =============================================================================\n# To Rhino\n# =============================================================================\n\n\ndef box_to_rhino(box):\n    \"\"\"Convert a COMPAS box to a Rhino box.\n\n    Parameters\n    ----------\n    box : :class:`compas.geometry.Box`\n\n    Returns\n    -------\n    :rhino:`Rhino.Geometry.Box`\n\n    \"\"\"\n    return Rhino.Geometry.Box(\n        frame_to_rhino(box.frame),\n        Rhino.Geometry.Interval(-0.5 * box.xsize, 0.5 * box.xsize),\n        Rhino.Geometry.Interval(-0.5 * box.ysize, 0.5 * box.ysize),\n        Rhino.Geometry.Interval(-0.5 * box.zsize, 0.5 * box.zsize),\n    )\n\n\ndef sphere_to_rhino(sphere):\n    \"\"\"Convert a COMPAS sphere to a Rhino sphere.\n\n    Parameters\n    ----------\n    sphere : :class:`compas.geometry.Sphere`\n\n    Returns\n    -------\n    :rhino:`Rhino.Geometry.Sphere`\n\n    \"\"\"\n    return Rhino.Geometry.Sphere(point_to_rhino(sphere.frame.point), sphere.radius)\n\n\ndef cone_to_rhino(cone):\n    \"\"\"Convert a COMPAS cone to a Rhino cone.\n\n    Parameters\n    ----------\n    cone : :class:`compas.geometry.Cone`\n\n    Returns\n    -------\n    :rhino:`Rhino.Geometry.Cone`\n\n    \"\"\"\n    # return Rhino.Geometry.Cone(plane_to_rhino(cone.circle.plane), cone.height, cone.circle.radius)\n    frame = Frame(cone.frame.point + cone.frame.zaxis * cone.height, cone.frame.xaxis, cone.frame.yaxis)\n    return Rhino.Geometry.Cone(frame_to_rhino(frame), -cone.height, cone.radius)\n\n\ndef cone_to_rhino_brep(cone):\n    \"\"\"Convert a COMPAS cone to a Rhino Brep.\n\n    Parameters\n    ----------\n    cone : :class:`compas.geometry.Cone`\n        A COMPAS cone.\n\n    Returns\n    -------\n    Rhino.Geometry.Brep\n\n    \"\"\"\n    return Rhino.Geometry.Cone.ToBrep(cone_to_rhino(cone), True)\n\n\ndef cylinder_to_rhino(cylinder):\n    \"\"\"Convert a COMPAS cylinder to a Rhino cylinder.\n\n    Parameters\n    ----------\n    cylinder : :class:`compas.geometry.Cylinder`\n\n    Returns\n    -------\n    :rhino:`Rhino.Geometry.Cylinder`\n\n    \"\"\"\n    circle = cylinder.circle.copy()\n    circle.frame.point += circle.frame.zaxis * (-0.5 * cylinder.height)\n    return Rhino.Geometry.Cylinder(circle_to_rhino(circle), cylinder.height)\n\n\ndef cylinder_to_rhino_brep(cylinder):\n    \"\"\"Convert a COMPAS cylinder to a Rhino Brep.\n\n    Parameters\n    ----------\n    cylinder : :class:`compas.geometry.Cylinder`\n        A COMPAS cylinder.\n\n    Returns\n    -------\n    Rhino.Geometry.Brep\n\n    \"\"\"\n    return Rhino.Geometry.Cylinder.ToBrep(cylinder_to_rhino(cylinder), True, True)\n\n\ndef capsule_to_rhino(capsule):\n    \"\"\"Convert a COMPAS capsule to a Rhino cylinder.\n\n    Parameters\n    ----------\n    capsule : :class:`compas.geometry.Capsule`\n\n    Returns\n    -------\n    :rhino:`Rhino.Geometry.Cylinder`\n\n    \"\"\"\n    raise NotImplementedError\n\n\ndef capsule_to_rhino_brep(capsule):\n    \"\"\"Convert a COMPAS capsule to a Rhino Brep.\n\n    Parameters\n    ----------\n    capsule : :class:`compas.geometry.Capsule`\n        A COMPAS capsule.\n\n    Returns\n    -------\n    list[Rhino.Geometry.Brep]\n\n    \"\"\"\n    abs_tol = sc.doc.ModelAbsoluteTolerance\n    ang_tol = sc.doc.ModelAngleToleranceRadians\n\n    radius = capsule.radius\n    line = capsule.axis\n    curve = line_to_rhino_curve(line)\n\n    return Rhino.Geometry.Brep.CreatePipe(curve, radius, False, Rhino.Geometry.PipeCapMode.Round, False, abs_tol, ang_tol)\n\n\ndef torus_to_rhino(torus):\n    \"\"\"Convert a COMPAS torus to a Rhino torus.\n\n    Parameters\n    ----------\n    torus : :class:`compas.geometry.Torus`\n\n    Returns\n    -------\n    :rhino:`Rhino.Geometry.Torus`\n\n    \"\"\"\n    return Rhino.Geometry.Torus(frame_to_rhino(torus.frame), torus.radius_axis, torus.radius_pipe)\n\n\ndef torus_to_rhino_brep(torus):\n    \"\"\"Convert a COMPAS torus to a Rhino Brep.\n\n    Parameters\n    ----------\n    torus : :class:`compas.geometry.Torus`\n        A COMPAS torus.\n\n    Returns\n    -------\n    Rhino.Geometry.Brep\n        The Rhino brep representation.\n\n    \"\"\"\n    return torus_to_rhino(torus).ToNurbsSurface().ToBrep()\n\n\n# =============================================================================\n# To COMPAS\n# =============================================================================\n\n\ndef box_to_compas(box):\n    \"\"\"Convert a Rhino box to a COMPAS box.\n\n    Parameters\n    ----------\n    box : :rhino:`Rhino.Geometry.Box`\n\n    Returns\n    -------\n    :class:`compas.geometry.Box`\n\n    \"\"\"\n    xsize = box.X.Length\n    ysize = box.Y.Length\n    zsize = box.Z.Length\n    frame = plane_to_compas_frame(box.Plane)\n    frame.point = point_to_compas(box.Center)\n    return Box(xsize, ysize, zsize, frame=frame)\n\n\ndef sphere_to_compas(sphere):\n    \"\"\"Convert a Rhino sphere to a COMPAS sphere.\n\n    Parameters\n    ----------\n    sphere : :rhino:`Rhino.Geometry.Sphere`\n\n    Returns\n    -------\n    :class:`compas.geometry.Sphere`\n\n    \"\"\"\n    return Sphere(point_to_compas(sphere.Center), sphere.Radius)\n\n\ndef cone_to_compas(cone):\n    \"\"\"Convert a Rhino cone to a COMPAS cone.\n\n    Parameters\n    ----------\n    cone : :rhino:`Rhino.Geometry.Cone`\n\n    Returns\n    -------\n    :class:`compas.geometry.Cone`\n\n    \"\"\"\n    frame = plane_to_compas_frame(cone.Plane)\n    frame.point = point_to_compas(cone.BasePoint)  # invert the z-axis?\n    return Cone(radius=cone.Radius, height=cone.Height, frame=frame)\n\n\ndef cylinder_to_compas(cylinder):\n    \"\"\"Convert a Rhino cylinder to a COMPAS cylinder.\n\n    Parameters\n    ----------\n    cylinder : :rhino:`Rhino.Geometry.Cylinder`\n\n    Returns\n    -------\n    :class:`compas.geometry.Cylinder`\n\n    \"\"\"\n    frame = plane_to_compas_frame(cylinder.BasePlane)\n    height = cylinder.TotalHeight\n    frame.point += frame.normal * (0.5 * height)\n    return Cylinder(radius=cylinder.Radius, height=height, frame=frame)\n\n\ndef torus_to_compas(torus):\n    \"\"\"Convert a Rhino torus to a COMPAS torus.\n\n    Parameters\n    ----------\n    torus : :rhino:`Rhino.Geometry.Torus`\n\n    Returns\n    -------\n    :class:`compas.geometry.Torus`\n\n    \"\"\"\n    frame = plane_to_compas_frame(torus.Plane)\n    return Torus(torus.MajorRadius, torus.MinorRadius, frame=frame)\n",
  "language": "python",
  "imports": [
    "Rhino",
    "Rhino.Geometry",
    "scriptcontext"
  ],
  "has_docstring": false
}