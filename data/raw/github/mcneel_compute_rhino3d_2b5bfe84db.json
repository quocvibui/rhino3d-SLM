{
  "source_url": "https://github.com/mcneel/compute.rhino3d/blob/677087c3683fb307c9d3a6e55651377c28c41e92/package/rpm/rhino-compute.spec",
  "repo": "mcneel/compute.rhino3d",
  "repo_stars": 378,
  "repo_description": "REST geometry server based on RhinoCommon and headless Rhino",
  "license": "NOASSERTION",
  "filepath": "package/rpm/rhino-compute.spec",
  "instruction": "Rhino compute",
  "code": "Name:           rhino-compute\nVersion:        9.0.0\nRelease:        1%{?dist}\nSummary:        REST geometry server based on RhinoCommon and headless Rhino\n\nLicense:        MIT\nURL:            https://github.com/mcneel/compute.rhino3d/blob/9.x/LICENSE.md\nSource0:        %{name}_%{version}-wip.tar.gz\nSource1:        rhino-compute.service\nSource2:        environment.example\nSource3:        rhino-compute-start.sh\n\n%global __requires_exclude ^liblttng-ust\\\\.so\\\\.0.*$\n\nRequires:       rhino3d\n\n\n%description\nRhino Compute for Linux.\n\n# ----------------------------------------------------------------\n# Prep: unpack the tarball\n%prep\n%setup -q -n rhino-compute_9.0.0-wip\n\n# ----------------------------------------------------------------\n# Install: copy files to buildroot\n%install\nrm -rf %{buildroot}\n\n# Create install prefix\nmkdir -p %{buildroot}/usr/lib/rhino-compute\n\n# Copy all files from tarball into /usr/lib/rhino-compute\ncp -a LICENSE.md compute.geometry rhino.compute %{buildroot}/usr/lib/rhino-compute/\n\n# Ensure executable is actually executable\nchmod +x %{buildroot}/usr/lib/rhino-compute/rhino.compute/rhino.compute\n\n# Optional: create symlink for launcher\nmkdir -p %{buildroot}/usr/bin\nln -s /usr/lib/rhino-compute/rhino.compute/rhino.compute %{buildroot}/usr/bin/rhino-compute\n\n# Install startup script for non-systemd environments\ninstall -m 0755 %{SOURCE3} %{buildroot}/usr/bin/rhino-compute-start\n\n# Install systemd service file (if systemd is available)\nif [ -d /usr/lib/systemd/system ] || [ -d /lib/systemd/system ]; then\n    mkdir -p %{buildroot}%{_unitdir}\n    install -m 0644 %{SOURCE1} %{buildroot}%{_unitdir}/rhino-compute.service\nfi\n\n# Install environment example file\nmkdir -p %{buildroot}%{_sysconfdir}/rhino-compute\ninstall -m 0644 %{SOURCE2} %{buildroot}%{_sysconfdir}/rhino-compute/environment.example\n\n# ----------------------------------------------------------------\n%clean\nrm -rf %{buildroot}\n\n# ----------------------------------------------------------------\n# Files included in the RPM\n%files\n%defattr(-,root,root,-)\n%license LICENSE.md\n/usr/lib/rhino-compute\n/usr/bin/rhino-compute\n/usr/bin/rhino-compute-start\n%dir %{_sysconfdir}/rhino-compute\n%config(noreplace) %{_sysconfdir}/rhino-compute/environment.example\n# Service file only if systemd directory exists\n%if 0%{?_unitdir:1}\n%{_unitdir}/rhino-compute.service\n%endif\n\n# ----------------------------------------------------------------\n# Pre-install: create service user if it doesn't exist\n%pre\ngetent group rhino-compute >/dev/null || groupadd -r rhino-compute\nif ! getent passwd rhino-compute >/dev/null; then\n    useradd -r -g rhino-compute -d /var/lib/rhino-compute -s /sbin/nologin \\\n    -c \"Rhino Compute Service\" rhino-compute\nelse\n    # Update existing user's home directory if incorrect\n    CURRENT_HOME=$(getent passwd rhino-compute | cut -d: -f6)\n    if [ \"$CURRENT_HOME\" != \"/var/lib/rhino-compute\" ]; then\n        usermod -d /var/lib/rhino-compute rhino-compute\n    fi\nfi\nexit 0\n\n# ----------------------------------------------------------------\n# Post-install: reload systemd and inform user\n%post\n# Only use systemd if it's available\nif [ -d /run/systemd/system ]; then\n    %systemd_post rhino-compute.service\nfi\n\n# Create and set ownership of state directory\nmkdir -p /var/lib/rhino-compute\nchown rhino-compute:rhino-compute /var/lib/rhino-compute\nchmod 755 /var/lib/rhino-compute\n\ncat <<EOF\n\n  # # # # # # # # # # # # # # # # # # # # #\n  #                                       #\n  #       R H I N O   C O M P U T E       #\n  #                                       #\n  # # # # # # # # # # # # # # # # # # # # #\n\nRhino Compute has been installed successfully!\n\nNext steps to get started:\n\n1. Configure your API key:\n   sudo cp /etc/rhino-compute/environment.example /etc/rhino-compute/environment\n   sudo nano /etc/rhino-compute/environment\n   (Set RHINO_TOKEN to your API key)\n\n2. Start the service:\n   sudo systemctl start rhino-compute\n\n3. Enable automatic startup on boot:\n   sudo systemctl enable rhino-compute\n\n4. Check the status:\n   sudo systemctl status rhino-compute\n\n5. Follow logs in real-time:\n   sudo journalctl -u rhino-compute -f\n\n---\n\nFor non-systemd environments:\n\n1. Configure your API key:\n   sudo cp /etc/rhino-compute/environment.example /etc/rhino-compute/environment\n   sudo nano /etc/rhino-compute/environment\n   (Set RHINO_TOKEN to your API key)\n\n2. Start rhino-compute: \n   rhino-compute-start\n\nEOF\n\n# ----------------------------------------------------------------\n# Pre-uninstall: stop and disable the service\n%preun\nif [ -d /run/systemd/system ] && [ -f %{_unitdir}/rhino-compute.service ]; then\n    %systemd_preun rhino-compute.service\nfi\n\n# ----------------------------------------------------------------\n# Post-uninstall: reload systemd\n%postun\nif [ -d /run/systemd/system ]; then\n    %systemd_postun_with_restart rhino-compute.service\nfi\n\n# ----------------------------------------------------------------\n%changelog\n* Tue Feb 10 2026 Luis Fraguada <luis@mcneel.com> - 9.0.0-1\n- Initial rhino-compute RPM",
  "language": "python",
  "imports": [
    "RhinoCommon"
  ],
  "has_docstring": false
}