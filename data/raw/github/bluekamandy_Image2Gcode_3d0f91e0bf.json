{
  "source_url": "https://github.com/bluekamandy/Image2Gcode/blob/84a8d83fd85fa6396120288d686f30e2f82108f0/resources/slicer.py",
  "repo": "bluekamandy/Image2Gcode",
  "repo_stars": 0,
  "repo_description": null,
  "license": "unknown",
  "filepath": "resources/slicer.py",
  "instruction": "Provides a scripting component.\n    Inputs:\n        x: The x script variable\n        y: The y script variable\n           a: The a output variable",
  "code": "\"\"\"Provides a scripting component.\n    Inputs:\n        x: The x script variable\n        y: The y script variable\n           a: The a output variable\"\"\"\n\n__author__ = \"jenniferjacobs\"\n\nimport rhinoscriptsyntax as rs\nfrom datetime import datetime\nimport math as math\n\ndef makeGcodeInfo(sb):\n    sb.append(\"; \" + datetime.now().strftime(\"%y%m%d_%H%M%S\") + \"\\n\")\n    \ndef makeGcodeHeatSettings(sb):\n    sb.append(\"M140 S\" + str(BedTemp) +\" ; Set Bed Temperature\\n\")\n    sb.append(\"M105\\n\")\n    sb.append(\"M190 S\" + str(BedTemp) +\" ; Wait for Bed Temperature\\n\")\n    sb.append(\"M104 S\" + str(NozzleTemp) +\" ; Set Nozzle Temperature\\n\")\n    sb.append(\"M105\\n\")\n    sb.append(\"M109 S\" + str(NozzleTemp) +\" ; Wait for Nozzle Temperature\\n\")\n    \ndef makeGcodeStartupSettings(sb):\n    sb.append(\"G28\\n\")\n    sb.append(\"M83\\n\")\n    sb.append(\"G90\\n\")\n    sb.append(\"G1 F300 Z0.4\\n\")\n    sb.append(\"G1 X50 E8 F800\\n\")\n    \n\ndef WriteFile(str, path):\n    \n    f = open(path, \"w\")\n    f.write(str)\n    f.close()\n\ndef makeRetraction(amount, speed, sign):\n    mes = \"\";\n    if(sign == -1):\n        mes = \" ; Retraction\"\n    else:\n        mes = \" ; Extraction\"\n    return \"G1 F\" + str(speed) + \" E\" + str(sign * amount) + mes + \"\\n\"\n\ndef makeGcodePoints(fr, to):\n    l = (to - fr).Length;\n    numerator = (_NozzleWidth * l * _LayerHeight)\n    denominator = (1.75 / 2) * (1.75 / 2) * Math.PI\n    e = numerator / denominator\n    return \"G1 F1200 X\" + \"{:.{}f}\".format(to.X,2) + \" Y\" + \"{:.{}f}\".format(to.Y,2) + \" E\" + \"{:.{}f}\".format(e,8) + \"\\n\";\n\ndef makeGcodeSpeed(fr, to, speed):\n    l = (to - fr).Length\n    numerator = (_NozzleWidth * l * _LayerHeight)\n    denominator = (1.75 / 2) * (1.75 / 2) * math.pi\n\n    e = numerator / denominator\n\n    return \"G1 F\" + str(speed) + \" X\" + \"{:.{}f}\".format(to.X,2) + \" Y\" + \"{:.{}f}\".format(to.Y,2) + \" E\" + \"{:.{}f}\".format(e,8) + \"\\n\"\n\ndef makeGcode(to):\n    return \"G0 F9000 X\" + \"{:.{}f}\".format(to.X,2) + \" Y\" + \"{:.{}f}\".format(to.Y,2) + \"\\n\" \n    \n\n\n\n_LayerHeight = LayerHeight;\n_NozzleWidth = 0.4;\n_RetAmount = 6.0;\n_RetSpeed = 1200;\nPrintSpeed = 500;\nPrintSpeedHigh = 1000;  \n\nif(Apply == True):\n    sb = []\n    makeGcodeInfo(sb)\n    makeGcodeHeatSettings(sb)\n    makeGcodeStartupSettings(sb)\n    sb.append(makeRetraction(_RetAmount, _RetSpeed, -1))\n   \n    CurrentHeight = 0;\n    i = 0\n\n    #Pillar generation\n    GAP = 3\n    LayerNum = 0\n    HairNum = 0\n    i = 0\n\n    for i in range(0, len(MeshPoints.Paths)):\n        pList = MeshPoints.Branch(i)\n        \n        if(len(pList) != 0):\n            CurrentHeight = pList[0].Z\n            sb.append(\"G1 F300 Z\" + str(CurrentHeight) + \"\\n\")\n            sb.append(makeGcode(pList[0]))\n            sb.append(makeRetraction(_RetAmount, _RetSpeed, 1))\n\n            j = 0\n            for j in range(0,len(pList)):\n                if(j == 0):\n                    #sb.Append(\"G4 P100\\n\");\n                    sb.append(makeGcode(pList[j]))\n                    continue\n\n                print(LayerHeight)\n                if(pList[j].Z > CurrentHeight + (_LayerHeight / 10)):\n                    CurrentHeight = pList[j].Z\n                    sb.append(\"G1 F300 Z\" + \"{:.{}f}\".format(CurrentHeight,3) + \"\\n\")\n\n                sb.append(makeGcodeSpeed(pList[j - 1], pList[j], PrintSpeed))\n\n            sb.append(makeGcodeSpeed(pList[len(pList) - 1], pList[0], PrintSpeed))\n\n        sb.append(makeRetraction(_RetAmount, _RetSpeed, -1))\n\n\n\n\n\n    sb.append(makeRetraction(_RetAmount, _RetSpeed, -1));\n    CurrentHeight += 10;\n    sb.append(\"G1 Z\" + \"{:.{}f}\".format(CurrentHeight,3) + \"\\n\");\n\n\n    sb.append(\"M84\");\n    strsb = ''.join(sb)\n    WriteFile(strsb, FilePath);  \n        \n        \n    a = strsb",
  "language": "python",
  "imports": [
    "rhinoscriptsyntax"
  ],
  "has_docstring": true
}