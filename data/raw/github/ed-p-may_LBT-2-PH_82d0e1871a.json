{
  "source_url": "https://github.com/ed-p-may/LBT-2-PH/blob/3c2bbdf0cb26deb92d36b870aeb920cbc31d8da2/ghuser_py/LBT2PH%20XL%20Open%20Workbook.py",
  "repo": "ed-p-may/LBT-2-PH",
  "repo_stars": 12,
  "repo_description": "LBT2PH is a free toolkit for creating PHPP energy models from Ladybug Tools v1.0+ definitions.",
  "license": "GPL-3.0",
  "filepath": "ghuser_py/LBT2PH XL Open Workbook.py",
  "instruction": "Enables the connection from Rhino to Excel.\n> When _run is set to TRUE, this will start up a new instance of Microsoft Excel.\n> If valid source and target file paths are provided, a new copy of the...",
  "code": "#\n# LBT2PH: A Plugin for creating Passive House Planning Package (PHPP) models from LadybugTools. Created by blgdtyp, llc\n# \n# This component is part of the PH-Tools toolkit <https://github.com/PH-Tools>.\n# \n# Copyright (c) 2020, bldgtyp, llc <phtools@bldgtyp.com> \n# LBT2PH is free software; you can redistribute it and/or modify \n# it under the terms of the GNU General Public License as published \n# by the Free Software Foundation; either version 3 of the License, \n# or (at your option) any later version. \n# \n# LBT2PH is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of \n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the \n# GNU General Public License for more details.\n# \n# For a copy of the GNU General Public License\n# see <http://www.gnu.org/licenses/>.\n# \n# @license GPL-3.0+ <http://spdx.org/licenses/GPL-3.0+>\n#\n\"\"\"\nEnables the connection from Rhino to Excel.\n> When _run is set to TRUE, this will start up a new instance of Microsoft Excel.\n> If valid source and target file paths are provided, a new copy of the source PHPP \nwill be created and automatically opened. \n> Once open, this new PHPP can be connected to the 'Write to Excel' or the 'Read \nfrom Excel' components.\n-\nOriginal component design by Jack Hymowitz <https://github.com/jackhymowitz>, \nPinacle Scholar Summer Research Student, Stevens Institute of Technology\n-\nMarch 1, 2021\n    Args:\n        _run: Set to True to enable the Excel application, False saves the open \n            workbook and stops the application.\n        _source_PHPP_filepath: (str) The existing filepath to the PHPP you would \n            like to use as the 'source' for the new one.\n        _new_PHPP_filepath: (str) The new filepath to the PHPP you would like to \n            create. If this file does not already exist it will be created by \n            this component when _run==True.\n    Returns:\n        excel: The Excel COM interface created, or None if not running.\n\"\"\"\n\nfrom ghpythonlib.componentbase import executingcomponent as component\nimport scriptcontext as sc\n\nimport LBT2PH\nimport LBT2PH.__versions__\nimport LBT2PH.xl_connect\n\nreload( LBT2PH )\nreload(LBT2PH.__versions__)\nreload( LBT2PH.xl_connect )\n\nghenv.Component.Name = \"LBT2PH XL Open Workbook\"\nLBT2PH.__versions__.set_component_params(ghenv, dev=False)\n#-------------------------------------------------------------------------------\n\nclass ThisComponent(component):\n    \n    def RunScript(self, _run, _source_PHPP_filepath, _new_PHPP_filepath):\n        #---- Sort out the file paths\n        path_source_file = LBT2PH.xl_connect.FileManager.get_path_source_file(_source_PHPP_filepath, ghenv)\n        path_target_file = LBT2PH.xl_connect.FileManager.get_path_target_file(_new_PHPP_filepath, ghenv)\n        \n        #---- Execute\n        if _run and path_source_file and path_target_file:\n            LBT2PH.xl_connect.FileManager.make_target_file(path_source_file, path_target_file, ghenv)\n            \n            #In order for this to close and save properly, the Excel instance needs\n            #so stick around even after _run is truned to FALSE. So always refer to\n            #the Excel instance saved in sc.sticky['excel']\n            excel = sc.sticky.get('excel', None)\n            if not excel:\n                excel = LBT2PH.xl_connect.ExcelInstance()\n                excel.start_new_instance( path_target_file )\n                excel.open_workbook()\n                excel.load_sheets()\n                \n                sc.sticky['excel'] = excel\n            \n        else:\n            excel = sc.sticky.pop('excel', None)\n            \n            if excel:\n                excel.save_and_quit()\n                excel = None\n        \n        return excel\n\n",
  "language": "python",
  "imports": [
    "ghpythonlib",
    "scriptcontext"
  ],
  "has_docstring": true
}