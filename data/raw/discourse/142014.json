{
  "source_url": "https://discourse.mcneel.com/t/scriptcontext-doc-create-fail/142014",
  "topic_id": 142014,
  "title": "scriptcontext.doc.Create fail",
  "question": "Hi there,\n\n\ni am trying to close the active document and open a new empty document without providing a template. Both fails under Rhino 7 for Mac SR 7.17. The script to open a new empty document, which works fine on windows looks like this:\n\n\ndef NewEmptyDocument():\n    scriptcontext.doc.Create(None)\n    scriptcontext.doc.AdjustModelUnitSystem(Rhino.UnitSystem.Millimeters, False)\n    scriptcontext.doc.ModelAbsoluteTolerance = 0.01\n    scriptcontext.doc.ModelAngleToleranceDegrees =  1.0\n    return True\n\nprint NewEmptyDocument()\n\n\n\nIf i run this from the python editor on Mac, it returns \nTrue\n, however, no document is created at all. If i run this on Windows, it closes the active document and opens a new one with the settings provided in the script.\n\n\nIf i pass a valid (template) file name and path to \nscriptcontext.doc.Create(file_path)\n instead of using \nNone\n, nothing happens.\n\n\nI understand that Rhino for Mac can open multiple documents. Therefore i tried to close the current document first by scripting the command \n_Close\n. If i do this, Rhino for Mac asks me for a filepath which i do not know. The document i have open doesn’t have a file path as it has not been saved. If i run the command \n_Close\n and click on “Done”, nothing happens.\n\n\nHow to close the active document and how can i open a new empty document on Mac using Python ?\n\n\nthanks,\n\nc.",
  "code_blocks": [
    {
      "code": "def NewEmptyDocument():\n    scriptcontext.doc.Create(None)\n    scriptcontext.doc.AdjustModelUnitSystem(Rhino.UnitSystem.Millimeters, False)\n    scriptcontext.doc.ModelAbsoluteTolerance = 0.01\n    scriptcontext.doc.ModelAngleToleranceDegrees =  1.0\n    return True\n\nprint NewEmptyDocument()",
      "language": "python",
      "author": "clement",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "file-io",
    "python"
  ],
  "has_accepted_answer": false,
  "category_id": 11,
  "posts_count": 2,
  "views": 314
}