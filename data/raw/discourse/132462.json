{
  "source_url": "https://discourse.mcneel.com/t/iges-exporter-doesnt-follow-unit-settings-from-headless-doc/132462",
  "topic_id": 132462,
  "title": "IGES exporter doesn't follow unit settings from headless doc",
  "question": "It seems the exporter doesnâ€™t follow unit system settings from headless document. Unit of the exported IGES file is inch instead of millimeter with the following code.\n\n\n  private void RunScript(string file, Surface srf, bool export, ref object result)\n  {\n    if(!export) return;\n    var doc = RhinoDoc.CreateHeadless(null);\n\n    doc.ModelUnitSystem = UnitSystem.Millimeters;\n    doc.Objects.Add(srf);\n\n    result = doc.Export(file);\n\n    doc.Dispose();\n  }\n\n\n\ntest_iges_export.gh\n (2.3 KB)\n\n\n\n\n\n\n(pay attention to unit system indicator in the bottom-left corner)",
  "code_blocks": [
    {
      "code": "private void RunScript(string file, Surface srf, bool export, ref object result)\n  {\n    if(!export) return;\n    var doc = RhinoDoc.CreateHeadless(null);\n\n    doc.ModelUnitSystem = UnitSystem.Millimeters;\n    doc.Objects.Add(srf);\n\n    result = doc.Export(file);\n\n    doc.Dispose();\n  }",
      "language": "csharp",
      "author": "gankeyu",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "file-io",
    "geometry"
  ],
  "has_accepted_answer": true,
  "category_id": 3,
  "posts_count": 5,
  "views": 440
}