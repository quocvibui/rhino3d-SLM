{
  "source_url": "https://github.com/ksteinfe/runway_sketch2pix/blob/4beb3628809029d072d6c754ef05050a29a00ac3/scripts/rhino_batch_render.py",
  "repo": "ksteinfe/runway_sketch2pix",
  "repo_stars": 13,
  "repo_description": "AI Augmented Architectural Sketching",
  "license": "unknown",
  "filepath": "scripts/rhino_batch_render.py",
  "instruction": "Rhino batch render",
  "code": "import os, sys, math, copy, StringIO, datetime, time, shutil, uuid\nfrom System.IO import Directory\nimport Rhino, System\nimport scriptcontext as sc\nimport rhinoscriptsyntax as rs\n\nDEBUG = False\n\nDEFAULT_SAVE_PATH = r\"C:\\Users\\ksteinfe\\Desktop\\TEMP\"\nREQUIRED_LAYERS = [\"rndr\", \"line\"]\nFILL_LAYER_NAME = \"fill\"\n\nDO_CAPTURE_VIEW = True\nDO_RENDER = True\nDO_PLOT_CAMPTS = False\n\nMODE_NAME_STR = \"SCRIPT GENERATED {} - DELETE THIS\"\nMODE_NAME_LINE = MODE_NAME_STR.format(\"LINE\")\nMODE_NAME_FILL = MODE_NAME_STR.format(\"FILL\")\n\ndef main():\n    cfg = setup()\n    rs.CurrentView(cfg['view'].ActiveViewportID)\n    # MAIN LOOP\n    print(\"plottting {} views across {} xforms.\".format( len(cfg['view_locs']), len(cfg['xforms']) ) )\n    print(\"{} images will result.\".format( len(cfg['view_locs']) * len(cfg['xforms']) ) )\n    try:\n        #raise Exception(\"nope\")\n        \n        for x,xf in enumerate(cfg['xforms']):\n            print(\"##### xform {} of {}\".format(x+1,len(cfg['xforms'])))\n            \n            all_layers_on(cfg)\n            apply_xf(xf,cfg) # apply transformation\n            \n            for c,cam in enumerate(cfg['view_locs']):\n                do_capture(cam, \"{}_{:04}_{:02}\".format(cfg['layer_info']['parent'].Name.lower(),c,x), cfg) # capture view\n            \n            all_layers_on(cfg)\n            apply_xf( rs.XformInverse(xf),cfg ) # restore transformation\n            \n            Rhino.RhinoApp.Wait()\n            if (sc.escape_test(False)): raise Exception('Esc key caught in main()')\n                    \n    except Exception as e:\n        print(\"!!!! SCRIPT STOPPED !!!!\")\n        print e\n    finally:\n        teardown(cfg)\n        \ndef setup():\n    cfg = {}\n    delete_residual_display_modes()\n    \n    ## properties dialog\n    #\n    props = [\n        (\"view_count\",2),\n        (\"image_size\",512),\n        (\"min_camera_percent\",-80),\n        (\"max_camera_percent\",80),\n        (\"do_scale_1d\", \"n\"),\n        (\"do_scale_2d\", \"n\"),\n        (\"do_shear\", \"n\")\n    ]\n    results = False\n    if DEBUG: results = [p[1] for p in props]\n    if not results:\n        itms, vals = [p[0] for p in props], [p[1] for p in props]\n        results = rs.PropertyListBox(itms, vals, \"Please set the following properties.\", \"Rhino Batch Render\")\n        if results is None: exit()\n    \n    try:\n        cfg[\"view_count\"]            = int(results[0])\n        cfg['size']                  = int(results[1])\n        cfg['min_camera_percent']    = 0.01 * int(results[2])\n        cfg['max_camera_percent']    = 0.01 * int(results[3])\n        cfg[\"do_scale_1d\"]           = str(results[4]).lower() in (\"y\", \"yes\", \"true\", \"t\", \"1\")\n        cfg[\"do_scale_2d\"]           = str(results[5]).lower() in (\"y\", \"yes\", \"true\", \"t\", \"1\")\n        cfg[\"do_shear\"]              = str(results[6]).lower() in (\"y\", \"yes\", \"true\", \"t\", \"1\")\n        \n    except Exception as e:\n        big_problem(\"There was a problem parsing the values given in the properties dialog.\")\n        \n    \n    ## lights\n    #\n    setup_lights(cfg)\n    \n    ## layers\n    #\n    setup_layers(cfg)\n    \n    ## root path\n    #\n    pth_root = False\n    if DEBUG: pth_root = DEFAULT_SAVE_PATH\n    if not pth_root: pth_root = rs.BrowseForFolder(message=\"message\", title=\"title\")\n    dir_cfg = initialize_directory(pth_root, cfg['do_capture_fill'], cfg['layer_info']['parent'].Name)\n    cfg.update(dir_cfg)\n    \n    \n    ## views\n    #\n    #print(\"Defining view locations:\\n{}\\t{}\\t{}\\t{}\".format(cfg[\"view_count\"], 1.0, cfg['min_camera_percent'], cfg['max_camera_percent']))\n    cfg['view_locs'] = fibonacci_lattice_pts(cfg[\"view_count\"], rad=1.0, min_z=cfg['min_camera_percent'], max_z=cfg['max_camera_percent'])\n    if DO_PLOT_CAMPTS:\n        for pt in cfg['view_locs']: rs.AddPoint(pt)\n    \n    ## xforms\n    #\n    cfg['xforms'] = xforms_to_apply(cfg, DEBUG)\n    \n    ## SETUP RHINO\n    #\n    rs.UnselectAllObjects()\n    setup_display_modes(cfg)\n    setup_floating_viewport(cfg)\n    setup_render_settings(cfg)\n    \n    \n    return cfg\n    \ndef teardown(cfg):\n    print(\"teardown\")\n    cfg['view'].Close()\n    sc.doc.RenderSettings = cfg['render_settings']\n    \n    for mode in cfg['display_modes'].keys():\n        if not Rhino.Display.DisplayModeDescription.DeleteDiplayMode(cfg['display_modes'][mode].Id): \n            print(\"Temporary display mode {} was not deleted. Consider removing this yourself.\".format(cfg['display_modes'][mode].EnglishName))\n    \n    delete_residual_display_modes()\n    all_layers_on(cfg)\n    return\n    \ndef delete_residual_display_modes():\n    dmds = Rhino.Display.DisplayModeDescription.GetDisplayModes()\n    for dmd in dmds:\n        if (MODE_NAME_LINE in dmd.EnglishName) or (MODE_NAME_FILL in dmd.EnglishName):\n            print(\"Deleting residual display mode {}\".format(dmd.EnglishName))\n            if not Rhino.Display.DisplayModeDescription.DeleteDiplayMode(dmd.Id): \n                print(\"Residual display mode {} was not deleted. Consider removing this yourself.\".format(dmd.EnglishName))\n    \ndef initialize_directory(pth_root, init_fill_dir, layername, debug=False):\n    print(\"Initializing save path: {}\".format(pth_root))\n    dir_cfg = {}\n    if not Directory.Exists(pth_root): big_problem(\"!!! Path does not exist.\\nSelect a valid folder.\\n{}\".format(pth_root))\n    \n    filename = \"unsavedfile\"\n    layername = layername.lower().replace(\" \",\"_\")\n    try:\n        filename = os.path.splitext(sc.doc.Name)[0].lower().replace(\" \",\"_\")\n    except:\n        pass\n    \n    success = False\n    for char in 'abcdefghijkmnpqrstuvwxyz':\n        dstmp = datetime.date.today().strftime('%y%m%d')\n        dir_cfg['pth_save'] = os.path.join(pth_root,'{}{}-{}-{}'.format(dstmp, char, filename, layername))\n        if not Directory.Exists(dir_cfg['pth_save']):\n            Directory.CreateDirectory(dir_cfg['pth_save'])\n            success = True\n            break\n            \n    if not success:\n        big_problem(\"!!!! failed to initalize save path.\\nClear out the following path by hand.\\n{}\".format(pth_root))\n    \n    dir_cfg['pth_save_render'] = os.path.join(dir_cfg['pth_save'],'rndr')\n    dir_cfg['pth_save_line'] = os.path.join(dir_cfg['pth_save'],'line')\n    dir_cfg['pth_save_fill'] = os.path.join(dir_cfg['pth_save'],'fill')\n    Directory.CreateDirectory(dir_cfg['pth_save_render'])\n    Directory.CreateDirectory(dir_cfg['pth_save_line'])\n    if init_fill_dir: Directory.CreateDirectory(dir_cfg['pth_save_fill'])\n    \n    return dir_cfg\n    \n    \ndef big_problem(msg):\n    rs.MessageBox(msg, 16)\n    raise Exception(msg)\n    \n####################################################\n\ndef do_capture(loc, name, cfg):\n    #print(\"view {} of {}\".format(m+1,len(locs)))\n    set_camera(loc, cfg)\n    align_light_to_camera(cfg) \n    \n    Rhino.RhinoApp.Wait()\n    if (sc.escape_test(False)): raise Exception('Esc key caught pre-render in do_capture()')  \n    \n    if DO_CAPTURE_VIEW: do_view_capture(cfg, name)\n    if DO_RENDER: do_render(cfg, name)\n    \n    Rhino.RhinoApp.Wait()\n    if (sc.escape_test(False)): raise Exception('Esc key caught post-render in do_capture()')     \n    \n    # delete_light_by_id(light_id)\n\ndef set_camera(crds, cfg):\n    pos = Rhino.Geometry.Point3d(*crds)\n    tar = Rhino.Geometry.Point3d(0,0,0)\n    all_layers_on(cfg)\n    cfg['view'].ActiveViewport.SetCameraLocations(tar, pos)\n    cfg['view'].ActiveViewport.ZoomExtents()\n\ndef do_view_capture(cfg, fname):\n    # https://discourse.mcneel.com/t/viewcapture-displayed-lineweights-bug/67610/9\n    def view_cap():\n        vc = Rhino.Display.ViewCapture()\n        vc.Width = cfg['size']\n        vc.Height = cfg['size']\n        vc.ScaleScreenItems = True\n        vc.DrawAxes = False\n        vc.DrawGrid = False\n        vc.DrawGridAxes = False\n        vc.TransparentBackground = True\n        vc.RealtimeRenderPasses = 0\n        return vc\n        \n    isolate_layer_line(cfg)\n    activate_display_mode(cfg, \"line\")\n    bmp = cfg['view'].CaptureToBitmap(System.Drawing.Size(cfg['size'],cfg['size']))\n    #bmp = view_cap().CaptureToBitmap(cfg['view'])\n    bmp.MakeTransparent() # this is rotten. https://discourse.mcneel.com/t/capturetobitmap-with-transparency/4905/2\n    bmp.Save( os.path.join(cfg['pth_save_line'], \"{}.png\".format(fname) ) )\n    \n    if cfg['do_capture_fill']:\n        isolate_layer_fill(cfg)\n        activate_display_mode(cfg, \"fill\")\n        #bmp = cfg['view'].CaptureToBitmap(System.Drawing.Size(cfg['size'],cfg['size']))\n        bmp = view_cap().CaptureToBitmap(cfg['view'])\n        bmp.Save( os.path.join(cfg['pth_save_fill'], \"{}.png\".format(fname) ) )    \n\ndef do_render(cfg, fname):\n    isolate_layer_rndr(cfg)\n    rs.CurrentView(cfg['view'].ActiveViewportID)\n    rs.Command(\"_-Render\")\n    rs.Command('_-SaveRenderWindowAs \"{}\"'.format( os.path.join(cfg['pth_save_render'],\"{}.png\".format(fname) ) ) )\n    rs.Command(\"_-CloseRenderWindow\")\n    \n####################################################\n\ndef setup_layers(cfg):\n    parent_layer = False\n    if DEBUG: parent_layer = \"DEBUG\"\n    if not parent_layer: parent_layer = rs.GetLayer(\"Please select the 'parent' layer\")\n    if parent_layer is None: exit()\n    cfg['layer_info'] = get_layer_info(parent_layer)\n    try:\n        cfg['do_capture_fill'] = False\n        if len(cfg['layer_info']['children'])==0: raise Exception(\"The selected parent layer has no sublayers. Please select a layer that has the proper sublayers defined.\")\n        for rlyr in REQUIRED_LAYERS:\n            if rlyr not in [lyr.Name for lyr in cfg['layer_info']['children']]: raise Exception(\"The selected parent layer does not contain the required sublayer '{}'.\".format(rlyr))\n            cfg['layer_info'][rlyr] = False\n            for lyr in cfg['layer_info']['children']:\n                if lyr.Name==rlyr:\n                    cfg['layer_info'][rlyr] = lyr\n                    break\n            \n        if FILL_LAYER_NAME in [lyr.Name for lyr in cfg['layer_info']['children']]:\n            cfg['do_capture_fill'] = True\n            cfg['layer_info'][FILL_LAYER_NAME] = False\n            for lyr in cfg['layer_info']['children']:\n                if lyr.Name==FILL_LAYER_NAME:\n                    cfg['layer_info'][FILL_LAYER_NAME] = lyr\n                    break\n    except Exception as e:\n        big_problem(\"There was a problem with the selected layer.\\n{}\".format(e))\n        \n    cfg['layer_info']['parent'].IsVisible = True\n    return\n\ndef get_layer_info(root_layer_name):\n    lay_root = sc.doc.Layers.FindName(root_layer_name, 0)\n    if lay_root is None : return False\n    ret = {\"parent\": lay_root, \"children\": []}\n    if lay_root.GetChildren() is not None:\n        for lay_child in lay_root.GetChildren():\n            if not rs.IsLayerEmpty(lay_child.Id):\n                ret[\"children\"].append( lay_child )\n    \n    return ret\n\ndef isolate_layer_rndr(cfg):\n    cfg['layer_info']['rndr'].IsVisible = True\n    cfg['layer_info']['rndr'].SetPersistentVisibility(True)  \n    cfg['layer_info']['line'].IsVisible = False\n    cfg['layer_info']['line'].SetPersistentVisibility(False)    \n    if cfg['do_capture_fill']:\n        cfg['layer_info']['fill'].IsVisible = False\n        cfg['layer_info']['fill'].SetPersistentVisibility(False)\n\ndef isolate_layer_line(cfg):\n    cfg['layer_info']['rndr'].IsVisible = False\n    cfg['layer_info']['rndr'].SetPersistentVisibility(False)  \n    cfg['layer_info']['line'].IsVisible = True\n    cfg['layer_info']['line'].SetPersistentVisibility(True)    \n    if cfg['do_capture_fill']:\n        cfg['layer_info']['fill'].IsVisible = False\n        cfg['layer_info']['fill'].SetPersistentVisibility(False)\n        \ndef isolate_layer_fill(cfg):\n    cfg['layer_info']['rndr'].IsVisible = False\n    cfg['layer_info']['rndr'].SetPersistentVisibility(False)  \n    cfg['layer_info']['line'].IsVisible = False\n    cfg['layer_info']['line'].SetPersistentVisibility(False)    \n    if cfg['do_capture_fill']:\n        cfg['layer_info']['fill'].IsVisible = True\n        cfg['layer_info']['fill'].SetPersistentVisibility(True)        \n\ndef all_layers_on(cfg):\n    cfg['layer_info']['rndr'].IsVisible = True\n    cfg['layer_info']['rndr'].SetPersistentVisibility(True)  \n    cfg['layer_info']['line'].IsVisible = True\n    cfg['layer_info']['line'].SetPersistentVisibility(True)    \n    if cfg['do_capture_fill']:\n        cfg['layer_info']['fill'].IsVisible = True\n        cfg['layer_info']['fill'].SetPersistentVisibility(True) \n\n####################################################\n\ndef fibonacci_lattice_pts(dcnt, rad=1.0, min_z=-0.8, max_z=0.8):\n    if min_z>=max_z: big_problem(\"Cannot define view locations with these parameters. Please ensure that min is less than max.\\nmin_z: {}  max_z: {}\".format(min_z,max_z))\n    \n    cnt = int( dcnt * (1.0/(max_z-min_z) * 2) ) + 2 # adjust count to roughly match the desired z range. add two at the end for padding.\n    print(\"count adjusted to {} from {}\".format(cnt,dcnt))\n    if cnt<=0: big_problem(\"No view locations were produced!\")\n    \n    phi = ( 1.0 + math.sqrt ( 5.0 ) ) / 2.0\n    i2 = [ 2*i-(cnt-1) for i in range(cnt) ]\n    theta = [ 2.0*math.pi*float(i2[i])/phi for i in range(cnt) ]\n    sphi = [ float(i2[i])/float(cnt) for i in range(cnt) ]\n    cphi = [ math.sqrt(float(cnt+i2[i])*float(cnt-i2[i])) / float(cnt) for i in range(cnt) ]\n    crds = [ (cphi[i]*math.sin(theta[i])*rad , cphi[i]*math.cos(theta[i])*rad , sphi[i]*rad ) for i in range(cnt) ]    \n    crds = filter(lambda pt: pt[2] >= min_z*rad and pt[2] <= max_z*rad, crds )\n    print(\"produced {} pts. will slice down to {}\".format(len(crds),dcnt))\n    return crds[:dcnt] # slice down to desired size\n\ndef setup_lights(cfg):\n    cfg['light'] = False\n    try:\n        for light_obj in sc.doc.Lights:\n            light_geo = light_obj.LightGeometry\n            if light_geo.IsDirectionalLight and not light_obj.IsDeleted: \n                cfg['light'] = light_obj\n                break\n        if not cfg['light']:\n            raise Exception(\"No directional lights were found in this model.\\nPlease create a directional light using the 'DirectionalLight' command.\")\n    except Exception as e:\n        big_problem(\"There was a problem setting up the lights.\\n{}\".format(e))\n        \n    return\n\ndef move_light(loc, tar, cfg):\n    light_geo = cfg['light'].LightGeometry\n    start = rs.coerce3dpoint(loc, True)\n    end = rs.coerce3dpoint(tar, True)\n    light_geo.Location = start\n    light_geo.Direction = end-start\n    \n    sc.doc.Lights.Modify(cfg['light'].Id, light_geo)\n    \ndef align_light_to_camera(cfg):\n    vec_cam = vector_of_active_view_camera()\n    vec_up = rs.VectorUnitize(rs.VectorCrossProduct(rs.VectorCrossProduct(vec_cam,(0,0,1)), vec_cam))\n    if vec_up is None: vec_up = rs.VectorUnitize(rs.VectorCrossProduct(rs.VectorCrossProduct(vec_cam,(0,1,0)), vec_cam))\n    vec_left = rs.VectorUnitize(rs.VectorCrossProduct(vec_up,vec_cam))\n    vec_light = rs.VectorAdd(vec_up,vec_left)\n    \n    # turn a bit toward the camera\n    vec_cam = rs.VectorScale( rs.VectorUnitize(vec_cam) , -0.25 )\n    vec_light = rs.VectorAdd(vec_light,vec_cam)\n    \n    move_light(vec_light,(0,0,0), cfg)\n    \ndef vector_of_active_view_camera():\n    loc = sc.doc.Views.ActiveView.ActiveViewport.CameraLocation\n    tar = sc.doc.Views.ActiveView.ActiveViewport.CameraTarget\n    vec_cam = rs.VectorUnitize(rs.VectorCreate(tar,loc))\n    return(vec_cam)\n    \n####################################################\n\ndef xforms_to_apply(cfg, do_limit):\n    s = 1.618\n    s2 = s/2.0\n    ret = [Rhino.Geometry.Transform.Identity]\n    #if do_limit: return ret\n    if cfg[\"do_scale_1d\"]: \n        ret.extend([\n        xf_scale((1, 1, s)),\n        xf_scale((1, s, 1)),\n        xf_scale((s, 1, 1))\n    ])\n    if cfg[\"do_scale_2d\"]: \n        ret.extend([\n        xf_scale((1, s, s)),\n        xf_scale((s, 1, s)),\n        xf_scale((s, s, 1))\n    ])\n    if cfg[\"do_shear\"]: \n        ret.extend([\n        xf_shear(vx=(1,s2,s2)),\n        #xf_shear(vx=(1,s2,-s2)), \n        xf_shear(vy=(1,s2,s2)),\n        #xf_shear(vy=(1,s2,-s2))\n        xf_shear(vz=(s2,s2,1)),\n       #xf_shear(vz=(s2,-s2,1))\n    ])\n        \n    return ret\n\ndef xf_scale(scale=(1,1,1)):\n    if 0 in scale:\n        print(\"you want to scale to 0%?\")\n        exit()\n    xs,ys,zs = scale\n    xform = Rhino.Geometry.Transform.Scale(rs.WorldXYPlane(), xs, ys, zs)\n    return xform\n    \ndef xf_shear(vx=(1,0,0),vy=(0,1,0),vz=(0,0,1)):\n    xform = Rhino.Geometry.Transform.Shear(rs.WorldXYPlane(), rs.CreateVector(vx), rs.CreateVector(vy), rs.CreateVector(vz))\n    return xform    \n\ndef apply_xf(xf,cfg,copy=False):\n    rc = []\n    \n    ids = []\n    ids.extend(sc.doc.Objects.FindByLayer(cfg['layer_info']['rndr']))\n    ids.extend(sc.doc.Objects.FindByLayer(cfg['layer_info']['line']))\n    if cfg['layer_info']['fill']: \n        ids.extend(sc.doc.Objects.FindByLayer(cfg['layer_info']['fill']))\n    \n    for object_id in ids:\n        #object_id = rs.coerceguid(object_id, True)\n        id = sc.doc.Objects.Transform(object_id, xf, not copy)\n        if id!=System.Guid.Empty: rc.append(id)\n    if rc: sc.doc.Views.Redraw()\n\n####################################################\n\ndef setup_display_modes(cfg):\n    cfg['display_modes'] = {}\n        \n    # LINE\n    # \n    disp_param_line = {\n        'Name':MODE_NAME_LINE,\n        'GUID':uuid.uuid4(),\n        'PipelineId':\"e1eb7363-87f2-4a2b-a861-256e77835369\",\n        'CurveColor':'0,0,0', # CurveColor color\n        'CurveThickness':2, # Curve thickness \n        \n        'TechnicalMask':14, # 14 shows mesh \"edges\" (described as \"creases\"); 6 hides mesh \"edges\"\n        'TechnicalUsageMask': 6,\n        \n        'TEThickness':1, # Edge thickness\n        'TSiThickness':3, # Silhouette thickness\n        'TEColor':'128,128,128', # technical edge color\n        'TSiColor':'1,1,1', # technical silhouette color\n    }\n    \n    pth_ini_line = cfg['pth_save'] + r\"\\line.ini\"\n    f = open(pth_ini_line,\"w\")\n    disp_param = disp_param_default\n    disp_param.update(disp_param_line)\n    f.write(disp_mode_str.format(**disp_param))\n    f.close()\n    \n    guid = Rhino.Display.DisplayModeDescription.ImportFromFile(pth_ini_line)\n    dst_display_mode_desc = Rhino.Display.DisplayModeDescription.GetDisplayMode(guid)\n    cfg['display_modes']['line'] = dst_display_mode_desc\n    \n    # FILL\n    # \n    disp_param_fill = {\n        'Name':MODE_NAME_FILL,\n        'GUID':uuid.uuid4(),\n        'PipelineId':\"952b2830-ce8a-4b4f-935a-8cd570d162c7\",\n        'FrontMaterialOverrideObjectColor':'y',\n        \n        'CurveColor':'224,224,224', # CurveColor color\n        'CurveThickness':3, # Curve thickness \n        \n        'ShadeSurface': 'y', # y or n\n        'FrontMaterialDiffuse':'224,224,224',\n        \n        'SurfacesShowEdges':'n',\n        'SurfacesShowTangentEdges':'n',\n        'SurfacesShowTangentSeams':'n',\n        'ShowMeshWires':'n'\n    }\n    \n    pth_ini_fill = cfg['pth_save'] + r\"\\fill.ini\"\n    f = open(pth_ini_fill,\"w\")\n    disp_param = disp_param_default\n    disp_param.update(disp_param_fill)\n    f.write(disp_mode_str.format(**disp_param))\n    f.close()\n    \n    guid = Rhino.Display.DisplayModeDescription.ImportFromFile(pth_ini_fill)\n    dst_display_mode_desc = Rhino.Display.DisplayModeDescription.GetDisplayMode(guid)\n    cfg['display_modes']['fill'] = dst_display_mode_desc\n    \n    if not DEBUG:\n        os.remove(pth_ini_line)\n        os.remove(pth_ini_fill)\n    \ndef setup_floating_viewport(cfg):\n    x,y = 100, 200 # position of floating window relative to the screen (not Rhino)\n    cfg['view'] = sc.doc.Views.Add(\"ksteinfe\",Rhino.Display.DefinedViewportProjection.Top,System.Drawing.Rectangle(x,y,cfg['size'],cfg['size']),True)\n    isolate_layer_line(cfg)\n    activate_display_mode(cfg, \"fill\")\n\ndef setup_render_settings(cfg):\n    rset = sc.doc.RenderSettings\n    cfg['render_settings'] = copy.deepcopy(rset)\n    rset.ImageSize = System.Drawing.Size(cfg['size'],cfg['size'])\n    rset.TransparentBackground = True\n    rset.UseViewportSize = False      \n    \ndef activate_display_mode(cfg, disp_mode_name):\n    cfg['view'].ActiveViewport.DisplayMode = cfg['display_modes'][disp_mode_name]\n    cfg['view'].Redraw()\n    sc.doc.Views.Redraw()\n\n\ndisp_param_default = {\n    'FillMode': 2, # background fill: 2 (solid color?) or 7 (transparent)\n    'SolidColor': \"255,255,255\", # background fill color if solid\n    'FrontMaterialOverrideObjectColor':'n',\n    \n    'TechnicalMask':47, # 47 is off?\n    'TechnicalUsageMask': 0, # don't know\n    'TEThickness':1, # technical edge thickness\n    'TSiThickness':1, # technical Silhouette thickness\n    'TEColor':'128,128,128', # technical edge color\n    'TSiColor':'0,0,255', # technical silhouette color    \n    \n    'ShadeSurface': 'n', # y or n\n    'SurfacesShowEdges':'y',\n    'SurfacesShowTangentEdges':'y',\n    'SurfacesShowTangentSeams':'y',\n    'ShowMeshWires':'n',\n    'SurfacesEdgeThickness':1,\n    'FrontMaterialDiffuse':'128,128,128',\n}\n\n\ndisp_mode_str = r\"\"\"\n[DisplayMode\\{GUID}]\nSupportsShadeCmd=y\nSupportsShading=y\nSupportsStereo=y\nAddToMenu=y\nAllowObjectAssignment=n\nShadedPipelineRequired=y\nWireframePipelineRequired=y\nPipelineLocked=y\nOrder=15\nDerivedFrom=b46ab226-05a0-4568-b454-4b1ab721c675\nName={Name}\nXrayAllObjects=n\nIgnoreHighlights=n\nDisableConduits=n\nDisableTransparency=n\nBBoxMode=0\nRealtimeDisplayId=00000000-0000-0000-0000-000000000000\nPipelineId={PipelineId}\n[DisplayMode\\{GUID}\\View settings]\nUseDocumentGrid=n\nDrawGrid=n\nDrawAxes=n\nDrawZAxis=n\nDrawWorldAxes=n\nShowGridOnTop=n\nShowTransGrid=n\nBlendGrid=n\nGridTrans=60\nDrawTransGridPlane=n\nGridPlaneTrans=90\nPlaneVisibility=0\nAxesPercentage=100\nPlaneUsesGridColor=n\nGridPlaneColor=0,0,0\nWorldAxesColor=0\nWxColor=150,75,75\nWyColor=75,150,75\nWzColor=0,0,150\nGroundPlaneUsage=0\nCustomGroundPlaneShow=n\nCustomGroundPlaneAltitude=0\nCustomGroundPlaneAutomaticAltitude=y\nCustomGroundPlaneShadowOnly=y\nLinearWorkflowUsage=0\nCustomLinearWorkflowPreProcessColors=y\nCustomLinearWorkflowPreProcessTextures=y\nCustomLinearWorkflowPostProcessFrameBuffer=n\nCustomLinearWorkflowPreProcessGamma=2.200000047683716\nCustomLinearWorkflowPostProcessGamma=2.200000047683716\nFillMode={FillMode}\nSolidColor={SolidColor}\nGradTopLeft=200,200,200\nGradBotLeft=140,140,140\nGradTopRight=200,200,200\nGradBotRight=140,140,140\nBackgroundBitmap=\nStereoModeEnabled=0\nStereoSeparation=1\nStereoParallax=1\nAGColorMode=0\nAGViewingMode=0\nFlipGlasses=n\nShowClippingPlanes=n\nClippingShowXSurface=y\nClippingShowXEdges=y\nClippingClipSelected=y\nClippingShowCP=y\nClippingSurfaceUsage=0\nClippingEdgesUsage=0\nClippingCPUsage=0\nClippingCPTrans=95\nClippingEdgeThickness=3\nClippingSurfaceColor=128,128,128\nClippingEdgeColor=0,0,0\nClippingCPColor=255,255,255\nHorzScale=1\nVertScale=1\n[DisplayMode\\{GUID}\\Shading]\nCullBackfaces=n\nShadeVertexColors=n\nSingleWireColor=n\nWireColor=0,0,0\nShadeSurface={ShadeSurface}\nUseObjectMaterial=n\nUseObjectBFMaterial=n\nBakeTextures=y\nShowDecals=y\nSurfaceColorWriting=y\nShadingEffect=0\nParallelLineWidth=2\nParallelLineSeparation=3\nParallelLineRotation=0\n[DisplayMode\\{GUID}\\Shading\\Material]\nUseBackMaterial=n\nFrontIsCustom=n\nBackIsCustom=n\n[DisplayMode\\{GUID}\\Shading\\Material\\Front Material]\nFlatShaded=n\nOverrideObjectColor={FrontMaterialOverrideObjectColor}\nOverrideObjectTransparency=y\nOverrideObjectReflectivity=y\nDiffuse={FrontMaterialDiffuse}\nShine=128\nSpecular=255,255,255\nTransparency=0\nReflectivity=0\nShineIntensity=100\nLuminosity=0\n[DisplayMode\\{GUID}\\Shading\\Material\\Back Material]\nFlatShaded=n\nOverrideObjectColor=y\nOverrideObjectTransparency=y\nOverrideObjectReflectivity=y\nDiffuse=126,126,126\nShine=0\nSpecular=255,255,255\nTransparency=0\nReflectivity=0\nShineIntensity=100\nLuminosity=0\n[DisplayMode\\{GUID}\\Lighting]\nShowLights=n\nUseHiddenLights=n\nUseLightColor=n\nLightingScheme=0\nLuminosity=0\nAmbientColor=0,0,0\nLightCount=0\nCastShadows=y\nShadowMapSize=2048\nNumSamples=11\nShadowMapType=2\nShadowBitDepth=32\nShadowColor=0,0,0\nShadowBias=2,12,0\nShadowBlur=1\nTransparencyTolerance=40\nPerPixelLighting=n\nShadowClippingUsage=0\nShadowClippingRadius=0\n[DisplayMode\\{GUID}\\Objects]\nCPSolidLines=n\nCPSingleColor=n\nCPHidePoints=n\nCPHideSurface=n\nCPHighlight=y\nCPHidden=n\nnCPWireThickness=1\nnCVSize=3\neCVStyle=102\nCPColor=0,0,0\nGhostLockedObjects=n\nLockedTrans=50\nLockedUsage=2\nLockedColor=100,100,100\nLockedObjectsBehind=n\nLayersFollowLockUsage=n\n[DisplayMode\\{GUID}\\Objects\\Surfaces]\nSurfaceKappaHair=n\nHighlightSurfaces=n\nShowIsocurves=n\nIsoThicknessUsed=n\nIsocurveThickness=1\nIsoUThickness=1\nIsoVThickness=1\nIsoWThickness=1\nSingleIsoColor=n\nIsoColor=0,0,0\nIsoColorsUsed=n\nIsoUColor=0,0,0\nIsoVColor=0,0,0\nIsoWColor=0,0,0\nIsoPatternUsed=n\nIsocurvePattern=-1\nIsoUPattern=-1\nIsoVPattern=-1\nIsoWPattern=-1\nShowEdges={SurfacesShowEdges}\nShowNakedEdges=n\nShowTangentEdges={SurfacesShowTangentEdges}\nShowTangentSeams={SurfacesShowTangentSeams}\nShowNonmanifoldEdges=n\nShowEdgeEndpoints=n\nEdgeThickness={SurfacesEdgeThickness}\nEdgeColorUsage=0\nNakedEdgeOverride=0\nNakedEdgeThickness=1\nNakedEdgeColorUsage=0\nEdgeColorReduction=0\nNakedEdgeColorReduction=0\nEdgeColor=0,0,0\nNakedEdgeColor=0,0,0\nNonmanifoldEdgeColor=0,0,0\nEdgePattern=-1\nNakedEdgePattern=-1\nNonmanifoldEdgePattern=-1\n[DisplayMode\\{GUID}\\Objects\\Meshes]\nHighlightMeshes=n\nSingleMeshWireColor=n\nMeshWireColor=0,0,0\nMeshWireThickness=1\nMeshWirePattern=-1\nShowMeshWires={ShowMeshWires}\nShowMeshVertices=n\nMeshVertexSize=0\nShowMeshEdges=n\nShowMeshNakedEdges=n\nShowMeshNonmanifoldEdges=n\nMeshEdgeThickness=0\nMeshNakedEdgeThickness=0\nMeshNonmanifoldEdgeThickness=0\nMeshEdgeColorReduction=0\nMeshNakedEdgeColorReduction=0\nMeshNonmanifoldEdgeColorReduction=0\nMeshEdgeColor=0,0,0\nMeshNakedEdgeColor=0,0,0\nMeshNonmanifoldEdgeColor=0,0,0\n[DisplayMode\\{GUID}\\Objects\\Curves]\nShowCurvatureHair=n\nShowCurves=y\nSingleCurveColor=y\nCurveColor={CurveColor}\nCurveThickness={CurveThickness}\nCurveTrans=0\nCurvePattern=-1\nLineEndCapStyle=0\nLineJoinStyle=0\n[DisplayMode\\{GUID}\\Objects\\Points]\nPointSize=3\nPointStyle=102\nShowPoints=n\nShowPointClouds=n\nPCSize=2\nPCStyle=50\nPCGripSize=2\nPCGripStyle=102\n[DisplayMode\\{GUID}\\Objects\\Annotations]\nShowText=n\nShowAnnotations=n\nDotTextColor=-1\nDotBorderColor=-1\n[DisplayMode\\{GUID}\\Objects\\Technical]\nTechnicalMask={TechnicalMask}\nTechnicalUsageMask={TechnicalUsageMask}\nTHThickness=2\nTEThickness={TEThickness}\nTSiThickness={TSiThickness}\nTCThickness=1\nTSThickness=1\nTIThickness=1\nTHColor=0,0,0\nTEColor={TEColor}\nTSiColor={TSiColor}\nTCColor=0,0,0\nTSColor=0,0,0\nTIColor=0,0,0\n\"\"\"\n\n\n\n\n\nif __name__ == \"__main__\": \n    main()\n    \n    \n    \n    \n",
  "language": "python",
  "imports": [
    "Rhino",
    "Rhino.Geometry",
    "rhinoscriptsyntax",
    "scriptcontext"
  ],
  "has_docstring": false
}