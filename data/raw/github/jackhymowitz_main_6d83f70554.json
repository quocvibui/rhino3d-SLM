{
  "source_url": "https://github.com/jackhymowitz/main/blob/7325131db23094f1a28bd184b6a68f864f41a729/01_GH_Components/py/BT_CreateXLObj_Geom.py",
  "repo": "jackhymowitz/main",
  "repo_stars": 0,
  "repo_description": "IDF2PH is a free open source toolkit for working with E+ and PHPP Energy Models",
  "license": "GPL-3.0",
  "filepath": "01_GH_Components/py/BT_CreateXLObj_Geom.py",
  "instruction": "Takes in the E+ objects from the IDF-->PHPP Component and creates simplied\r\r\nExcel-ready objects for writing to the PHPP\r\r\nEach 'excel-ready' object has a Value, a Cell Range ('A4', 'BB56', etc...)...",
  "code": "#\r\r\n# IDF2PHPP: A Plugin for exporting an EnergyPlus IDF file to the Passive House Planning Package (PHPP). Created by blgdtyp, llc\r\r\n# \r\r\n# This component is part of IDF2PHPP.\r\r\n# \r\r\n# Copyright (c) 2020, bldgtyp, llc <info@bldgtyp.com> \r\r\n# IDF2PHPP is free software; you can redistribute it and/or modify \r\r\n# it under the terms of the GNU General Public License as published \r\r\n# by the Free Software Foundation; either version 3 of the License, \r\r\n# or (at your option) any later version. \r\r\n# \r\r\n# IDF2PHPP is distributed in the hope that it will be useful,\r\r\n# but WITHOUT ANY WARRANTY; without even the implied warranty of \r\r\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the \r\r\n# GNU General Public License for more details.\r\r\n# \r\r\n# For a copy of the GNU General Public License\r\r\n# see <http://www.gnu.org/licenses/>.\r\r\n# \r\r\n# @license GPL-3.0+ <http://spdx.org/licenses/GPL-3.0+>\r\r\n#\r\r\n\"\"\"\r\r\nTakes in the E+ objects from the IDF-->PHPP Component and creates simplied\r\r\nExcel-ready objects for writing to the PHPP\r\r\nEach 'excel-ready' object has a Value, a Cell Range ('A4', 'BB56', etc...) and a Sheet Name\r\r\n-\r\r\nEM August 11, 2020\r\r\n\r\r\n    Args:\r\r\n        _PHPPObjs: A DataTree of the PHPP Objects to write out to Excel. Connect to the 'PHPPObjs_' in the 'IDF->PHPP Objs' Component.\r\r\n        zonesInclude_: <Optional> Input the Zone Name or a list of Zone Names to output to a PHPP document. If no input, all zones found in the IDF will be output to a single PHPP Excel document. \r\r\n        zoneExclude_: <Optional> Pass in a list of string values to filter out certain zones by name. If the zone name includes the string anywhere in its name, it will be removed from the set to output.\r\r\n        tfa_: <Optional> Input either a list of values (numbers) or a list of geometry representing the TFA (Treated Floor Area) of the building (m2). Set input as 'From Zone Geometry' and it will try and read any TFA from Zone's Room Objects as well. Direct input will take precedence over any Zone Rooms though. Leave blank for no TFA output to the PHPP\r\r\n        thermalBridges_: <Optional> Input of Thermal Bridge Objects to write to the PHPP\r\r\n        udRowStarts_: <Optional> Input a list of string values for any non-standard starting positions (rows) in your PHPP. This might be neccessary if you have modified your PHPP from the normal one you got originally. For instance, if you added new rows to the PHPP in  order to add more rooms (Additional Ventilation) or surfaces (Areas) or that sort of thing. To set the correct values here, input strings in the format \" Worksheet Name, Start Key: New Start Row \" - so use commas to separate the levels of the dict, then a semicolon before the value you want to input. Will accept multiline strings for multiple value resets.\r\r\n        Enter any of the following valid Start Rows:\r\r\n            -  Additional Ventilation, Rooms: ## (Default=56)\r\r\n            -  Additional Ventilation, Vent Unit Selection: ## (Default=97)\r\r\n            -  Additional Ventilation, Vent Ducts: ## (Default=127)\r\r\n            -  Components, Ventilator: ## (Default=15)\r\r\n            -  Areas, TB: ## (Default=145)\r\r\n            -  Areas, Surfaces: ## (Default=41)\r\r\n            -  Electricity non-res, Lighting: ## (Default= 19)\r\r\n            -  Electricity non-res, Office Equip: ## (Default=62)\r\r\n            -  Electricity non-res, Kitchen: ## (Default=77)\r\r\n    Returns:\r\r\n        toPHPP_Geom_: A DataTree of the final clean, Excel-Ready output objects. Each output object has a Worksheet-Name, a Cell Range, and a Value. Connect to the 'Geom_' input on the 'Write 2PHPP' Component to write to Excel.\r\r\n\"\"\"\r\r\n\r\r\nghenv.Component.Name = \"BT_CreateXLObj_Geom\"\r\r\nghenv.Component.NickName = \"Create Excel Obj - Geom\"\r\r\nghenv.Component.Message = 'AUG_11_2020'\r\r\nghenv.Component.IconDisplayMode = ghenv.Component.IconDisplayMode.application\r\r\nghenv.Component.Category = \"BT\"\r\r\nghenv.Component.SubCategory = \"02 | IDF2PHPP\"\r\r\n\r\r\nimport Grasshopper.Kernel as ghK\r\r\nfrom string import ascii_uppercase\r\r\nimport itertools\r\r\nfrom System import Object\r\r\nfrom Grasshopper import DataTree\r\r\nfrom Grasshopper.Kernel.Data import GH_Path\r\r\nimport rhinoscriptsyntax as rs\r\r\nimport ghpythonlib.components as gh\r\r\nimport scriptcontext as sc\r\r\nfrom collections import defaultdict\r\r\nimport statistics\r\r\n\r\r\n# Classes and Defs\r\r\nPHPP_XL_Obj = sc.sticky['PHPP_XL_Obj'] \r\r\npreview = sc.sticky['Preview']\r\r\nPHPP_DHW_System = sc.sticky['PHPP_DHW_System']\r\r\nPHPP_DHW_usage = sc.sticky['PHPP_DHW_usage'] \r\r\nPHPP_DHW_branch_piping = sc.sticky['PHPP_DHW_branch_piping']\r\r\nPHPP_DHW_tank = sc.sticky['PHPP_DHW_tank']\r\r\nPHPP_DHW_RecircPipe = sc.sticky['PHPP_DHW_RecircPipe']\r\r\n\r\r\ndef getUvalues(_inputBranch):\r\r\n    uID_Count = 1\r\r\n    uValueUID_Names = []\r\r\n    uValuesConstructorStartRow = 10\r\r\n    uValuesList = []\r\r\n    print 'Creating the U-Values Objects...'\r\r\n    for eachConst in _inputBranch:\r\r\n        # for each Construction Assembly in the model....\r\r\n        \r\r\n        # Get the Construction's Name and the Materal Layers in the EP Model\r\r\n        construcionNameEP = getattr(eachConst, 'Name')\r\r\n        layers = sorted(getattr(eachConst, 'Layers'))\r\r\n        intInsuFlag = eachConst.IntInsul if eachConst.IntInsul != None else ''\r\r\n        \r\r\n        # Filter out any of the Window Constructions\r\r\n        isWindow = False\r\r\n        opaqueMaterialNames = []\r\r\n        for eachMat in _PHPPObjs.Branch(0):\r\r\n            opaqueMaterialNames.append(eachMat.Name) # Get all the Opaque Construction Material Names\r\r\n        \r\r\n        # Check if the material matches any of the Opaque ones\r\r\n        for eachLayer in layers:\r\r\n            if eachLayer[1] in opaqueMaterialNames:\r\r\n                eachLayer[1]\r\r\n                break\r\r\n            else:\r\r\n                # If not... it must be a window (maybe?)\r\r\n                isWindow = True\r\r\n        \r\r\n        if isWindow == True:\r\r\n            pass\r\r\n        else:\r\r\n            # Fix the name to remove 'PHPP_CONST_'\r\r\n            if 'PHPP_CONST_' in construcionNameEP:\r\r\n                constName_clean = construcionNameEP.split('PHPP_CONST_')[1].replace('_', ' ')\r\r\n            else:\r\r\n                constName_clean = construcionNameEP.replace('_', ' ')\r\r\n            \r\r\n            # Create the list of User-ID Constructions to match PHPP\r\r\n            uValueUID_Names.append('{:02d}ud-{}'.format(uID_Count, constName_clean) )\r\r\n            \r\r\n            # Create the Objects for the Header Piece (Name, Rsi, Rse)\r\r\n            nameAddress = '{}{}'.format('M', uValuesConstructorStartRow + 1) # Construction Name\r\r\n            rSi = '{}{}'.format('M', uValuesConstructorStartRow + 3) # R-surface-int\r\r\n            rSe = '{}{}'.format('M', uValuesConstructorStartRow + 4) # R-surface-ext\r\r\n            intIns = '{}{}'.format('S', uValuesConstructorStartRow + 1) # Interior Insulation Flag\r\r\n            \r\r\n            uValuesList.append( PHPP_XL_Obj('U-Values', nameAddress, constName_clean))\r\r\n            uValuesList.append( PHPP_XL_Obj('U-Values', rSi, 0)) # For now, zero out\r\r\n            uValuesList.append( PHPP_XL_Obj('U-Values', rSe, 0)) # For now, zero out\r\r\n            if eachConst.IntInsul != None:\r\r\n                uValuesList.append( PHPP_XL_Obj('U-Values', intIns, 'x'))\r\r\n            \r\r\n            # Create the actual Material Layers for PHPP U-Value\r\r\n            layerCount = 0\r\r\n            for layer in layers:\r\r\n                # For each layer in the Construction Assembly...\r\r\n                for eachMatLayer in  _PHPPObjs.Branch(0):\r\r\n                    # See if the Construction's Layer material name matches one in the Materials list....\r\r\n                    # If so, use those parameters from the Material Layer\r\r\n                    if layer[1] == getattr(eachMatLayer, 'Name'):\r\r\n                        # Filter out any MASSLAYERs\r\r\n                        if layer[1] != 'MASSLAYER':\r\r\n                            \r\r\n                            # Clean the name\r\r\n                            if 'PHPP_MAT_' in layer[1]:\r\r\n                                layerMatName = layer[1].split('PHPP_MAT_')[1].replace('_', ' ')\r\r\n                            else:\r\r\n                                layerMatName = layer[1].replace('_', ' ')\r\r\n                            \r\r\n                            layerNum = layer[0]\r\r\n                            layerMatCond = getattr(eachMatLayer, 'LayerConductivity')\r\r\n                            layerThickness = getattr(eachMatLayer, 'LayerThickness')*1000 # Cus PHPP uses mm for thickness\r\r\n                            \r\r\n                            # Set up the Range tagets\r\r\n                            layer1Address_L = '{}{}'.format('L', uValuesConstructorStartRow + 7 + layerCount) # Material Name\r\r\n                            layer1Address_M = '{}{}'.format('M', uValuesConstructorStartRow + 7 + layerCount) # Conductivity\r\r\n                            layer1Address_S = '{}{}'.format('S', uValuesConstructorStartRow + 7 + layerCount) # Thickness\r\r\n                            \r\r\n                            # Create the Layer Objects\r\r\n                            uValuesList.append( PHPP_XL_Obj('U-Values', layer1Address_L, layerMatName))# Material Name\r\r\n                            uValuesList.append( PHPP_XL_Obj('U-Values', layer1Address_M, layerMatCond)) # Conductivity\r\r\n                            uValuesList.append( PHPP_XL_Obj('U-Values', layer1Address_S, layerThickness)) # Thickness\r\r\n                            \r\r\n                            layerCount+=1\r\r\n            \r\r\n            uID_Count += 1\r\r\n            uValuesConstructorStartRow += 21\r\r\n    \r\r\n    return uValuesList, uValueUID_Names\r\r\n\r\r\ndef getComponents(_inputBranch):\r\r\n    winComponentStartRow = 15\r\r\n    frame_Count = 0\r\r\n    glass_Count = 0\r\r\n    winComponentsList = []\r\r\n    glassNameDict = {}\r\r\n    frameNameDict = {}\r\r\n    \r\r\n    print('Creating the Components:Window Objects...')\r\r\n    \r\r\n    for eachWin in _inputBranch:\r\r\n        # For each PHPP Style Window Object in the model....\r\r\n        \r\r\n        ########## Glass ##########\r\r\n        # Pull out the Glass info from the window\r\r\n        gNm = getattr(eachWin.Type_Glass, 'Name')\r\r\n        gV = getattr(eachWin.Type_Glass, 'gValue')\r\r\n        uG = getattr(eachWin.Type_Glass, 'uValue')\r\r\n        \r\r\n        if gNm not in glassNameDict.keys():\r\r\n            # Add the new glass type to the dict of UD Names:\r\r\n            # ie: {'Ikon: SDH': '01ud-Ikon: SDH', ....}\r\r\n            glassNameDict[gNm] = '{:02d}ud-{}'.format(glass_Count+1, gNm)\r\r\n            \r\r\n            # Set the glass range addresses\r\r\n            Address_Gname = '{}{}'.format('IE', winComponentStartRow + glass_Count) # Name\r\r\n            Address_Gvalue = '{}{}'.format('IF', winComponentStartRow + glass_Count) # g-Value\r\r\n            Address_Uvalue = '{}{}'.format('IG', winComponentStartRow + glass_Count) # U-Value\r\r\n            \r\r\n            # Create the PHPP write Objects\r\r\n            winComponentsList.append( PHPP_XL_Obj('Components', Address_Gname, gNm))# Glass Type Name\r\r\n            winComponentsList.append( PHPP_XL_Obj('Components', Address_Gvalue, gV))# g-Value\r\r\n            winComponentsList.append( PHPP_XL_Obj('Components', Address_Uvalue, uG))# U-Value\r\r\n            \r\r\n            glass_Count +=1\r\r\n            \r\r\n        # Add the new PHPP UD Glass Name to the Window:Simple Object\r\r\n        setattr(eachWin, 'UD_glass_Name', glassNameDict[gNm] )\r\r\n        \r\r\n        ########## Frames ##########\r\r\n        # Get the Frame info\r\r\n        fNm = getattr(eachWin.Type_Frame, 'Name')\r\r\n        uF_L, uF_R, uF_B, uF_T  = eachWin.Type_Frame.uLeft, eachWin.Type_Frame.uRight, eachWin.Type_Frame.uBottom, eachWin.Type_Frame.uTop\r\r\n        wF_L, wF_R, wF_B, wF_T  = eachWin.Type_Frame.fLeft, eachWin.Type_Frame.fRight, eachWin.Type_Frame.fBottom, eachWin.Type_Frame.fTop\r\r\n        psiG_L, psiG_R, psiG_B, psiG_T  = eachWin.Type_Frame.psigLeft, eachWin.Type_Frame.psigRight, eachWin.Type_Frame.psigBottom, eachWin.Type_Frame.psigTop\r\r\n        psiI_L, psiI_R, psiI_B, psiI_T  = eachWin.Type_Frame.psiInstLeft, eachWin.Type_Frame.psiInstRight, eachWin.Type_Frame.psiInstBottom, eachWin.Type_Frame.psiInstTop\r\r\n        \r\r\n        if fNm not in frameNameDict.keys():\r\r\n            # Add the new frame type to the dict of UD Names:\r\r\n            # ie: {'Ikon: SDH': '01ud-Ikon: SDH', ....}\r\r\n            frameNameDict[fNm] = '{:02d}ud-{}'.format(frame_Count+1, fNm) # was glass_count????\r\r\n            \r\r\n            # Set the frame range address\r\r\n            Address_Fname = '{}{}'.format('IL', winComponentStartRow + frame_Count)\r\r\n            Address_Uf_Left = '{}{}'.format('IM', winComponentStartRow + frame_Count)\r\r\n            Address_Uf_Right = '{}{}'.format('IN', winComponentStartRow + frame_Count)\r\r\n            Address_Uf_Bottom = '{}{}'.format('IO', winComponentStartRow + frame_Count)\r\r\n            Address_Uf_Top = '{}{}'.format('IP', winComponentStartRow + frame_Count)\r\r\n            Address_W_Left = '{}{}'.format('IQ', winComponentStartRow + frame_Count)\r\r\n            Address_W_Right = '{}{}'.format('IR', winComponentStartRow + frame_Count)\r\r\n            Address_W_Bottom = '{}{}'.format('IS', winComponentStartRow + frame_Count)\r\r\n            Address_W_Top = '{}{}'.format('IT', winComponentStartRow + frame_Count)\r\r\n            Address_Psi_g_Left = '{}{}'.format('IU', winComponentStartRow + frame_Count)\r\r\n            Address_Psi_g_Right = '{}{}'.format('IV', winComponentStartRow + frame_Count)\r\r\n            Address_Psi_g_Bottom = '{}{}'.format('IW', winComponentStartRow + frame_Count)\r\r\n            Address_Psi_g_Top = '{}{}'.format('IX', winComponentStartRow + frame_Count)\r\r\n            Address_Psi_I_Left = '{}{}'.format('IY', winComponentStartRow + frame_Count)\r\r\n            Address_Psi_I_Right = '{}{}'.format('IZ', winComponentStartRow + frame_Count)\r\r\n            Address_Psi_I_Bottom = '{}{}'.format('JA', winComponentStartRow + frame_Count)\r\r\n            Address_Psi_I_Top = '{}{}'.format('JB', winComponentStartRow + frame_Count)\r\r\n            \r\r\n            # Create the PHPP Objects for the Frames\r\r\n            winComponentsList.append( PHPP_XL_Obj('Components', Address_Fname, fNm))# Frame Type Name\r\r\n            winComponentsList.append( PHPP_XL_Obj('Components', Address_Uf_Left, uF_L)) # Frame Type U-Values\r\r\n            winComponentsList.append( PHPP_XL_Obj('Components', Address_Uf_Right, uF_R))\r\r\n            winComponentsList.append( PHPP_XL_Obj('Components', Address_Uf_Bottom, uF_B))\r\r\n            winComponentsList.append( PHPP_XL_Obj('Components', Address_Uf_Top, uF_T))\r\r\n            \r\r\n            winComponentsList.append( PHPP_XL_Obj('Components', Address_W_Left, wF_L)) # Frame Type Widths\r\r\n            winComponentsList.append( PHPP_XL_Obj('Components', Address_W_Right, wF_R))\r\r\n            winComponentsList.append( PHPP_XL_Obj('Components', Address_W_Bottom, wF_B))\r\r\n            winComponentsList.append( PHPP_XL_Obj('Components', Address_W_Top, wF_T))\r\r\n            \r\r\n            winComponentsList.append( PHPP_XL_Obj('Components', Address_Psi_g_Left, psiG_L)) # Frame Type Psi-Glazing\r\r\n            winComponentsList.append( PHPP_XL_Obj('Components', Address_Psi_g_Right, psiG_R))\r\r\n            winComponentsList.append( PHPP_XL_Obj('Components', Address_Psi_g_Bottom, psiG_B))\r\r\n            winComponentsList.append( PHPP_XL_Obj('Components', Address_Psi_g_Top, psiG_T))\r\r\n            \r\r\n            winComponentsList.append( PHPP_XL_Obj('Components', Address_Psi_I_Left, psiI_L)) # Frame Type Psi-Installs\r\r\n            winComponentsList.append( PHPP_XL_Obj('Components', Address_Psi_I_Right, psiI_R))\r\r\n            winComponentsList.append( PHPP_XL_Obj('Components', Address_Psi_I_Bottom, psiI_B))\r\r\n            winComponentsList.append( PHPP_XL_Obj('Components', Address_Psi_I_Top, psiI_T))\r\r\n            \r\r\n            frame_Count +=1\r\r\n            \r\r\n        # Add the PHPP UD Frame Name to the Window:Simple Object\r\r\n        setattr(eachWin, 'UD_frame_Name', frameNameDict[fNm] )\r\r\n    \r\r\n    return winComponentsList\r\r\n\r\r\ndef getAreas(_inputBranch, _zones):\r\r\n    areasRowStart = 41\r\r\n    areaCount = 0\r\r\n    uID_Count = 1\r\r\n    areasList = []\r\r\n    surfacesIncluded = []\r\r\n    print \"Creating the 'Areas' Objects...\"\r\r\n    for surface in _inputBranch:\r\r\n        # for each Opaque Surface in the model....\r\r\n        \r\r\n        # First, see if the Surface should be included in the output\r\r\n        for eachZoneName in _zones:\r\r\n            if surface.HostZoneName == eachZoneName:\r\r\n                includeSurface = True\r\r\n                break\r\r\n            else:\r\r\n                includeSurface = False\r\r\n        \r\r\n        if includeSurface:\r\r\n            # Get the Surface Parameters\r\r\n            nm = getattr(surface, 'Name')\r\r\n            groupNum = getattr(surface, 'GroupNum')\r\r\n            quantity = 1\r\r\n            surfaceArea = getattr(surface, 'SurfaceArea')\r\r\n            assemblyName = getattr(surface, 'AssemblyName').replace('_', ' ') \r\r\n            angleFromNorth = getattr(surface, 'AngleFromNorth')\r\r\n            angleFromHoriz = getattr(surface, 'AngleFromHoriz')\r\r\n            shading = getattr(surface, 'Factor_Shading')\r\r\n            abs = getattr(surface, 'Factor_Absorptivity')\r\r\n            emmis = getattr(surface, 'Factor_Emissivity')\r\r\n            \r\r\n            # Find the right UID name (with the numeric prefix)\r\r\n            for uIDName in uValueUID_Names:\r\r\n                if assemblyName in uIDName[5:] or uIDName[5:] in assemblyName: # compare to slice without prefix\r\r\n                    assemblyName = uIDName\r\r\n            \r\r\n            # Setup the Excel Address Locations\r\r\n            Address_Name = '{}{}'.format('L', areasRowStart + areaCount)\r\r\n            Address_GroupNum = '{}{}'.format('M', areasRowStart + areaCount)\r\r\n            Address_Quantity = '{}{}'.format('P', areasRowStart + areaCount)\r\r\n            Address_Area = '{}{}'.format('V', areasRowStart + areaCount)\r\r\n            Address_Assembly = '{}{}'.format('AC', areasRowStart + areaCount)\r\r\n            Address_AngleNorth = '{}{}'.format('AG', areasRowStart + areaCount)\r\r\n            Address_AngleHoriz = '{}{}'.format('AH', areasRowStart + areaCount)\r\r\n            Address_ShadingFac = '{}{}'.format('AJ', areasRowStart + areaCount)\r\r\n            Address_Abs = '{}{}'.format('AK', areasRowStart + areaCount)\r\r\n            Address_Emmis = '{}{}'.format('AL', areasRowStart + areaCount)\r\r\n            \r\r\n            areasList.append( PHPP_XL_Obj('Areas', Address_Name, nm))# Surface Name\r\r\n            areasList.append( PHPP_XL_Obj('Areas', Address_GroupNum, groupNum))# Surface Group Number\r\r\n            areasList.append( PHPP_XL_Obj('Areas', Address_Quantity, quantity))# Surface Quantity\r\r\n            areasList.append( PHPP_XL_Obj('Areas', Address_Area, surfaceArea))# Surface Area (m2)\r\r\n            areasList.append( PHPP_XL_Obj('Areas', Address_Assembly, assemblyName))# Assembly Type Name\r\r\n            areasList.append( PHPP_XL_Obj('Areas', Address_AngleNorth, angleFromNorth))# Orientation Off North\r\r\n            areasList.append( PHPP_XL_Obj('Areas', Address_AngleHoriz, angleFromHoriz))# Orientation Off Horizontal\r\r\n            areasList.append( PHPP_XL_Obj('Areas', Address_ShadingFac, shading))# Shading Factor\r\r\n            areasList.append( PHPP_XL_Obj('Areas', Address_Abs, abs))# Absorptivity\r\r\n            areasList.append( PHPP_XL_Obj('Areas', Address_Emmis, emmis))# Emmissivity\r\r\n            \r\r\n            # Add the PHPP UD Surface Name to the Surface Object\r\r\n            setattr(surface, 'UD_Srfc_Name', '{:d}-{}'.format(uID_Count, nm) )\r\r\n            \r\r\n            # Keep track of which Surfaces are included in the output\r\r\n            surfacesIncluded.append(nm)\r\r\n            \r\r\n            uID_Count += 1\r\r\n            areaCount += 1\r\r\n    \r\r\n    areasList.append( PHPP_XL_Obj('Areas', 'L19', 'Suspended Floor') )\r\r\n    return areasList, surfacesIncluded\r\r\n\r\r\ndef getThermalBridges(_inputBranch, _startRows):\r\r\n    tb_RowStart = _startRows.get('Areas').get('TB')\r\r\n    tb_List = []\r\r\n    print \"Creating the 'Thermal Bridging' Objects...\"\r\r\n    for i, tb in enumerate(_inputBranch):\r\r\n        # for each Thermal Bridge in the model....\r\r\n        if tb.Name == 'Estimated':\r\r\n            i = 0\r\r\n        else:\r\r\n            i = i+1\r\r\n        \r\r\n         # Setup the Excel Address Locations\r\r\n        Address_Name = '{}{}'.format('L', tb_RowStart + i)\r\r\n        Address_GroupNo = '{}{}'.format('M', tb_RowStart + i)\r\r\n        Address_Quantity = '{}{}'.format('P', tb_RowStart + i)\r\r\n        Address_Length = '{}{}'.format('R', tb_RowStart + i)\r\r\n        Address_PsiValue = '{}{}'.format('X', tb_RowStart + i)\r\r\n        \r\r\n        tb_List.append( PHPP_XL_Obj('Areas', Address_Name, tb.Name))\r\r\n        tb_List.append( PHPP_XL_Obj('Areas', Address_GroupNo, tb.GroupNo))\r\r\n        tb_List.append( PHPP_XL_Obj('Areas', Address_Quantity, 1))\r\r\n        tb_List.append( PHPP_XL_Obj('Areas', Address_Length, tb.Length))\r\r\n        tb_List.append( PHPP_XL_Obj('Areas', Address_PsiValue, tb.PsiValue))\r\r\n    \r\r\n    return tb_List\r\r\n\r\r\ndef getWindows(_inputBranch, _surfacesIncluded, _srfcBranch):\r\r\n    windowsRowStart = 24\r\r\n    windowsCount = 0\r\r\n    winSurfacesList = []\r\r\n    \r\r\n    print \"Creating the 'Windows' Objects...\"\r\r\n    for window in _inputBranch:\r\r\n        # for each Window Surface Object in the model....\r\r\n        # Get the window's basic params\r\r\n        quant = getattr(window, 'Quantity')\r\r\n        nm = getattr(window, 'Name')\r\r\n        w = getattr(window, 'Width')\r\r\n        h = getattr(window, 'Height')\r\r\n        host = getattr(window, 'HostSrfc')\r\r\n        glassType = getattr(window.Type_Glass, 'Name')\r\r\n        frameType = getattr(window.Type_Frame, 'Name')\r\r\n        glassTypeUD = getattr(window, 'UD_glass_Name')\r\r\n        frameTypeUD = getattr(window, 'UD_frame_Name')\r\r\n        variantType = getattr(window, 'Type_Variant', 'a')\r\r\n        \r\r\n        # See if the Window should be included in the output\r\r\n        includeWindow = False\r\r\n        for eachSurfaceName in _surfacesIncluded:\r\r\n            if eachSurfaceName == host:\r\r\n                includeWindow = True\r\r\n                break\r\r\n            else:\r\r\n                includeWindow = False\r\r\n        \r\r\n        if includeWindow:\r\r\n            # Find the Window's Host Surface UD\r\r\n            for srfc in _srfcBranch:\r\r\n                if host == getattr(srfc, 'Name'):\r\r\n                    hostUD = getattr(srfc, 'UD_Srfc_Name')\r\r\n           \r\r\n           # Get the Window Range Addresses\r\r\n            Address_varType = '{}{}'.format('F', windowsRowStart + windowsCount)\r\r\n            Address_winQuantity = '{}{}'.format('L', windowsRowStart + windowsCount)\r\r\n            Address_winName = '{}{}'.format('M', windowsRowStart + windowsCount)\r\r\n            Address_w = '{}{}'.format('Q', windowsRowStart + windowsCount)\r\r\n            Address_h = '{}{}'.format('R', windowsRowStart + windowsCount)\r\r\n            Address_hostName = '{}{}'.format('S', windowsRowStart + windowsCount)\r\r\n            Address_glassType = '{}{}'.format('T', windowsRowStart + windowsCount)\r\r\n            Address_frameType = '{}{}'.format('U', windowsRowStart + windowsCount)\r\r\n            Address_install_Left = '{}{}'.format('AA', windowsRowStart + windowsCount)\r\r\n            Address_install_Right = '{}{}'.format('AB', windowsRowStart + windowsCount)\r\r\n            Address_install_Bottom = '{}{}'.format('AC', windowsRowStart + windowsCount)\r\r\n            Address_install_Top = '{}{}'.format('AD', windowsRowStart + windowsCount)\r\r\n            \r\r\n            # Create the PHPP Window Object\r\r\n            winSurfacesList.append( PHPP_XL_Obj('Windows', Address_varType, variantType)) # Quantity\r\r\n            winSurfacesList.append( PHPP_XL_Obj('Windows', Address_winQuantity, quant)) # Quantity\r\r\n            winSurfacesList.append( PHPP_XL_Obj('Windows', Address_winName, nm)) # Name\r\r\n            winSurfacesList.append( PHPP_XL_Obj('Windows', Address_w, w)) # Width\r\r\n            winSurfacesList.append( PHPP_XL_Obj('Windows', Address_h, h)) # Height\r\r\n            winSurfacesList.append( PHPP_XL_Obj('Windows', Address_hostName, hostUD)) # Host Name\r\r\n            winSurfacesList.append( PHPP_XL_Obj('Windows', Address_glassType, glassTypeUD)) # Glass UD Name\r\r\n            winSurfacesList.append( PHPP_XL_Obj('Windows', Address_frameType, frameTypeUD)) # Frame UD Name\r\r\n            winSurfacesList.append( PHPP_XL_Obj('Windows', Address_install_Left, window.Installs.Inst_L)) # Install Condition Left\r\r\n            winSurfacesList.append( PHPP_XL_Obj('Windows', Address_install_Right, window.Installs.Inst_R)) # Install Condition Right\r\r\n            winSurfacesList.append( PHPP_XL_Obj('Windows', Address_install_Bottom, window.Installs.Inst_B)) # Install Condition Bottom\r\r\n            winSurfacesList.append( PHPP_XL_Obj('Windows', Address_install_Top, window.Installs.Inst_T)) # Install Condition Top\r\r\n            \r\r\n            windowsCount += 1\r\r\n            \r\r\n    return winSurfacesList\r\r\n\r\r\ndef getShading(_inputBranch, _surfacesIncluded):\r\r\n    shadingRowStart = 17\r\r\n    shadingCount = 0\r\r\n    shadingList = []\r\r\n    print \"Creating the 'Shading' Objects...\"\r\r\n    for window in _inputBranch:\r\r\n        # for each Window IDF Object in the model....\r\r\n        \r\r\n        # First, see if the Window should be included in the output\r\r\n        host = getattr(window, 'HostSrfc')\r\r\n        includeWindow = False\r\r\n        for eachSurfaceName in _surfacesIncluded:\r\r\n            if eachSurfaceName == host:\r\r\n                includeWindow = True\r\r\n                break\r\r\n            else:\r\r\n                includeWindow = False\r\r\n        \r\r\n        if includeWindow:\r\r\n            # Get the Window's shading Params\r\r\n            try:\r\r\n                winterShadingFactor = getattr(window, 'winterShadingFac')\r\r\n                summerShadingFactor = getattr(window, 'summerShadingFac')\r\r\n            except:\r\r\n                winterShadingFactor = 0.75\r\r\n                summerShadingFactor = 0.75\r\r\n            \r\r\n            # Create the PHPP Objects\r\r\n            Address1_start = '{}{}'.format('AF', shadingRowStart + shadingCount)\r\r\n            Address1_end = '{}{}'.format('AG', shadingRowStart + shadingCount)\r\r\n            shadingList.append( PHPP_XL_Obj( 'Shading', Address1_start , winterShadingFactor))\r\r\n            shadingList.append( PHPP_XL_Obj( 'Shading', Address1_end , summerShadingFactor))\r\r\n            \r\r\n            shadingCount += 1\r\r\n        \r\r\n    return shadingList\r\r\n\r\r\ndef getTFA(tfaFromUser, tfaBranch, _zones):\r\r\n    ##########################################\r\r\n    ##############     TFA     ###############\r\r\n    tfa = []\r\r\n    \r\r\n    if len(tfaFromUser)>0:\r\r\n        if tfaFromUser[0] == 'From Zone Geometry':\r\r\n            # Pulling data in from the HB Zone Objects\r\r\n            print(\"Trying to find any Honeybee Zone Room TFA info...\")\r\r\n            try:\r\r\n                tfaSurfaceAreas = [0]\r\r\n                for each in tfaBranch:\r\r\n                    # First, see if the Surface should be included in the output\r\r\n                    for zoneName in _zones:\r\r\n                        if each.HostZoneName == zoneName:\r\r\n                            includeRoom = True\r\r\n                            break\r\r\n                        else:\r\r\n                            includeRoom = False\r\r\n                    \r\r\n                    if includeRoom:\r\r\n                        # Get the room's TFA info\r\r\n                        roomTFA = each.FloorArea_TFA\r\r\n                        tfaSurfaceAreas.append( roomTFA )\r\r\n                # Total up the TFA Areas for output\r\r\n                tfaTotal = sum(tfaSurfaceAreas)\r\r\n                tfa.append( PHPP_XL_Obj('Areas', 'V34', tfaTotal )) # TFA (m2)\r\r\n            except:\r\r\n                pass\r\r\n        else:\r\r\n            print(\"Determining the TFA from user input...\")\r\r\n            tfaSurfaceAreas = [0]\r\r\n            for each in tfaFromUser:\r\r\n                try:\r\r\n                    # if its a number or list of numbers\r\r\n                    tfaSurfaceAreas.append(float(each))\r\r\n                except:\r\r\n                    # if it isn't a number, try bringing it in as geometry\r\r\n                    area = gh.Area(each)[0] # Position 0 is the area in m2\r\r\n                    tfaSurfaceAreas.append(float(area))\r\r\n            \r\r\n            if sum(tfaSurfaceAreas) != 0:\r\r\n                tfaTotal = sum(tfaSurfaceAreas)\r\r\n                tfa.append( PHPP_XL_Obj('Areas', 'V34', tfaTotal )) # TFA (m2)\r\r\n    \r\r\n    return tfa\r\r\n\r\r\ndef getAddnlVentRooms(_inputBranch, _ventSystems, _zones, _startRows):\r\r\n    print \"Creating 'Additional Ventilation' Rooms... \"\r\r\n    addnlVentRooms = []\r\r\n    ventUnitsUsed = []\r\r\n    roomRowStart = _startRows.get('Additional Ventilation').get('Rooms', 57)\r\r\n    ventUnitRowStart = _startRows.get('Additional Ventilation').get('Vent Unit Selection', 97)\r\r\n    ventSystemsInlcuded = set()\r\r\n    i = 0\r\r\n    \r\r\n    for i, roomObj in enumerate(_inputBranch):\r\r\n        \r\r\n        # First, see if the Room should be included in the output\r\r\n        for zoneName in _zones:\r\r\n            if roomObj.HostZoneName == zoneName:\r\r\n                includeRoom = True\r\r\n                break\r\r\n            else:\r\r\n                includeRoom = False\r\r\n        \r\r\n        if includeRoom:\r\r\n            ventSystemsInlcuded.add(roomObj.VentSystemName)\r\r\n            \r\r\n            # Try and sort out the Room's Ventilation airflow and schedule if there is any\r\r\n            try:\r\r\n                roomAirFlow_sup = roomObj.getVsup()\r\r\n                roomAirFlow_eta = roomObj.getVeta()\r\r\n                roomAirFlow_trans = roomObj.getVtrans()\r\r\n            except:\r\r\n                roomAirFlow_sup = roomObj.getVsup()\r\r\n                roomAirFlow_eta = roomObj.getVeta()\r\r\n                roomAirFlow_trans = roomObj.getVtrans()\r\r\n            \r\r\n            try:\r\r\n                ventUnitName = roomObj.VentUnitName\r\r\n                ventSystemName = roomObj.VentSystemName\r\r\n            except:\r\r\n                ventUnitName = '97ud-Default HRV unit'\r\r\n                ventSystemName = 'Vent-1'\r\r\n            \r\r\n            # Get the Ventilation Schedule from the room if it has any\r\r\n            try:\r\r\n                speed_high = roomObj.phppVentSched.speed_high\r\r\n                time_high = roomObj.phppVentSched.time_high\r\r\n                speed_med = roomObj.phppVentSched.speed_med\r\r\n                time_med = roomObj.phppVentSched.time_med\r\r\n                speed_low = roomObj.phppVentSched.speed_low\r\r\n                time_low = roomObj.phppVentSched.time_low\r\r\n            except:\r\r\n                speed_high = 1\r\r\n                time_high = 1\r\r\n                speed_med = None\r\r\n                time_med = None\r\r\n                speed_low = None\r\r\n                time_low = None\r\r\n            \r\r\n            address_Amount = '{}{}'.format('D', roomRowStart + i)\r\r\n            address_Name = '{}{}'.format('E', roomRowStart + i)\r\r\n            address_VentAllocation = '{}{}'.format('F', roomRowStart + i)\r\r\n            address_Area = '{}{}'.format('G', roomRowStart + i)\r\r\n            address_RoomHeight = '{}{}'.format('H', roomRowStart + i)\r\r\n            address_SupplyAirFlow = '{}{}'.format('J', roomRowStart + i)\r\r\n            address_ExractAirFlow = '{}{}'.format('K', roomRowStart + i)\r\r\n            address_TransferAirFlow = '{}{}'.format('L', roomRowStart + i)\r\r\n            address_Util_hrs = '{}{}'.format('N', roomRowStart + i)\r\r\n            address_Util_days = '{}{}'.format('O', roomRowStart + i)\r\r\n            address_Holidays = '{}{}'.format('P', roomRowStart + i)\r\r\n            \r\r\n            address_ventSpeed_high = '{}{}'.format('Q', roomRowStart + i)\r\r\n            address_ventTime_high = '{}{}'.format('R', roomRowStart + i) \r\r\n            address_ventSpeed_med = '{}{}'.format('S', roomRowStart + i)\r\r\n            address_ventTime_med = '{}{}'.format('T', roomRowStart + i)\r\r\n            address_ventSpeed_low = '{}{}'.format('U', roomRowStart + i)\r\r\n            address_ventTime_low = '{}{}'.format('V', roomRowStart + i)\r\r\n            \r\r\n            ventMatchFormula = '=MATCH(\"{}\",E{}:E{},0)'.format(ventSystemName, ventUnitRowStart, ventUnitRowStart+9)\r\r\n            \r\r\n            addnlVentRooms.append( PHPP_XL_Obj('Additional Vent', address_Amount, 1 ))\r\r\n            addnlVentRooms.append( PHPP_XL_Obj('Additional Vent', address_Name, '{}-{}'.format(roomObj.RoomNumber, roomObj.RoomName )))\r\r\n            addnlVentRooms.append( PHPP_XL_Obj('Additional Vent', address_VentAllocation, ventMatchFormula ))\r\r\n            addnlVentRooms.append( PHPP_XL_Obj('Additional Vent', address_Area, roomObj.FloorArea_TFA ))\r\r\n            addnlVentRooms.append( PHPP_XL_Obj('Additional Vent', address_RoomHeight, roomObj.RoomClearHeight ))\r\r\n            \r\r\n            addnlVentRooms.append( PHPP_XL_Obj('Additional Vent', address_SupplyAirFlow, roomAirFlow_sup ))\r\r\n            addnlVentRooms.append( PHPP_XL_Obj('Additional Vent', address_ExractAirFlow, roomAirFlow_eta ))\r\r\n            addnlVentRooms.append( PHPP_XL_Obj('Additional Vent', address_TransferAirFlow, roomAirFlow_trans ))\r\r\n            \r\r\n            addnlVentRooms.append( PHPP_XL_Obj('Additional Vent', address_Util_hrs, '24'))\r\r\n            addnlVentRooms.append( PHPP_XL_Obj('Additional Vent', address_Util_days, '7'))\r\r\n            addnlVentRooms.append( PHPP_XL_Obj('Additional Vent', address_Holidays,'0'))\r\r\n            \r\r\n            addnlVentRooms.append( PHPP_XL_Obj('Additional Vent', address_ventSpeed_high, speed_high if speed_high else 1))\r\r\n            addnlVentRooms.append( PHPP_XL_Obj('Additional Vent', address_ventTime_high, time_high if time_high else 1))\r\r\n            addnlVentRooms.append( PHPP_XL_Obj('Additional Vent', address_ventSpeed_med,speed_med if speed_med else 1))\r\r\n            addnlVentRooms.append( PHPP_XL_Obj('Additional Vent', address_ventTime_med, time_med if time_med else 0))\r\r\n            addnlVentRooms.append( PHPP_XL_Obj('Additional Vent', address_ventSpeed_low,speed_low if speed_low else 0))\r\r\n            addnlVentRooms.append( PHPP_XL_Obj('Additional Vent', address_ventTime_low, time_low if time_low else 0))\r\r\n            \r\r\n            # Keep track of the names of the Vent units used\r\r\n            ventUnitsUsed.append( ventUnitName )\r\r\n    \r\r\n    # Include any Exhaust Ventilation Objects that are found in any of the included Vent Systems\r\r\n    rowCount = i+1\r\r\n    for ventSystemDict in _ventSystems:\r\r\n        for ventSystem in ventSystemDict.values():\r\r\n            if ventSystem.SystemName in ventSystemsInlcuded:\r\r\n                for exhaustVentObj in ventSystem.ExhaustObjs:\r\r\n                    for mode in ['on', 'off']:\r\r\n                        \r\r\n                        address_Amount = '{}{}'.format('D', roomRowStart + rowCount)\r\r\n                        address_Name = '{}{}'.format('E', roomRowStart + rowCount)\r\r\n                        address_VentAllocation = '{}{}'.format('F', roomRowStart + rowCount)\r\r\n                        address_Area = '{}{}'.format('G', roomRowStart + rowCount)\r\r\n                        address_RoomHeight = '{}{}'.format('H', roomRowStart + rowCount)\r\r\n                        address_SupplyAirFlow = '{}{}'.format('J', roomRowStart + rowCount)\r\r\n                        address_ExractAirFlow = '{}{}'.format('K', roomRowStart + rowCount)\r\r\n                        address_TransferAirFlow = '{}{}'.format('L', roomRowStart + rowCount)\r\r\n                        address_Util_hrs = '{}{}'.format('N', roomRowStart + rowCount)\r\r\n                        address_Util_days = '{}{}'.format('O', roomRowStart + rowCount)\r\r\n                        address_Holidays = '{}{}'.format('P', roomRowStart + rowCount)\r\r\n                            \r\r\n                        address_ventSpeed_high = '{}{}'.format('Q', roomRowStart + rowCount)\r\r\n                        address_ventTime_high = '{}{}'.format('R', roomRowStart + rowCount) \r\r\n                        address_ventSpeed_med = '{}{}'.format('S', roomRowStart + rowCount)\r\r\n                        address_ventTime_med = '{}{}'.format('T', roomRowStart + rowCount)\r\r\n                        address_ventSpeed_low = '{}{}'.format('U', roomRowStart + rowCount)\r\r\n                        address_ventTime_low = '{}{}'.format('V', roomRowStart + rowCount)\r\r\n                        \r\r\n                        ventMatchFormula = '=MATCH(\"{}\",E{}:E{},0)'.format(exhaustVentObj.Name, ventUnitRowStart, ventUnitRowStart+9)\r\r\n                        \r\r\n                        addnlVentRooms.append( PHPP_XL_Obj('Additional Vent', address_Amount, 1 ))\r\r\n                        addnlVentRooms.append( PHPP_XL_Obj('Additional Vent', address_Name, exhaustVentObj.Name +' [ON]' if mode=='on' else exhaustVentObj.Name +' [OFF]'))\r\r\n                        addnlVentRooms.append( PHPP_XL_Obj('Additional Vent', address_VentAllocation, ventMatchFormula ))\r\r\n                        addnlVentRooms.append( PHPP_XL_Obj('Additional Vent', address_Area, '10'))\r\r\n                        addnlVentRooms.append( PHPP_XL_Obj('Additional Vent', address_RoomHeight, '2.5' ))\r\r\n                        \r\r\n                        addnlVentRooms.append( PHPP_XL_Obj('Additional Vent', address_SupplyAirFlow, exhaustVentObj.FlowRate_On if mode=='on' else exhaustVentObj.FlowRate_Off))\r\r\n                        addnlVentRooms.append( PHPP_XL_Obj('Additional Vent', address_ExractAirFlow, exhaustVentObj.FlowRate_On if mode=='on' else exhaustVentObj.FlowRate_Off))\r\r\n                        addnlVentRooms.append( PHPP_XL_Obj('Additional Vent', address_TransferAirFlow, '0' ))\r\r\n                        \r\r\n                        addnlVentRooms.append( PHPP_XL_Obj('Additional Vent', address_Util_hrs, exhaustVentObj.HrsPerDay_On if mode=='on' else 24 - float(exhaustVentObj.HrsPerDay_On)))\r\r\n                        addnlVentRooms.append( PHPP_XL_Obj('Additional Vent', address_Util_days, exhaustVentObj.DaysPerWeek_On if mode=='on' else 7))\r\r\n                        addnlVentRooms.append( PHPP_XL_Obj('Additional Vent', address_Holidays, exhaustVentObj.Holidays))\r\r\n                        \r\r\n                        addnlVentRooms.append( PHPP_XL_Obj('Additional Vent', address_ventSpeed_high, 1))\r\r\n                        addnlVentRooms.append( PHPP_XL_Obj('Additional Vent', address_ventTime_high, 1))\r\r\n                        addnlVentRooms.append( PHPP_XL_Obj('Additional Vent', address_ventSpeed_med,0))\r\r\n                        addnlVentRooms.append( PHPP_XL_Obj('Additional Vent', address_ventTime_med, 0))\r\r\n                        addnlVentRooms.append( PHPP_XL_Obj('Additional Vent', address_ventSpeed_low, 0))\r\r\n                        addnlVentRooms.append( PHPP_XL_Obj('Additional Vent', address_ventTime_low, 0))\r\r\n                        \r\r\n                        rowCount += 1\r\r\n    \r\r\n    return addnlVentRooms, ventUnitsUsed\r\r\n\r\r\ndef getAddnlVentSystems(_inputBranch, _ventUnitsUsed, _startRows):\r\r\n    # Go through each Ventilation System passed in\r\r\n    vent = []\r\r\n    ventCompoRowStart = _startRows.get('Components').get('Ventilator')\r\r\n    ventUnitRowStart = _startRows.get('Additional Ventilation').get('Vent Unit Selection')\r\r\n    ventDuctsRowStart = _startRows.get('Additional Ventilation').get('Vent Ducts')\r\r\n    ventCount = 0\r\r\n    ductsCount = 0\r\r\n    ductColCount = ord('Q')\r\r\n    \r\r\n    if len(_inputBranch)>0:\r\r\n        print \"Creating 'Additional Ventilation' Systems...\"\r\r\n        vent.append( PHPP_XL_Obj('Ventilation', 'H42', 'x') ) # Turn on Additional Vent\r\r\n        vent.append( PHPP_XL_Obj('Additional Vent', 'F'+str(ventDuctsRowStart-11) , \"=AVERAGE(Climate!E24, Climate!F24, Climate!N24, Climate!O24, Climate!P24\") ) # External Average Temp\r\r\n        \r\r\n        for key in _inputBranch[0].keys():\r\r\n            ventSystem = _inputBranch[0][key] \r\r\n            \r\r\n            # Test to see if the Vent System should be included in the output\r\r\n            ventIncluded = False\r\r\n            for ventUnitName in _ventUnitsUsed:\r\r\n                if ventSystem.Unit_Name == ventUnitName:\r\r\n                    ventIncluded = True\r\r\n                    break\r\r\n                else:\r\r\n                    ventIncluded = False\r\r\n            \r\r\n            # Basic Ventialtion\r\r\n            if ventIncluded:\r\r\n                # Create the Vent Unit in the Components Worksheet\r\r\n                vent.append( PHPP_XL_Obj('Components', 'JH{}'.format(ventCompoRowStart + ventCount), ventSystem.Unit_Name if ventSystem else 'Default_Name' )) #  Create the Vent Unit\r\r\n                vent.append( PHPP_XL_Obj('Components', 'JI{}'.format(ventCompoRowStart + ventCount), ventSystem.Unit_HR if ventSystem else 0.75 )) #  Vent Heat Recovery\r\r\n                vent.append( PHPP_XL_Obj('Components', 'JJ{}'.format(ventCompoRowStart + ventCount), ventSystem.Unit_MR if ventSystem else 0 )) #  Vent Moisture Recovery\r\r\n                vent.append( PHPP_XL_Obj('Components', 'JK{}'.format(ventCompoRowStart + ventCount), ventSystem.Unit_ElecEff if ventSystem else 0.45 )) #  Vent Elec Efficiency\r\r\n                vent.append( PHPP_XL_Obj('Components', 'JL{}'.format(ventCompoRowStart + ventCount), 1)) #  DEFAULT MIN FLOW\r\r\n                vent.append( PHPP_XL_Obj('Components', 'JM{}'.format(ventCompoRowStart + ventCount), 10000 )) #  DEFAULT MAX FLOW\r\r\n                \r\r\n                # Set the Vent Unit Type\r\r\n                vent.append( PHPP_XL_Obj('Ventilation', 'L12', ventSystem.SystemType) ) \r\r\n                \r\r\n                # Set the UD name for access in 'Addnl-Vent' dropdown list\r\r\n                setattr(ventSystem, 'Unit_Name_UD', '{:02d}ud-{}'.format(ventCount+1, ventSystem.Unit_Name))\r\r\n                \r\r\n                # Build the Vent Unit\r\r\n                vent.append(  PHPP_XL_Obj('Additional Vent',  'D{}'.format(ventUnitRowStart + ventCount) ,  1) ) # Quantity\r\r\n                vent.append(  PHPP_XL_Obj('Additional Vent',  'E{}'.format(ventUnitRowStart + ventCount) ,  ventSystem.SystemName  if ventSystem.SystemName else '') ) # System Name\r\r\n                #vent.append(  PHPP_XL_Obj('Additional Vent',  'E{}'.format(ventUnitRowStart + ventCount) ,  '=RIGHT(F{0},LEN(F{0})-5)'.format(ventUnitRowStart + ventCount))) # Description Formula to pull ERV Name\r\r\n                vent.append(  PHPP_XL_Obj('Additional Vent',  'F{}'.format(ventUnitRowStart + ventCount) ,  ventSystem.Unit_Name_UD if ventSystem else '') ) # Vent Conpmonent UD Name\r\r\n                vent.append(  PHPP_XL_Obj('Additional Vent',  'Q{}'.format(ventUnitRowStart + ventCount) ,  ventSystem.Exterior if ventSystem else '') ) # Exterior Installation?\r\r\n                vent.append(  PHPP_XL_Obj('Additional Vent',  'X{}'.format(ventUnitRowStart + ventCount) ,  '2-Elec.') ) # Frost Protection Type\r\r\n                vent.append(  PHPP_XL_Obj('Additional Vent',  'Y{}'.format(ventUnitRowStart + ventCount) ,  ventSystem.FrostTemp if ventSystem else '-5') ) # Frost Protection Temp\r\r\n                \r\r\n                # Build the Vent Unit Ducting\r\r\n                vent.append( PHPP_XL_Obj('Additional Vent',  'D{}'.format(ventDuctsRowStart + ductsCount) , 1)) # Quantity\r\r\n                vent.append( PHPP_XL_Obj('Additional Vent',  'E{}'.format(ventDuctsRowStart + ductsCount) , ventSystem.Duct01.DuctWidth if ventSystem else 104 ))\r\r\n                vent.append( PHPP_XL_Obj('Additional Vent',  'H{}'.format(ventDuctsRowStart + ductsCount) , ventSystem.Duct01.InsulationThickness if ventSystem else 52 ))\r\r\n                vent.append( PHPP_XL_Obj('Additional Vent',  'I{}'.format(ventDuctsRowStart + ductsCount) , ventSystem.Duct01.InsulationLambda if ventSystem else 0.04 ))\r\r\n                vent.append( PHPP_XL_Obj('Additional Vent',  'J{}'.format(ventDuctsRowStart + ductsCount) , 'x' ))# Reflective\r\r\n                vent.append( PHPP_XL_Obj('Additional Vent',  'L{}'.format(ventDuctsRowStart + ductsCount) , ventSystem.Duct01.DuctLength if ventSystem else 5 ))\r\r\n                vent.append( PHPP_XL_Obj('Additional Vent',  'M{}'.format(ventDuctsRowStart + ductsCount) , '1'))\r\r\n                \r\r\n                vent.append( PHPP_XL_Obj('Additional Vent',  'D{}'.format(ventDuctsRowStart + ductsCount+1) , 1)) # Quantity\r\r\n                vent.append( PHPP_XL_Obj('Additional Vent',  'E{}'.format(ventDuctsRowStart + ductsCount+1) , ventSystem.Duct02.DuctWidth if ventSystem else 104 ))\r\r\n                vent.append( PHPP_XL_Obj('Additional Vent',  'H{}'.format(ventDuctsRowStart + ductsCount+1) , ventSystem.Duct02.InsulationThickness if ventSystem else 52 ))\r\r\n                vent.append( PHPP_XL_Obj('Additional Vent',  'I{}'.format(ventDuctsRowStart + ductsCount+1) , ventSystem.Duct02.InsulationLambda if ventSystem else 0.04 ))\r\r\n                vent.append( PHPP_XL_Obj('Additional Vent',  'J{}'.format(ventDuctsRowStart + ductsCount+1) , 'x' ))# Reflective\r\r\n                vent.append( PHPP_XL_Obj('Additional Vent',  'L{}'.format(ventDuctsRowStart + ductsCount+1) , ventSystem.Duct02.DuctLength if ventSystem else 5 ))\r\r\n                vent.append( PHPP_XL_Obj('Additional Vent',  'N{}'.format(ventDuctsRowStart + ductsCount+1) , '1'))\r\r\n                \r\r\n                vent.append( PHPP_XL_Obj('Additional Vent',  '{}{}'.format(chr(ductColCount), ventDuctsRowStart + ductsCount) , 1)) # Assign Duct to Vent\r\r\n                vent.append( PHPP_XL_Obj('Additional Vent',  '{}{}'.format(chr(ductColCount), ventDuctsRowStart + ductsCount+1) , 1)) # Assign Duct to Vent\r\r\n                \r\r\n                ductColCount+=1\r\r\n                ductsCount+=2\r\r\n                ventCount+=1\r\r\n                \r\r\n            # Exhaust Ventialtion Objects\r\r\n            if ventIncluded:\r\r\n                # Add in any 'Exhaust Only' ventilation objects (kitchen hoods, etc...)\r\r\n                for exhaustSystem in ventSystem.ExhaustObjs:\r\r\n                    # Build the Vent in the Components Worksheet\r\r\n                    vent.append( PHPP_XL_Obj('Components', 'JH{}'.format(ventCompoRowStart + ventCount), exhaustSystem.Name if exhaustSystem.Name else 'Exhaust' )) #  Create the Vent Unit\r\r\n                    vent.append( PHPP_XL_Obj('Components', 'JI{}'.format(ventCompoRowStart + ventCount), 0 )) #  Vent Heat Recovery\r\r\n                    vent.append( PHPP_XL_Obj('Components', 'JJ{}'.format(ventCompoRowStart + ventCount), 0 )) #  Vent Moisture Recovery\r\r\n                    vent.append( PHPP_XL_Obj('Components', 'JK{}'.format(ventCompoRowStart + ventCount), 0.25 )) #  Vent Elec Efficiency\r\r\n                    vent.append( PHPP_XL_Obj('Components', 'JL{}'.format(ventCompoRowStart + ventCount), 1)) #  DEFAULT MIN FLOW\r\r\n                    vent.append( PHPP_XL_Obj('Components', 'JM{}'.format(ventCompoRowStart + ventCount), 10000 )) #  DEFAULT MAX FLOW\r\r\n                    \r\r\n                    # Set the UD name for access in 'Addnl-Vent' dropdown list\r\r\n                    setattr(exhaustSystem, 'Unit_Name_UD', '{:02d}ud-{}'.format(ventCount+1, exhaustSystem.Name))\r\r\n                    \r\r\n                    # Build the Vent Unit\r\r\n                    vent.append(  PHPP_XL_Obj('Additional Vent',  'D{}'.format(ventUnitRowStart + ventCount) ,  1) ) # Quantity\r\r\n                    vent.append(  PHPP_XL_Obj('Additional Vent',  'E{}'.format(ventUnitRowStart + ventCount) ,  exhaustSystem.Name  if exhaustSystem.Name else 'Exhaust_Unit') )\r\r\n                    vent.append(  PHPP_XL_Obj('Additional Vent',  'F{}'.format(ventUnitRowStart + ventCount) ,  exhaustSystem.Unit_Name_UD) ) # Vent Component UD Name\r\r\n                    vent.append(  PHPP_XL_Obj('Additional Vent',  'Q{}'.format(ventUnitRowStart + ventCount) ,  '') ) # Exterior Installation?\r\r\n                    vent.append(  PHPP_XL_Obj('Additional Vent',  'X{}'.format(ventUnitRowStart + ventCount) ,  '1-No') ) # Frost Protection Type\r\r\n                    vent.append(  PHPP_XL_Obj('Additional Vent',  'Y{}'.format(ventUnitRowStart + ventCount) ,  '-5') ) # Frost Protection Temp\r\r\n                    \r\r\n                    # Build the Vent Unit Ducting\r\r\n                    vent.append( PHPP_XL_Obj('Additional Vent',  'D{}'.format(ventDuctsRowStart + ductsCount) , 1)) # Quantity\r\r\n                    vent.append( PHPP_XL_Obj('Additional Vent',  'E{}'.format(ventDuctsRowStart + ductsCount) , exhaustSystem.Duct01.DuctWidth if exhaustSystem else 104 ))\r\r\n                    vent.append( PHPP_XL_Obj('Additional Vent',  'H{}'.format(ventDuctsRowStart + ductsCount) , exhaustSystem.Duct01.InsulationThickness if exhaustSystem else 52 ))\r\r\n                    vent.append( PHPP_XL_Obj('Additional Vent',  'I{}'.format(ventDuctsRowStart + ductsCount) , exhaustSystem.Duct01.InsulationLambda if exhaustSystem else 0.04 ))\r\r\n                    vent.append( PHPP_XL_Obj('Additional Vent',  'J{}'.format(ventDuctsRowStart + ductsCount) , 'x' ))# Reflective\r\r\n                    vent.append( PHPP_XL_Obj('Additional Vent',  'L{}'.format(ventDuctsRowStart + ductsCount) , exhaustSystem.Duct01.DuctLength if exhaustSystem else 5 ))\r\r\n                    vent.append( PHPP_XL_Obj('Additional Vent',  'M{}'.format(ventDuctsRowStart + ductsCount) , '1'))\r\r\n                    \r\r\n                    vent.append( PHPP_XL_Obj('Additional Vent',  'D{}'.format(ventDuctsRowStart + ductsCount+1) , 1)) # Quantity\r\r\n                    vent.append( PHPP_XL_Obj('Additional Vent',  'E{}'.format(ventDuctsRowStart + ductsCount+1) , exhaustSystem.Duct02.DuctWidth if exhaustSystem else 104 ))\r\r\n                    vent.append( PHPP_XL_Obj('Additional Vent',  'H{}'.format(ventDuctsRowStart + ductsCount+1) , exhaustSystem.Duct02.InsulationThickness if exhaustSystem else 52 ))\r\r\n                    vent.append( PHPP_XL_Obj('Additional Vent',  'I{}'.format(ventDuctsRowStart + ductsCount+1) , exhaustSystem.Duct02.InsulationLambda if exhaustSystem else 0.04 ))\r\r\n                    vent.append( PHPP_XL_Obj('Additional Vent',  'J{}'.format(ventDuctsRowStart + ductsCount+1) , 'x' ))# Reflective\r\r\n                    vent.append( PHPP_XL_Obj('Additional Vent',  'L{}'.format(ventDuctsRowStart + ductsCount+1) , exhaustSystem.Duct02.DuctLength if exhaustSystem else 5 ))\r\r\n                    vent.append( PHPP_XL_Obj('Additional Vent',  'N{}'.format(ventDuctsRowStart + ductsCount+1) , '1'))\r\r\n                    \r\r\n                    vent.append( PHPP_XL_Obj('Additional Vent',  '{}{}'.format(chr(ductColCount), ventDuctsRowStart + ductsCount) , 1)) # Assign Duct to Vent\r\r\n                    vent.append( PHPP_XL_Obj('Additional Vent',  '{}{}'.format(chr(ductColCount), ventDuctsRowStart + ductsCount+1) , 1)) # Assign Duct to Vent\r\r\n                    \r\r\n                    ductColCount+=1\r\r\n                    ductsCount+=2\r\r\n                    ventCount+=1\r\r\n    \r\r\n    return vent\r\r\n\r\r\ndef getNonResRoomData(_inputBranch, _zones, _startRows):\r\r\n    print \"Creating 'Electricity non-res' Objects ... \"\r\r\n    elecNonRes = []\r\r\n    rowStart_Lighting = _startRows.get('Electricity non-res').get('Lighting', 19)\r\r\n    rowStart_OfficeEquip = _startRows.get('Electricity non-res').get('Office Equip', 62)\r\r\n    rowStart_Kitchen = _startRows.get('Electricity non-res').get('Kitchen', 77)\r\r\n    \r\r\n    for i, roomObj in enumerate(_inputBranch):\r\r\n        # First, see if the Room should be included in the output\r\r\n        for zoneName in _zones:\r\r\n            if roomObj.HostZoneName != zoneName:\r\r\n                includeRoom = False\r\r\n            elif getattr(roomObj, 'NonRes_RoomUse', '-') == '-':\r\r\n                includeRoom = False\r\r\n            else:\r\r\n                includeRoom = True\r\r\n                break\r\r\n        \r\r\n        # If the Room is to be included, write out the Excel objects\r\r\n        if includeRoom:\r\r\n            # Try and sort out the Room's Ventilation airflow and schedule if there is any\r\r\n            if getattr(roomObj, 'NonRes_RoomLightingControl', None):\r\r\n                roomID = '{}-{}'.format(getattr(roomObj, 'RoomNumber', None), getattr(roomObj, 'RoomName', None) )\r\r\n                lightingControlNum = getattr(roomObj, 'NonRes_RoomLightingControl', '1-').split('-')[0]\r\r\n                \r\r\n                elecNonRes.append( PHPP_XL_Obj('Electricity non-res', 'C{}'.format(rowStart_Lighting+i), roomID))\r\r\n                elecNonRes.append( PHPP_XL_Obj('Electricity non-res', 'D{}'.format(rowStart_Lighting+i), getattr(roomObj, 'FloorArea_Gross', None) ))\r\r\n                elecNonRes.append( PHPP_XL_Obj('Electricity non-res', 'F{}'.format(rowStart_Lighting+i), getattr(roomObj, 'NonRes_RoomUse', None) ))\r\r\n                elecNonRes.append( PHPP_XL_Obj('Electricity non-res', 'H{}'.format(rowStart_Lighting+i), 0)) # Deviation From North=0\r\r\n                elecNonRes.append( PHPP_XL_Obj('Electricity non-res', 'J{}'.format(rowStart_Lighting+i), 0.69)) # Triple Glazing\r\r\n                elecNonRes.append( PHPP_XL_Obj('Electricity non-res', 'M{}'.format(rowStart_Lighting+i), getattr(roomObj, 'RoomDepth', None)   ))\r\r\n                elecNonRes.append( PHPP_XL_Obj('Electricity non-res', 'N{}'.format(rowStart_Lighting+i), '=D{}/M{}'.format(rowStart_Lighting+i, rowStart_Lighting+i)  ))\r\r\n                elecNonRes.append( PHPP_XL_Obj('Electricity non-res', 'O{}'.format(rowStart_Lighting+i), getattr(roomObj, 'RoomClearHeight', None)   ))\r\r\n                elecNonRes.append( PHPP_XL_Obj('Electricity non-res', 'P{}'.format(rowStart_Lighting+i), 1  )) # Lintel Height\r\r\n                elecNonRes.append( PHPP_XL_Obj('Electricity non-res', 'Q{}'.format(rowStart_Lighting+i), 0  )) # Window Width                \r\r\n                elecNonRes.append( PHPP_XL_Obj('Electricity non-res', 'W{}'.format(rowStart_Lighting+i), lightingControlNum ))\r\r\n                \r\r\n                if getattr(roomObj, 'NonRes_RoomMotionControl', 'No')=='Yes':\r\r\n                    elecNonRes.append( PHPP_XL_Obj('Electricity non-res', 'X{}'.format(rowStart_Lighting+i), 'x' ))\r\r\n    \r\r\n    return elecNonRes\r\r\n\r\r\ndef getInfiltration(_inputBranch, _zonesToInclude):\r\r\n    ##########################################\r\r\n    ######   Envelope Airtightness    ########\r\r\n    \r\r\n    # Defaults\r\r\n    Coef_E = 0.07\r\r\n    Coef_F  = 15\r\r\n    bldgWeightedACH = None\r\r\n    bldgVn50 = None\r\r\n    \r\r\n    # Find the Floor-Area Weighted Average ACH of the Zones\r\r\n    zonesVn50 = []\r\r\n    zonesFloorArea = []\r\r\n    zonesWeightedACH = []\r\r\n    \r\r\n    for zoneNametoInclude in _zonesToInclude:\r\r\n        for zoneObj in _inputBranch:\r\r\n            if zoneObj.ZoneName == zoneNametoInclude:\r\r\n                try:\r\r\n                    zonesFloorArea.append(zoneObj.FloorArea_Gross if zoneObj.FloorArea_Gross else False)\r\r\n                    zonesWeightedACH.append(zoneObj.InfiltrationACH50 * zoneObj.FloorArea_Gross)\r\r\n                    zonesVn50.append(zoneObj.Volume_Vn50)\r\r\n                except:\r\r\n                    pass\r\r\n    \r\r\n    if sum(zonesFloorArea)!= 0:\r\r\n        bldgWeightedACH = sum(zonesWeightedACH) / sum(zonesFloorArea)\r\r\n        bldgVn50 = sum(zonesVn50)\r\r\n    \r\r\n    airtightness = []\r\r\n    print(\"Creating the Airtightness Objects...\")\r\r\n    airtightness.append(PHPP_XL_Obj('Ventilation', 'N25', Coef_E if Coef_E else float(0.07) ))# Wind protection E\r\r\n    airtightness.append(PHPP_XL_Obj('Ventilation', 'N26', Coef_F if Coef_F else float(15) ))# Wind protection F\r\r\n    airtightness.append(PHPP_XL_Obj('Ventilation', 'N27', bldgWeightedACH if bldgWeightedACH else float(0.6) ))# ACH50\r\r\n    airtightness.append(PHPP_XL_Obj('Ventilation', 'P27', bldgVn50 if bldgVn50 else '=N9*1.2' ))#  Internal Reference Volume\r\r\n    \r\r\n    return airtightness\r\r\n\r\r\ndef updateStartRows(_startRowDict, _udIn):\r\r\n    \"\"\"Takes in the dictionary of start rows and any user-determined inputs\r\r\n    modifies the dict values based on iputs. This is useful if the user has\r\r\n    modified the PHPP for some reason and the start rows no longer align with \r\r\n    the normal ones. This happens esp. if the user adds more rows for an XXL\r\r\n    size PHPP. (more rooms, more areas, etc...)\"\"\"\r\r\n    try:\r\r\n        for each in _udIn:\r\r\n            parsed = each.split(':')\r\r\n            newRowStart = int(parsed[1])\r\r\n            worksheet, startItem = (parsed[0].split(','))\r\r\n            _startRowDict[worksheet.lstrip().rstrip()][startItem.lstrip().rstrip()] = newRowStart\r\r\n    except:\r\r\n        udRowsMsg = \"Couldn't read the udRowStarts_ input? Make sure it has dict keys separated by a comma and a semicolon before the value.\"\r\r\n        ghenv.Component.AddRuntimeMessage(ghK.GH_RuntimeMessageLevel.Warning, udRowsMsg)\r\r\n    \r\r\n    return _startRowDict\r\r\n\r\r\ndef filterName(_zoneName, _zonesNamesToFilter):\r\r\n    flag = True\r\r\n    for each in _zonesNamesToFilter:\r\r\n        if each in _zoneName:\r\r\n            flag = False\r\r\n    \r\r\n    return flag\r\r\n\r\r\ndef getGround(_floorElements, _zones):\r\r\n    ground = []\r\r\n    \r\r\n    colLetter = {\r\r\n        0: {'col0':'C', 'col1':'H', 'col2':'P'},\r\r\n        1: {'col0':'W', 'col1':'AB', 'col2':'AJ'},\r\r\n        2: {'col0':'AQ', 'col1':'AV', 'col2':'BD'}\r\r\n        }\r\r\n    \r\r\n    if len(_floorElements) == 0:\r\r\n        return ''\r\r\n    \r\r\n    if len(_floorElements) > 3:\r\r\n        FloorElementsWarning= 'Warning: (grndFloorElements_) PHPP accepts only up to 3 unique \\n'\\\r\r\n        'ground contact Floor Elements. Please simplify / consolidate your Floor Elements\\n'\\\r\r\n        'before proceeding with export. For now only the first three Floor Elements\\n'\\\r\r\n        'will be exported to PHPP.'\r\r\n        ghenv.Component.AddRuntimeMessage(ghK.GH_RuntimeMessageLevel.Warning, FloorElementsWarning)\r\r\n        _floorElements = _floorElements[0:3]\r\r\n    \r\r\n    for i, floorElement in enumerate(_floorElements):\r\r\n        if floorElement == None:\r\r\n           continue\r\r\n        \r\r\n        # Filter for UD zone exclusions\r\r\n        if floorElement.Zone not in _zones:\r\r\n            continue\r\r\n        \r\r\n        col0 = colLetter[i]['col0']\r\r\n        col1 = colLetter[i]['col1']\r\r\n        col2 = colLetter[i]['col2']\r\r\n        \r\r\n        ground.append(PHPP_XL_Obj('Ground', col1+'9', floorElement.soilThermalConductivity ))\r\r\n        ground.append(PHPP_XL_Obj('Ground', col1+'10', floorElement.soilHeatCapacity ))\r\r\n        ground.append(PHPP_XL_Obj('Ground', col1+'18', floorElement.FloorArea ))\r\r\n        ground.append(PHPP_XL_Obj('Ground', col1+'19', floorElement.PerimLen ))\r\r\n        ground.append(PHPP_XL_Obj('Ground', col2+'17', floorElement.FloorUvalue ))\r\r\n        ground.append(PHPP_XL_Obj('Ground', col2+'18', floorElement.PerimPsixLen ))\r\r\n        ground.append(PHPP_XL_Obj('Ground', col1+'49', floorElement.groundWaterDepth ))\r\r\n        ground.append(PHPP_XL_Obj('Ground', col1+'50', floorElement.groundWaterFlowrate ))\r\r\n        \r\r\n        if '1' in floorElement.Type or 'SLAB' in floorElement.Type.upper():\r\r\n            # Slab on Grade Type\r\r\n            ground.append(PHPP_XL_Obj('Ground', col0+'24', 'x' ))\r\r\n            ground.append(PHPP_XL_Obj('Ground', col0+'29', '' ))\r\r\n            ground.append(PHPP_XL_Obj('Ground', col0+'31', '' ))\r\r\n            ground.append(PHPP_XL_Obj('Ground', col0+'38', '' ))\r\r\n            ground.append(PHPP_XL_Obj('Ground', col1+'25', floorElement.perimInsulDepth ))\r\r\n            ground.append(PHPP_XL_Obj('Ground', col1+'26', floorElement.perimInsulThick ))\r\r\n            ground.append(PHPP_XL_Obj('Ground', col1+'27', floorElement.perimInsulConductivity ))\r\r\n            if 'V' in floorElement.perimInsulOrientation.upper():\r\r\n                ground.append(PHPP_XL_Obj('Ground', col2+'25', '' ))\r\r\n            else:\r\r\n                ground.append(PHPP_XL_Obj('Ground', col2+'25', 'x' ))\r\r\n        elif '2' in floorElement.Type or 'HEATED' in floorElement.Type.upper():\r\r\n            # Heated Basement\r\r\n            ground.append(PHPP_XL_Obj('Ground', col0+'24', '' ))\r\r\n            ground.append(PHPP_XL_Obj('Ground', col0+'29', 'x' ))\r\r\n            ground.append(PHPP_XL_Obj('Ground', col0+'31', '' ))\r\r\n            ground.append(PHPP_XL_Obj('Ground', col0+'38', '' ))\r\r\n            ground.append(PHPP_XL_Obj('Ground', col1+'30', floorElement.WallHeight_BG ))\r\r\n            ground.append(PHPP_XL_Obj('Ground', col2+'30', floorElement.WallU_BG ))\r\r\n            \r\r\n        elif '3' in floorElement.Type or 'UNHEATED' in floorElement.Type.upper():\r\r\n            # Unheated Basement\r\r\n            ground.append(PHPP_XL_Obj('Ground', col0+'24', '' ))\r\r\n            ground.append(PHPP_XL_Obj('Ground', col0+'29', '' ))\r\r\n            ground.append(PHPP_XL_Obj('Ground', col0+'31', 'x' ))\r\r\n            ground.append(PHPP_XL_Obj('Ground', col0+'38', '' ))\r\r\n            ground.append(PHPP_XL_Obj('Ground', col1+'33', floorElement.WallHeight_AG ))\r\r\n            ground.append(PHPP_XL_Obj('Ground', col2+'33', floorElement.WallU_AG ))\r\r\n            ground.append(PHPP_XL_Obj('Ground', col1+'34', floorElement.WallHeight_BG ))\r\r\n            ground.append(PHPP_XL_Obj('Ground', col2+'34', floorElement.WallU_BG ))\r\r\n            ground.append(PHPP_XL_Obj('Ground', col2+'35', floorElement.FloorU ))\r\r\n            ground.append(PHPP_XL_Obj('Ground', col1+'35', floorElement.ACH ))\r\r\n            ground.append(PHPP_XL_Obj('Ground', col1+'36', floorElement.Volume ))\r\r\n            \r\r\n        elif '4' in floorElement.Type or 'CRAWL' in floorElement.Type.upper():\r\r\n            # Suspended Floor overCrawlspace\r\r\n            ground.append(PHPP_XL_Obj('Ground', col0+'24', '' ))\r\r\n            ground.append(PHPP_XL_Obj('Ground', col0+'29', '' ))\r\r\n            ground.append(PHPP_XL_Obj('Ground', col0+'31', '' ))\r\r\n            ground.append(PHPP_XL_Obj('Ground', col0+'38', 'x' ))\r\r\n            ground.append(PHPP_XL_Obj('Ground', col1+'39', floorElement.CrawlU ))\r\r\n            ground.append(PHPP_XL_Obj('Ground', col1+'40', floorElement.WallHeight ))\r\r\n            ground.append(PHPP_XL_Obj('Ground', col1+'41', floorElement.WallU ))\r\r\n            ground.append(PHPP_XL_Obj('Ground', col2+'39', floorElement.VentOpeningArea ))\r\r\n            ground.append(PHPP_XL_Obj('Ground', col2+'40', floorElement.windVelocity ))\r\r\n            ground.append(PHPP_XL_Obj('Ground', col2+'41', floorElement.windFactor ))\r\r\n            \r\r\n    return ground\r\r\n\r\r\ndef getDHWSystem(_dhwSystems, _zones):\r\r\n    ##########################################\r\r\n    # If more that one system are to be used, combine them into a single system\r\r\n    \r\r\n    dhwSystems = defaultdict()\r\r\n    \r\r\n    for dhwSystem in _dhwSystems:\r\r\n        dhwZonesServing = dhwSystem.ZonesAssigned\r\r\n        for zoneName in dhwZonesServing:\r\r\n            if zoneName in _zones:\r\r\n                dhwSystems[dhwSystem.SystemName] = dhwSystem\r\r\n   \r\r\n    if len(dhwSystems.keys()) == 0:\r\r\n        dhw_ = None\r\r\n    elif len(list(set(dhwSystems.keys())))>1:\r\r\n        dhw_ = combineDHWSystems(dhwSystems)\r\r\n    else:\r\r\n        dhw_ = _dhwSystems[0]\r\r\n    \r\r\n    ##########################################\r\r\n    # DHW System Excel Objs\r\r\n    dhwSystem = []\r\r\n    if dhw_:\r\r\n        print(\"Creating the 'DHW' Objects...\")\r\r\n        dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', 'J146', dhw_.forwardTemp ) )\r\r\n        dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', 'P145', 0 ) )\r\r\n        dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', 'P29', 0 ) )\r\r\n        \r\r\n        # Usage Volume\r\r\n        if dhw_.usage != None:\r\r\n            if dhw_.usage.UsageType == 'Res':\r\r\n                dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', 'J47', dhw_.usage.demand_showers ) )\r\r\n                dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', 'J48', dhw_.usage.demand_others ) )\r\r\n            elif dhw_.usage.UsageType == 'NonRes':\r\r\n                dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', 'J47', '=Q57'))\r\r\n                dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', 'J48', '=Q58'))\r\r\n                dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', 'J58', getattr(dhw_.usage, 'use_daysPerYear') ) )\r\r\n                dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', 'J62', 'x' if getattr(dhw_.usage, 'useShowers') != 'False' else '' ))\r\r\n                dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', 'J63', 'x' if getattr(dhw_.usage, 'useHandWashing') != 'False' else '' ))\r\r\n                dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', 'J64', 'x' if getattr(dhw_.usage, 'useWashStand') != 'False' else '' ))\r\r\n                dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', 'J65', 'x' if getattr(dhw_.usage, 'useBidets') != 'False' else '' ))\r\r\n                dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', 'J66', 'x' if getattr(dhw_.usage, 'useBathing') != 'False' else '' ))\r\r\n                dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', 'J67', 'x' if getattr(dhw_.usage, 'useToothBrushing') != 'False' else '' ))\r\r\n                dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', 'J68', 'x' if getattr(dhw_.usage, 'useCooking') != 'False' else '' ))\r\r\n                dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', 'J74', 'x' if getattr(dhw_.usage, 'useDishwashing') != 'False' else '' ))\r\r\n                dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', 'J75', 'x' if getattr(dhw_.usage, 'useCleanKitchen') != 'False' else '' ))\r\r\n                dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', 'J76', 'x' if getattr(dhw_.usage, 'useCleanRooms') != 'False' else '' ))\r\r\n        \r\r\n        # Recirc Piping\r\r\n        if len(dhw_.circulation_piping)>0:\r\r\n            dhwSystem.append( PHPP_XL_Obj('Aux Electricity', 'H29', 1 ) ) # Circulator Pump\r\r\n            \r\r\n        for colNum, recirc_line in enumerate(dhw_.circulation_piping):\r\r\n            col = chr(ord('J') + colNum)\r\r\n            \r\r\n            if ord(col) <= ord('N'):\r\r\n                dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', '{}{}'.format(col, 149), recirc_line.length ) )\r\r\n                dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', '{}{}'.format(col, 150), recirc_line.diam ) )\r\r\n                dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', '{}{}'.format(col, 151), recirc_line.insulThck ) )\r\r\n                dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', '{}{}'.format(col, 152), 'x' if recirc_line.insulRefl=='Yes' else '' ) )\r\r\n                dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', '{}{}'.format(col, 153), recirc_line.insulCond ) )\r\r\n                dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', '{}{}'.format(col, 155), recirc_line.quality ) )\r\r\n                dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', '{}{}'.format(col, 159), recirc_line.period ) )\r\r\n            else:\r\r\n                dhwRecircWarning = \"Too many recirculation loops. PHPP only allows up to 5 loops to be entered.\\nConsolidate the loops before moving forward\"\r\r\n                ghenv.Component.AddRuntimeMessage(ghK.GH_RuntimeMessageLevel.Warning, dhwRecircWarning)\r\r\n        \r\r\n        # Branch Piping\r\r\n        for colNum, branch_line in enumerate(dhw_.branch_piping):\r\r\n            col = chr(ord('J') + colNum)\r\r\n            \r\r\n            if ord(col) <= ord('N'):\r\r\n                dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', '{}{}'.format(col, 167), branch_line.diameter) )\r\r\n                dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', '{}{}'.format(col, 168), branch_line.totalLength) )\r\r\n                dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', '{}{}'.format(col, 169), branch_line.totalTapPoints) )\r\r\n                dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', '{}{}'.format(col, 171), branch_line.tapOpenings) )\r\r\n                dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', '{}{}'.format(col, 172), branch_line.utilisation) )\r\r\n            else:\r\r\n                dhwRecircWarning = \"Too many branch piping sets. PHPP only allows up to 5 sets to be entered.\\nConsolidate the piping sets before moving forward\"\r\r\n                ghenv.Component.AddRuntimeMessage(ghK.GH_RuntimeMessageLevel.Warning, dhwRecircWarning)\r\r\n        \r\r\n        # Tanks\r\r\n        if dhw_.tank1:\r\r\n            dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', 'J186', dhw_.tank1.type) )\r\r\n            dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', 'J189', 'x' if dhw_.tank1.solar==True else '') )\r\r\n            dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', 'J191', dhw_.tank1.hl_rate) )\r\r\n            dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', 'J192', dhw_.tank1.vol) )\r\r\n            dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', 'J193', dhw_.tank1.stndbyFrac) )\r\r\n            dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', 'J195', dhw_.tank1.loction) )\r\r\n            dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', 'J198', dhw_.tank1.locaton_t) )\r\r\n        if dhw_.tank2:\r\r\n            dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', 'M186', dhw_.tank2.type) )\r\r\n            dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', 'M189', 'x' if dhw_.tank2.solar==True else '') )\r\r\n            dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', 'M191', dhw_.tank2.hl_rate) )\r\r\n            dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', 'M192', dhw_.tank2.vol) )\r\r\n            dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', 'M193', dhw_.tank2.stndbyFrac) )\r\r\n            dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', 'M195', dhw_.tank2.loction) )\r\r\n            dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', 'M198', dhw_.tank2.locaton_t) )\r\r\n        if dhw_.tank_buffer:\r\r\n            dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', 'P186', dhw_.tank_buffer.type) )\r\r\n            dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', 'P191', dhw_.tank_buffer.hl_rate) )\r\r\n            dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', 'P192', dhw_.tank_buffer.vol) )\r\r\n            dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', 'P195', dhw_.tank_buffer.loction) )\r\r\n            dhwSystem.append( PHPP_XL_Obj('DHW+Distribution', 'P198', dhw_.tank_buffer.locaton_t) )\r\r\n        \r\r\n    return dhwSystem\r\r\n\r\r\ndef combineDHWSystems(_dhwSystems):\r\r\n    def getBranchPipeAttr(_dhwSystems, _attrName, _branchOrRecirc, _resultType):\r\r\n        # Combine Elements accross the Systems\r\r\n        results = DataTree[Object]()\r\r\n        for sysNum, dhwSystem in enumerate(_dhwSystems.values()):\r\r\n            pipingObj = getattr(dhwSystem, _branchOrRecirc)\r\r\n            \r\r\n            for i in range(0, 4):\r\r\n                try:\r\r\n                    temp = getattr(pipingObj[i], _attrName)\r\r\n                    results.Add(temp, GH_Path(i) )\r\r\n                except: \r\r\n                    pass\r\r\n        \r\r\n        output = []\r\r\n        if _resultType == 'Sum':\r\r\n            for i in range(results.BranchCount):\r\r\n                output.append( sum( results.Branch(i) ) )\r\r\n        elif _resultType == 'Average':\r\r\n            for i in range(results.BranchCount):\r\r\n                output.append( statistics.mean( results.Branch(i) ) )\r\r\n        \r\r\n        return output\r\r\n    \r\r\n    def combineTank(_dhwSystems, _tankName):\r\r\n        # Combine Tank 1s\r\r\n        hasTank = False\r\r\n        tankObj = {'type':[], 'solar':[], 'hl_rate':[], 'vol':[],\r\r\n        'stndbyFrac':[], 'loction':[], 'locaton_t':[]}\r\r\n        for v in _dhwSystems.values():\r\r\n            vTankObj = getattr(v, _tankName)\r\r\n            \r\r\n            if vTankObj != None:\r\r\n                hasTank = True\r\r\n                tankObj['type'].append( getattr(vTankObj, 'type') )\r\r\n                tankObj['solar'].append( getattr(vTankObj, 'solar') )\r\r\n                tankObj['hl_rate'].append( getattr(vTankObj, 'hl_rate') )\r\r\n                tankObj['vol'].append( getattr(vTankObj, 'vol') )\r\r\n                tankObj['stndbyFrac'].append( getattr(vTankObj, 'stndbyFrac') )\r\r\n                tankObj['loction'].append( getattr(vTankObj, 'loction') )\r\r\n                tankObj['locaton_t'].append( getattr(vTankObj, 'locaton_t') )\r\r\n        \r\r\n        if hasTank:\r\r\n            return PHPP_DHW_tank(\r\r\n                                _type = tankObj['type'][0] if len(tankObj['type']) != 0 else None,\r\r\n                                _solar = tankObj['solar'][0] if len(tankObj['solar']) != 0 else None,\r\r\n                                _hl_rate = statistics.mean(tankObj['hl_rate']) if len(tankObj['hl_rate']) != 0 else None,\r\r\n                                _vol = statistics.mean(tankObj['vol']) if len(tankObj['vol']) != 0 else None,\r\r\n                                _stndby_frac = statistics.mean(tankObj['stndbyFrac']) if len(tankObj['stndbyFrac']) != 0 else None,\r\r\n                                _loc = tankObj['loction'][0] if len(tankObj['loction']) != 0 else None,\r\r\n                                _loc_T = tankObj['locaton_t'][0] if len(tankObj['locaton_t']) != 0 else None,\r\r\n                                )\r\r\n        else:\r\r\n            return None\r\r\n    \r\r\n    print 'Combining together DHW Systems...'\r\r\n    #Combine Usages\r\r\n    showers = []\r\r\n    other = []\r\r\n    for v in _dhwSystems.values():\r\r\n        if isinstance(v.usage, PHPP_DHW_usage):\r\r\n            showers.append( getattr(v.usage, 'demand_showers' ) )\r\r\n            other.append( getattr(v.usage, 'demand_others' ) )\r\r\n    \r\r\n    dhwInputs = {'showers_demand_': sum(showers)/len(showers),\r\r\n    'other_demand_': sum(other)/len(other)}\r\r\n    print dhwInputs\r\r\n    combinedUsage = PHPP_DHW_usage( dhwInputs )\r\r\n    \r\r\n    # Combine Branch Pipings\r\r\n    combined_Diams = getBranchPipeAttr(_dhwSystems, 'diameter', 'branch_piping', 'Average')\r\r\n    combined_Lens = getBranchPipeAttr(_dhwSystems, 'totalLength', 'branch_piping', 'Sum')\r\r\n    combined_Taps =  getBranchPipeAttr(_dhwSystems, 'totalTapPoints', 'branch_piping',  'Sum')\r\r\n    combined_Opens =  getBranchPipeAttr(_dhwSystems, 'tapOpenings', 'branch_piping',  'Average')\r\r\n    combined_Utils =  getBranchPipeAttr(_dhwSystems, 'utilisation', 'branch_piping',  'Average')\r\r\n    \r\r\n    combined_BranchPipings = []\r\r\n    for i in range(len(combined_Diams)):\r\r\n        combinedBranchPiping = PHPP_DHW_branch_piping(\r\r\n                                    combined_Diams[i],\r\r\n                                    combined_Lens[i],\r\r\n                                    combined_Taps[i],\r\r\n                                    combined_Opens[i],\r\r\n                                    combined_Utils[i]\r\r\n                                   )\r\r\n        combined_BranchPipings.append( combinedBranchPiping )\r\r\n    \r\r\n    # Combine Recirculation Pipings\r\r\n    hasRecircPiping = False\r\r\n    recircObj = {'length':[], 'diam':[], 'insulThck':[],\r\r\n    'insulCond':[], 'insulRefl':[], 'quality':[], 'period':[],}\r\r\n    for v in _dhwSystems.values():\r\r\n        circObjs = v.circulation_piping\r\r\n        if len(circObjs) != 0:\r\r\n            hasRecircPiping = True\r\r\n            try:\r\r\n                recircObj['length'].append( getattr(circObjs[0], 'length'  ) )\r\r\n                recircObj['diam'].append( getattr(circObjs[0], 'diam'  )) \r\r\n                recircObj['insulThck'].append( getattr(circObjs[0], 'insulThck'  ) )\r\r\n                recircObj['insulCond'].append( getattr(circObjs[0], 'insulCond'  ) )\r\r\n                recircObj['insulRefl'].append( getattr(circObjs[0], 'insulRefl'  ) )\r\r\n                recircObj['quality'].append( getattr(circObjs[0], 'quality'  ) )\r\r\n                recircObj['period'].append( getattr(circObjs[0], 'period'  ) )\r\r\n            except:\r\r\n                pass\r\r\n    \r\r\n    if hasRecircPiping:\r\r\n        combined_RecircPipings = [PHPP_DHW_RecircPipe(\r\r\n                        sum(recircObj['length']),\r\r\n                        statistics.mean(recircObj['diam']) if len(recircObj['diam']) != 0 else None,\r\r\n                        statistics.mean(recircObj['insulThck']) if len(recircObj['insulThck']) != 0 else None,\r\r\n                        statistics.mean(recircObj['insulCond']) if len(recircObj['insulCond']) != 0 else None,\r\r\n                        recircObj['insulRefl'][0] if len(recircObj['insulRefl']) != 0 else None,\r\r\n                        recircObj['quality'][0] if len(recircObj['quality']) != 0 else None,\r\r\n                        recircObj['period'][0] if len(recircObj['period']) != 0 else None\r\r\n                        )]\r\r\n    else:\r\r\n        combined_RecircPipings = []\r\r\n    \r\r\n    # Combine the Tanks\r\r\n    tank1 = combineTank(_dhwSystems, 'tank1')\r\r\n    tank2 = combineTank(_dhwSystems, 'tank2')\r\r\n    tank_buffer = combineTank(_dhwSystems, 'tank_buffer')\r\r\n    \r\r\n    # Build the combined / Averaged DHW System\r\r\n    combinedDHWSys = PHPP_DHW_System(\r\r\n                         _name='Combined', \r\r\n                         _usage=combinedUsage,\r\r\n                         _fwdT=60, \r\r\n                         _pCirc=combined_RecircPipings, \r\r\n                         _pBran=combined_BranchPipings, \r\r\n                         _t1=tank1, \r\r\n                         _t2=tank2, \r\r\n                         _tBf=tank_buffer\r\r\n                         )\r\r\n    \r\r\n    return combinedDHWSys\r\r\n\r\r\ndef getLocation(_locationObjs):\r\r\n    climate = []\r\r\n    \r\r\n    if len(_locationObjs) == 0:\r\r\n        return climate\r\r\n    \r\r\n    loc = _locationObjs[0]\r\r\n    print(\"Creating the 'Climate' Objeects...\")\r\r\n    climate.append( PHPP_XL_Obj('Climate', 'D9', loc.Country if loc else 'US-United States of America' )) # Climate Data Set Name (Dropdown)\r\r\n    climate.append( PHPP_XL_Obj('Climate', 'D10', loc.Region if loc else 'New York' )) # Climate Data Set Name (Dropdown)\r\r\n    climate.append( PHPP_XL_Obj('Climate', 'D12', loc.DataSet if loc else 'US0055b-New York' )) # Climate Data Set Name (Dropdown)\r\r\n    climate.append( PHPP_XL_Obj('Climate', 'D18', loc.Altitude if loc else '=D17' )) # Altitude\r\r\n    \r\r\n    return climate\r\r\n\r\r\n##########################################\r\r\n# Figure out the right Rows to start writing\r\r\n# Modify values based on user input (if any)\r\r\nstartRows = {'Additional Ventilation': \r\r\n                {'Rooms':56,\r\r\n                'Vent Unit Selection':97,\r\r\n                'Vent Ducts':127 },\r\r\n            'Components':\r\r\n                {'Ventilator':15},\r\r\n            'Areas':\r\r\n                {'TB':145, 'Surfaces':41},\r\r\n            'Electricity non-res':\r\r\n                {'Lighting': 19,\r\r\n                'Office Equip': 62,\r\r\n                'Kitchen':77},\r\r\n            }\r\r\n\r\r\nif len(udRowStarts_)>0:\r\r\n    startRows = updateStartRows(startRows, udRowStarts_)\r\r\n\r\r\n##########################################\r\r\n# Sort out which zones to include in the output\r\r\n# Filter out any zones not to include\r\r\nif _PHPPObjs.BranchCount>0:\r\r\n    zones = [x.ZoneName for x in _PHPPObjs.Branch(8)]\r\r\n    if len(zonesInclude_)>0: \r\r\n        zones = [x for x in zones if not filterName(x, zonesInclude_)]\r\r\n    if len(zoneExclude_)>0:\r\r\n        zones = [x for x in zones if filterName(x, zoneExclude_)]\r\r\n    print 'Inlcuding Zones {} in the Export'.format(zones)\r\r\n\r\r\n##########################################\r\r\n# Construct the Excel-Ready Write Objects\r\r\ntoPHPP_Geom_ = DataTree[Object]() # Master tree to hold all the results\r\r\nif _PHPPObjs.BranchCount != 0:\r\r\n    uValuesList, uValueUID_Names    = getUvalues( _PHPPObjs.Branch(1) )\r\r\n    winComponentsList               = getComponents( _PHPPObjs.Branch(5) )\r\r\n    areasList, surfacesIncluded     = getAreas( _PHPPObjs.Branch(4), zones )\r\r\n    tb_List                         = getThermalBridges( thermalBridges_, startRows)\r\r\n    winSurfacesList                 = getWindows( _PHPPObjs.Branch(5), surfacesIncluded, _PHPPObjs.Branch(4) )   \r\r\n    shadingList                     = getShading( _PHPPObjs.Branch(5), surfacesIncluded )\r\r\n    tfa                             = getTFA(tfa_, _PHPPObjs.Branch(6), zones)\r\r\n    addnlVentRooms, ventUnitsUsed   = getAddnlVentRooms( _PHPPObjs.Branch(6), _PHPPObjs.Branch(7), zones, startRows )\r\r\n    vent                            = getAddnlVentSystems( _PHPPObjs.Branch(7), ventUnitsUsed, startRows )\r\r\n    airtightness                    = getInfiltration( _PHPPObjs.Branch(8), zones)\r\r\n    ground                          = getGround( grndFloorElements_ if len(grndFloorElements_)>0 else _PHPPObjs.Branch(11), zones )\r\r\n    dhw                             = getDHWSystem( _PHPPObjs.Branch(10), zones )\r\r\n    nonRes_Elec                     = getNonResRoomData( _PHPPObjs.Branch(6), zones, startRows )\r\r\n    location                        = getLocation( _PHPPObjs.Branch(12) )\r\r\n    \r\r\n    ##########################################\r\r\n    # Add all the Excel-Ready Objects to a master Tree for outputting / passing\r\r\n    toPHPP_Geom_.AddRange(uValuesList, GH_Path(0))\r\r\n    toPHPP_Geom_.AddRange(winComponentsList, GH_Path(1))\r\r\n    toPHPP_Geom_.AddRange(areasList, GH_Path(2))\r\r\n    toPHPP_Geom_.AddRange(winSurfacesList, GH_Path(3))\r\r\n    toPHPP_Geom_.AddRange(shadingList, GH_Path(4))\r\r\n    toPHPP_Geom_.AddRange(tfa, GH_Path(5))\r\r\n    toPHPP_Geom_.AddRange(tb_List, GH_Path(6))\r\r\n    toPHPP_Geom_.AddRange(addnlVentRooms, GH_Path(7))\r\r\n    toPHPP_Geom_.AddRange(vent, GH_Path(8))  \r\r\n    toPHPP_Geom_.AddRange(airtightness, GH_Path(9))  \r\r\n    toPHPP_Geom_.AddRange(ground, GH_Path(10)) \r\r\n    toPHPP_Geom_.AddRange(dhw, GH_Path(11)) \r\r\n    toPHPP_Geom_.AddRange(nonRes_Elec, GH_Path(12))\r\r\n    toPHPP_Geom_.AddRange(location, GH_Path(13))\r\r\n    \r\r\n    ##########################################\r\r\n    # Give Warnings\r\r\n    if len(toPHPP_Geom_.Branch(2))/10 > 100:\r\r\n        AreasWarning = 'Warning: It looks like you have {:.0f} surfaces in the model. By Default\\n'\\\r\r\n        'the PHPP can only hold 100 surfaces. Before writing out to the PHPP be sure to\\n '\\\r\r\n        'add more lines to the \"Areas\" worksheet of your excel file.\\n'\\\r\r\n        'After adding lines to the PHPP, be sure to input the correct Start Rows into\\n'\\\r\r\n        'the \"udRowStarts_\" of this component.'.format(len(toPHPP_Geom_.Branch(2))/10)\r\r\n        ghenv.Component.AddRuntimeMessage(ghK.GH_RuntimeMessageLevel.Warning, AreasWarning)\r\r\n    \r\r\n    if len(toPHPP_Geom_.Branch(7))/17 > 30:\r\r\n        VentWarning = 'Warning: It looks like you have {:.0f} rooms in the model. By Default\\n'\\\r\r\n        'the PHPP can only hold 30 different rooms in the Additional Ventilation worksheet.\\n'\\\r\r\n        'Before writing out to the PHPP be sure to add more lines to the\\n'\\\r\r\n        '\"Additional Ventilation\" worksheet in the \"Dimensionsing of Air Quantities\" section.\\n'\\\r\r\n        'After adding lines to the PHPP, be sure to input the correct Start Rows into\\n'\\\r\r\n        'the \"udRowStarts_\" of this component.'.format(len(toPHPP_Geom_.Branch(7))/17)\r\r\n        ghenv.Component.AddRuntimeMessage(ghK.GH_RuntimeMessageLevel.Warning, VentWarning)\r\r\n    \r\r\n    if len(toPHPP_Geom_.Branch(12))/8 > 22:\r\r\n        NonResWarning = 'Warning: It looks like you have {:.0f} Non-Residential Rooms in the model. By Default\\n'\\\r\r\n        'the PHPP can only hold 22 different rooms in the \"Electricity non-res\" worksheet.\\n'\\\r\r\n        'Before writing out to the PHPP be sure to add more lines to the \\n '\\\r\r\n        '\"Electricity non-res\" worksheet in the \"Lighting/non-residential\" section.'.format(len(toPHPP_Geom_.Branch(12))/8)\r\r\n        ghenv.Component.AddRuntimeMessage(ghK.GH_RuntimeMessageLevel.Warning, NonResWarning)\r\n",
  "language": "python",
  "imports": [
    "ghpythonlib",
    "rhinoscriptsyntax",
    "scriptcontext"
  ],
  "has_docstring": true
}