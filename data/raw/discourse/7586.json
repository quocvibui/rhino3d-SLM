{
  "source_url": "https://discourse.mcneel.com/t/python-how-to-get-layer-user-strings/7586",
  "topic_id": 7586,
  "title": "Python : How to get Layer User Strings",
  "question": "Dear Community,\n\n\nI am French speacking person, so sorry in advance for my English.\n\n\nI used to script a lot in RVB and I latly switch to Python. I am totaly ammazed by all the possibiliies.\n\n\nFor 3 days now, in am blocking on a very stupide thing: I would like to know the way to get the same return then the RVB command “rhino.GetLayerUserText(strLayerName)”.\n\n\nI have been trying things like that :\n\n\n\n\nCollecUserStringOnLayer = scriptcontext.doc.Layers[layerIndex].GetUserStrings but the return is : :  <built-in method GetUserStrings of Layer object at 0x00000000000015C3> and I don’t know how to access the values inside…\n\n\n\n\nThank you in advance.\n\n\nLoïc\n\n\nPlease find below the complet code :\n\nCode :\n\n# coding=utf-8\n\n\nimport rhinoscriptsyntax as rs\nimport Rhino \nimport scriptcontext \n\ndef GetAllUserString(layerName):\n\n\tlayerIndex = layerName.LayerIndex\n\tarrReturn = []\n\n\tnb =layerName.UserStringCount\n\n\tCollecUserStringOnLayer = scriptcontext.doc.Layers[layerIndex].GetUserStrings  \n\n\tprint \"Number of user strings : \",nb\n\tprint \"Dir : \" , dir(CollecUserStringOnLayer)\n\tprint \"Value : \" , CollecUserStringOnLayer\n\n\treturn arrReturn\n\n\n\ndef Main():\n\t# Get the layer table of the project\n\tPolygonLayerToProcess = scriptcontext.doc.Layers\n\tLayerCandidate=[]\n\n\t# let the user choose the  layer\n\tChoosenLayer = rs.ListBox(PolygonLayerToProcess,\"Select the polygon layer\", \"Select layer\")\n\tif ChoosenLayer == None:\n\t\treturn False\n\t\n\tarrExistingFieldOnLayer = GetAllUserString(ChoosenLayer)\n\n\nif( __name__ == \"__main__\" ):\n\tMain()",
  "code_blocks": [
    {
      "code": "import rhinoscriptsyntax as rs\nimport Rhino \nimport scriptcontext \n\ndef GetAllUserString(layerName):\n\n\tlayerIndex = layerName.LayerIndex\n\tarrReturn = []\n\n\tnb =layerName.UserStringCount\n\n\tCollecUserStringOnLayer = scriptcontext.doc.Layers[layerIndex].GetUserStrings  \n\n\tprint \"Number of user strings : \",nb\n\tprint \"Dir : \" , dir(CollecUserStringOnLayer)\n\tprint \"Value : \" , CollecUserStringOnLayer\n\n\treturn arrReturn\n\n\n\ndef Main():\n\t# Get the layer table of the project\n\tPolygonLayerToProcess = scriptcontext.doc.Layers\n\tLayerCandidate=[]\n\n\t# let the user choose the  layer\n\tChoosenLayer = rs.ListBox(PolygonLayerToProcess,\"Select the polygon layer\", \"Select layer\")\n\tif ChoosenLayer == None:\n\t\treturn False\n\t\n\tarrExistingFieldOnLayer = GetAllUserString(ChoosenLayer)\n\n\nif( __name__ == \"__main__\" ):\n\tMain()",
      "language": "python",
      "author": "loic",
      "post_number": 1,
      "is_solution": false
    }
  ],
  "tags": [
    "file-io",
    "geometry",
    "layers",
    "python",
    "rhinoscriptsyntax",
    "ui"
  ],
  "has_accepted_answer": false,
  "category_id": 11,
  "posts_count": 3,
  "views": 859
}