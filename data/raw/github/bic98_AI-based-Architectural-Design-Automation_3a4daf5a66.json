{
  "source_url": "https://github.com/bic98/AI-based-Architectural-Design-Automation/blob/1371c5cbfef79af412e2bec5e2158c544e2f2470/08_mapMaker2D/mapAddress.py",
  "repo": "bic98/AI-based-Architectural-Design-Automation",
  "repo_stars": 2,
  "repo_description": null,
  "license": "MIT",
  "filepath": "08_mapMaker2D/mapAddress.py",
  "instruction": "Provides a scripting component.\n    Inputs:\n        x: The x script variable\n        y: The y script variable\n    Output:\n        a: The a output variable",
  "code": "\"\"\"Provides a scripting component.\n    Inputs:\n        x: The x script variable\n        y: The y script variable\n    Output:\n        a: The a output variable\"\"\"\n\n__author__ = \"BaekInchan\"\n__version__ = \"2024.02.08\"\n\nimport rhinoscriptsyntax as rs\nfrom System.Net import HttpWebRequest, WebRequest\nfrom System.IO import StreamReader\nimport json\nimport clr\nclr.AddReference('System.Web.Extensions')\nfrom System.Web.Script.Serialization import JavaScriptSerializer\nvworld_key = \"valid - key\"\n\ndef read(apiurl) : \n    request = WebRequest.Create(apiurl)\n    request.Method = \"GET\"\n    response = request.GetResponse()\n    stream = response.GetResponseStream()\n    reader = StreamReader(stream)\n    responseText = reader.ReadToEnd()\n    return json.loads(responseText)\n\ndef terrain(ymin,xmin,ymax,xmax, typeCol, vworld_key) :\n    params = {\n        \"SERVICE\": \"WFS\",\n        \"REQUEST\": \"GetFeature\",\n        \"TYPENAME\": typeCol,\n        \"BBOX\": \"{0},{1},{2},{3}\".format(ymin, xmin, ymax, xmax),\n        \"VERSION\": \"2.0.0\",\n        \"MAXFEATURES\": \"1000\",\n        \"SRSNAME\": \"EPSG:4326\",\n        \"OUTPUT\": \"application/json\",\n        \"EXCEPTIONS\": \"text/xml\",\n        \"KEY\": vworld_key\n    }\n\n    apiurl = \"https://api.vworld.kr/req/wfs\"\n\n    # params 딕셔너리를 URL 쿼리 스트링으로 변환\n    query_string = \"&\".join([\"{0}={1}\".format(key, value) for key, value in params.items()])\n    full_url = \"{0}?{1}\".format(apiurl,query_string)\n    data = read(full_url)\n    return data\n\n\ndef AddressToCoord(input_address, vworld_key):\n    apiurl = \"https://api.vworld.kr/req/address?service=address&request=getcoord&crs=EPSG:4326&address={0}&format=json&type=road&key={1}\".format(input_address, vworld_key)\n    request = WebRequest.Create(apiurl)\n    request.Method = \"GET\"\n    response = request.GetResponse()\n    stream = response.GetResponseStream()\n    reader = StreamReader(stream)\n    responseText = reader.ReadToEnd()\n    response_data = json.loads(responseText)\n    x_coord = response_data['response']['result']['point']['x']\n    y_coord = response_data['response']['result']['point']['y']\n    return float(x_coord), float(y_coord)\n\ndef divideMap(t, ymin, xmin, ymax, xmax) : \n    rectangles = []\n    current_x = xmin\n    while current_x < xmax:\n        next_x = min(current_x + t, xmax)\n        current_y = ymin\n        while current_y < ymax:\n            next_y = min(current_y + t, ymax)\n            rectangles.append((current_y, current_x, next_y, next_x))\n            current_y += t\n        current_x += t\n    return rectangles\n    \n    \ninfo = []\n\nif Run : \n    xmin, ymin = AddressToCoord(input_address1, vworld_key)\n    xmax, ymax = AddressToCoord(input_address2, vworld_key)\n    if(ymin > ymax) : ymin, ymax = ymax, ymin\n    if(xmin > xmax) : xmin, xmax = xmax, xmin\n    dm = divideMap(0.005, ymin,xmin, ymax, xmax)\n    print(len(dm))\n    if(len(dm) <= 80) : \n        for i in dm : \n            typeM = [\"lt_c_spbd\", \"lt_c_upisuq151\", \"lt_c_wkmstrm\", \"lp_pa_cbnd_bubun\", \"lt_c_uq162\", \"lt_c_upisuq152\"]\n            obj = []\n            for s in typeM : \n                result = JavaScriptSerializer().Serialize(terrain(i[0],i[1],i[2],i[3], s, vworld_key))\n                obj.append(result)\n            info.append(obj)\n\n\ninfo\n\n\n\n",
  "language": "python",
  "imports": [
    "rhinoscriptsyntax"
  ],
  "has_docstring": true
}