{
  "source_url": "https://github.com/compas-dev/compas/blob/HEAD/src/compas_rhino/uninstall_plugin.py",
  "repo": "compas-dev/compas",
  "repo_stars": 352,
  "repo_description": "Main library of the COMPAS framework and CAD integrations for Rhino/GH and Blender.",
  "license": "MIT",
  "filepath": "src/compas_rhino/uninstall_plugin.py",
  "instruction": "Uninstall plugin",
  "code": "from __future__ import absolute_import\nfrom __future__ import division\nfrom __future__ import print_function\n\nimport os\n\nimport compas_rhino\nfrom compas._os import remove_symlink\n\n\ndef uninstall_plugin(plugin, version=None):\n    \"\"\"Uninstall a Rhino Python Command Plugin.\n\n    Parameters\n    ----------\n    plugin : str\n        The name of the plugin.\n    version : {'5.0', '6.0', '7.0', '8.0'}, optional\n        The version of Rhino for which the plugin should be uninstalled.\n        Default is ``'7.0'``.\n\n    Notes\n    -----\n    The version info is only relevant for Rhino on Windows.\n\n    Examples\n    --------\n    .. code-block:: bash\n\n        python -m compas_rhino.uninstall_plugin XXX\n\n    \"\"\"\n    version = compas_rhino._check_rhino_version(version)\n\n    python_plugins_path = compas_rhino._get_rhino_pythonplugins_path(version)\n    plugin_name = plugin.split(\"{\")[0]\n\n    symlinks = []\n    dirs = []\n\n    for name in os.listdir(python_plugins_path):\n        path = os.path.join(python_plugins_path, name)\n\n        if os.path.islink(path):\n            if name.split(\"{\")[0] == plugin_name:\n                symlinks.append(name)\n\n        elif os.path.isdir(path):\n            if name.split(\"{\")[0] == plugin_name:\n                dirs.append(name)\n\n    print(\"\\nUninstalling PlugIn {} from Rhino PythonPlugIns:\".format(plugin_name))\n\n    if not symlinks and not dirs:\n        print(\"Nothing to uninstall...\\n\")\n\n    else:\n        for name in symlinks:\n            print(\"- {}\".format(name))\n            destination = os.path.join(python_plugins_path, name)\n            remove_symlink(destination)\n\n        for name in dirs:\n            print(\"- {}\".format(name))\n            destination = os.path.join(python_plugins_path, name)\n            os.rmdir(destination)\n\n        print(\"\\nPlugIn {} Uninstalled.\\n\".format(plugin_name))\n\n\n# ==============================================================================\n# Main\n# ==============================================================================\n\nif __name__ == \"__main__\":\n    import argparse\n\n    parser = argparse.ArgumentParser()\n\n    parser.add_argument(\"plugin\", help=\"The name of the plugin.\")\n    parser.add_argument(\n        \"-v\",\n        \"--version\",\n        choices=compas_rhino.SUPPORTED_VERSIONS,\n        default=compas_rhino.DEFAULT_VERSION,\n        help=\"The version of Rhino.\",\n    )\n\n    args = parser.parse_args()\n\n    uninstall_plugin(args.plugin, version=args.version)\n",
  "language": "python",
  "imports": [],
  "has_docstring": false
}