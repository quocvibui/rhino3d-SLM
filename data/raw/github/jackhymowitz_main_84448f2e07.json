{
  "source_url": "https://github.com/jackhymowitz/main/blob/7325131db23094f1a28bd184b6a68f864f41a729/01_GH_Components/py/BT_SetVariants.py",
  "repo": "jackhymowitz/main",
  "repo_stars": 0,
  "repo_description": "IDF2PH is a free open source toolkit for working with E+ and PHPP Energy Models",
  "license": "GPL-3.0",
  "filepath": "01_GH_Components/py/BT_SetVariants.py",
  "instruction": "Used to set up any 'Variants' desired in the output PHPP. The 'Variants' worksheet can contol the PHPP all from a single dashboard worksheet. This is useful when doing iterative studies and examining...",
  "code": "#\r\r\n# IDF2PHPP: A Plugin for exporting an EnergyPlus IDF file to the Passive House Planning Package (PHPP). Created by blgdtyp, llc\r\r\n# \r\r\n# This component is part of IDF2PHPP.\r\r\n# \r\r\n# Copyright (c) 2020, bldgtyp, llc <info@bldgtyp.com> \r\r\n# IDF2PHPP is free software; you can redistribute it and/or modify \r\r\n# it under the terms of the GNU General Public License as published \r\r\n# by the Free Software Foundation; either version 3 of the License, \r\r\n# or (at your option) any later version. \r\r\n# \r\r\n# IDF2PHPP is distributed in the hope that it will be useful,\r\r\n# but WITHOUT ANY WARRANTY; without even the implied warranty of \r\r\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the \r\r\n# GNU General Public License for more details.\r\r\n# \r\r\n# For a copy of the GNU General Public License\r\r\n# see <http://www.gnu.org/licenses/>.\r\r\n# \r\r\n# @license GPL-3.0+ <http://spdx.org/licenses/GPL-3.0+>\r\r\n#\r\r\n\"\"\"\r\r\nUsed to set up any 'Variants' desired in the output PHPP. The 'Variants' worksheet can contol the PHPP all from a single dashboard worksheet. This is useful when doing iterative studies and examining the impacts of varying assembly insulation levels, window products, etc.. To use, set the desired categories to 'True' to have this setup the PHPP to refer to the 'Variants' worksheet.\r\r\n-\r\r\nNote: You'll have to set all the variants parameters in that worksheet either before or after writing out to the PHPP here. Best practice is to set up the 'source' PHPP with all the variant schemes and parameters desired before writing.\r\r\n-\r\r\nNote: For the ventilation input, use 'True' to set the ventilation system for a default PHPP. If you are using \r\r\na modified PHPP (XL, added rows to the 'Additional Vent' worksheet, etc..) you can alternately input a list of \r\r\nvalues here in place of a boolean value. These values should correspond to to the:\r\r\n    Ventilation Unit\r\r\n    Duct Insualtion Thickness\r\r\n    Duct Length\r\r\n\r\r\nie: if you have modified the number of rows on the 'Additional Vent' worksheetsuch that the Ventilation unit inputs now start on row 141 and the ducting inputs now start on row 171, enter:\r\r\n    Additional Vent!F141=Variants!D856\r\r\n    Additional Vent!H171=Variants!D858\r\r\n    Additional Vent!H172=Variants!D858\r\r\n    Additional Vent!L171=Variants!D857\r\r\n    Additional Vent!L172=Variants!D857\r\r\nin order to set the variant control for any a typical 2-duct ventilation system.\r\r\n-\r\r\nEM Jul. 21, 2020\r\r\n\r\r\n    Args:\r\r\n        windows_: (bool) True = Set up the windows to refer to the 'Variants' worksheet\r\r\n        uValues_: (bool) True = Set up the 'Areas' to refer to the 'Variants' worksheet\r\r\n        airtightness_: (bool) True = Set airtightness (n50) value to refer to the 'Variants' worksheet\r\r\n        ventilation_: (bool) True = Set Ventilation system to refer to the 'Variants' worksheet\r\r\n        thermalBridges_: (bool) True = Set Thermal Bridge allocation (% value) to refer to the 'Variants' worksheet\r\r\n        certification_: (bool) True = Set Certification options on the 'Verification' worksheet to refer to the 'Variants' worksheet\r\r\n        primaryEnergy_: (bool) True = Set PER worksheet heating, DHW and Cooling system designations to refer to the 'Variants' worksheet\r\r\n    Returns:\r\r\n        variants_: A DataTree of the final clean, Excel-Ready output objects. Each output object has a Worksheet-Name, a Cell Range, and a Value. Connect to the 'Variants_' input on the 'PHPP | 2XL Write' Component to write out to Excel.\r\r\n\"\"\"\r\r\n\r\r\nghenv.Component.Name = \"BT_SetVariants\"\r\r\nghenv.Component.NickName = \"Variants\"\r\r\nghenv.Component.Message = 'JUL_21_2020'\r\r\nghenv.Component.IconDisplayMode = ghenv.Component.IconDisplayMode.application\r\r\nghenv.Component.Category = \"BT\"\r\r\nghenv.Component.SubCategory = \"02 | IDF2PHPP\"\r\r\n\r\r\nfrom System import Object\r\r\nfrom Grasshopper import DataTree\r\r\nfrom Grasshopper.Kernel.Data import GH_Path\r\r\nimport Grasshopper.Kernel as ghK\r\r\nimport scriptcontext as sc\r\r\n\r\r\n# Classes and Defs\r\r\nPHPP_XL_Obj = sc.sticky['PHPP_XL_Obj'] \r\r\npreview = sc.sticky['Preview']\r\r\n\r\r\nvariants_ = DataTree[Object]()\r\r\n\r\r\npaths = {'vent':1, 'uVals':6, 'air':0, 'tb':2, 'cert':3, 'win':4, 'per':5}\r\r\n\r\r\nif windows_:\r\r\n    for i in range(24, 175):\r\r\n        variants_.Add(  PHPP_XL_Obj('Windows', 'T{}'.format(i), '=G{}'.format(i) ), GH_Path( paths['win'] )  )\r\r\n        variants_.Add(  PHPP_XL_Obj('Windows', 'U{}'.format(i), '=H{}'.format(i) ), GH_Path( paths['win'] )  )\r\r\n\r\r\nif uValues_:\r\r\n    for i in range(0, 10):\r\r\n        row_Uval = 17+i*21\r\r\n        row_Variant = 410+i*2\r\r\n        row_Compo = 15+i\r\r\n        \r\r\n        variants_.Add(  PHPP_XL_Obj('U-Values', 'M'+str(row_Uval), '=F'+str(row_Uval) ), GH_Path(paths['uVals'])  )\r\r\n        variants_.Add(  PHPP_XL_Obj('U-Values', 'S'+str(row_Uval), '=G'+str(row_Uval) ), GH_Path(paths['uVals'])  )\r\r\n        variants_.Add(  PHPP_XL_Obj('Variants', 'B'+str(row_Variant), '=Components!D'+str(row_Compo) ), GH_Path(paths['uVals'])  )\r\r\n\r\r\nif airtightness_:\r\r\n    variants_.Add(  PHPP_XL_Obj('Ventilation', 'N27', '=D27' ), GH_Path( paths['air'] )  )\r\r\n\r\r\nif len(ventilation_)==1:\r\r\n    variants_.Add(  PHPP_XL_Obj('Ventilation', 'L12', '=D12' ), GH_Path(100)  )\r\r\n    variants_.Add(  PHPP_XL_Obj('Additional Vent', 'F97', '=Variants!D856' ), GH_Path(paths['vent'])  )\r\r\n    variants_.Add(  PHPP_XL_Obj('Additional Vent', 'H127', '=Variants!D858' ), GH_Path(paths['vent'])  )\r\r\n    variants_.Add(  PHPP_XL_Obj('Additional Vent', 'H128', '=Variants!D858' ), GH_Path(paths['vent'])  )\r\r\n    variants_.Add(  PHPP_XL_Obj('Additional Vent', 'L127', '=Variants!D857' ), GH_Path(paths['vent'])  )\r\r\n    variants_.Add(  PHPP_XL_Obj('Additional Vent', 'L128', '=Variants!D857' ), GH_Path(paths['vent'])  )\r\r\nelif len(ventilation_)==5:\r\r\n    variants_.Add(  PHPP_XL_Obj('Ventilation', 'L12', '=D12' ), GH_Path(100)  )\r\r\n    for each in ventilation_:\r\r\n        first, reference = each.split('=')\r\r\n        wrksht, rng = first.split('!')\r\r\n        variants_.Add(  PHPP_XL_Obj(wrksht, rng, '='+reference ), GH_Path(paths['vent'])  )\r\r\nelif len(ventilation_)!=0:\r\r\n    msg1 = \"Error. ventialtion_ input not understood? Either input TRUE to use the defaults\\n\"\\\r\r\n    \"or input multiline line string with the excel formula to write? Multine string format should look like:\\n\"\\\r\r\n    \"------------\\n\"\\\r\r\n    \"   Additional Vent!F{Your Row Number}=Variants!D856\\n\"\\\r\r\n    \"   Additional Vent!H{Your Row Number}=Variants!D858\\n\"\\\r\r\n    \"   Additional Vent!H{Your Row Number}=Variants!D858\\n\"\\\r\r\n    \"   Additional Vent!L{Your Row Number}=Variants!D857\\n\"\\\r\r\n    \"   Additional Vent!L{Your Row Number}=Variants!D857\\n\"\r\r\n    ghenv.Component.AddRuntimeMessage(ghK.GH_RuntimeMessageLevel.Warning, msg1)\r\r\n\r\r\nif thermalBridges_:\r\r\n    variants_.Add(  PHPP_XL_Obj('Areas', 'R145', '=Variants!D933' ), GH_Path(paths['tb'])  )\r\r\n\r\r\nif certification_:\r\r\n    variants_.Add(  PHPP_XL_Obj('Verification', 'R78', '=Variants!D927' ), GH_Path(paths['cert'])  )\r\r\n    variants_.Add(  PHPP_XL_Obj('Verification', 'R80', '=Variants!D928' ), GH_Path(paths['cert'])  )\r\r\n    variants_.Add(  PHPP_XL_Obj('Verification', 'R82', '=Variants!D929' ), GH_Path(paths['cert'])  )\r\r\n    variants_.Add(  PHPP_XL_Obj('Verification', 'R85', '=Variants!D930' ), GH_Path(paths['cert'])  )\r\r\n    variants_.Add(  PHPP_XL_Obj('Verification', 'R87', '=Variants!D931' ), GH_Path(paths['cert'])  )\r\r\n    \r\r\nif primaryEnergy_:\r\r\n    variants_.Add(  PHPP_XL_Obj('PER', 'P10', '=H10' ), GH_Path(paths['per'])  )\r\r\n    variants_.Add(  PHPP_XL_Obj('PER', 'P12', '=H12' ), GH_Path(paths['per'])  )\r\r\n    variants_.Add(  PHPP_XL_Obj('PER', 'S10', '=I10' ), GH_Path(paths['per'])  )\r\r\n    variants_.Add(  PHPP_XL_Obj('PER', 'T10', '=J10' ), GH_Path(paths['per'])  )\r\r\n\r\n",
  "language": "python",
  "imports": [
    "scriptcontext"
  ],
  "has_docstring": true
}